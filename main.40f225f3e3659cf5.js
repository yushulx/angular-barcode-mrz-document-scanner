"use strict";(self.webpackChunkangular_barcode_qr_code_scanner=self.webpackChunkangular_barcode_qr_code_scanner||[]).push([[179],{942:()=>{function Pt(u){return"function"==typeof u}function Ya(u){const l=u(f=>{Error.call(f),f.stack=(new Error).stack});return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}const Wc=Ya(u=>function(l){u(this),this.message=l?`${l.length} errors occurred during unsubscription:\n${l.map((f,g)=>`${g+1}) ${f.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=l});function $a(u,a){if(u){const l=u.indexOf(a);0<=l&&u.splice(l,1)}}class mi{constructor(a){this.initialTeardown=a,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let a;if(!this.closed){this.closed=!0;const{_parentage:l}=this;if(l)if(this._parentage=null,Array.isArray(l))for(const p of l)p.remove(this);else l.remove(this);const{initialTeardown:f}=this;if(Pt(f))try{f()}catch(p){a=p instanceof Wc?p.errors:[p]}const{_finalizers:g}=this;if(g){this._finalizers=null;for(const p of g)try{H_(p)}catch(_){a=null!=a?a:[],_ instanceof Wc?a=[...a,..._.errors]:a.push(_)}}if(a)throw new Wc(a)}}add(a){var l;if(a&&a!==this)if(this.closed)H_(a);else{if(a instanceof mi){if(a.closed||a._hasParent(this))return;a._addParent(this)}(this._finalizers=null!==(l=this._finalizers)&&void 0!==l?l:[]).push(a)}}_hasParent(a){const{_parentage:l}=this;return l===a||Array.isArray(l)&&l.includes(a)}_addParent(a){const{_parentage:l}=this;this._parentage=Array.isArray(l)?(l.push(a),l):l?[l,a]:a}_removeParent(a){const{_parentage:l}=this;l===a?this._parentage=null:Array.isArray(l)&&$a(l,a)}remove(a){const{_finalizers:l}=this;l&&$a(l,a),a instanceof mi&&a._removeParent(this)}}mi.EMPTY=(()=>{const u=new mi;return u.closed=!0,u})();const U_=mi.EMPTY;function G_(u){return u instanceof mi||u&&"closed"in u&&Pt(u.remove)&&Pt(u.add)&&Pt(u.unsubscribe)}function H_(u){Pt(u)?u():u.unsubscribe()}const Ns={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},zc={setTimeout(u,a,...l){const{delegate:f}=zc;return(null==f?void 0:f.setTimeout)?f.setTimeout(u,a,...l):setTimeout(u,a,...l)},clearTimeout(u){const{delegate:a}=zc;return((null==a?void 0:a.clearTimeout)||clearTimeout)(u)},delegate:void 0};function W_(u){zc.setTimeout(()=>{const{onUnhandledError:a}=Ns;if(!a)throw u;a(u)})}function z_(){}const uI=Fd("C",void 0,void 0);function Fd(u,a,l){return{kind:u,value:a,error:l}}let ks=null;function Yc(u){if(Ns.useDeprecatedSynchronousErrorHandling){const a=!ks;if(a&&(ks={errorThrown:!1,error:null}),u(),a){const{errorThrown:l,error:f}=ks;if(ks=null,l)throw f}}else u()}class Pd extends mi{constructor(a){super(),this.isStopped=!1,a?(this.destination=a,G_(a)&&a.add(this)):this.destination=_I}static create(a,l,f){return new $c(a,l,f)}next(a){this.isStopped?kd(function dI(u){return Fd("N",u,void 0)}(a),this):this._next(a)}error(a){this.isStopped?kd(function hI(u){return Fd("E",void 0,u)}(a),this):(this.isStopped=!0,this._error(a))}complete(){this.isStopped?kd(uI,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(a){this.destination.next(a)}_error(a){try{this.destination.error(a)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const gI=Function.prototype.bind;function Nd(u,a){return gI.call(u,a)}class pI{constructor(a){this.partialObserver=a}next(a){const{partialObserver:l}=this;if(l.next)try{l.next(a)}catch(f){Xc(f)}}error(a){const{partialObserver:l}=this;if(l.error)try{l.error(a)}catch(f){Xc(f)}else Xc(a)}complete(){const{partialObserver:a}=this;if(a.complete)try{a.complete()}catch(l){Xc(l)}}}class $c extends Pd{constructor(a,l,f){let g;if(super(),Pt(a)||!a)g={next:null!=a?a:void 0,error:null!=l?l:void 0,complete:null!=f?f:void 0};else{let p;this&&Ns.useDeprecatedNextContext?(p=Object.create(a),p.unsubscribe=()=>this.unsubscribe(),g={next:a.next&&Nd(a.next,p),error:a.error&&Nd(a.error,p),complete:a.complete&&Nd(a.complete,p)}):g=a}this.destination=new pI(g)}}function Xc(u){Ns.useDeprecatedSynchronousErrorHandling?function fI(u){Ns.useDeprecatedSynchronousErrorHandling&&ks&&(ks.errorThrown=!0,ks.error=u)}(u):W_(u)}function kd(u,a){const{onStoppedNotification:l}=Ns;l&&zc.setTimeout(()=>l(u,a))}const _I={closed:!0,next:z_,error:function mI(u){throw u},complete:z_},Bd="function"==typeof Symbol&&Symbol.observable||"@@observable";function Bs(u){return u}let sn=(()=>{class u{constructor(l){l&&(this._subscribe=l)}lift(l){const f=new u;return f.source=this,f.operator=l,f}subscribe(l,f,g){const p=function yI(u){return u&&u instanceof Pd||function vI(u){return u&&Pt(u.next)&&Pt(u.error)&&Pt(u.complete)}(u)&&G_(u)}(l)?l:new $c(l,f,g);return Yc(()=>{const{operator:_,source:y}=this;p.add(_?_.call(p,y):y?this._subscribe(p):this._trySubscribe(p))}),p}_trySubscribe(l){try{return this._subscribe(l)}catch(f){l.error(f)}}forEach(l,f){return new(f=$_(f))((g,p)=>{const _=new $c({next:y=>{try{l(y)}catch(b){p(b),_.unsubscribe()}},error:p,complete:g});this.subscribe(_)})}_subscribe(l){var f;return null===(f=this.source)||void 0===f?void 0:f.subscribe(l)}[Bd](){return this}pipe(...l){return function Y_(u){return 0===u.length?Bs:1===u.length?u[0]:function(l){return u.reduce((f,g)=>g(f),l)}}(l)(this)}toPromise(l){return new(l=$_(l))((f,g)=>{let p;this.subscribe(_=>p=_,_=>g(_),()=>f(p))})}}return u.create=a=>new u(a),u})();function $_(u){var a;return null!==(a=null!=u?u:Ns.Promise)&&void 0!==a?a:Promise}const CI=Ya(u=>function(){u(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Sr=(()=>{class u extends sn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(l){const f=new X_(this,this);return f.operator=l,f}_throwIfClosed(){if(this.closed)throw new CI}next(l){Yc(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const f of this.currentObservers)f.next(l)}})}error(l){Yc(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=l;const{observers:f}=this;for(;f.length;)f.shift().error(l)}})}complete(){Yc(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:l}=this;for(;l.length;)l.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var l;return(null===(l=this.observers)||void 0===l?void 0:l.length)>0}_trySubscribe(l){return this._throwIfClosed(),super._trySubscribe(l)}_subscribe(l){return this._throwIfClosed(),this._checkFinalizedStatuses(l),this._innerSubscribe(l)}_innerSubscribe(l){const{hasError:f,isStopped:g,observers:p}=this;return f||g?U_:(this.currentObservers=null,p.push(l),new mi(()=>{this.currentObservers=null,$a(p,l)}))}_checkFinalizedStatuses(l){const{hasError:f,thrownError:g,isStopped:p}=this;f?l.error(g):p&&l.complete()}asObservable(){const l=new sn;return l.source=this,l}}return u.create=(a,l)=>new X_(a,l),u})();class X_ extends Sr{constructor(a,l){super(),this.destination=a,this.source=l}next(a){var l,f;null===(f=null===(l=this.destination)||void 0===l?void 0:l.next)||void 0===f||f.call(l,a)}error(a){var l,f;null===(f=null===(l=this.destination)||void 0===l?void 0:l.error)||void 0===f||f.call(l,a)}complete(){var a,l;null===(l=null===(a=this.destination)||void 0===a?void 0:a.complete)||void 0===l||l.call(a)}_subscribe(a){var l,f;return null!==(f=null===(l=this.source)||void 0===l?void 0:l.subscribe(a))&&void 0!==f?f:U_}}function q_(u){return Pt(null==u?void 0:u.lift)}function Dn(u){return a=>{if(q_(a))return a.lift(function(l){try{return u(l,this)}catch(f){this.error(f)}});throw new TypeError("Unable to lift unknown Observable type")}}function Cn(u,a,l,f,g){return new EI(u,a,l,f,g)}class EI extends Pd{constructor(a,l,f,g,p,_){super(a),this.onFinalize=p,this.shouldUnsubscribe=_,this._next=l?function(y){try{l(y)}catch(b){a.error(b)}}:super._next,this._error=g?function(y){try{g(y)}catch(b){a.error(b)}finally{this.unsubscribe()}}:super._error,this._complete=f?function(){try{f()}catch(y){a.error(y)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var a;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:l}=this;super.unsubscribe(),!l&&(null===(a=this.onFinalize)||void 0===a||a.call(this))}}}function Nt(u,a){return Dn((l,f)=>{let g=0;l.subscribe(Cn(f,p=>{f.next(u.call(a,p,g++))}))})}function Vs(u){return this instanceof Vs?(this.v=u,this):new Vs(u)}function DI(u,a,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g,f=l.apply(u,a||[]),p=[];return g={},_("next"),_("throw"),_("return"),g[Symbol.asyncIterator]=function(){return this},g;function _(k){f[k]&&(g[k]=function(V){return new Promise(function(H,z){p.push([k,V,H,z])>1||y(k,V)})})}function y(k,V){try{!function b(k){k.value instanceof Vs?Promise.resolve(k.value.v).then(O,M):P(p[0][2],k)}(f[k](V))}catch(H){P(p[0][3],H)}}function O(k){y("next",k)}function M(k){y("throw",k)}function P(k,V){k(V),p.shift(),p.length&&y(p[0][0],p[0][1])}}function SI(u){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,a=u[Symbol.asyncIterator];return a?a.call(u):(u=function Q_(u){var a="function"==typeof Symbol&&Symbol.iterator,l=a&&u[a],f=0;if(l)return l.call(u);if(u&&"number"==typeof u.length)return{next:function(){return u&&f>=u.length&&(u=void 0),{value:u&&u[f++],done:!u}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}(u),l={},f("next"),f("throw"),f("return"),l[Symbol.asyncIterator]=function(){return this},l);function f(p){l[p]=u[p]&&function(_){return new Promise(function(y,b){!function g(p,_,y,b){Promise.resolve(b).then(function(O){p({value:O,done:y})},_)}(y,b,(_=u[p](_)).done,_.value)})}}}const J_=u=>u&&"number"==typeof u.length&&"function"!=typeof u;function ev(u){return Pt(null==u?void 0:u.then)}function tv(u){return Pt(u[Bd])}function nv(u){return Symbol.asyncIterator&&Pt(null==u?void 0:u[Symbol.asyncIterator])}function iv(u){return new TypeError(`You provided ${null!==u&&"object"==typeof u?"an invalid object":`'${u}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const rv=function II(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function sv(u){return Pt(null==u?void 0:u[rv])}function ov(u){return DI(this,arguments,function*(){const l=u.getReader();try{for(;;){const{value:f,done:g}=yield Vs(l.read());if(g)return yield Vs(void 0);yield yield Vs(f)}}finally{l.releaseLock()}})}function av(u){return Pt(null==u?void 0:u.getReader)}function er(u){if(u instanceof sn)return u;if(null!=u){if(tv(u))return function xI(u){return new sn(a=>{const l=u[Bd]();if(Pt(l.subscribe))return l.subscribe(a);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(u);if(J_(u))return function AI(u){return new sn(a=>{for(let l=0;l<u.length&&!a.closed;l++)a.next(u[l]);a.complete()})}(u);if(ev(u))return function RI(u){return new sn(a=>{u.then(l=>{a.closed||(a.next(l),a.complete())},l=>a.error(l)).then(null,W_)})}(u);if(nv(u))return lv(u);if(sv(u))return function OI(u){return new sn(a=>{for(const l of u)if(a.next(l),a.closed)return;a.complete()})}(u);if(av(u))return function MI(u){return lv(ov(u))}(u)}throw iv(u)}function lv(u){return new sn(a=>{(function LI(u,a){var l,f,g,p;return function wI(u,a,l,f){return new(l||(l=Promise))(function(p,_){function y(M){try{O(f.next(M))}catch(P){_(P)}}function b(M){try{O(f.throw(M))}catch(P){_(P)}}function O(M){M.done?p(M.value):function g(p){return p instanceof l?p:new l(function(_){_(p)})}(M.value).then(y,b)}O((f=f.apply(u,a||[])).next())})}(this,void 0,void 0,function*(){try{for(l=SI(u);!(f=yield l.next()).done;)if(a.next(f.value),a.closed)return}catch(_){g={error:_}}finally{try{f&&!f.done&&(p=l.return)&&(yield p.call(l))}finally{if(g)throw g.error}}a.complete()})})(u,a).catch(l=>a.error(l))})}function Tr(u,a,l,f=0,g=!1){const p=a.schedule(function(){l(),g?u.add(this.schedule(null,f)):this.unsubscribe()},f);if(u.add(p),!g)return p}function En(u,a,l=1/0){return Pt(a)?En((f,g)=>Nt((p,_)=>a(f,p,g,_))(er(u(f,g))),l):("number"==typeof a&&(l=a),Dn((f,g)=>function FI(u,a,l,f,g,p,_,y){const b=[];let O=0,M=0,P=!1;const k=()=>{P&&!b.length&&!O&&a.complete()},V=z=>O<f?H(z):b.push(z),H=z=>{p&&a.next(z),O++;let Y=!1;er(l(z,M++)).subscribe(Cn(a,X=>{null==g||g(X),p?V(X):a.next(X)},()=>{Y=!0},void 0,()=>{if(Y)try{for(O--;b.length&&O<f;){const X=b.shift();_?Tr(a,_,()=>H(X)):H(X)}k()}catch(X){a.error(X)}}))};return u.subscribe(Cn(a,V,()=>{P=!0,k()})),()=>{null==y||y()}}(f,g,u,l)))}function Xa(u=1/0){return En(Bs,u)}const Ir=new sn(u=>u.complete());function jd(u){return u[u.length-1]}function cv(u){return Pt(jd(u))?u.pop():void 0}function qa(u){return function NI(u){return u&&Pt(u.schedule)}(jd(u))?u.pop():void 0}function uv(u,a=0){return Dn((l,f)=>{l.subscribe(Cn(f,g=>Tr(f,u,()=>f.next(g),a),()=>Tr(f,u,()=>f.complete(),a),g=>Tr(f,u,()=>f.error(g),a)))})}function hv(u,a=0){return Dn((l,f)=>{f.add(u.schedule(()=>l.subscribe(f),a))})}function dv(u,a){if(!u)throw new Error("Iterable cannot be null");return new sn(l=>{Tr(l,a,()=>{const f=u[Symbol.asyncIterator]();Tr(l,a,()=>{f.next().then(g=>{g.done?l.complete():l.next(g.value)})},0,!0)})})}function wn(u,a){return a?function HI(u,a){if(null!=u){if(tv(u))return function BI(u,a){return er(u).pipe(hv(a),uv(a))}(u,a);if(J_(u))return function jI(u,a){return new sn(l=>{let f=0;return a.schedule(function(){f===u.length?l.complete():(l.next(u[f++]),l.closed||this.schedule())})})}(u,a);if(ev(u))return function VI(u,a){return er(u).pipe(hv(a),uv(a))}(u,a);if(nv(u))return dv(u,a);if(sv(u))return function UI(u,a){return new sn(l=>{let f;return Tr(l,a,()=>{f=u[rv](),Tr(l,a,()=>{let g,p;try{({value:g,done:p}=f.next())}catch(_){return void l.error(_)}p?l.complete():l.next(g)},0,!0)}),()=>Pt(null==f?void 0:f.return)&&f.return()})}(u,a);if(av(u))return function GI(u,a){return dv(ov(u),a)}(u,a)}throw iv(u)}(u,a):er(u)}function qc(u){return u<=0?()=>Ir:Dn((a,l)=>{let f=0;a.subscribe(Cn(l,g=>{++f<=u&&(l.next(g),u<=f&&l.complete())}))})}function Ud(u,a,...l){return!0===a?(u(),null):!1===a?null:a(...l).pipe(qc(1)).subscribe(()=>u())}function Ot(u){for(let a in u)if(u[a]===Ot)return a;throw Error("Could not find renamed property on target object.")}function Gd(u,a){for(const l in a)a.hasOwnProperty(l)&&!u.hasOwnProperty(l)&&(u[l]=a[l])}function Dt(u){if("string"==typeof u)return u;if(Array.isArray(u))return"["+u.map(Dt).join(", ")+"]";if(null==u)return""+u;if(u.overriddenName)return`${u.overriddenName}`;if(u.name)return`${u.name}`;const a=u.toString();if(null==a)return""+a;const l=a.indexOf("\n");return-1===l?a:a.substring(0,l)}function Hd(u,a){return null==u||""===u?null===a?"":a:null==a||""===a?u:u+" "+a}const YI=Ot({__forward_ref__:Ot});function kt(u){return u.__forward_ref__=kt,u.toString=function(){return Dt(this())},u}function et(u){return fv(u)?u():u}function fv(u){return"function"==typeof u&&u.hasOwnProperty(YI)&&u.__forward_ref__===kt}class yt extends Error{constructor(a,l){super(function Wd(u,a){return`NG0${Math.abs(u)}${a?": "+a:""}`}(a,l)),this.code=a}}function Xe(u){return"string"==typeof u?u:null==u?"":String(u)}function Sn(u){return"function"==typeof u?u.name||u.toString():"object"==typeof u&&null!=u&&"function"==typeof u.type?u.type.name||u.type.toString():Xe(u)}function Zc(u,a){const l=a?` in ${a}`:"";throw new yt(-201,`No provider for ${Sn(u)} found${l}`)}function ei(u,a){null==u&&function Mt(u,a,l,f){throw new Error(`ASSERTION ERROR: ${u}`+(null==f?"":` [Expected=> ${l} ${f} ${a} <=Actual]`))}(a,u,null,"!=")}function mt(u){return{token:u.token,providedIn:u.providedIn||null,factory:u.factory,value:void 0}}function Pi(u){return{providers:u.providers||[],imports:u.imports||[]}}function zd(u){return gv(u,Kc)||gv(u,mv)}function gv(u,a){return u.hasOwnProperty(a)?u[a]:null}function pv(u){return u&&(u.hasOwnProperty(Yd)||u.hasOwnProperty(JI))?u[Yd]:null}const Kc=Ot({\u0275prov:Ot}),Yd=Ot({\u0275inj:Ot}),mv=Ot({ngInjectableDef:Ot}),JI=Ot({ngInjectorDef:Ot});var ze=(()=>((ze=ze||{})[ze.Default=0]="Default",ze[ze.Host=1]="Host",ze[ze.Self=2]="Self",ze[ze.SkipSelf=4]="SkipSelf",ze[ze.Optional=8]="Optional",ze))();let $d;function rs(u){const a=$d;return $d=u,a}function _v(u,a,l){const f=zd(u);return f&&"root"==f.providedIn?void 0===f.value?f.value=f.factory():f.value:l&ze.Optional?null:void 0!==a?a:void Zc(Dt(u),"Injector")}function ss(u){return{toString:u}.toString()}var Ni=(()=>((Ni=Ni||{})[Ni.OnPush=0]="OnPush",Ni[Ni.Default=1]="Default",Ni))(),tr=(()=>{return(u=tr||(tr={}))[u.Emulated=0]="Emulated",u[u.None=2]="None",u[u.ShadowDom=3]="ShadowDom",tr;var u})();const tx="undefined"!=typeof globalThis&&globalThis,nx="undefined"!=typeof window&&window,ix="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,xt=tx||"undefined"!=typeof global&&global||nx||ix,Eo={},Lt=[],Qc=Ot({\u0275cmp:Ot}),Xd=Ot({\u0275dir:Ot}),qd=Ot({\u0275pipe:Ot}),vv=Ot({\u0275mod:Ot}),Ar=Ot({\u0275fac:Ot}),Za=Ot({__NG_ELEMENT_ID__:Ot});let rx=0;function os(u){return ss(()=>{const l={},f={type:u.type,providersResolver:null,decls:u.decls,vars:u.vars,factory:null,template:u.template||null,consts:u.consts||null,ngContentSelectors:u.ngContentSelectors,hostBindings:u.hostBindings||null,hostVars:u.hostVars||0,hostAttrs:u.hostAttrs||null,contentQueries:u.contentQueries||null,declaredInputs:l,inputs:null,outputs:null,exportAs:u.exportAs||null,onPush:u.changeDetection===Ni.OnPush,directiveDefs:null,pipeDefs:null,selectors:u.selectors||Lt,viewQuery:u.viewQuery||null,features:u.features||null,data:u.data||{},encapsulation:u.encapsulation||tr.Emulated,id:"c",styles:u.styles||Lt,_:null,setInput:null,schemas:u.schemas||null,tView:null},g=u.directives,p=u.features,_=u.pipes;return f.id+=rx++,f.inputs=wv(u.inputs,l),f.outputs=wv(u.outputs),p&&p.forEach(y=>y(f)),f.directiveDefs=g?()=>("function"==typeof g?g():g).map(yv):null,f.pipeDefs=_?()=>("function"==typeof _?_():_).map(Cv):null,f})}function yv(u){return On(u)||function as(u){return u[Xd]||null}(u)}function Cv(u){return function js(u){return u[qd]||null}(u)}const Ev={};function nr(u){return ss(()=>{const a={type:u.type,bootstrap:u.bootstrap||Lt,declarations:u.declarations||Lt,imports:u.imports||Lt,exports:u.exports||Lt,transitiveCompileScopes:null,schemas:u.schemas||null,id:u.id||null};return null!=u.id&&(Ev[u.id]=u.type),a})}function wv(u,a){if(null==u)return Eo;const l={};for(const f in u)if(u.hasOwnProperty(f)){let g=u[f],p=g;Array.isArray(g)&&(p=g[1],g=g[0]),l[g]=f,a&&(a[g]=p)}return l}const He=os;function On(u){return u[Qc]||null}function _i(u,a){const l=u[vv]||null;if(!l&&!0===a)throw new Error(`Type ${Dt(u)} does not have '\u0275mod' property.`);return l}function ir(u){return Array.isArray(u)&&"object"==typeof u[1]}function Bi(u){return Array.isArray(u)&&!0===u[1]}function Qd(u){return 0!=(8&u.flags)}function nu(u){return 2==(2&u.flags)}function iu(u){return 1==(1&u.flags)}function Vi(u){return null!==u.template}function ux(u){return 0!=(512&u[2])}function Ws(u,a){return u.hasOwnProperty(Ar)?u[Ar]:null}class fx{constructor(a,l,f){this.previousValue=a,this.currentValue=l,this.firstChange=f}isFirstChange(){return this.firstChange}}function yi(){return Dv}function Dv(u){return u.type.prototype.ngOnChanges&&(u.setInput=px),gx}function gx(){const u=Tv(this),a=null==u?void 0:u.current;if(a){const l=u.previous;if(l===Eo)u.previous=a;else for(let f in a)l[f]=a[f];u.current=null,this.ngOnChanges(a)}}function px(u,a,l,f){const g=Tv(u)||function mx(u,a){return u[Sv]=a}(u,{previous:Eo,current:null}),p=g.current||(g.current={}),_=g.previous,y=this.declaredInputs[l],b=_[y];p[y]=new fx(b&&b.currentValue,a,_===Eo),u[f]=a}yi.ngInherit=!0;const Sv="__ngSimpleChanges__";function Tv(u){return u[Sv]||null}let rf;function $t(u){return!!u.listen}const Iv={createRenderer:(u,a)=>function sf(){return void 0!==rf?rf:"undefined"!=typeof document?document:void 0}()};function on(u){for(;Array.isArray(u);)u=u[0];return u}function ru(u,a){return on(a[u])}function Ei(u,a){return on(a[u.index])}function of(u,a){return u.data[a]}function ni(u,a){const l=a[u];return ir(l)?l:l[0]}function af(u){return 128==(128&u[2])}function ls(u,a){return null==a?null:u[a]}function Av(u){u[18]=0}function lf(u,a){u[5]+=a;let l=u,f=u[3];for(;null!==f&&(1===a&&1===l[5]||-1===a&&0===l[5]);)f[5]+=a,l=f,f=f[3]}const qe={lFrame:Bv(null),bindingsEnabled:!0};function Ov(){return qe.bindingsEnabled}function me(){return qe.lFrame.lView}function Ct(){return qe.lFrame.tView}function pn(){let u=Mv();for(;null!==u&&64===u.type;)u=u.parent;return u}function Mv(){return qe.lFrame.currentTNode}function rr(u,a){const l=qe.lFrame;l.currentTNode=u,l.isParent=a}function cf(){return qe.lFrame.isParent}function Io(){return qe.lFrame.bindingIndex++}function Fx(u,a){const l=qe.lFrame;l.bindingIndex=l.bindingRootIndex=u,hf(a)}function hf(u){qe.lFrame.currentDirectiveIndex=u}function ff(u){qe.lFrame.currentQueryIndex=u}function Nx(u){const a=u[1];return 2===a.type?a.declTNode:1===a.type?u[6]:null}function Nv(u,a,l){if(l&ze.SkipSelf){let g=a,p=u;for(;!(g=g.parent,null!==g||l&ze.Host||(g=Nx(p),null===g||(p=p[15],10&g.type))););if(null===g)return!1;a=g,u=p}const f=qe.lFrame=kv();return f.currentTNode=a,f.lView=u,!0}function ou(u){const a=kv(),l=u[1];qe.lFrame=a,a.currentTNode=l.firstChild,a.lView=u,a.tView=l,a.contextLView=u,a.bindingIndex=l.bindingStartIndex,a.inI18n=!1}function kv(){const u=qe.lFrame,a=null===u?null:u.child;return null===a?Bv(u):a}function Bv(u){const a={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:u,child:null,inI18n:!1};return null!==u&&(u.child=a),a}function Vv(){const u=qe.lFrame;return qe.lFrame=u.parent,u.currentTNode=null,u.lView=null,u}const jv=Vv;function au(){const u=Vv();u.isParent=!0,u.tView=null,u.selectedIndex=-1,u.contextLView=null,u.elementDepthCount=0,u.currentDirectiveIndex=-1,u.currentNamespace=null,u.bindingRootIndex=-1,u.bindingIndex=-1,u.currentQueryIndex=0}function Vn(){return qe.lFrame.selectedIndex}function cs(u){qe.lFrame.selectedIndex=u}function Xt(){const u=qe.lFrame;return of(u.tView,u.selectedIndex)}function lu(u,a){for(let l=a.directiveStart,f=a.directiveEnd;l<f;l++){const p=u.data[l].type.prototype,{ngAfterContentInit:_,ngAfterContentChecked:y,ngAfterViewInit:b,ngAfterViewChecked:O,ngOnDestroy:M}=p;_&&(u.contentHooks||(u.contentHooks=[])).push(-l,_),y&&((u.contentHooks||(u.contentHooks=[])).push(l,y),(u.contentCheckHooks||(u.contentCheckHooks=[])).push(l,y)),b&&(u.viewHooks||(u.viewHooks=[])).push(-l,b),O&&((u.viewHooks||(u.viewHooks=[])).push(l,O),(u.viewCheckHooks||(u.viewCheckHooks=[])).push(l,O)),null!=M&&(u.destroyHooks||(u.destroyHooks=[])).push(l,M)}}function cu(u,a,l){Uv(u,a,3,l)}function uu(u,a,l,f){(3&u[2])===l&&Uv(u,a,l,f)}function gf(u,a){let l=u[2];(3&l)===a&&(l&=2047,l+=1,u[2]=l)}function Uv(u,a,l,f){const p=null!=f?f:-1,_=a.length-1;let y=0;for(let b=void 0!==f?65535&u[18]:0;b<_;b++)if("number"==typeof a[b+1]){if(y=a[b],null!=f&&y>=f)break}else a[b]<0&&(u[18]+=65536),(y<p||-1==p)&&(zx(u,l,a,b),u[18]=(4294901760&u[18])+b+2),b++}function zx(u,a,l,f){const g=l[f]<0,p=l[f+1],y=u[g?-l[f]:l[f]];if(g){if(u[2]>>11<u[18]>>16&&(3&u[2])===a){u[2]+=2048;try{p.call(y)}finally{}}}else try{p.call(y)}finally{}}class tl{constructor(a,l,f){this.factory=a,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=f}}function hu(u,a,l){const f=$t(u);let g=0;for(;g<l.length;){const p=l[g];if("number"==typeof p){if(0!==p)break;g++;const _=l[g++],y=l[g++],b=l[g++];f?u.setAttribute(a,y,b,_):a.setAttributeNS(_,y,b)}else{const _=p,y=l[++g];mf(_)?f&&u.setProperty(a,_,y):f?u.setAttribute(a,_,y):a.setAttribute(_,y),g++}}return g}function Gv(u){return 3===u||4===u||6===u}function mf(u){return 64===u.charCodeAt(0)}function du(u,a){if(null!==a&&0!==a.length)if(null===u||0===u.length)u=a.slice();else{let l=-1;for(let f=0;f<a.length;f++){const g=a[f];"number"==typeof g?l=g:0===l||Hv(u,l,g,null,-1===l||2===l?a[++f]:null)}}return u}function Hv(u,a,l,f,g){let p=0,_=u.length;if(-1===a)_=-1;else for(;p<u.length;){const y=u[p++];if("number"==typeof y){if(y===a){_=-1;break}if(y>a){_=p-1;break}}}for(;p<u.length;){const y=u[p];if("number"==typeof y)break;if(y===l){if(null===f)return void(null!==g&&(u[p+1]=g));if(f===u[p+1])return void(u[p+2]=g)}p++,null!==f&&p++,null!==g&&p++}-1!==_&&(u.splice(_,0,a),p=_+1),u.splice(p++,0,l),null!==f&&u.splice(p++,0,f),null!==g&&u.splice(p++,0,g)}function Wv(u){return-1!==u}function xo(u){return 32767&u}function Ao(u,a){let l=function Zx(u){return u>>16}(u),f=a;for(;l>0;)f=f[15],l--;return f}let _f=!0;function fu(u){const a=_f;return _f=u,a}let Kx=0;function il(u,a){const l=yf(u,a);if(-1!==l)return l;const f=a[1];f.firstCreatePass&&(u.injectorIndex=a.length,vf(f.data,u),vf(a,null),vf(f.blueprint,null));const g=gu(u,a),p=u.injectorIndex;if(Wv(g)){const _=xo(g),y=Ao(g,a),b=y[1].data;for(let O=0;O<8;O++)a[p+O]=y[_+O]|b[_+O]}return a[p+8]=g,p}function vf(u,a){u.push(0,0,0,0,0,0,0,0,a)}function yf(u,a){return-1===u.injectorIndex||u.parent&&u.parent.injectorIndex===u.injectorIndex||null===a[u.injectorIndex+8]?-1:u.injectorIndex}function gu(u,a){if(u.parent&&-1!==u.parent.injectorIndex)return u.parent.injectorIndex;let l=0,f=null,g=a;for(;null!==g;){const p=g[1],_=p.type;if(f=2===_?p.declTNode:1===_?g[6]:null,null===f)return-1;if(l++,g=g[15],-1!==f.injectorIndex)return f.injectorIndex|l<<16}return-1}function pu(u,a,l){!function Qx(u,a,l){let f;"string"==typeof l?f=l.charCodeAt(0)||0:l.hasOwnProperty(Za)&&(f=l[Za]),null==f&&(f=l[Za]=Kx++);const g=255&f;a.data[u+(g>>5)]|=1<<g}(u,a,l)}function $v(u,a,l){if(l&ze.Optional)return u;Zc(a,"NodeInjector")}function Xv(u,a,l,f){if(l&ze.Optional&&void 0===f&&(f=null),0==(l&(ze.Self|ze.Host))){const g=u[9],p=rs(void 0);try{return g?g.get(a,f,l&ze.Optional):_v(a,f,l&ze.Optional)}finally{rs(p)}}return $v(f,a,l)}function qv(u,a,l,f=ze.Default,g){if(null!==u){const p=function nA(u){if("string"==typeof u)return u.charCodeAt(0)||0;const a=u.hasOwnProperty(Za)?u[Za]:void 0;return"number"==typeof a?a>=0?255&a:eA:a}(l);if("function"==typeof p){if(!Nv(a,u,f))return f&ze.Host?$v(g,l,f):Xv(a,l,f,g);try{const _=p(f);if(null!=_||f&ze.Optional)return _;Zc(l)}finally{jv()}}else if("number"==typeof p){let _=null,y=yf(u,a),b=-1,O=f&ze.Host?a[16][6]:null;for((-1===y||f&ze.SkipSelf)&&(b=-1===y?gu(u,a):a[y+8],-1!==b&&Qv(f,!1)?(_=a[1],y=xo(b),a=Ao(b,a)):y=-1);-1!==y;){const M=a[1];if(Kv(p,y,M.data)){const P=tA(y,a,l,_,f,O);if(P!==Zv)return P}b=a[y+8],-1!==b&&Qv(f,a[1].data[y+8]===O)&&Kv(p,y,a)?(_=M,y=xo(b),a=Ao(b,a)):y=-1}}}return Xv(a,l,f,g)}const Zv={};function eA(){return new Ro(pn(),me())}function tA(u,a,l,f,g,p){const _=a[1],y=_.data[u+8],M=function mu(u,a,l,f,g){const p=u.providerIndexes,_=a.data,y=1048575&p,b=u.directiveStart,M=p>>20,k=g?y+M:u.directiveEnd;for(let V=f?y:y+M;V<k;V++){const H=_[V];if(V<b&&l===H||V>=b&&H.type===l)return V}if(g){const V=_[b];if(V&&Vi(V)&&V.type===l)return b}return null}(y,_,l,null==f?nu(y)&&_f:f!=_&&0!=(3&y.type),g&ze.Host&&p===y);return null!==M?rl(a,_,M,y):Zv}function rl(u,a,l,f){let g=u[l];const p=a.data;if(function Yx(u){return u instanceof tl}(g)){const _=g;_.resolving&&function $I(u,a){const l=a?`. Dependency path: ${a.join(" > ")} > ${u}`:"";throw new yt(-200,`Circular dependency in DI detected for ${u}${l}`)}(Sn(p[l]));const y=fu(_.canSeeViewProviders);_.resolving=!0;const b=_.injectImpl?rs(_.injectImpl):null;Nv(u,f,ze.Default);try{g=u[l]=_.factory(void 0,p,u,f),a.firstCreatePass&&l>=f.directiveStart&&function Wx(u,a,l){const{ngOnChanges:f,ngOnInit:g,ngDoCheck:p}=a.type.prototype;if(f){const _=Dv(a);(l.preOrderHooks||(l.preOrderHooks=[])).push(u,_),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(u,_)}g&&(l.preOrderHooks||(l.preOrderHooks=[])).push(0-u,g),p&&((l.preOrderHooks||(l.preOrderHooks=[])).push(u,p),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(u,p))}(l,p[l],a)}finally{null!==b&&rs(b),fu(y),_.resolving=!1,jv()}}return g}function Kv(u,a,l){return!!(l[a+(u>>5)]&1<<u)}function Qv(u,a){return!(u&ze.Self||u&ze.Host&&a)}class Ro{constructor(a,l){this._tNode=a,this._lView=l}get(a,l,f){return qv(this._tNode,this._lView,a,f,l)}}function Cf(u){return fv(u)?()=>{const a=Cf(et(u));return a&&a()}:Ws(u)}const Mo="__parameters__";function Fo(u,a,l){return ss(()=>{const f=function Ef(u){return function(...l){if(u){const f=u(...l);for(const g in f)this[g]=f[g]}}}(a);function g(...p){if(this instanceof g)return f.apply(this,p),this;const _=new g(...p);return y.annotation=_,y;function y(b,O,M){const P=b.hasOwnProperty(Mo)?b[Mo]:Object.defineProperty(b,Mo,{value:[]})[Mo];for(;P.length<=M;)P.push(null);return(P[M]=P[M]||[]).push(_),b}}return l&&(g.prototype=Object.create(l.prototype)),g.prototype.ngMetadataName=u,g.annotationCls=g,g})}class ct{constructor(a,l){this._desc=a,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=mt({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}toString(){return`InjectionToken ${this._desc}`}}const rA=new ct("AnalyzeForEntryComponents");function sr(u,a){u.forEach(l=>Array.isArray(l)?sr(l,a):a(l))}function ey(u,a,l){a>=u.length?u.push(l):u.splice(a,0,l)}function _u(u,a){return a>=u.length-1?u.pop():u.splice(a,1)[0]}function ii(u,a,l){let f=Po(u,a);return f>=0?u[1|f]=l:(f=~f,function aA(u,a,l,f){let g=u.length;if(g==a)u.push(l,f);else if(1===g)u.push(f,u[0]),u[0]=l;else{for(g--,u.push(u[g-1],u[g]);g>a;)u[g]=u[g-2],g--;u[a]=l,u[a+1]=f}}(u,f,a,l)),f}function bf(u,a){const l=Po(u,a);if(l>=0)return u[1|l]}function Po(u,a){return function iy(u,a,l){let f=0,g=u.length>>l;for(;g!==f;){const p=f+(g-f>>1),_=u[p<<l];if(a===_)return p<<l;_>a?g=p:f=p+1}return~(g<<l)}(u,a,1)}const cl={},Sf="__NG_DI_FLAG__",yu="ngTempTokenPath",gA=/\n/gm,sy="__source",mA=Ot({provide:String,useValue:Ot});let ul;function oy(u){const a=ul;return ul=u,a}function _A(u,a=ze.Default){if(void 0===ul)throw new yt(203,"");return null===ul?_v(u,void 0,a):ul.get(u,a&ze.Optional?null:void 0,a)}function We(u,a=ze.Default){return(function ex(){return $d}()||_A)(et(u),a)}const vA=We;function Tf(u){const a=[];for(let l=0;l<u.length;l++){const f=et(u[l]);if(Array.isArray(f)){if(0===f.length)throw new yt(900,"");let g,p=ze.Default;for(let _=0;_<f.length;_++){const y=f[_],b=yA(y);"number"==typeof b?-1===b?g=y.token:p|=b:g=y}a.push(We(g,p))}else a.push(We(f))}return a}function hl(u,a){return u[Sf]=a,u.prototype[Sf]=a,u}function yA(u){return u[Sf]}const Cu=hl(Fo("Inject",u=>({token:u})),-1),hs=hl(Fo("Optional"),8),dl=hl(Fo("SkipSelf"),4);class py{constructor(a){this.changingThisBreaksApplicationSecurity=a}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function ds(u){return u instanceof py?u.changingThisBreaksApplicationSecurity:u}const UA=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,GA=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var an=(()=>((an=an||{})[an.NONE=0]="NONE",an[an.HTML=1]="HTML",an[an.STYLE=2]="STYLE",an[an.SCRIPT=3]="SCRIPT",an[an.URL=4]="URL",an[an.RESOURCE_URL=5]="RESOURCE_URL",an))();function Ff(u){const a=function ml(){const u=me();return u&&u[12]}();return a?a.sanitize(an.URL,u)||"":function gl(u,a){const l=function kA(u){return u instanceof py&&u.getTypeName()||null}(u);if(null!=l&&l!==a){if("ResourceURL"===l&&"URL"===a)return!0;throw new Error(`Required a safe ${a}, got a ${l} (see https://g.co/ng/security#xss)`)}return l===a}(u,"URL")?ds(u):function Du(u){return(u=String(u)).match(UA)||u.match(GA)?u:"unsafe:"+u}(Xe(u))}const Sy="__ngContext__";function Fn(u,a){u[Sy]=a}function Nf(u){const a=function _l(u){return u[Sy]||null}(u);return a?Array.isArray(a)?a:a.lView:null}function Bf(u){return u.ngOriginalError}function hR(u,...a){u.error(...a)}class vl{constructor(){this._console=console}handleError(a){const l=this._findOriginalError(a),f=function uR(u){return u&&u.ngErrorLogger||hR}(a);f(this._console,"ERROR",a),l&&f(this._console,"ORIGINAL ERROR",l)}_findOriginalError(a){let l=a&&Bf(a);for(;l&&Bf(l);)l=Bf(l);return l||null}}const ER=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(xt))();function ar(u){return u instanceof Function?u():u}var ri=(()=>((ri=ri||{})[ri.Important=1]="Important",ri[ri.DashCase=2]="DashCase",ri))();function jf(u,a){return undefined(u,a)}function yl(u){const a=u[3];return Bi(a)?a[3]:a}function Uf(u){return Fy(u[13])}function Gf(u){return Fy(u[4])}function Fy(u){for(;null!==u&&!Bi(u);)u=u[4];return u}function Vo(u,a,l,f,g){if(null!=f){let p,_=!1;Bi(f)?p=f:ir(f)&&(_=!0,f=f[0]);const y=on(f);0===u&&null!==l?null==g?jy(a,l,y):zs(a,l,y,g||null,!0):1===u&&null!==l?zs(a,l,y,g||null,!0):2===u?function $y(u,a,l){const f=Tu(u,a);f&&function PR(u,a,l,f){$t(u)?u.removeChild(a,l,f):a.removeChild(l)}(u,f,a,l)}(a,y,_):3===u&&a.destroyNode(y),null!=p&&function BR(u,a,l,f,g){const p=l[7];p!==on(l)&&Vo(a,u,f,p,g);for(let y=10;y<l.length;y++){const b=l[y];Cl(b[1],b,u,a,f,p)}}(a,u,p,l,g)}}function Wf(u,a,l){if($t(u))return u.createElement(a,l);{const f=null!==l?function Cx(u){const a=u.toLowerCase();return"svg"===a?"http://www.w3.org/2000/svg":"math"===a?"http://www.w3.org/1998/MathML/":null}(l):null;return null===f?u.createElement(a):u.createElementNS(f,a)}}function Ny(u,a){const l=u[9],f=l.indexOf(a),g=a[3];1024&a[2]&&(a[2]&=-1025,lf(g,-1)),l.splice(f,1)}function zf(u,a){if(u.length<=10)return;const l=10+a,f=u[l];if(f){const g=f[17];null!==g&&g!==u&&Ny(g,f),a>0&&(u[l-1][4]=f[4]);const p=_u(u,10+a);!function IR(u,a){Cl(u,a,a[11],2,null,null),a[0]=null,a[6]=null}(f[1],f);const _=p[19];null!==_&&_.detachView(p[1]),f[3]=null,f[4]=null,f[2]&=-129}return f}function ky(u,a){if(!(256&a[2])){const l=a[11];$t(l)&&l.destroyNode&&Cl(u,a,l,3,null,null),function RR(u){let a=u[13];if(!a)return Yf(u[1],u);for(;a;){let l=null;if(ir(a))l=a[13];else{const f=a[10];f&&(l=f)}if(!l){for(;a&&!a[4]&&a!==u;)ir(a)&&Yf(a[1],a),a=a[3];null===a&&(a=u),ir(a)&&Yf(a[1],a),l=a&&a[4]}a=l}}(a)}}function Yf(u,a){if(!(256&a[2])){a[2]&=-129,a[2]|=256,function FR(u,a){let l;if(null!=u&&null!=(l=u.destroyHooks))for(let f=0;f<l.length;f+=2){const g=a[l[f]];if(!(g instanceof tl)){const p=l[f+1];if(Array.isArray(p))for(let _=0;_<p.length;_+=2){const y=g[p[_]],b=p[_+1];try{b.call(y)}finally{}}else try{p.call(g)}finally{}}}}(u,a),function LR(u,a){const l=u.cleanup,f=a[7];let g=-1;if(null!==l)for(let p=0;p<l.length-1;p+=2)if("string"==typeof l[p]){const _=l[p+1],y="function"==typeof _?_(a):on(a[_]),b=f[g=l[p+2]],O=l[p+3];"boolean"==typeof O?y.removeEventListener(l[p],b,O):O>=0?f[g=O]():f[g=-O].unsubscribe(),p+=2}else{const _=f[g=l[p+1]];l[p].call(_)}if(null!==f){for(let p=g+1;p<f.length;p++)f[p]();a[7]=null}}(u,a),1===a[1].type&&$t(a[11])&&a[11].destroy();const l=a[17];if(null!==l&&Bi(a[3])){l!==a[3]&&Ny(l,a);const f=a[19];null!==f&&f.detachView(u)}}}function By(u,a,l){return function Vy(u,a,l){let f=a;for(;null!==f&&40&f.type;)f=(a=f).parent;if(null===f)return l[0];if(2&f.flags){const g=u.data[f.directiveStart].encapsulation;if(g===tr.None||g===tr.Emulated)return null}return Ei(f,l)}(u,a.parent,l)}function zs(u,a,l,f,g){$t(u)?u.insertBefore(a,l,f,g):a.insertBefore(l,f,g)}function jy(u,a,l){$t(u)?u.appendChild(a,l):a.appendChild(l)}function Uy(u,a,l,f,g){null!==f?zs(u,a,l,f,g):jy(u,a,l)}function Tu(u,a){return $t(u)?u.parentNode(a):a.parentNode}let Wy=function Hy(u,a,l){return 40&u.type?Ei(u,l):null};function Iu(u,a,l,f){const g=By(u,f,a),p=a[11],y=function Gy(u,a,l){return Wy(u,a,l)}(f.parent||a[6],f,a);if(null!=g)if(Array.isArray(l))for(let b=0;b<l.length;b++)Uy(p,g,l[b],y,!1);else Uy(p,g,l,y,!1)}function xu(u,a){if(null!==a){const l=a.type;if(3&l)return Ei(a,u);if(4&l)return Xf(-1,u[a.index]);if(8&l){const f=a.child;if(null!==f)return xu(u,f);{const g=u[a.index];return Bi(g)?Xf(-1,g):on(g)}}if(32&l)return jf(a,u)()||on(u[a.index]);{const f=Yy(u,a);return null!==f?Array.isArray(f)?f[0]:xu(yl(u[16]),f):xu(u,a.next)}}return null}function Yy(u,a){return null!==a?u[16][6].projection[a.projection]:null}function Xf(u,a){const l=10+u+1;if(l<a.length){const f=a[l],g=f[1].firstChild;if(null!==g)return xu(f,g)}return a[7]}function qf(u,a,l,f,g,p,_){for(;null!=l;){const y=f[l.index],b=l.type;if(_&&0===a&&(y&&Fn(on(y),f),l.flags|=4),64!=(64&l.flags))if(8&b)qf(u,a,l.child,f,g,p,!1),Vo(a,u,g,y,p);else if(32&b){const O=jf(l,f);let M;for(;M=O();)Vo(a,u,g,M,p);Vo(a,u,g,y,p)}else 16&b?Xy(u,a,f,l,g,p):Vo(a,u,g,y,p);l=_?l.projectionNext:l.next}}function Cl(u,a,l,f,g,p){qf(l,f,u.firstChild,a,g,p,!1)}function Xy(u,a,l,f,g,p){const _=l[16],b=_[6].projection[f.projection];if(Array.isArray(b))for(let O=0;O<b.length;O++)Vo(a,u,g,b[O],p);else qf(u,a,b,_[3],g,p,!0)}function qy(u,a,l){$t(u)?u.setAttribute(a,"style",l):a.style.cssText=l}function Zf(u,a,l){$t(u)?""===l?u.removeAttribute(a,"class"):u.setAttribute(a,"class",l):a.className=l}function Zy(u,a,l){let f=u.length;for(;;){const g=u.indexOf(a,l);if(-1===g)return g;if(0===g||u.charCodeAt(g-1)<=32){const p=a.length;if(g+p===f||u.charCodeAt(g+p)<=32)return g}l=g+1}}const Ky="ng-template";function jR(u,a,l){let f=0;for(;f<u.length;){let g=u[f++];if(l&&"class"===g){if(g=u[f],-1!==Zy(g.toLowerCase(),a,0))return!0}else if(1===g){for(;f<u.length&&"string"==typeof(g=u[f++]);)if(g.toLowerCase()===a)return!0;return!1}}return!1}function Qy(u){return 4===u.type&&u.value!==Ky}function UR(u,a,l){return a===(4!==u.type||l?u.value:Ky)}function GR(u,a,l){let f=4;const g=u.attrs||[],p=function zR(u){for(let a=0;a<u.length;a++)if(Gv(u[a]))return a;return u.length}(g);let _=!1;for(let y=0;y<a.length;y++){const b=a[y];if("number"!=typeof b){if(!_)if(4&f){if(f=2|1&f,""!==b&&!UR(u,b,l)||""===b&&1===a.length){if(ji(f))return!1;_=!0}}else{const O=8&f?b:a[++y];if(8&f&&null!==u.attrs){if(!jR(u.attrs,O,l)){if(ji(f))return!1;_=!0}continue}const P=HR(8&f?"class":b,g,Qy(u),l);if(-1===P){if(ji(f))return!1;_=!0;continue}if(""!==O){let k;k=P>p?"":g[P+1].toLowerCase();const V=8&f?k:null;if(V&&-1!==Zy(V,O,0)||2&f&&O!==k){if(ji(f))return!1;_=!0}}}}else{if(!_&&!ji(f)&&!ji(b))return!1;if(_&&ji(b))continue;_=!1,f=b|1&f}}return ji(f)||_}function ji(u){return 0==(1&u)}function HR(u,a,l,f){if(null===a)return-1;let g=0;if(f||!l){let p=!1;for(;g<a.length;){const _=a[g];if(_===u)return g;if(3===_||6===_)p=!0;else{if(1===_||2===_){let y=a[++g];for(;"string"==typeof y;)y=a[++g];continue}if(4===_)break;if(0===_){g+=4;continue}}g+=p?1:2}return-1}return function YR(u,a){let l=u.indexOf(4);if(l>-1)for(l++;l<u.length;){const f=u[l];if("number"==typeof f)return-1;if(f===a)return l;l++}return-1}(a,u)}function Jy(u,a,l=!1){for(let f=0;f<a.length;f++)if(GR(u,a[f],l))return!0;return!1}function e0(u,a){return u?":not("+a.trim()+")":a}function XR(u){let a=u[0],l=1,f=2,g="",p=!1;for(;l<u.length;){let _=u[l];if("string"==typeof _)if(2&f){const y=u[++l];g+="["+_+(y.length>0?'="'+y+'"':"")+"]"}else 8&f?g+="."+_:4&f&&(g+=" "+_);else""!==g&&!ji(_)&&(a+=e0(p,g),g=""),f=_,p=p||!ji(f);l++}return""!==g&&(a+=e0(p,g)),a}const Ze={};function lr(u){t0(Ct(),me(),Vn()+u,!1)}function t0(u,a,l,f){if(!f)if(3==(3&a[2])){const p=u.preOrderCheckHooks;null!==p&&cu(a,p,l)}else{const p=u.preOrderHooks;null!==p&&uu(a,p,0,l)}cs(l)}function Au(u,a){return u<<17|a<<2}function Ui(u){return u>>17&32767}function Kf(u){return 2|u}function Mr(u){return(131068&u)>>2}function Qf(u,a){return-131069&u|a<<2}function Jf(u){return 1|u}function f0(u,a){const l=u.contentQueries;if(null!==l)for(let f=0;f<l.length;f+=2){const g=l[f],p=l[f+1];if(-1!==p){const _=u.data[p];ff(g),_.contentQueries(2,a[p],p)}}}function El(u,a,l,f,g,p,_,y,b,O){const M=a.blueprint.slice();return M[0]=g,M[2]=140|f,Av(M),M[3]=M[15]=u,M[8]=l,M[10]=_||u&&u[10],M[11]=y||u&&u[11],M[12]=b||u&&u[12]||null,M[9]=O||u&&u[9]||null,M[6]=p,M[16]=2==a.type?u[16]:M,M}function jo(u,a,l,f,g){let p=u.data[a];if(null===p)p=function lg(u,a,l,f,g){const p=Mv(),_=cf(),b=u.data[a]=function dO(u,a,l,f,g,p){return{type:l,index:f,insertBeforeIndex:null,injectorIndex:a?a.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:g,attrs:p,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:a,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,_?p:p&&p.parent,l,a,f,g);return null===u.firstChild&&(u.firstChild=b),null!==p&&(_?null==p.child&&null!==b.parent&&(p.child=b):null===p.next&&(p.next=b)),b}(u,a,l,f,g),function Lx(){return qe.lFrame.inI18n}()&&(p.flags|=64);else if(64&p.type){p.type=l,p.value=f,p.attrs=g;const _=function el(){const u=qe.lFrame,a=u.currentTNode;return u.isParent?a:a.parent}();p.injectorIndex=null===_?-1:_.injectorIndex}return rr(p,!0),p}function Uo(u,a,l,f){if(0===l)return-1;const g=a.length;for(let p=0;p<l;p++)a.push(f),u.blueprint.push(f),u.data.push(null);return g}function wl(u,a,l){ou(a);try{const f=u.viewQuery;null!==f&&_g(1,f,l);const g=u.template;null!==g&&g0(u,a,g,1,l),u.firstCreatePass&&(u.firstCreatePass=!1),u.staticContentQueries&&f0(u,a),u.staticViewQueries&&_g(2,u.viewQuery,l);const p=u.components;null!==p&&function cO(u,a){for(let l=0;l<a.length;l++)RO(u,a[l])}(a,p)}catch(f){throw u.firstCreatePass&&(u.incompleteFirstPass=!0,u.firstCreatePass=!1),f}finally{a[2]&=-5,au()}}function Go(u,a,l,f){const g=a[2];if(256!=(256&g)){ou(a);try{Av(a),function Lv(u){return qe.lFrame.bindingIndex=u}(u.bindingStartIndex),null!==l&&g0(u,a,l,2,f);const _=3==(3&g);if(_){const O=u.preOrderCheckHooks;null!==O&&cu(a,O,null)}else{const O=u.preOrderHooks;null!==O&&uu(a,O,0,null),gf(a,0)}if(function xO(u){for(let a=Uf(u);null!==a;a=Gf(a)){if(!a[2])continue;const l=a[9];for(let f=0;f<l.length;f++){const g=l[f],p=g[3];0==(1024&g[2])&&lf(p,1),g[2]|=1024}}}(a),function IO(u){for(let a=Uf(u);null!==a;a=Gf(a))for(let l=10;l<a.length;l++){const f=a[l],g=f[1];af(f)&&Go(g,f,g.template,f[8])}}(a),null!==u.contentQueries&&f0(u,a),_){const O=u.contentCheckHooks;null!==O&&cu(a,O)}else{const O=u.contentHooks;null!==O&&uu(a,O,1),gf(a,1)}!function aO(u,a){const l=u.hostBindingOpCodes;if(null!==l)try{for(let f=0;f<l.length;f++){const g=l[f];if(g<0)cs(~g);else{const p=g,_=l[++f],y=l[++f];Fx(_,p),y(2,a[p])}}}finally{cs(-1)}}(u,a);const y=u.components;null!==y&&function lO(u,a){for(let l=0;l<a.length;l++)AO(u,a[l])}(a,y);const b=u.viewQuery;if(null!==b&&_g(2,b,f),_){const O=u.viewCheckHooks;null!==O&&cu(a,O)}else{const O=u.viewHooks;null!==O&&uu(a,O,2),gf(a,2)}!0===u.firstUpdatePass&&(u.firstUpdatePass=!1),a[2]&=-73,1024&a[2]&&(a[2]&=-1025,lf(a[3],-1))}finally{au()}}}function uO(u,a,l,f){const g=a[10],_=function xv(u){return 4==(4&u[2])}(a);try{!_&&g.begin&&g.begin(),_&&wl(u,a,f),Go(u,a,l,f)}finally{!_&&g.end&&g.end()}}function g0(u,a,l,f,g){const p=Vn(),_=2&f;try{cs(-1),_&&a.length>20&&t0(u,a,20,!1),l(f,g)}finally{cs(p)}}function cg(u,a,l){!Ov()||(function yO(u,a,l,f){const g=l.directiveStart,p=l.directiveEnd;u.firstCreatePass||il(l,a),Fn(f,a);const _=l.initialInputs;for(let y=g;y<p;y++){const b=u.data[y],O=Vi(b);O&&DO(a,l,b);const M=rl(a,u,y,l);Fn(M,a),null!==_&&SO(0,y-g,M,b,0,_),O&&(ni(l.index,a)[8]=M)}}(u,a,l,Ei(l,a)),128==(128&l.flags)&&function CO(u,a,l){const f=l.directiveStart,g=l.directiveEnd,_=l.index,y=function Px(){return qe.lFrame.currentDirectiveIndex}();try{cs(_);for(let b=f;b<g;b++){const O=u.data[b],M=a[b];hf(b),(null!==O.hostBindings||0!==O.hostVars||null!==O.hostAttrs)&&b0(O,M)}}finally{cs(-1),hf(y)}}(u,a,l))}function ug(u,a,l=Ei){const f=a.localNames;if(null!==f){let g=a.index+1;for(let p=0;p<f.length;p+=2){const _=f[p+1],y=-1===_?l(a,u):u[_];u[g++]=y}}}function m0(u){const a=u.tView;return null===a||a.incompleteFirstPass?u.tView=Mu(1,null,u.template,u.decls,u.vars,u.directiveDefs,u.pipeDefs,u.viewQuery,u.schemas,u.consts):a}function Mu(u,a,l,f,g,p,_,y,b,O){const M=20+f,P=M+g,k=function hO(u,a){const l=[];for(let f=0;f<a;f++)l.push(f<u?null:Ze);return l}(M,P),V="function"==typeof O?O():O;return k[1]={type:u,blueprint:k,template:l,queries:null,viewQuery:y,declTNode:a,data:k.slice().fill(null,M),bindingStartIndex:M,expandoStartIndex:P,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof p?p():p,pipeRegistry:"function"==typeof _?_():_,firstChild:null,schemas:b,consts:V,incompleteFirstPass:!1}}function C0(u,a,l){for(let f in u)if(u.hasOwnProperty(f)){const g=u[f];(l=null===l?{}:l).hasOwnProperty(f)?l[f].push(a,g):l[f]=[a,g]}return l}function hg(u,a,l,f){let g=!1;if(Ov()){const p=function EO(u,a,l){const f=u.directiveRegistry;let g=null;if(f)for(let p=0;p<f.length;p++){const _=f[p];Jy(l,_.selectors,!1)&&(g||(g=[]),pu(il(l,a),u,_.type),Vi(_)?(D0(u,l),g.unshift(_)):g.push(_))}return g}(u,a,l),_=null===f?null:{"":-1};if(null!==p){g=!0,S0(l,u.data.length,p.length);for(let M=0;M<p.length;M++){const P=p[M];P.providersResolver&&P.providersResolver(P)}let y=!1,b=!1,O=Uo(u,a,p.length,null);for(let M=0;M<p.length;M++){const P=p[M];l.mergedAttrs=du(l.mergedAttrs,P.hostAttrs),T0(u,l,a,O,P),bO(O,P,_),null!==P.contentQueries&&(l.flags|=8),(null!==P.hostBindings||null!==P.hostAttrs||0!==P.hostVars)&&(l.flags|=128);const k=P.type.prototype;!y&&(k.ngOnChanges||k.ngOnInit||k.ngDoCheck)&&((u.preOrderHooks||(u.preOrderHooks=[])).push(l.index),y=!0),!b&&(k.ngOnChanges||k.ngDoCheck)&&((u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(l.index),b=!0),O++}!function fO(u,a){const f=a.directiveEnd,g=u.data,p=a.attrs,_=[];let y=null,b=null;for(let O=a.directiveStart;O<f;O++){const M=g[O],P=M.inputs,k=null===p||Qy(a)?null:TO(P,p);_.push(k),y=C0(P,O,y),b=C0(M.outputs,O,b)}null!==y&&(y.hasOwnProperty("class")&&(a.flags|=16),y.hasOwnProperty("style")&&(a.flags|=32)),a.initialInputs=_,a.inputs=y,a.outputs=b}(u,l)}_&&function wO(u,a,l){if(a){const f=u.localNames=[];for(let g=0;g<a.length;g+=2){const p=l[a[g+1]];if(null==p)throw new yt(-301,!1);f.push(a[g],p)}}}(l,f,_)}return l.mergedAttrs=du(l.mergedAttrs,l.attrs),g}function w0(u,a,l,f,g,p){const _=p.hostBindings;if(_){let y=u.hostBindingOpCodes;null===y&&(y=u.hostBindingOpCodes=[]);const b=~a.index;(function vO(u){let a=u.length;for(;a>0;){const l=u[--a];if("number"==typeof l&&l<0)return l}return 0})(y)!=b&&y.push(b),y.push(f,g,_)}}function b0(u,a){null!==u.hostBindings&&u.hostBindings(1,a)}function D0(u,a){a.flags|=2,(u.components||(u.components=[])).push(a.index)}function bO(u,a,l){if(l){if(a.exportAs)for(let f=0;f<a.exportAs.length;f++)l[a.exportAs[f]]=u;Vi(a)&&(l[""]=u)}}function S0(u,a,l){u.flags|=1,u.directiveStart=a,u.directiveEnd=a+l,u.providerIndexes=a}function T0(u,a,l,f,g){u.data[f]=g;const p=g.factory||(g.factory=Ws(g.type)),_=new tl(p,Vi(g),null);u.blueprint[f]=_,l[f]=_,w0(u,a,0,f,Uo(u,l,g.hostVars,Ze),g)}function DO(u,a,l){const f=Ei(a,u),g=m0(l),p=u[10],_=Lu(u,El(u,g,null,l.onPush?64:16,f,a,p,p.createRenderer(f,l),null,null));u[a.index]=_}function cr(u,a,l,f,g,p){const _=Ei(u,a);!function dg(u,a,l,f,g,p,_){if(null==p)$t(u)?u.removeAttribute(a,g,l):a.removeAttribute(g);else{const y=null==_?Xe(p):_(p,f||"",g);$t(u)?u.setAttribute(a,g,y,l):l?a.setAttributeNS(l,g,y):a.setAttribute(g,y)}}(a[11],_,p,u.value,l,f,g)}function SO(u,a,l,f,g,p){const _=p[a];if(null!==_){const y=f.setInput;for(let b=0;b<_.length;){const O=_[b++],M=_[b++],P=_[b++];null!==y?f.setInput(l,P,O,M):l[M]=P}}}function TO(u,a){let l=null,f=0;for(;f<a.length;){const g=a[f];if(0!==g)if(5!==g){if("number"==typeof g)break;u.hasOwnProperty(g)&&(null===l&&(l=[]),l.push(g,u[g],a[f+1])),f+=2}else f+=2;else f+=4}return l}function I0(u,a,l,f){return new Array(u,!0,!1,a,null,0,f,l,null,null)}function AO(u,a){const l=ni(a,u);if(af(l)){const f=l[1];80&l[2]?Go(f,l,f.template,l[8]):l[5]>0&&fg(l)}}function fg(u){for(let f=Uf(u);null!==f;f=Gf(f))for(let g=10;g<f.length;g++){const p=f[g];if(1024&p[2]){const _=p[1];Go(_,p,_.template,p[8])}else p[5]>0&&fg(p)}const l=u[1].components;if(null!==l)for(let f=0;f<l.length;f++){const g=ni(l[f],u);af(g)&&g[5]>0&&fg(g)}}function RO(u,a){const l=ni(a,u),f=l[1];(function OO(u,a){for(let l=a.length;l<u.blueprint.length;l++)a.push(u.blueprint[l])})(f,l),wl(f,l,l[8])}function Lu(u,a){return u[13]?u[14][4]=a:u[13]=a,u[14]=a,a}function gg(u){for(;u;){u[2]|=64;const a=yl(u);if(ux(u)&&!a)return u;u=a}return null}function x0(u){!function pg(u){for(let a=0;a<u.components.length;a++){const l=u.components[a],f=Nf(l),g=f[1];uO(g,f,g.template,l)}}(u[8])}function _g(u,a,l){ff(0),a(u,l)}const LO=(()=>Promise.resolve(null))();function A0(u){return u[7]||(u[7]=[])}function R0(u){return u.cleanup||(u.cleanup=[])}function M0(u,a){const l=u[9],f=l?l.get(vl,null):null;f&&f.handleError(a)}function L0(u,a,l,f,g){for(let p=0;p<l.length;){const _=l[p++],y=l[p++],b=a[_],O=u.data[_];null!==O.setInput?O.setInput(b,g,f,y):b[y]=g}}function Lr(u,a,l){const f=ru(a,u);!function Py(u,a,l){$t(u)?u.setValue(a,l):a.textContent=l}(u[11],f,l)}function Fu(u,a,l){let f=l?u.styles:null,g=l?u.classes:null,p=0;if(null!==a)for(let _=0;_<a.length;_++){const y=a[_];"number"==typeof y?p=y:1==p?g=Hd(g,y):2==p&&(f=Hd(f,y+": "+a[++_]+";"))}l?u.styles=f:u.stylesWithoutHost=f,l?u.classes=g:u.classesWithoutHost=g}const vg=new ct("INJECTOR",-1);class F0{get(a,l=cl){if(l===cl){const f=new Error(`NullInjectorError: No provider for ${Dt(a)}!`);throw f.name="NullInjectorError",f}return l}}const yg=new ct("Set Injector scope."),bl={},NO={};let Cg;function P0(){return void 0===Cg&&(Cg=new F0),Cg}function N0(u,a=null,l=null,f){const g=k0(u,a,l,f);return g._resolveInjectorDefTypes(),g}function k0(u,a=null,l=null,f){return new kO(u,l,a||P0(),f)}class kO{constructor(a,l,f,g=null){this.parent=f,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const p=[];l&&sr(l,y=>this.processProvider(y,a,l)),sr([a],y=>this.processInjectorType(y,[],p)),this.records.set(vg,Ho(void 0,this));const _=this.records.get(yg);this.scope=null!=_?_.value:null,this.source=g||("object"==typeof a?null:Dt(a))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(a=>a.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(a,l=cl,f=ze.Default){this.assertNotDestroyed();const g=oy(this),p=rs(void 0);try{if(!(f&ze.SkipSelf)){let y=this.records.get(a);if(void 0===y){const b=function zO(u){return"function"==typeof u||"object"==typeof u&&u instanceof ct}(a)&&zd(a);y=b&&this.injectableDefInScope(b)?Ho(Eg(a),bl):null,this.records.set(a,y)}if(null!=y)return this.hydrate(a,y)}return(f&ze.Self?P0():this.parent).get(a,l=f&ze.Optional&&l===cl?null:l)}catch(_){if("NullInjectorError"===_.name){if((_[yu]=_[yu]||[]).unshift(Dt(a)),g)throw _;return function CA(u,a,l,f){const g=u[yu];throw a[sy]&&g.unshift(a[sy]),u.message=function EA(u,a,l,f=null){u=u&&"\n"===u.charAt(0)&&"\u0275"==u.charAt(1)?u.substr(2):u;let g=Dt(a);if(Array.isArray(a))g=a.map(Dt).join(" -> ");else if("object"==typeof a){let p=[];for(let _ in a)if(a.hasOwnProperty(_)){let y=a[_];p.push(_+":"+("string"==typeof y?JSON.stringify(y):Dt(y)))}g=`{${p.join(", ")}}`}return`${l}${f?"("+f+")":""}[${g}]: ${u.replace(gA,"\n  ")}`}("\n"+u.message,g,l,f),u.ngTokenPath=g,u[yu]=null,u}(_,a,"R3InjectorError",this.source)}throw _}finally{rs(p),oy(g)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(a=>this.get(a))}toString(){const a=[];return this.records.forEach((f,g)=>a.push(Dt(g))),`R3Injector[${a.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new yt(205,!1)}processInjectorType(a,l,f){if(!(a=et(a)))return!1;let g=pv(a);const p=null==g&&a.ngModule||void 0,_=void 0===p?a:p,y=-1!==f.indexOf(_);if(void 0!==p&&(g=pv(p)),null==g)return!1;if(null!=g.imports&&!y){let M;f.push(_);try{sr(g.imports,P=>{this.processInjectorType(P,l,f)&&(void 0===M&&(M=[]),M.push(P))})}finally{}if(void 0!==M)for(let P=0;P<M.length;P++){const{ngModule:k,providers:V}=M[P];sr(V,H=>this.processProvider(H,k,V||Lt))}}this.injectorDefTypes.add(_);const b=Ws(_)||(()=>new _);this.records.set(_,Ho(b,bl));const O=g.providers;if(null!=O&&!y){const M=a;sr(O,P=>this.processProvider(P,M,O))}return void 0!==p&&void 0!==a.providers}processProvider(a,l,f){let g=Wo(a=et(a))?a:et(a&&a.provide);const p=function VO(u,a,l){return V0(u)?Ho(void 0,u.useValue):Ho(B0(u),bl)}(a);if(Wo(a)||!0!==a.multi)this.records.get(g);else{let _=this.records.get(g);_||(_=Ho(void 0,bl,!0),_.factory=()=>Tf(_.multi),this.records.set(g,_)),g=a,_.multi.push(a)}this.records.set(g,p)}hydrate(a,l){return l.value===bl&&(l.value=NO,l.value=l.factory()),"object"==typeof l.value&&l.value&&function WO(u){return null!==u&&"object"==typeof u&&"function"==typeof u.ngOnDestroy}(l.value)&&this.onDestroy.add(l.value),l.value}injectableDefInScope(a){if(!a.providedIn)return!1;const l=et(a.providedIn);return"string"==typeof l?"any"===l||l===this.scope:this.injectorDefTypes.has(l)}}function Eg(u){const a=zd(u),l=null!==a?a.factory:Ws(u);if(null!==l)return l;if(u instanceof ct)throw new yt(204,!1);if(u instanceof Function)return function BO(u){const a=u.length;if(a>0)throw function ll(u,a){const l=[];for(let f=0;f<u;f++)l.push(a);return l}(a,"?"),new yt(204,!1);const l=function KI(u){const a=u&&(u[Kc]||u[mv]);if(a){const l=function QI(u){if(u.hasOwnProperty("name"))return u.name;const a=(""+u).match(/^function\s*([^\s(]+)/);return null===a?"":a[1]}(u);return console.warn(`DEPRECATED: DI is instantiating a token "${l}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${l}" class.`),a}return null}(u);return null!==l?()=>l.factory(u):()=>new u}(u);throw new yt(204,!1)}function B0(u,a,l){let f;if(Wo(u)){const g=et(u);return Ws(g)||Eg(g)}if(V0(u))f=()=>et(u.useValue);else if(function UO(u){return!(!u||!u.useFactory)}(u))f=()=>u.useFactory(...Tf(u.deps||[]));else if(function jO(u){return!(!u||!u.useExisting)}(u))f=()=>We(et(u.useExisting));else{const g=et(u&&(u.useClass||u.provide));if(!function HO(u){return!!u.deps}(u))return Ws(g)||Eg(g);f=()=>new g(...Tf(u.deps))}return f}function Ho(u,a,l=!1){return{factory:u,value:a,multi:l?[]:void 0}}function V0(u){return null!==u&&"object"==typeof u&&mA in u}function Wo(u){return"function"==typeof u}let Xn=(()=>{class u{static create(l,f){var g;if(Array.isArray(l))return N0({name:""},f,l,"");{const p=null!==(g=l.name)&&void 0!==g?g:"";return N0({name:p},l.parent,l.providers,p)}}}return u.THROW_IF_NOT_FOUND=cl,u.NULL=new F0,u.\u0275prov=mt({token:u,providedIn:"any",factory:()=>We(vg)}),u.__NG_ELEMENT_ID__=-1,u})();function JO(u,a){lu(Nf(u)[1],pn())}function St(u){let a=function K0(u){return Object.getPrototypeOf(u.prototype).constructor}(u.type),l=!0;const f=[u];for(;a;){let g;if(Vi(u))g=a.\u0275cmp||a.\u0275dir;else{if(a.\u0275cmp)throw new yt(903,"");g=a.\u0275dir}if(g){if(l){f.push(g);const _=u;_.inputs=Dg(u.inputs),_.declaredInputs=Dg(u.declaredInputs),_.outputs=Dg(u.outputs);const y=g.hostBindings;y&&i1(u,y);const b=g.viewQuery,O=g.contentQueries;if(b&&t1(u,b),O&&n1(u,O),Gd(u.inputs,g.inputs),Gd(u.declaredInputs,g.declaredInputs),Gd(u.outputs,g.outputs),Vi(g)&&g.data.animation){const M=u.data;M.animation=(M.animation||[]).concat(g.data.animation)}}const p=g.features;if(p)for(let _=0;_<p.length;_++){const y=p[_];y&&y.ngInherit&&y(u),y===St&&(l=!1)}}a=Object.getPrototypeOf(a)}!function e1(u){let a=0,l=null;for(let f=u.length-1;f>=0;f--){const g=u[f];g.hostVars=a+=g.hostVars,g.hostAttrs=du(g.hostAttrs,l=du(l,g.hostAttrs))}}(f)}function Dg(u){return u===Eo?{}:u===Lt?[]:u}function t1(u,a){const l=u.viewQuery;u.viewQuery=l?(f,g)=>{a(f,g),l(f,g)}:a}function n1(u,a){const l=u.contentQueries;u.contentQueries=l?(f,g,p)=>{a(f,g,p),l(f,g,p)}:a}function i1(u,a){const l=u.hostBindings;u.hostBindings=l?(f,g)=>{a(f,g),l(f,g)}:a}let Pu=null;function zo(){if(!Pu){const u=xt.Symbol;if(u&&u.iterator)Pu=u.iterator;else{const a=Object.getOwnPropertyNames(Map.prototype);for(let l=0;l<a.length;++l){const f=a[l];"entries"!==f&&"size"!==f&&Map.prototype[f]===Map.prototype.entries&&(Pu=f)}}}return Pu}function Dl(u){return!!function Sg(u){return null!==u&&("function"==typeof u||"object"==typeof u)}(u)&&(Array.isArray(u)||!(u instanceof Map)&&zo()in u)}function Pn(u,a,l){return!Object.is(u[a],l)&&(u[a]=l,!0)}function hr(u,a,l,f){const g=me();return Pn(g,Io(),a)&&(Ct(),cr(Xt(),g,u,a,l,f)),hr}function ta(u,a,l,f,g,p,_,y){const b=me(),O=Ct(),M=u+20,P=O.firstCreatePass?function u1(u,a,l,f,g,p,_,y,b){const O=a.consts,M=jo(a,u,4,_||null,ls(O,y));hg(a,l,M,ls(O,b)),lu(a,M);const P=M.tViews=Mu(2,M,f,g,p,a.directiveRegistry,a.pipeRegistry,null,a.schemas,O);return null!==a.queries&&(a.queries.template(a,M),P.queries=a.queries.embeddedTView(M)),M}(M,O,b,a,l,f,g,p,_):O.data[M];rr(P,!1);const k=b[11].createComment("");Iu(O,b,k,P),Fn(k,b),Lu(b,b[M]=I0(k,b,k,P)),iu(P)&&cg(O,b,P),null!=_&&ug(b,P,y)}function ve(u,a=ze.Default){const l=me();return null===l?We(u,a):qv(pn(),l,et(u),a)}function Rg(){throw new Error("invalid")}function dr(u,a,l){const f=me();return Pn(f,Io(),a)&&function si(u,a,l,f,g,p,_,y){const b=Ei(a,l);let M,O=a.inputs;!y&&null!=O&&(M=O[f])?(L0(u,l,M,f,g),nu(a)&&function pO(u,a){const l=ni(a,u);16&l[2]||(l[2]|=64)}(l,a.index)):3&a.type&&(f=function gO(u){return"class"===u?"className":"for"===u?"htmlFor":"formaction"===u?"formAction":"innerHtml"===u?"innerHTML":"readonly"===u?"readOnly":"tabindex"===u?"tabIndex":u}(f),g=null!=_?_(g,a.value||"",f):g,$t(p)?p.setProperty(b,f,g):mf(f)||(b.setProperty?b.setProperty(f,g):b[f]=g))}(Ct(),Xt(),f,u,a,f[11],l,!1),dr}function Og(u,a,l,f,g){const _=g?"class":"style";L0(u,l,a.inputs[_],_,f)}function ln(u,a,l,f){const g=me(),p=Ct(),_=20+u,y=g[11],b=g[_]=Wf(y,a,function Hx(){return qe.lFrame.currentNamespace}()),O=p.firstCreatePass?function O1(u,a,l,f,g,p,_){const y=a.consts,O=jo(a,u,2,g,ls(y,p));return hg(a,l,O,ls(y,_)),null!==O.attrs&&Fu(O,O.attrs,!1),null!==O.mergedAttrs&&Fu(O,O.mergedAttrs,!0),null!==a.queries&&a.queries.elementStart(a,O),O}(_,p,g,0,a,l,f):p.data[_];rr(O,!0);const M=O.mergedAttrs;null!==M&&hu(y,b,M);const P=O.classes;null!==P&&Zf(y,b,P);const k=O.styles;return null!==k&&qy(y,b,k),64!=(64&O.flags)&&Iu(p,g,b,O),0===function Tx(){return qe.lFrame.elementDepthCount}()&&Fn(b,g),function Ix(){qe.lFrame.elementDepthCount++}(),iu(O)&&(cg(p,g,O),function p0(u,a,l){if(Qd(a)){const g=a.directiveEnd;for(let p=a.directiveStart;p<g;p++){const _=u.data[p];_.contentQueries&&_.contentQueries(1,l[p],p)}}}(p,O,g)),null!==f&&ug(g,O),ln}function tn(){let u=pn();cf()?function uf(){qe.lFrame.isParent=!1}():(u=u.parent,rr(u,!1));const a=u;!function xx(){qe.lFrame.elementDepthCount--}();const l=Ct();return l.firstCreatePass&&(lu(l,u),Qd(u)&&l.queries.elementEnd(u)),null!=a.classesWithoutHost&&function Xx(u){return 0!=(16&u.flags)}(a)&&Og(l,a,me(),a.classesWithoutHost,!0),null!=a.stylesWithoutHost&&function qx(u){return 0!=(32&u.flags)}(a)&&Og(l,a,me(),a.stylesWithoutHost,!1),tn}function ps(u,a,l,f){return ln(u,a,l,f),tn(),ps}function Tl(u){return!!u&&"function"==typeof u.then}const Fg=function yC(u){return!!u&&"function"==typeof u.subscribe};function Tn(u,a,l,f){const g=me(),p=Ct(),_=pn();return function EC(u,a,l,f,g,p,_,y){const b=iu(f),M=u.firstCreatePass&&R0(u),P=a[8],k=A0(a);let V=!0;if(3&f.type||y){const Y=Ei(f,a),X=y?y(Y):Y,$=k.length,K=y?ge=>y(on(ge[f.index])):f.index;if($t(l)){let ge=null;if(!y&&b&&(ge=function F1(u,a,l,f){const g=u.cleanup;if(null!=g)for(let p=0;p<g.length-1;p+=2){const _=g[p];if(_===l&&g[p+1]===f){const y=a[7],b=g[p+2];return y.length>b?y[b]:null}"string"==typeof _&&(p+=2)}return null}(u,a,g,f.index)),null!==ge)(ge.__ngLastListenerFn__||ge).__ngNextListenerFn__=p,ge.__ngLastListenerFn__=p,V=!1;else{p=Pg(f,a,P,p,!1);const _e=l.listen(X,g,p);k.push(p,_e),M&&M.push(g,K,$,$+1)}}else p=Pg(f,a,P,p,!0),X.addEventListener(g,p,_),k.push(p),M&&M.push(g,K,$,_)}else p=Pg(f,a,P,p,!1);const H=f.outputs;let z;if(V&&null!==H&&(z=H[g])){const Y=z.length;if(Y)for(let X=0;X<Y;X+=2){const Te=a[z[X]][z[X+1]].subscribe(p),xe=k.length;k.push(p,Te),M&&M.push(g,f.index,xe,-(xe+1))}}}(p,g,g[11],_,u,a,!!l,f),Tn}function wC(u,a,l,f){try{return!1!==l(f)}catch(g){return M0(u,g),!1}}function Pg(u,a,l,f,g){return function p(_){if(_===Function)return f;const y=2&u.flags?ni(u.index,a):a;0==(32&a[2])&&gg(y);let b=wC(a,0,f,_),O=p.__ngNextListenerFn__;for(;O;)b=wC(a,0,O,_)&&b,O=O.__ngNextListenerFn__;return g&&!1===b&&(_.preventDefault(),_.returnValue=!1),b}}function Il(u=1){return function kx(u){return(qe.lFrame.contextLView=function Bx(u,a){for(;u>0;)a=a[15],u--;return a}(u,qe.lFrame.contextLView))[8]}(u)}function MC(u,a,l,f,g){const p=u[l+1],_=null===a;let y=f?Ui(p):Mr(p),b=!1;for(;0!==y&&(!1===b||_);){const M=u[y+1];j1(u[y],a)&&(b=!0,u[y+1]=f?Jf(M):Kf(M)),y=f?Ui(M):Mr(M)}b&&(u[l+1]=f?Kf(p):Jf(p))}function j1(u,a){return null===u||null==a||(Array.isArray(u)?u[1]:u)===a||!(!Array.isArray(u)||"string"!=typeof a)&&Po(u,a)>=0}function Bu(u,a){return function Hi(u,a,l,f){const g=me(),p=Ct(),_=function Or(u){const a=qe.lFrame,l=a.bindingIndex;return a.bindingIndex=a.bindingIndex+u,l}(2);p.firstUpdatePass&&function UC(u,a,l,f){const g=u.data;if(null===g[l+1]){const p=g[Vn()],_=function jC(u,a){return a>=u.expandoStartIndex}(u,l);(function zC(u,a){return 0!=(u.flags&(a?16:32))})(p,f)&&null===a&&!_&&(a=!1),a=function q1(u,a,l,f){const g=function df(u){const a=qe.lFrame.currentDirectiveIndex;return-1===a?null:u[a]}(u);let p=f?a.residualClasses:a.residualStyles;if(null===g)0===(f?a.classBindings:a.styleBindings)&&(l=xl(l=kg(null,u,a,l,f),a.attrs,f),p=null);else{const _=a.directiveStylingLast;if(-1===_||u[_]!==g)if(l=kg(g,u,a,l,f),null===p){let b=function Z1(u,a,l){const f=l?a.classBindings:a.styleBindings;if(0!==Mr(f))return u[Ui(f)]}(u,a,f);void 0!==b&&Array.isArray(b)&&(b=kg(null,u,a,b[1],f),b=xl(b,a.attrs,f),function K1(u,a,l,f){u[Ui(l?a.classBindings:a.styleBindings)]=f}(u,a,f,b))}else p=function Q1(u,a,l){let f;const g=a.directiveEnd;for(let p=1+a.directiveStylingLast;p<g;p++)f=xl(f,u[p].hostAttrs,l);return xl(f,a.attrs,l)}(u,a,f)}return void 0!==p&&(f?a.residualClasses=p:a.residualStyles=p),l}(g,p,a,f),function B1(u,a,l,f,g,p){let _=p?a.classBindings:a.styleBindings,y=Ui(_),b=Mr(_);u[f]=l;let M,O=!1;if(Array.isArray(l)){const P=l;M=P[1],(null===M||Po(P,M)>0)&&(O=!0)}else M=l;if(g)if(0!==b){const k=Ui(u[y+1]);u[f+1]=Au(k,y),0!==k&&(u[k+1]=Qf(u[k+1],f)),u[y+1]=function KR(u,a){return 131071&u|a<<17}(u[y+1],f)}else u[f+1]=Au(y,0),0!==y&&(u[y+1]=Qf(u[y+1],f)),y=f;else u[f+1]=Au(b,0),0===y?y=f:u[b+1]=Qf(u[b+1],f),b=f;O&&(u[f+1]=Kf(u[f+1])),MC(u,M,f,!0),MC(u,M,f,!1),function V1(u,a,l,f,g){const p=g?u.residualClasses:u.residualStyles;null!=p&&"string"==typeof a&&Po(p,a)>=0&&(l[f+1]=Jf(l[f+1]))}(a,M,u,f,p),_=Au(y,b),p?a.classBindings=_:a.styleBindings=_}(g,p,a,l,_,f)}}(p,u,_,f),a!==Ze&&Pn(g,_,a)&&function HC(u,a,l,f,g,p,_,y){if(!(3&a.type))return;const b=u.data,O=b[y+1];Vu(function s0(u){return 1==(1&u)}(O)?WC(b,a,l,g,Mr(O),_):void 0)||(Vu(p)||function r0(u){return 2==(2&u)}(O)&&(p=WC(b,null,l,g,y,_)),function VR(u,a,l,f,g){const p=$t(u);if(a)g?p?u.addClass(l,f):l.classList.add(f):p?u.removeClass(l,f):l.classList.remove(f);else{let _=-1===f.indexOf("-")?void 0:ri.DashCase;if(null==g)p?u.removeStyle(l,f,_):l.style.removeProperty(f);else{const y="string"==typeof g&&g.endsWith("!important");y&&(g=g.slice(0,-10),_|=ri.Important),p?u.setStyle(l,f,g,_):l.style.setProperty(f,g,y?"important":"")}}}(f,_,ru(Vn(),l),g,p))}(p,p.data[Vn()],g,g[11],u,g[_+1]=function tM(u,a){return null==u||("string"==typeof a?u+=a:"object"==typeof u&&(u=Dt(ds(u)))),u}(a,l),f,_)}(u,a,null,!0),Bu}function kg(u,a,l,f,g){let p=null;const _=l.directiveEnd;let y=l.directiveStylingLast;for(-1===y?y=l.directiveStart:y++;y<_&&(p=a[y],f=xl(f,p.hostAttrs,g),p!==u);)y++;return null!==u&&(l.directiveStylingLast=y),f}function xl(u,a,l){const f=l?1:2;let g=-1;if(null!==a)for(let p=0;p<a.length;p++){const _=a[p];"number"==typeof _?g=_:g===f&&(Array.isArray(u)||(u=void 0===u?[]:["",u]),ii(u,_,!!l||a[++p]))}return void 0===u?null:u}function WC(u,a,l,f,g,p){const _=null===a;let y;for(;g>0;){const b=u[g],O=Array.isArray(b),M=O?b[1]:b,P=null===M;let k=l[g+1];k===Ze&&(k=P?Lt:void 0);let V=P?bf(k,f):M===f?k:void 0;if(O&&!Vu(V)&&(V=bf(b,f)),Vu(V)&&(y=V,_))return y;const H=u[g+1];g=_?Ui(H):Mr(H)}if(null!==a){let b=p?a.residualClasses:a.residualStyles;null!=b&&(y=bf(b,f))}return y}function Vu(u){return void 0!==u}function pr(u,a=""){const l=me(),f=Ct(),g=u+20,p=f.firstCreatePass?jo(f,g,1,a,null):f.data[g],_=l[g]=function Hf(u,a){return $t(u)?u.createText(a):u.createTextNode(a)}(l[11],a);Iu(f,l,_,p),rr(p,!1)}function ra(u,a,l){const f=me(),g=function $o(u,a,l,f){return Pn(u,Io(),l)?a+Xe(l)+f:Ze}(f,u,a,l);return g!==Ze&&Lr(f,Vn(),g),ra}const ju="en-US";let gE=ju;function jg(u,a,l,f,g){if(u=et(u),Array.isArray(u))for(let p=0;p<u.length;p++)jg(u[p],a,l,f,g);else{const p=Ct(),_=me();let y=Wo(u)?u:et(u.provide),b=B0(u);const O=pn(),M=1048575&O.providerIndexes,P=O.directiveStart,k=O.providerIndexes>>20;if(Wo(u)||!u.multi){const V=new tl(b,g,ve),H=Gg(y,a,g?M:M+k,P);-1===H?(pu(il(O,_),p,y),Ug(p,u,a.length),a.push(y),O.directiveStart++,O.directiveEnd++,g&&(O.providerIndexes+=1048576),l.push(V),_.push(V)):(l[H]=V,_[H]=V)}else{const V=Gg(y,a,M+k,P),H=Gg(y,a,M,M+k),z=V>=0&&l[V],Y=H>=0&&l[H];if(g&&!Y||!g&&!z){pu(il(O,_),p,y);const X=function CL(u,a,l,f,g){const p=new tl(u,l,ve);return p.multi=[],p.index=a,p.componentProviders=0,BE(p,g,f&&!l),p}(g?yL:vL,l.length,g,f,b);!g&&Y&&(l[H].providerFactory=X),Ug(p,u,a.length,0),a.push(y),O.directiveStart++,O.directiveEnd++,g&&(O.providerIndexes+=1048576),l.push(X),_.push(X)}else Ug(p,u,V>-1?V:H,BE(l[g?H:V],b,!g&&f));!g&&f&&Y&&l[H].componentProviders++}}}function Ug(u,a,l,f){const g=Wo(a),p=function GO(u){return!!u.useClass}(a);if(g||p){const b=(p?et(a.useClass):a).prototype.ngOnDestroy;if(b){const O=u.destroyHooks||(u.destroyHooks=[]);if(!g&&a.multi){const M=O.indexOf(l);-1===M?O.push(l,[f,b]):O[M+1].push(f,b)}else O.push(l,b)}}}function BE(u,a,l){return l&&u.componentProviders++,u.multi.push(a)-1}function Gg(u,a,l,f){for(let g=l;g<f;g++)if(a[g]===u)return g;return-1}function vL(u,a,l,f){return Hg(this.multi,[])}function yL(u,a,l,f){const g=this.multi;let p;if(this.providerFactory){const _=this.providerFactory.componentProviders,y=rl(l,l[1],this.providerFactory.index,f);p=y.slice(0,_),Hg(g,p);for(let b=_;b<y.length;b++)p.push(y[b])}else p=[],Hg(g,p);return p}function Hg(u,a){for(let l=0;l<u.length;l++)a.push((0,u[l])());return a}function Ht(u,a=[]){return l=>{l.providersResolver=(f,g)=>function _L(u,a,l){const f=Ct();if(f.firstCreatePass){const g=Vi(u);jg(l,f.data,f.blueprint,g,!0),jg(a,f.data,f.blueprint,g,!1)}}(f,g?g(u):u,a)}}class VE{}class bL{resolveComponentFactory(a){throw function wL(u){const a=Error(`No component factory found for ${Dt(u)}. Did you add it to @NgModule.entryComponents?`);return a.ngComponent=u,a}(a)}}let Ll=(()=>{class u{}return u.NULL=new bL,u})();function DL(){return aa(pn(),me())}function aa(u,a){return new oi(Ei(u,a))}let oi=(()=>{class u{constructor(l){this.nativeElement=l}}return u.__NG_ELEMENT_ID__=DL,u})();class UE{}let Fr=(()=>{class u{}return u.__NG_ELEMENT_ID__=()=>function IL(){const u=me(),l=ni(pn().index,u);return function TL(u){return u[11]}(ir(l)?l:u)}(),u})(),xL=(()=>{class u{}return u.\u0275prov=mt({token:u,providedIn:"root",factory:()=>null}),u})();class Fl{constructor(a){this.full=a,this.major=a.split(".")[0],this.minor=a.split(".")[1],this.patch=a.split(".").slice(2).join(".")}}const AL=new Fl("13.3.10"),Wg={};function zu(u,a,l,f,g=!1){for(;null!==l;){const p=a[l.index];if(null!==p&&f.push(on(p)),Bi(p))for(let y=10;y<p.length;y++){const b=p[y],O=b[1].firstChild;null!==O&&zu(b[1],b,O,f)}const _=l.type;if(8&_)zu(u,a,l.child,f);else if(32&_){const y=jf(l,a);let b;for(;b=y();)f.push(b)}else if(16&_){const y=Yy(a,l);if(Array.isArray(y))f.push(...y);else{const b=yl(a[16]);zu(b[1],b,y,f,!0)}}l=g?l.projectionNext:l.next}return f}class Pl{constructor(a,l){this._lView=a,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const a=this._lView,l=a[1];return zu(l,a,l.firstChild,[])}get context(){return this._lView[8]}set context(a){this._lView[8]=a}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const a=this._lView[3];if(Bi(a)){const l=a[8],f=l?l.indexOf(this):-1;f>-1&&(zf(a,f),_u(l,f))}this._attachedToViewContainer=!1}ky(this._lView[1],this._lView)}onDestroy(a){!function y0(u,a,l,f){const g=A0(a);null===l?g.push(f):(g.push(l),u.firstCreatePass&&R0(u).push(f,g.length-1))}(this._lView[1],this._lView,null,a)}markForCheck(){gg(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function mg(u,a,l){const f=a[10];f.begin&&f.begin();try{Go(u,a,u.template,l)}catch(g){throw M0(a,g),g}finally{f.end&&f.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new yt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function AR(u,a){Cl(u,a,a[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(a){if(this._attachedToViewContainer)throw new yt(902,"");this._appRef=a}}class RL extends Pl{constructor(a){super(a),this._view=a}detectChanges(){x0(this._view)}checkNoChanges(){}get context(){return null}}class GE extends Ll{constructor(a){super(),this.ngModule=a}resolveComponentFactory(a){const l=On(a);return new zg(l,this.ngModule)}}function HE(u){const a=[];for(let l in u)u.hasOwnProperty(l)&&a.push({propName:u[l],templateName:l});return a}class zg extends VE{constructor(a,l){super(),this.componentDef=a,this.ngModule=l,this.componentType=a.type,this.selector=function qR(u){return u.map(XR).join(",")}(a.selectors),this.ngContentSelectors=a.ngContentSelectors?a.ngContentSelectors:[],this.isBoundToModule=!!l}get inputs(){return HE(this.componentDef.inputs)}get outputs(){return HE(this.componentDef.outputs)}create(a,l,f,g){const p=(g=g||this.ngModule)?function ML(u,a){return{get:(l,f,g)=>{const p=u.get(l,Wg,g);return p!==Wg||f===Wg?p:a.get(l,f,g)}}}(a,g.injector):a,_=p.get(UE,Iv),y=p.get(xL,null),b=_.createRenderer(null,this.componentDef),O=this.componentDef.selectors[0][0]||"div",M=f?function v0(u,a,l){if($t(u))return u.selectRootElement(a,l===tr.ShadowDom);let f="string"==typeof a?u.querySelector(a):a;return f.textContent="",f}(b,f,this.componentDef.encapsulation):Wf(_.createRenderer(null,this.componentDef),O,function OL(u){const a=u.toLowerCase();return"svg"===a?"svg":"math"===a?"math":null}(O)),P=this.componentDef.onPush?576:528,k=function Z0(u,a){return{components:[],scheduler:u||ER,clean:LO,playerHandler:a||null,flags:0}}(),V=Mu(0,null,null,1,0,null,null,null,null,null),H=El(null,V,k,P,null,null,_,b,y,p);let z,Y;ou(H);try{const X=function X0(u,a,l,f,g,p){const _=l[1];l[20]=u;const b=jo(_,20,2,"#host",null),O=b.mergedAttrs=a.hostAttrs;null!==O&&(Fu(b,O,!0),null!==u&&(hu(g,u,O),null!==b.classes&&Zf(g,u,b.classes),null!==b.styles&&qy(g,u,b.styles)));const M=f.createRenderer(u,a),P=El(l,m0(a),null,a.onPush?64:16,l[20],b,f,M,p||null,null);return _.firstCreatePass&&(pu(il(b,l),_,a.type),D0(_,b),S0(b,l.length,1)),Lu(l,P),l[20]=P}(M,this.componentDef,H,_,b);if(M)if(f)hu(b,M,["ng-version",AL.full]);else{const{attrs:$,classes:K}=function ZR(u){const a=[],l=[];let f=1,g=2;for(;f<u.length;){let p=u[f];if("string"==typeof p)2===g?""!==p&&a.push(p,u[++f]):8===g&&l.push(p);else{if(!ji(g))break;g=p}f++}return{attrs:a,classes:l}}(this.componentDef.selectors[0]);$&&hu(b,M,$),K&&K.length>0&&Zf(b,M,K.join(" "))}if(Y=of(V,20),void 0!==l){const $=Y.projection=[];for(let K=0;K<this.ngContentSelectors.length;K++){const ge=l[K];$.push(null!=ge?Array.from(ge):null)}}z=function q0(u,a,l,f,g){const p=l[1],_=function _O(u,a,l){const f=pn();u.firstCreatePass&&(l.providersResolver&&l.providersResolver(l),T0(u,f,a,Uo(u,a,1,null),l));const g=rl(a,u,f.directiveStart,f);Fn(g,a);const p=Ei(f,a);return p&&Fn(p,a),g}(p,l,a);if(f.components.push(_),u[8]=_,g&&g.forEach(b=>b(_,a)),a.contentQueries){const b=pn();a.contentQueries(1,_,b.directiveStart)}const y=pn();return!p.firstCreatePass||null===a.hostBindings&&null===a.hostAttrs||(cs(y.index),w0(l[1],y,0,y.directiveStart,y.directiveEnd,a),b0(a,_)),_}(X,this.componentDef,H,k,[JO]),wl(V,H,null)}finally{au()}return new FL(this.componentType,z,aa(Y,H),H,Y)}}class FL extends class EL{}{constructor(a,l,f,g,p){super(),this.location=f,this._rootLView=g,this._tNode=p,this.instance=l,this.hostView=this.changeDetectorRef=new RL(g),this.componentType=a}get injector(){return new Ro(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(a){this.hostView.onDestroy(a)}}class Pr{}class WE{}const la=new Map;class $E extends Pr{constructor(a,l){super(),this._parent=l,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new GE(this);const f=_i(a);this._bootstrapComponents=ar(f.bootstrap),this._r3Injector=k0(a,l,[{provide:Pr,useValue:this},{provide:Ll,useValue:this.componentFactoryResolver}],Dt(a)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(a)}get(a,l=Xn.THROW_IF_NOT_FOUND,f=ze.Default){return a===Xn||a===Pr||a===vg?this:this._r3Injector.get(a,l,f)}destroy(){const a=this._r3Injector;!a.destroyed&&a.destroy(),this.destroyCbs.forEach(l=>l()),this.destroyCbs=null}onDestroy(a){this.destroyCbs.push(a)}}class Yg extends WE{constructor(a){super(),this.moduleType=a,null!==_i(a)&&function NL(u){const a=new Set;!function l(f){const g=_i(f,!0),p=g.id;null!==p&&(function zE(u,a,l){if(a&&a!==l)throw new Error(`Duplicate module registered for ${u} - ${Dt(a)} vs ${Dt(a.name)}`)}(p,la.get(p),f),la.set(p,f));const _=ar(g.imports);for(const y of _)a.has(y)||(a.add(y),l(y))}(u)}(a)}create(a){return new $E(this.moduleType,a)}}function Yu(u,a,l){const f=function Bn(){const u=qe.lFrame;let a=u.bindingRootIndex;return-1===a&&(a=u.bindingRootIndex=u.tView.bindingStartIndex),a}()+u,g=me();return g[f]===Ze?function ur(u,a,l){return u[a]=l}(g,f,l?a.call(l):a()):function Sl(u,a){return u[a]}(g,f)}function $g(u){return a=>{setTimeout(u,void 0,a)}}const Zt=class JL extends Sr{constructor(a=!1){super(),this.__isAsync=a}emit(a){super.next(a)}subscribe(a,l,f){var g,p,_;let y=a,b=l||(()=>null),O=f;if(a&&"object"==typeof a){const P=a;y=null===(g=P.next)||void 0===g?void 0:g.bind(P),b=null===(p=P.error)||void 0===p?void 0:p.bind(P),O=null===(_=P.complete)||void 0===_?void 0:_.bind(P)}this.__isAsync&&(b=$g(b),y&&(y=$g(y)),O&&(O=$g(O)));const M=super.subscribe({next:y,error:b,complete:O});return a instanceof mi&&a.add(M),M}};Symbol;let Nr=(()=>{class u{}return u.__NG_ELEMENT_ID__=iF,u})();const tF=Nr,nF=class extends tF{constructor(a,l,f){super(),this._declarationLView=a,this._declarationTContainer=l,this.elementRef=f}createEmbeddedView(a){const l=this._declarationTContainer.tViews,f=El(this._declarationLView,l,a,16,null,l.declTNode,null,null,null,null);f[17]=this._declarationLView[this._declarationTContainer.index];const p=this._declarationLView[19];return null!==p&&(f[19]=p.createEmbeddedView(l)),wl(l,f,a),new Pl(f)}};function iF(){return $u(pn(),me())}function $u(u,a){return 4&u.type?new nF(a,u,aa(u,a)):null}let zi=(()=>{class u{}return u.__NG_ELEMENT_ID__=rF,u})();function rF(){return function tw(u,a){let l;const f=a[u.index];if(Bi(f))l=f;else{let g;if(8&u.type)g=on(f);else{const p=a[11];g=p.createComment("");const _=Ei(u,a);zs(p,Tu(p,_),g,function NR(u,a){return $t(u)?u.nextSibling(a):a.nextSibling}(p,_),!1)}a[u.index]=l=I0(f,a,g,u),Lu(a,l)}return new JE(l,u,a)}(pn(),me())}const sF=zi,JE=class extends sF{constructor(a,l,f){super(),this._lContainer=a,this._hostTNode=l,this._hostLView=f}get element(){return aa(this._hostTNode,this._hostLView)}get injector(){return new Ro(this._hostTNode,this._hostLView)}get parentInjector(){const a=gu(this._hostTNode,this._hostLView);if(Wv(a)){const l=Ao(a,this._hostLView),f=xo(a);return new Ro(l[1].data[f+8],l)}return new Ro(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(a){const l=ew(this._lContainer);return null!==l&&l[a]||null}get length(){return this._lContainer.length-10}createEmbeddedView(a,l,f){const g=a.createEmbeddedView(l||{});return this.insert(g,f),g}createComponent(a,l,f,g,p){const _=a&&!function al(u){return"function"==typeof u}(a);let y;if(_)y=l;else{const P=l||{};y=P.index,f=P.injector,g=P.projectableNodes,p=P.ngModuleRef}const b=_?a:new zg(On(a)),O=f||this.parentInjector;if(!p&&null==b.ngModule){const k=(_?O:this.parentInjector).get(Pr,null);k&&(p=k)}const M=b.create(O,g,void 0,p);return this.insert(M.hostView,y),M}insert(a,l){const f=a._lView,g=f[1];if(function Sx(u){return Bi(u[3])}(f)){const M=this.indexOf(a);if(-1!==M)this.detach(M);else{const P=f[3],k=new JE(P,P[6],P[3]);k.detach(k.indexOf(a))}}const p=this._adjustIndex(l),_=this._lContainer;!function OR(u,a,l,f){const g=10+f,p=l.length;f>0&&(l[g-1][4]=a),f<p-10?(a[4]=l[g],ey(l,10+f,a)):(l.push(a),a[4]=null),a[3]=l;const _=a[17];null!==_&&l!==_&&function MR(u,a){const l=u[9];a[16]!==a[3][3][16]&&(u[2]=!0),null===l?u[9]=[a]:l.push(a)}(_,a);const y=a[19];null!==y&&y.insertView(u),a[2]|=128}(g,f,_,p);const y=Xf(p,_),b=f[11],O=Tu(b,_[7]);return null!==O&&function xR(u,a,l,f,g,p){f[0]=g,f[6]=a,Cl(u,f,l,1,g,p)}(g,_[6],b,f,O,y),a.attachToViewContainerRef(),ey(qg(_),p,a),a}move(a,l){return this.insert(a,l)}indexOf(a){const l=ew(this._lContainer);return null!==l?l.indexOf(a):-1}remove(a){const l=this._adjustIndex(a,-1),f=zf(this._lContainer,l);f&&(_u(qg(this._lContainer),l),ky(f[1],f))}detach(a){const l=this._adjustIndex(a,-1),f=zf(this._lContainer,l);return f&&null!=_u(qg(this._lContainer),l)?new Pl(f):null}_adjustIndex(a,l=0){return null==a?this.length+l:a}};function ew(u){return u[8]}function qg(u){return u[8]||(u[8]=[])}function aw(u,a){return $u(u,a)}function Zu(...u){}const cp=new ct("Application Initializer");let up=(()=>{class u{constructor(l){this.appInits=l,this.resolve=Zu,this.reject=Zu,this.initialized=!1,this.done=!1,this.donePromise=new Promise((f,g)=>{this.resolve=f,this.reject=g})}runInitializers(){if(this.initialized)return;const l=[],f=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let g=0;g<this.appInits.length;g++){const p=this.appInits[g]();if(Tl(p))l.push(p);else if(Fg(p)){const _=new Promise((y,b)=>{p.subscribe({complete:y,error:b})});l.push(_)}}Promise.all(l).then(()=>{f()}).catch(g=>{this.reject(g)}),0===l.length&&f(),this.initialized=!0}}return u.\u0275fac=function(l){return new(l||u)(We(cp,8))},u.\u0275prov=mt({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const Vl=new ct("AppId",{providedIn:"root",factory:function Dw(){return`${hp()}${hp()}${hp()}`}});function hp(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Sw=new ct("Platform Initializer"),Tw=new ct("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Iw=new ct("appBootstrapListener");let OF=(()=>{class u{log(l){console.log(l)}warn(l){console.warn(l)}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275prov=mt({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})();const ms=new ct("LocaleId",{providedIn:"root",factory:()=>vA(ms,ze.Optional|ze.SkipSelf)||function MF(){return"undefined"!=typeof $localize&&$localize.locale||ju}()});class FF{constructor(a,l){this.ngModuleFactory=a,this.componentFactories=l}}let xw=(()=>{class u{compileModuleSync(l){return new Yg(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const f=this.compileModuleSync(l),p=ar(_i(l).declarations).reduce((_,y)=>{const b=On(y);return b&&_.push(new zg(b)),_},[]);return new FF(f,p)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275prov=mt({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const NF=(()=>Promise.resolve(0))();function dp(u){"undefined"==typeof Zone?NF.then(()=>{u&&u.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",u)}class In{constructor({enableLongStackTrace:a=!1,shouldCoalesceEventChangeDetection:l=!1,shouldCoalesceRunChangeDetection:f=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Zt(!1),this.onMicrotaskEmpty=new Zt(!1),this.onStable=new Zt(!1),this.onError=new Zt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const g=this;g._nesting=0,g._outer=g._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(g._inner=g._inner.fork(new Zone.TaskTrackingZoneSpec)),a&&Zone.longStackTraceZoneSpec&&(g._inner=g._inner.fork(Zone.longStackTraceZoneSpec)),g.shouldCoalesceEventChangeDetection=!f&&l,g.shouldCoalesceRunChangeDetection=f,g.lastRequestAnimationFrameId=-1,g.nativeRequestAnimationFrame=function kF(){let u=xt.requestAnimationFrame,a=xt.cancelAnimationFrame;if("undefined"!=typeof Zone&&u&&a){const l=u[Zone.__symbol__("OriginalDelegate")];l&&(u=l);const f=a[Zone.__symbol__("OriginalDelegate")];f&&(a=f)}return{nativeRequestAnimationFrame:u,nativeCancelAnimationFrame:a}}().nativeRequestAnimationFrame,function jF(u){const a=()=>{!function VF(u){u.isCheckStableRunning||-1!==u.lastRequestAnimationFrameId||(u.lastRequestAnimationFrameId=u.nativeRequestAnimationFrame.call(xt,()=>{u.fakeTopEventTask||(u.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{u.lastRequestAnimationFrameId=-1,gp(u),u.isCheckStableRunning=!0,fp(u),u.isCheckStableRunning=!1},void 0,()=>{},()=>{})),u.fakeTopEventTask.invoke()}),gp(u))}(u)};u._inner=u._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,f,g,p,_,y)=>{try{return Aw(u),l.invokeTask(g,p,_,y)}finally{(u.shouldCoalesceEventChangeDetection&&"eventTask"===p.type||u.shouldCoalesceRunChangeDetection)&&a(),Rw(u)}},onInvoke:(l,f,g,p,_,y,b)=>{try{return Aw(u),l.invoke(g,p,_,y,b)}finally{u.shouldCoalesceRunChangeDetection&&a(),Rw(u)}},onHasTask:(l,f,g,p)=>{l.hasTask(g,p),f===g&&("microTask"==p.change?(u._hasPendingMicrotasks=p.microTask,gp(u),fp(u)):"macroTask"==p.change&&(u.hasPendingMacrotasks=p.macroTask))},onHandleError:(l,f,g,p)=>(l.handleError(g,p),u.runOutsideAngular(()=>u.onError.emit(p)),!1)})}(g)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!In.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(In.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(a,l,f){return this._inner.run(a,l,f)}runTask(a,l,f,g){const p=this._inner,_=p.scheduleEventTask("NgZoneEvent: "+g,a,BF,Zu,Zu);try{return p.runTask(_,l,f)}finally{p.cancelTask(_)}}runGuarded(a,l,f){return this._inner.runGuarded(a,l,f)}runOutsideAngular(a){return this._outer.run(a)}}const BF={};function fp(u){if(0==u._nesting&&!u.hasPendingMicrotasks&&!u.isStable)try{u._nesting++,u.onMicrotaskEmpty.emit(null)}finally{if(u._nesting--,!u.hasPendingMicrotasks)try{u.runOutsideAngular(()=>u.onStable.emit(null))}finally{u.isStable=!0}}}function gp(u){u.hasPendingMicrotasks=!!(u._hasPendingMicrotasks||(u.shouldCoalesceEventChangeDetection||u.shouldCoalesceRunChangeDetection)&&-1!==u.lastRequestAnimationFrameId)}function Aw(u){u._nesting++,u.isStable&&(u.isStable=!1,u.onUnstable.emit(null))}function Rw(u){u._nesting--,fp(u)}class UF{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Zt,this.onMicrotaskEmpty=new Zt,this.onStable=new Zt,this.onError=new Zt}run(a,l,f){return a.apply(l,f)}runGuarded(a,l,f){return a.apply(l,f)}runOutsideAngular(a){return a()}runTask(a,l,f,g){return a.apply(l,f)}}let pp=(()=>{class u{constructor(l){this._ngZone=l,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{In.assertNotInAngularZone(),dp(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())dp(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(f=>!f.updateCb||!f.updateCb(l)||(clearTimeout(f.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,f,g){let p=-1;f&&f>0&&(p=setTimeout(()=>{this._callbacks=this._callbacks.filter(_=>_.timeoutId!==p),l(this._didWork,this.getPendingTasks())},f)),this._callbacks.push({doneCb:l,timeoutId:p,updateCb:g})}whenStable(l,f,g){if(g&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,f,g),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(l,f,g){return[]}}return u.\u0275fac=function(l){return new(l||u)(We(In))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})(),GF=(()=>{class u{constructor(){this._applications=new Map,mp.addToWindow(this)}registerApplication(l,f){this._applications.set(l,f)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,f=!0){return mp.findTestabilityInTree(this,l,f)}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275prov=mt({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})();class HF{addToWindow(a){}findTestabilityInTree(a,l,f){return null}}let mp=new HF,Xs=null;const Ow=new ct("AllowMultipleToken"),Mw=new ct("PlatformOnDestroy");class Lw{constructor(a,l){this.name=a,this.token=l}}function Fw(u,a,l=[]){const f=`Platform: ${a}`,g=new ct(f);return(p=[])=>{let _=_p();if(!_||_.injector.get(Ow,!1)){const y=[...l,...p,{provide:g,useValue:!0}];u?u(y):function $F(u){if(Xs&&!Xs.get(Ow,!1))throw new yt(400,"");Xs=u;const a=u.get(Pw),l=u.get(Sw,null);l&&l.forEach(f=>f())}(function qF(u=[],a){return Xn.create({name:a,providers:[{provide:yg,useValue:"platform"},{provide:Mw,useValue:()=>Xs=null},...u]})}(y,f))}return function XF(u){const a=_p();if(!a)throw new yt(401,"");return a}()}}function _p(){var u;return null!==(u=null==Xs?void 0:Xs.get(Pw))&&void 0!==u?u:null}let Pw=(()=>{class u{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,f){const y=function ZF(u,a){let l;return l="noop"===u?new UF:("zone.js"===u?void 0:u)||new In({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==a?void 0:a.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==a?void 0:a.ngZoneRunCoalescing)}),l}(f?f.ngZone:void 0,{ngZoneEventCoalescing:f&&f.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:f&&f.ngZoneRunCoalescing||!1}),b=[{provide:In,useValue:y}];return y.run(()=>{const O=Xn.create({providers:b,parent:this.injector,name:l.moduleType.name}),M=l.create(O),P=M.injector.get(vl,null);if(!P)throw new yt(402,"");return y.runOutsideAngular(()=>{const k=y.onError.subscribe({next:V=>{P.handleError(V)}});M.onDestroy(()=>{yp(this._modules,M),k.unsubscribe()})}),function KF(u,a,l){try{const f=l();return Tl(f)?f.catch(g=>{throw a.runOutsideAngular(()=>u.handleError(g)),g}):f}catch(f){throw a.runOutsideAngular(()=>u.handleError(f)),f}}(P,y,()=>{const k=M.injector.get(up);return k.runInitializers(),k.donePromise.then(()=>(function TM(u){ei(u,"Expected localeId to be defined"),"string"==typeof u&&(gE=u.toLowerCase().replace(/_/g,"-"))}(M.injector.get(ms,ju)||ju),this._moduleDoBootstrap(M),M))})})}bootstrapModule(l,f=[]){const g=Nw({},f);return function zF(u,a,l){const f=new Yg(l);return Promise.resolve(f)}(0,0,l).then(p=>this.bootstrapModuleFactory(p,g))}_moduleDoBootstrap(l){const f=l.injector.get(vp);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(g=>f.bootstrap(g));else{if(!l.instance.ngDoBootstrap)throw new yt(403,"");l.instance.ngDoBootstrap(f)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new yt(404,"");this._modules.slice().forEach(f=>f.destroy()),this._destroyListeners.forEach(f=>f());const l=this._injector.get(Mw,null);null==l||l(),this._destroyed=!0}get destroyed(){return this._destroyed}}return u.\u0275fac=function(l){return new(l||u)(We(Xn))},u.\u0275prov=mt({token:u,factory:u.\u0275fac,providedIn:"platform"}),u})();function Nw(u,a){return Array.isArray(a)?a.reduce(Nw,u):Object.assign(Object.assign({},u),a)}let vp=(()=>{class u{constructor(l,f,g,p){this._zone=l,this._injector=f,this._exceptionHandler=g,this._initStatus=p,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const _=new sn(b=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{b.next(this._stable),b.complete()})}),y=new sn(b=>{let O;this._zone.runOutsideAngular(()=>{O=this._zone.onStable.subscribe(()=>{In.assertNotInAngularZone(),dp(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,b.next(!0))})})});const M=this._zone.onUnstable.subscribe(()=>{In.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{b.next(!1)}))});return()=>{O.unsubscribe(),M.unsubscribe()}});this.isStable=function WI(...u){const a=qa(u),l=function kI(u,a){return"number"==typeof jd(u)?u.pop():a}(u,1/0),f=u;return f.length?1===f.length?er(f[0]):Xa(l)(wn(f,a)):Ir}(_,y.pipe(function zI(u={}){const{connector:a=(()=>new Sr),resetOnError:l=!0,resetOnComplete:f=!0,resetOnRefCountZero:g=!0}=u;return p=>{let _=null,y=null,b=null,O=0,M=!1,P=!1;const k=()=>{null==y||y.unsubscribe(),y=null},V=()=>{k(),_=b=null,M=P=!1},H=()=>{const z=_;V(),null==z||z.unsubscribe()};return Dn((z,Y)=>{O++,!P&&!M&&k();const X=b=null!=b?b:a();Y.add(()=>{O--,0===O&&!P&&!M&&(y=Ud(H,g))}),X.subscribe(Y),_||(_=new $c({next:$=>X.next($),error:$=>{P=!0,k(),y=Ud(V,l,$),X.error($)},complete:()=>{M=!0,k(),y=Ud(V,f),X.complete()}}),wn(z).subscribe(_))})(p)}}()))}bootstrap(l,f){if(!this._initStatus.done)throw new yt(405,"");let g;g=l instanceof VE?l:this._injector.get(Ll).resolveComponentFactory(l),this.componentTypes.push(g.componentType);const p=function YF(u){return u.isBoundToModule}(g)?void 0:this._injector.get(Pr),y=g.create(Xn.NULL,[],f||g.selector,p),b=y.location.nativeElement,O=y.injector.get(pp,null),M=O&&y.injector.get(GF);return O&&M&&M.registerApplication(b,O),y.onDestroy(()=>{this.detachView(y.hostView),yp(this.components,y),M&&M.unregisterApplication(b)}),this._loadComponent(y),y}tick(){if(this._runningTick)throw new yt(101,"");try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(l))}finally{this._runningTick=!1}}attachView(l){const f=l;this._views.push(f),f.attachToAppRef(this)}detachView(l){const f=l;yp(this._views,f),f.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l),this._injector.get(Iw,[]).concat(this._bootstrapListeners).forEach(g=>g(l))}ngOnDestroy(){this._views.slice().forEach(l=>l.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return u.\u0275fac=function(l){return new(l||u)(We(In),We(Xn),We(vl),We(up))},u.\u0275prov=mt({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();function yp(u,a){const l=u.indexOf(a);l>-1&&u.splice(l,1)}let Bw=!0,Ku=(()=>{class u{}return u.__NG_ELEMENT_ID__=eP,u})();function eP(u){return function tP(u,a,l){if(nu(u)&&!l){const f=ni(u.index,a);return new Pl(f,f)}return 47&u.type?new Pl(a[16],a):null}(pn(),me(),16==(16&u))}class Hw{constructor(){}supports(a){return Dl(a)}create(a){return new aP(a)}}const oP=(u,a)=>a;class aP{constructor(a){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=a||oP}forEachItem(a){let l;for(l=this._itHead;null!==l;l=l._next)a(l)}forEachOperation(a){let l=this._itHead,f=this._removalsHead,g=0,p=null;for(;l||f;){const _=!f||l&&l.currentIndex<zw(f,g,p)?l:f,y=zw(_,g,p),b=_.currentIndex;if(_===f)g--,f=f._nextRemoved;else if(l=l._next,null==_.previousIndex)g++;else{p||(p=[]);const O=y-g,M=b-g;if(O!=M){for(let k=0;k<O;k++){const V=k<p.length?p[k]:p[k]=0,H=V+k;M<=H&&H<O&&(p[k]=V+1)}p[_.previousIndex]=M-O}}y!==b&&a(_,y,b)}}forEachPreviousItem(a){let l;for(l=this._previousItHead;null!==l;l=l._nextPrevious)a(l)}forEachAddedItem(a){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)a(l)}forEachMovedItem(a){let l;for(l=this._movesHead;null!==l;l=l._nextMoved)a(l)}forEachRemovedItem(a){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)a(l)}forEachIdentityChange(a){let l;for(l=this._identityChangesHead;null!==l;l=l._nextIdentityChange)a(l)}diff(a){if(null==a&&(a=[]),!Dl(a))throw new yt(900,"");return this.check(a)?this:null}onDestroy(){}check(a){this._reset();let g,p,_,l=this._itHead,f=!1;if(Array.isArray(a)){this.length=a.length;for(let y=0;y<this.length;y++)p=a[y],_=this._trackByFn(y,p),null!==l&&Object.is(l.trackById,_)?(f&&(l=this._verifyReinsertion(l,p,_,y)),Object.is(l.item,p)||this._addIdentityChange(l,p)):(l=this._mismatch(l,p,_,y),f=!0),l=l._next}else g=0,function c1(u,a){if(Array.isArray(u))for(let l=0;l<u.length;l++)a(u[l]);else{const l=u[zo()]();let f;for(;!(f=l.next()).done;)a(f.value)}}(a,y=>{_=this._trackByFn(g,y),null!==l&&Object.is(l.trackById,_)?(f&&(l=this._verifyReinsertion(l,y,_,g)),Object.is(l.item,y)||this._addIdentityChange(l,y)):(l=this._mismatch(l,y,_,g),f=!0),l=l._next,g++}),this.length=g;return this._truncate(l),this.collection=a,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let a;for(a=this._previousItHead=this._itHead;null!==a;a=a._next)a._nextPrevious=a._next;for(a=this._additionsHead;null!==a;a=a._nextAdded)a.previousIndex=a.currentIndex;for(this._additionsHead=this._additionsTail=null,a=this._movesHead;null!==a;a=a._nextMoved)a.previousIndex=a.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(a,l,f,g){let p;return null===a?p=this._itTail:(p=a._prev,this._remove(a)),null!==(a=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null))?(Object.is(a.item,l)||this._addIdentityChange(a,l),this._reinsertAfter(a,p,g)):null!==(a=null===this._linkedRecords?null:this._linkedRecords.get(f,g))?(Object.is(a.item,l)||this._addIdentityChange(a,l),this._moveAfter(a,p,g)):a=this._addAfter(new lP(l,f),p,g),a}_verifyReinsertion(a,l,f,g){let p=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null);return null!==p?a=this._reinsertAfter(p,a._prev,g):a.currentIndex!=g&&(a.currentIndex=g,this._addToMoves(a,g)),a}_truncate(a){for(;null!==a;){const l=a._next;this._addToRemovals(this._unlink(a)),a=l}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(a,l,f){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(a);const g=a._prevRemoved,p=a._nextRemoved;return null===g?this._removalsHead=p:g._nextRemoved=p,null===p?this._removalsTail=g:p._prevRemoved=g,this._insertAfter(a,l,f),this._addToMoves(a,f),a}_moveAfter(a,l,f){return this._unlink(a),this._insertAfter(a,l,f),this._addToMoves(a,f),a}_addAfter(a,l,f){return this._insertAfter(a,l,f),this._additionsTail=null===this._additionsTail?this._additionsHead=a:this._additionsTail._nextAdded=a,a}_insertAfter(a,l,f){const g=null===l?this._itHead:l._next;return a._next=g,a._prev=l,null===g?this._itTail=a:g._prev=a,null===l?this._itHead=a:l._next=a,null===this._linkedRecords&&(this._linkedRecords=new Ww),this._linkedRecords.put(a),a.currentIndex=f,a}_remove(a){return this._addToRemovals(this._unlink(a))}_unlink(a){null!==this._linkedRecords&&this._linkedRecords.remove(a);const l=a._prev,f=a._next;return null===l?this._itHead=f:l._next=f,null===f?this._itTail=l:f._prev=l,a}_addToMoves(a,l){return a.previousIndex===l||(this._movesTail=null===this._movesTail?this._movesHead=a:this._movesTail._nextMoved=a),a}_addToRemovals(a){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Ww),this._unlinkedRecords.put(a),a.currentIndex=null,a._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=a,a._prevRemoved=null):(a._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=a),a}_addIdentityChange(a,l){return a.item=l,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=a:this._identityChangesTail._nextIdentityChange=a,a}}class lP{constructor(a,l){this.item=a,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class cP{constructor(){this._head=null,this._tail=null}add(a){null===this._head?(this._head=this._tail=a,a._nextDup=null,a._prevDup=null):(this._tail._nextDup=a,a._prevDup=this._tail,a._nextDup=null,this._tail=a)}get(a,l){let f;for(f=this._head;null!==f;f=f._nextDup)if((null===l||l<=f.currentIndex)&&Object.is(f.trackById,a))return f;return null}remove(a){const l=a._prevDup,f=a._nextDup;return null===l?this._head=f:l._nextDup=f,null===f?this._tail=l:f._prevDup=l,null===this._head}}class Ww{constructor(){this.map=new Map}put(a){const l=a.trackById;let f=this.map.get(l);f||(f=new cP,this.map.set(l,f)),f.add(a)}get(a,l){const g=this.map.get(a);return g?g.get(a,l):null}remove(a){const l=a.trackById;return this.map.get(l).remove(a)&&this.map.delete(l),a}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function zw(u,a,l){const f=u.previousIndex;if(null===f)return f;let g=0;return l&&f<l.length&&(g=l[f]),f+a+g}function $w(){return new eh([new Hw])}let eh=(()=>{class u{constructor(l){this.factories=l}static create(l,f){if(null!=f){const g=f.factories.slice();l=l.concat(g)}return new u(l)}static extend(l){return{provide:u,useFactory:f=>u.create(l,f||$w()),deps:[[u,new dl,new hs]]}}find(l){const f=this.factories.find(g=>g.supports(l));if(null!=f)return f;throw new yt(901,"")}}return u.\u0275prov=mt({token:u,providedIn:"root",factory:$w}),u})();const gP=Fw(null,"core",[]);let pP=(()=>{class u{constructor(l){}}return u.\u0275fac=function(l){return new(l||u)(We(vp))},u.\u0275mod=nr({type:u}),u.\u0275inj=Pi({}),u})(),th=null;function mr(){return th}const Di=new ct("DocumentToken");let Zs=(()=>{class u{historyGo(l){throw new Error("Not implemented")}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275prov=mt({token:u,factory:function(){return function yP(){return We(qw)}()},providedIn:"platform"}),u})();const CP=new ct("Location Initialized");let qw=(()=>{class u extends Zs{constructor(l){super(),this._doc=l,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return mr().getBaseHref(this._doc)}onPopState(l){const f=mr().getGlobalEventTarget(this._doc,"window");return f.addEventListener("popstate",l,!1),()=>f.removeEventListener("popstate",l)}onHashChange(l){const f=mr().getGlobalEventTarget(this._doc,"window");return f.addEventListener("hashchange",l,!1),()=>f.removeEventListener("hashchange",l)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(l){this.location.pathname=l}pushState(l,f,g){Zw()?this._history.pushState(l,f,g):this.location.hash=g}replaceState(l,f,g){Zw()?this._history.replaceState(l,f,g):this.location.hash=g}forward(){this._history.forward()}back(){this._history.back()}historyGo(l=0){this._history.go(l)}getState(){return this._history.state}}return u.\u0275fac=function(l){return new(l||u)(We(Di))},u.\u0275prov=mt({token:u,factory:function(){return function EP(){return new qw(We(Di))}()},providedIn:"platform"}),u})();function Zw(){return!!window.history.pushState}function Dp(u,a){if(0==u.length)return a;if(0==a.length)return u;let l=0;return u.endsWith("/")&&l++,a.startsWith("/")&&l++,2==l?u+a.substring(1):1==l?u+a:u+"/"+a}function Kw(u){const a=u.match(/#|\?|$/),l=a&&a.index||u.length;return u.slice(0,l-("/"===u[l-1]?1:0))+u.slice(l)}function kr(u){return u&&"?"!==u[0]?"?"+u:u}let ua=(()=>{class u{historyGo(l){throw new Error("Not implemented")}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275prov=mt({token:u,factory:function(){return function wP(u){const a=We(Di).location;return new Qw(We(Zs),a&&a.origin||"")}()},providedIn:"root"}),u})();const Sp=new ct("appBaseHref");let Qw=(()=>{class u extends ua{constructor(l,f){if(super(),this._platformLocation=l,this._removeListenerFns=[],null==f&&(f=this._platformLocation.getBaseHrefFromDOM()),null==f)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=f}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(l){this._removeListenerFns.push(this._platformLocation.onPopState(l),this._platformLocation.onHashChange(l))}getBaseHref(){return this._baseHref}prepareExternalUrl(l){return Dp(this._baseHref,l)}path(l=!1){const f=this._platformLocation.pathname+kr(this._platformLocation.search),g=this._platformLocation.hash;return g&&l?`${f}${g}`:f}pushState(l,f,g,p){const _=this.prepareExternalUrl(g+kr(p));this._platformLocation.pushState(l,f,_)}replaceState(l,f,g,p){const _=this.prepareExternalUrl(g+kr(p));this._platformLocation.replaceState(l,f,_)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(l=0){var f,g;null===(g=(f=this._platformLocation).historyGo)||void 0===g||g.call(f,l)}}return u.\u0275fac=function(l){return new(l||u)(We(Zs),We(Sp,8))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})(),bP=(()=>{class u extends ua{constructor(l,f){super(),this._platformLocation=l,this._baseHref="",this._removeListenerFns=[],null!=f&&(this._baseHref=f)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(l){this._removeListenerFns.push(this._platformLocation.onPopState(l),this._platformLocation.onHashChange(l))}getBaseHref(){return this._baseHref}path(l=!1){let f=this._platformLocation.hash;return null==f&&(f="#"),f.length>0?f.substring(1):f}prepareExternalUrl(l){const f=Dp(this._baseHref,l);return f.length>0?"#"+f:f}pushState(l,f,g,p){let _=this.prepareExternalUrl(g+kr(p));0==_.length&&(_=this._platformLocation.pathname),this._platformLocation.pushState(l,f,_)}replaceState(l,f,g,p){let _=this.prepareExternalUrl(g+kr(p));0==_.length&&(_=this._platformLocation.pathname),this._platformLocation.replaceState(l,f,_)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(l=0){var f,g;null===(g=(f=this._platformLocation).historyGo)||void 0===g||g.call(f,l)}}return u.\u0275fac=function(l){return new(l||u)(We(Zs),We(Sp,8))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})(),Tp=(()=>{class u{constructor(l,f){this._subject=new Zt,this._urlChangeListeners=[],this._platformStrategy=l;const g=this._platformStrategy.getBaseHref();this._platformLocation=f,this._baseHref=Kw(Jw(g)),this._platformStrategy.onPopState(p=>{this._subject.emit({url:this.path(!0),pop:!0,state:p.state,type:p.type})})}path(l=!1){return this.normalize(this._platformStrategy.path(l))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(l,f=""){return this.path()==this.normalize(l+kr(f))}normalize(l){return u.stripTrailingSlash(function SP(u,a){return u&&a.startsWith(u)?a.substring(u.length):a}(this._baseHref,Jw(l)))}prepareExternalUrl(l){return l&&"/"!==l[0]&&(l="/"+l),this._platformStrategy.prepareExternalUrl(l)}go(l,f="",g=null){this._platformStrategy.pushState(g,"",l,f),this._notifyUrlChangeListeners(this.prepareExternalUrl(l+kr(f)),g)}replaceState(l,f="",g=null){this._platformStrategy.replaceState(g,"",l,f),this._notifyUrlChangeListeners(this.prepareExternalUrl(l+kr(f)),g)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(l=0){var f,g;null===(g=(f=this._platformStrategy).historyGo)||void 0===g||g.call(f,l)}onUrlChange(l){this._urlChangeListeners.push(l),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(f=>{this._notifyUrlChangeListeners(f.url,f.state)}))}_notifyUrlChangeListeners(l="",f){this._urlChangeListeners.forEach(g=>g(l,f))}subscribe(l,f,g){return this._subject.subscribe({next:l,error:f,complete:g})}}return u.normalizeQueryParams=kr,u.joinWithSlash=Dp,u.stripTrailingSlash=Kw,u.\u0275fac=function(l){return new(l||u)(We(ua),We(Zs))},u.\u0275prov=mt({token:u,factory:function(){return function DP(){return new Tp(We(ua),We(Zs))}()},providedIn:"root"}),u})();function Jw(u){return u.replace(/\/index.html$/,"")}class hN{constructor(a,l,f,g){this.$implicit=a,this.ngForOf=l,this.index=f,this.count=g}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let lb=(()=>{class u{constructor(l,f,g){this._viewContainer=l,this._template=f,this._differs=g,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(l){this._ngForOf=l,this._ngForOfDirty=!0}set ngForTrackBy(l){this._trackByFn=l}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(l){l&&(this._template=l)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const l=this._ngForOf;!this._differ&&l&&(this._differ=this._differs.find(l).create(this.ngForTrackBy))}if(this._differ){const l=this._differ.diff(this._ngForOf);l&&this._applyChanges(l)}}_applyChanges(l){const f=this._viewContainer;l.forEachOperation((g,p,_)=>{if(null==g.previousIndex)f.createEmbeddedView(this._template,new hN(g.item,this._ngForOf,-1,-1),null===_?void 0:_);else if(null==_)f.remove(null===p?void 0:p);else if(null!==p){const y=f.get(p);f.move(y,_),cb(y,g)}});for(let g=0,p=f.length;g<p;g++){const y=f.get(g).context;y.index=g,y.count=p,y.ngForOf=this._ngForOf}l.forEachIdentityChange(g=>{cb(f.get(g.currentIndex),g)})}static ngTemplateContextGuard(l,f){return!0}}return u.\u0275fac=function(l){return new(l||u)(ve(zi),ve(Nr),ve(eh))},u.\u0275dir=He({type:u,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),u})();function cb(u,a){u.context.$implicit=a.item}let ub=(()=>{class u{constructor(l,f){this._viewContainer=l,this._context=new dN,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=f}set ngIf(l){this._context.$implicit=this._context.ngIf=l,this._updateView()}set ngIfThen(l){hb("ngIfThen",l),this._thenTemplateRef=l,this._thenViewRef=null,this._updateView()}set ngIfElse(l){hb("ngIfElse",l),this._elseTemplateRef=l,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(l,f){return!0}}return u.\u0275fac=function(l){return new(l||u)(ve(zi),ve(Nr))},u.\u0275dir=He({type:u,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),u})();class dN{constructor(){this.$implicit=null,this.ngIf=null}}function hb(u,a){if(a&&!a.createEmbeddedView)throw new Error(`${u} must be a TemplateRef, but received '${Dt(a)}'.`)}let VN=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275mod=nr({type:u}),u.\u0275inj=Pi({}),u})();let HN=(()=>{class u{}return u.\u0275prov=mt({token:u,providedIn:"root",factory:()=>new WN(We(Di),window)}),u})();class WN{constructor(a,l){this.document=a,this.window=l,this.offset=()=>[0,0]}setOffset(a){this.offset=Array.isArray(a)?()=>a:a}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(a){this.supportsScrolling()&&this.window.scrollTo(a[0],a[1])}scrollToAnchor(a){if(!this.supportsScrolling())return;const l=function zN(u,a){const l=u.getElementById(a)||u.getElementsByName(a)[0];if(l)return l;if("function"==typeof u.createTreeWalker&&u.body&&(u.body.createShadowRoot||u.body.attachShadow)){const f=u.createTreeWalker(u.body,NodeFilter.SHOW_ELEMENT);let g=f.currentNode;for(;g;){const p=g.shadowRoot;if(p){const _=p.getElementById(a)||p.querySelector(`[name="${a}"]`);if(_)return _}g=f.nextNode()}}return null}(this.document,a);l&&(this.scrollToElement(l),l.focus())}setHistoryScrollRestoration(a){if(this.supportScrollRestoration()){const l=this.window.history;l&&l.scrollRestoration&&(l.scrollRestoration=a)}}scrollToElement(a){const l=a.getBoundingClientRect(),f=l.left+this.window.pageXOffset,g=l.top+this.window.pageYOffset,p=this.offset();this.window.scrollTo(f-p[0],g-p[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const a=pb(this.window.history)||pb(Object.getPrototypeOf(this.window.history));return!(!a||!a.writable&&!a.set)}catch(a){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(a){return!1}}}function pb(u){return Object.getOwnPropertyDescriptor(u,"scrollRestoration")}class jp extends class $N extends class vP{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function _P(u){th||(th=u)}(new jp)}onAndCancel(a,l,f){return a.addEventListener(l,f,!1),()=>{a.removeEventListener(l,f,!1)}}dispatchEvent(a,l){a.dispatchEvent(l)}remove(a){a.parentNode&&a.parentNode.removeChild(a)}createElement(a,l){return(l=l||this.getDefaultDocument()).createElement(a)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(a){return a.nodeType===Node.ELEMENT_NODE}isShadowRoot(a){return a instanceof DocumentFragment}getGlobalEventTarget(a,l){return"window"===l?window:"document"===l?a:"body"===l?a.body:null}getBaseHref(a){const l=function XN(){return Hl=Hl||document.querySelector("base"),Hl?Hl.getAttribute("href"):null}();return null==l?null:function qN(u){hh=hh||document.createElement("a"),hh.setAttribute("href",u);const a=hh.pathname;return"/"===a.charAt(0)?a:`/${a}`}(l)}resetBaseElement(){Hl=null}getUserAgent(){return window.navigator.userAgent}getCookie(a){return function lN(u,a){a=encodeURIComponent(a);for(const l of u.split(";")){const f=l.indexOf("="),[g,p]=-1==f?[l,""]:[l.slice(0,f),l.slice(f+1)];if(g.trim()===a)return decodeURIComponent(p)}return null}(document.cookie,a)}}let hh,Hl=null;const mb=new ct("TRANSITION_ID"),KN=[{provide:cp,useFactory:function ZN(u,a,l){return()=>{l.get(up).donePromise.then(()=>{const f=mr(),g=a.querySelectorAll(`style[ng-transition="${u}"]`);for(let p=0;p<g.length;p++)f.remove(g[p])})}},deps:[mb,Di,Xn],multi:!0}];class Up{static init(){!function WF(u){mp=u}(new Up)}addToWindow(a){xt.getAngularTestability=(f,g=!0)=>{const p=a.findTestabilityInTree(f,g);if(null==p)throw new Error("Could not find testability for element.");return p},xt.getAllAngularTestabilities=()=>a.getAllTestabilities(),xt.getAllAngularRootElements=()=>a.getAllRootElements(),xt.frameworkStabilizers||(xt.frameworkStabilizers=[]),xt.frameworkStabilizers.push(f=>{const g=xt.getAllAngularTestabilities();let p=g.length,_=!1;const y=function(b){_=_||b,p--,0==p&&f(_)};g.forEach(function(b){b.whenStable(y)})})}findTestabilityInTree(a,l,f){if(null==l)return null;const g=a.getTestability(l);return null!=g?g:f?mr().isShadowRoot(l)?this.findTestabilityInTree(a,l.host,!0):this.findTestabilityInTree(a,l.parentElement,!0):null}}let QN=(()=>{class u{build(){return new XMLHttpRequest}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();const dh=new ct("EventManagerPlugins");let fh=(()=>{class u{constructor(l,f){this._zone=f,this._eventNameToPlugin=new Map,l.forEach(g=>g.manager=this),this._plugins=l.slice().reverse()}addEventListener(l,f,g){return this._findPluginFor(f).addEventListener(l,f,g)}addGlobalEventListener(l,f,g){return this._findPluginFor(f).addGlobalEventListener(l,f,g)}getZone(){return this._zone}_findPluginFor(l){const f=this._eventNameToPlugin.get(l);if(f)return f;const g=this._plugins;for(let p=0;p<g.length;p++){const _=g[p];if(_.supports(l))return this._eventNameToPlugin.set(l,_),_}throw new Error(`No event manager plugin found for event ${l}`)}}return u.\u0275fac=function(l){return new(l||u)(We(dh),We(In))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();class _b{constructor(a){this._doc=a}addGlobalEventListener(a,l,f){const g=mr().getGlobalEventTarget(this._doc,a);if(!g)throw new Error(`Unsupported event target ${g} for event ${l}`);return this.addEventListener(g,l,f)}}let vb=(()=>{class u{constructor(){this._stylesSet=new Set}addStyles(l){const f=new Set;l.forEach(g=>{this._stylesSet.has(g)||(this._stylesSet.add(g),f.add(g))}),this.onStylesAdded(f)}onStylesAdded(l){}getAllStyles(){return Array.from(this._stylesSet)}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})(),Wl=(()=>{class u extends vb{constructor(l){super(),this._doc=l,this._hostNodes=new Map,this._hostNodes.set(l.head,[])}_addStylesToHost(l,f,g){l.forEach(p=>{const _=this._doc.createElement("style");_.textContent=p,g.push(f.appendChild(_))})}addHost(l){const f=[];this._addStylesToHost(this._stylesSet,l,f),this._hostNodes.set(l,f)}removeHost(l){const f=this._hostNodes.get(l);f&&f.forEach(yb),this._hostNodes.delete(l)}onStylesAdded(l){this._hostNodes.forEach((f,g)=>{this._addStylesToHost(l,g,f)})}ngOnDestroy(){this._hostNodes.forEach(l=>l.forEach(yb))}}return u.\u0275fac=function(l){return new(l||u)(We(Di))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();function yb(u){mr().remove(u)}const Gp={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Hp=/%COMP%/g;function gh(u,a,l){for(let f=0;f<a.length;f++){let g=a[f];Array.isArray(g)?gh(u,g,l):(g=g.replace(Hp,u),l.push(g))}return l}function wb(u){return a=>{if("__ngUnwrap__"===a)return u;!1===u(a)&&(a.preventDefault(),a.returnValue=!1)}}let Wp=(()=>{class u{constructor(l,f,g){this.eventManager=l,this.sharedStylesHost=f,this.appId=g,this.rendererByCompId=new Map,this.defaultRenderer=new zp(l)}createRenderer(l,f){if(!l||!f)return this.defaultRenderer;switch(f.encapsulation){case tr.Emulated:{let g=this.rendererByCompId.get(f.id);return g||(g=new rk(this.eventManager,this.sharedStylesHost,f,this.appId),this.rendererByCompId.set(f.id,g)),g.applyToHost(l),g}case 1:case tr.ShadowDom:return new sk(this.eventManager,this.sharedStylesHost,l,f);default:if(!this.rendererByCompId.has(f.id)){const g=gh(f.id,f.styles,[]);this.sharedStylesHost.addStyles(g),this.rendererByCompId.set(f.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return u.\u0275fac=function(l){return new(l||u)(We(fh),We(Wl),We(Vl))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();class zp{constructor(a){this.eventManager=a,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(a,l){return l?document.createElementNS(Gp[l]||l,a):document.createElement(a)}createComment(a){return document.createComment(a)}createText(a){return document.createTextNode(a)}appendChild(a,l){a.appendChild(l)}insertBefore(a,l,f){a&&a.insertBefore(l,f)}removeChild(a,l){a&&a.removeChild(l)}selectRootElement(a,l){let f="string"==typeof a?document.querySelector(a):a;if(!f)throw new Error(`The selector "${a}" did not match any elements`);return l||(f.textContent=""),f}parentNode(a){return a.parentNode}nextSibling(a){return a.nextSibling}setAttribute(a,l,f,g){if(g){l=g+":"+l;const p=Gp[g];p?a.setAttributeNS(p,l,f):a.setAttribute(l,f)}else a.setAttribute(l,f)}removeAttribute(a,l,f){if(f){const g=Gp[f];g?a.removeAttributeNS(g,l):a.removeAttribute(`${f}:${l}`)}else a.removeAttribute(l)}addClass(a,l){a.classList.add(l)}removeClass(a,l){a.classList.remove(l)}setStyle(a,l,f,g){g&(ri.DashCase|ri.Important)?a.style.setProperty(l,f,g&ri.Important?"important":""):a.style[l]=f}removeStyle(a,l,f){f&ri.DashCase?a.style.removeProperty(l):a.style[l]=""}setProperty(a,l,f){a[l]=f}setValue(a,l){a.nodeValue=l}listen(a,l,f){return"string"==typeof a?this.eventManager.addGlobalEventListener(a,l,wb(f)):this.eventManager.addEventListener(a,l,wb(f))}}class rk extends zp{constructor(a,l,f,g){super(a),this.component=f;const p=gh(g+"-"+f.id,f.styles,[]);l.addStyles(p),this.contentAttr=function tk(u){return"_ngcontent-%COMP%".replace(Hp,u)}(g+"-"+f.id),this.hostAttr=function nk(u){return"_nghost-%COMP%".replace(Hp,u)}(g+"-"+f.id)}applyToHost(a){super.setAttribute(a,this.hostAttr,"")}createElement(a,l){const f=super.createElement(a,l);return super.setAttribute(f,this.contentAttr,""),f}}class sk extends zp{constructor(a,l,f,g){super(a),this.sharedStylesHost=l,this.hostEl=f,this.shadowRoot=f.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const p=gh(g.id,g.styles,[]);for(let _=0;_<p.length;_++){const y=document.createElement("style");y.textContent=p[_],this.shadowRoot.appendChild(y)}}nodeOrShadowRoot(a){return a===this.hostEl?this.shadowRoot:a}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(a,l){return super.appendChild(this.nodeOrShadowRoot(a),l)}insertBefore(a,l,f){return super.insertBefore(this.nodeOrShadowRoot(a),l,f)}removeChild(a,l){return super.removeChild(this.nodeOrShadowRoot(a),l)}parentNode(a){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(a)))}}let ok=(()=>{class u extends _b{constructor(l){super(l)}supports(l){return!0}addEventListener(l,f,g){return l.addEventListener(f,g,!1),()=>this.removeEventListener(l,f,g)}removeEventListener(l,f,g){return l.removeEventListener(f,g)}}return u.\u0275fac=function(l){return new(l||u)(We(Di))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();const Db=["alt","control","meta","shift"],lk={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Sb={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},ck={alt:u=>u.altKey,control:u=>u.ctrlKey,meta:u=>u.metaKey,shift:u=>u.shiftKey};let uk=(()=>{class u extends _b{constructor(l){super(l)}supports(l){return null!=u.parseEventName(l)}addEventListener(l,f,g){const p=u.parseEventName(f),_=u.eventCallback(p.fullKey,g,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>mr().onAndCancel(l,p.domEventName,_))}static parseEventName(l){const f=l.toLowerCase().split("."),g=f.shift();if(0===f.length||"keydown"!==g&&"keyup"!==g)return null;const p=u._normalizeKey(f.pop());let _="";if(Db.forEach(b=>{const O=f.indexOf(b);O>-1&&(f.splice(O,1),_+=b+".")}),_+=p,0!=f.length||0===p.length)return null;const y={};return y.domEventName=g,y.fullKey=_,y}static getEventFullKey(l){let f="",g=function hk(u){let a=u.key;if(null==a){if(a=u.keyIdentifier,null==a)return"Unidentified";a.startsWith("U+")&&(a=String.fromCharCode(parseInt(a.substring(2),16)),3===u.location&&Sb.hasOwnProperty(a)&&(a=Sb[a]))}return lk[a]||a}(l);return g=g.toLowerCase()," "===g?g="space":"."===g&&(g="dot"),Db.forEach(p=>{p!=g&&ck[p](l)&&(f+=p+".")}),f+=g,f}static eventCallback(l,f,g){return p=>{u.getEventFullKey(p)===l&&g.runGuarded(()=>f(p))}}static _normalizeKey(l){return"esc"===l?"escape":l}}return u.\u0275fac=function(l){return new(l||u)(We(Di))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();const pk=Fw(gP,"browser",[{provide:Tw,useValue:"browser"},{provide:Sw,useValue:function dk(){jp.makeCurrent(),Up.init()},multi:!0},{provide:Di,useFactory:function gk(){return function Ex(u){rf=u}(document),document},deps:[]}]),mk=[{provide:yg,useValue:"root"},{provide:vl,useFactory:function fk(){return new vl},deps:[]},{provide:dh,useClass:ok,multi:!0,deps:[Di,In,Tw]},{provide:dh,useClass:uk,multi:!0,deps:[Di]},{provide:Wp,useClass:Wp,deps:[fh,Wl,Vl]},{provide:UE,useExisting:Wp},{provide:vb,useExisting:Wl},{provide:Wl,useClass:Wl,deps:[Di]},{provide:pp,useClass:pp,deps:[In]},{provide:fh,useClass:fh,deps:[dh,In]},{provide:class YN{},useClass:QN,deps:[]}];let _k=(()=>{class u{constructor(l){if(l)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(l){return{ngModule:u,providers:[{provide:Vl,useValue:l.appId},{provide:mb,useExisting:Vl},KN]}}}return u.\u0275fac=function(l){return new(l||u)(We(u,12))},u.\u0275mod=nr({type:u}),u.\u0275inj=Pi({providers:mk,imports:[VN,pP]}),u})();"undefined"!=typeof window&&window;const{isArray:xk}=Array,{getPrototypeOf:Ak,prototype:Rk,keys:Ok}=Object;function xb(u){if(1===u.length){const a=u[0];if(xk(a))return{args:a,keys:null};if(function Mk(u){return u&&"object"==typeof u&&Ak(u)===Rk}(a)){const l=Ok(a);return{args:l.map(f=>a[f]),keys:l}}}return{args:u,keys:null}}const{isArray:Lk}=Array;function Ab(u){return Nt(a=>function Fk(u,a){return Lk(a)?u(...a):u(a)}(u,a))}function Rb(u,a){return u.reduce((l,f,g)=>(l[f]=a[g],l),{})}let Ob=(()=>{class u{constructor(l,f){this._renderer=l,this._elementRef=f,this.onChange=g=>{},this.onTouched=()=>{}}setProperty(l,f){this._renderer.setProperty(this._elementRef.nativeElement,l,f)}registerOnTouched(l){this.onTouched=l}registerOnChange(l){this.onChange=l}setDisabledState(l){this.setProperty("disabled",l)}}return u.\u0275fac=function(l){return new(l||u)(ve(Fr),ve(oi))},u.\u0275dir=He({type:u}),u})(),Ks=(()=>{class u extends Ob{}return u.\u0275fac=function(){let a;return function(f){return(a||(a=function Ln(u){return ss(()=>{const a=u.prototype.constructor,l=a[Ar]||Cf(a),f=Object.prototype;let g=Object.getPrototypeOf(u.prototype).constructor;for(;g&&g!==f;){const p=g[Ar]||Cf(g);if(p&&p!==l)return p;g=Object.getPrototypeOf(g)}return p=>new p})}(u)))(f||u)}}(),u.\u0275dir=He({type:u,features:[St]}),u})();const _r=new ct("NgValueAccessor"),kk={provide:_r,useExisting:kt(()=>ph),multi:!0},Vk=new ct("CompositionEventMode");let ph=(()=>{class u extends Ob{constructor(l,f,g){super(l,f),this._compositionMode=g,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Bk(){const u=mr()?mr().getUserAgent():"";return/android (\d+)/.test(u.toLowerCase())}())}writeValue(l){this.setProperty("value",null==l?"":l)}_handleInput(l){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(l)}_compositionStart(){this._composing=!0}_compositionEnd(l){this._composing=!1,this._compositionMode&&this.onChange(l)}}return u.\u0275fac=function(l){return new(l||u)(ve(Fr),ve(oi),ve(Vk,8))},u.\u0275dir=He({type:u,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(l,f){1&l&&Tn("input",function(p){return f._handleInput(p.target.value)})("blur",function(){return f.onTouched()})("compositionstart",function(){return f._compositionStart()})("compositionend",function(p){return f._compositionEnd(p.target.value)})},features:[Ht([kk]),St]}),u})();const Nn=new ct("NgValidators"),ys=new ct("NgAsyncValidators");function Gb(u){return null!=u}function Hb(u){const a=Tl(u)?wn(u):u;return Fg(a),a}function Wb(u){let a={};return u.forEach(l=>{a=null!=l?Object.assign(Object.assign({},a),l):a}),0===Object.keys(a).length?null:a}function zb(u,a){return a.map(l=>l(u))}function Yb(u){return u.map(a=>function Uk(u){return!u.validate}(a)?a:l=>a.validate(l))}function $p(u){return null!=u?function $b(u){if(!u)return null;const a=u.filter(Gb);return 0==a.length?null:function(l){return Wb(zb(l,a))}}(Yb(u)):null}function Xp(u){return null!=u?function Xb(u){if(!u)return null;const a=u.filter(Gb);return 0==a.length?null:function(l){return function Pk(...u){const a=cv(u),{args:l,keys:f}=xb(u),g=new sn(p=>{const{length:_}=l;if(!_)return void p.complete();const y=new Array(_);let b=_,O=_;for(let M=0;M<_;M++){let P=!1;er(l[M]).subscribe(Cn(p,k=>{P||(P=!0,O--),y[M]=k},()=>b--,void 0,()=>{(!b||!P)&&(O||p.next(f?Rb(f,y):y),p.complete())}))}});return a?g.pipe(Ab(a)):g}(zb(l,a).map(Hb)).pipe(Nt(Wb))}}(Yb(u)):null}function qb(u,a){return null===u?[a]:Array.isArray(u)?[...u,a]:[u,a]}function qp(u){return u?Array.isArray(u)?u:[u]:[]}function _h(u,a){return Array.isArray(u)?u.includes(a):u===a}function Qb(u,a){const l=qp(a);return qp(u).forEach(g=>{_h(l,g)||l.push(g)}),l}function Jb(u,a){return qp(a).filter(l=>!_h(u,l))}class eD{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(a){this._rawValidators=a||[],this._composedValidatorFn=$p(this._rawValidators)}_setAsyncValidators(a){this._rawAsyncValidators=a||[],this._composedAsyncValidatorFn=Xp(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(a){this._onDestroyCallbacks.push(a)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(a=>a()),this._onDestroyCallbacks=[]}reset(a){this.control&&this.control.reset(a)}hasError(a,l){return!!this.control&&this.control.hasError(a,l)}getError(a,l){return this.control?this.control.getError(a,l):null}}class Cs extends eD{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Hn extends eD{get formDirective(){return null}get path(){return null}}let nD=(()=>{class u extends class tD{constructor(a){this._cd=a}is(a){var l,f,g;return"submitted"===a?!!(null===(l=this._cd)||void 0===l?void 0:l.submitted):!!(null===(g=null===(f=this._cd)||void 0===f?void 0:f.control)||void 0===g?void 0:g[a])}}{constructor(l){super(l)}}return u.\u0275fac=function(l){return new(l||u)(ve(Cs,2))},u.\u0275dir=He({type:u,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(l,f){2&l&&Bu("ng-untouched",f.is("untouched"))("ng-touched",f.is("touched"))("ng-pristine",f.is("pristine"))("ng-dirty",f.is("dirty"))("ng-valid",f.is("valid"))("ng-invalid",f.is("invalid"))("ng-pending",f.is("pending"))},features:[St]}),u})();function zl(u,a){(function Qp(u,a){const l=function Zb(u){return u._rawValidators}(u);null!==a.validator?u.setValidators(qb(l,a.validator)):"function"==typeof l&&u.setValidators([l]);const f=function Kb(u){return u._rawAsyncValidators}(u);null!==a.asyncValidator?u.setAsyncValidators(qb(f,a.asyncValidator)):"function"==typeof f&&u.setAsyncValidators([f]);const g=()=>u.updateValueAndValidity();Eh(a._rawValidators,g),Eh(a._rawAsyncValidators,g)})(u,a),a.valueAccessor.writeValue(u.value),function Zk(u,a){a.valueAccessor.registerOnChange(l=>{u._pendingValue=l,u._pendingChange=!0,u._pendingDirty=!0,"change"===u.updateOn&&rD(u,a)})}(u,a),function Qk(u,a){const l=(f,g)=>{a.valueAccessor.writeValue(f),g&&a.viewToModelUpdate(f)};u.registerOnChange(l),a._registerOnDestroy(()=>{u._unregisterOnChange(l)})}(u,a),function Kk(u,a){a.valueAccessor.registerOnTouched(()=>{u._pendingTouched=!0,"blur"===u.updateOn&&u._pendingChange&&rD(u,a),"submit"!==u.updateOn&&u.markAsTouched()})}(u,a),function qk(u,a){if(a.valueAccessor.setDisabledState){const l=f=>{a.valueAccessor.setDisabledState(f)};u.registerOnDisabledChange(l),a._registerOnDestroy(()=>{u._unregisterOnDisabledChange(l)})}}(u,a)}function Eh(u,a){u.forEach(l=>{l.registerOnValidatorChange&&l.registerOnValidatorChange(a)})}function rD(u,a){u._pendingDirty&&u.markAsDirty(),u.setValue(u._pendingValue,{emitModelToViewChange:!1}),a.viewToModelUpdate(u._pendingValue),u._pendingChange=!1}function tm(u,a){const l=u.indexOf(a);l>-1&&u.splice(l,1)}const Yl="VALID",bh="INVALID",ha="PENDING",$l="DISABLED";function im(u){return(Dh(u)?u.validators:u)||null}function lD(u){return Array.isArray(u)?$p(u):u||null}function rm(u,a){return(Dh(a)?a.asyncValidators:u)||null}function cD(u){return Array.isArray(u)?Xp(u):u||null}function Dh(u){return null!=u&&!Array.isArray(u)&&"object"==typeof u}const sm=u=>u instanceof am;function hD(u){return(u=>u instanceof gD)(u)?u.value:u.getRawValue()}function dD(u,a){const l=sm(u),f=u.controls;if(!(l?Object.keys(f):f).length)throw new yt(1e3,"");if(!f[a])throw new yt(1001,"")}function fD(u,a){sm(u),u._forEachChild((f,g)=>{if(void 0===a[g])throw new yt(1002,"")})}class om{constructor(a,l){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=a,this._rawAsyncValidators=l,this._composedValidatorFn=lD(this._rawValidators),this._composedAsyncValidatorFn=cD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(a){this._rawValidators=this._composedValidatorFn=a}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(a){this._rawAsyncValidators=this._composedAsyncValidatorFn=a}get parent(){return this._parent}get valid(){return this.status===Yl}get invalid(){return this.status===bh}get pending(){return this.status==ha}get disabled(){return this.status===$l}get enabled(){return this.status!==$l}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(a){this._rawValidators=a,this._composedValidatorFn=lD(a)}setAsyncValidators(a){this._rawAsyncValidators=a,this._composedAsyncValidatorFn=cD(a)}addValidators(a){this.setValidators(Qb(a,this._rawValidators))}addAsyncValidators(a){this.setAsyncValidators(Qb(a,this._rawAsyncValidators))}removeValidators(a){this.setValidators(Jb(a,this._rawValidators))}removeAsyncValidators(a){this.setAsyncValidators(Jb(a,this._rawAsyncValidators))}hasValidator(a){return _h(this._rawValidators,a)}hasAsyncValidator(a){return _h(this._rawAsyncValidators,a)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(a={}){this.touched=!0,this._parent&&!a.onlySelf&&this._parent.markAsTouched(a)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(a=>a.markAllAsTouched())}markAsUntouched(a={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(l=>{l.markAsUntouched({onlySelf:!0})}),this._parent&&!a.onlySelf&&this._parent._updateTouched(a)}markAsDirty(a={}){this.pristine=!1,this._parent&&!a.onlySelf&&this._parent.markAsDirty(a)}markAsPristine(a={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(l=>{l.markAsPristine({onlySelf:!0})}),this._parent&&!a.onlySelf&&this._parent._updatePristine(a)}markAsPending(a={}){this.status=ha,!1!==a.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!a.onlySelf&&this._parent.markAsPending(a)}disable(a={}){const l=this._parentMarkedDirty(a.onlySelf);this.status=$l,this.errors=null,this._forEachChild(f=>{f.disable(Object.assign(Object.assign({},a),{onlySelf:!0}))}),this._updateValue(),!1!==a.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},a),{skipPristineCheck:l})),this._onDisabledChange.forEach(f=>f(!0))}enable(a={}){const l=this._parentMarkedDirty(a.onlySelf);this.status=Yl,this._forEachChild(f=>{f.enable(Object.assign(Object.assign({},a),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:a.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},a),{skipPristineCheck:l})),this._onDisabledChange.forEach(f=>f(!1))}_updateAncestors(a){this._parent&&!a.onlySelf&&(this._parent.updateValueAndValidity(a),a.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(a){this._parent=a}updateValueAndValidity(a={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Yl||this.status===ha)&&this._runAsyncValidator(a.emitEvent)),!1!==a.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!a.onlySelf&&this._parent.updateValueAndValidity(a)}_updateTreeValidity(a={emitEvent:!0}){this._forEachChild(l=>l._updateTreeValidity(a)),this.updateValueAndValidity({onlySelf:!0,emitEvent:a.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?$l:Yl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(a){if(this.asyncValidator){this.status=ha,this._hasOwnPendingAsyncValidator=!0;const l=Hb(this.asyncValidator(this));this._asyncValidationSubscription=l.subscribe(f=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(f,{emitEvent:a})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(a,l={}){this.errors=a,this._updateControlsErrors(!1!==l.emitEvent)}get(a){return function n2(u,a,l){if(null==a||(Array.isArray(a)||(a=a.split(l)),Array.isArray(a)&&0===a.length))return null;let f=u;return a.forEach(g=>{f=sm(f)?f.controls.hasOwnProperty(g)?f.controls[g]:null:(u=>u instanceof r2)(f)&&f.at(g)||null}),f}(this,a,".")}getError(a,l){const f=l?this.get(l):this;return f&&f.errors?f.errors[a]:null}hasError(a,l){return!!this.getError(a,l)}get root(){let a=this;for(;a._parent;)a=a._parent;return a}_updateControlsErrors(a){this.status=this._calculateStatus(),a&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(a)}_initObservables(){this.valueChanges=new Zt,this.statusChanges=new Zt}_calculateStatus(){return this._allControlsDisabled()?$l:this.errors?bh:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ha)?ha:this._anyControlsHaveStatus(bh)?bh:Yl}_anyControlsHaveStatus(a){return this._anyControls(l=>l.status===a)}_anyControlsDirty(){return this._anyControls(a=>a.dirty)}_anyControlsTouched(){return this._anyControls(a=>a.touched)}_updatePristine(a={}){this.pristine=!this._anyControlsDirty(),this._parent&&!a.onlySelf&&this._parent._updatePristine(a)}_updateTouched(a={}){this.touched=this._anyControlsTouched(),this._parent&&!a.onlySelf&&this._parent._updateTouched(a)}_isBoxedValue(a){return"object"==typeof a&&null!==a&&2===Object.keys(a).length&&"value"in a&&"disabled"in a}_registerOnCollectionChange(a){this._onCollectionChange=a}_setUpdateStrategy(a){Dh(a)&&null!=a.updateOn&&(this._updateOn=a.updateOn)}_parentMarkedDirty(a){return!a&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class gD extends om{constructor(a=null,l,f){super(im(l),rm(f,l)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(a),this._setUpdateStrategy(l),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Dh(l)&&l.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(a)?a.value:a)}setValue(a,l={}){this.value=this._pendingValue=a,this._onChange.length&&!1!==l.emitModelToViewChange&&this._onChange.forEach(f=>f(this.value,!1!==l.emitViewToModelChange)),this.updateValueAndValidity(l)}patchValue(a,l={}){this.setValue(a,l)}reset(a=this.defaultValue,l={}){this._applyFormState(a),this.markAsPristine(l),this.markAsUntouched(l),this.setValue(this.value,l),this._pendingChange=!1}_updateValue(){}_anyControls(a){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(a){this._onChange.push(a)}_unregisterOnChange(a){tm(this._onChange,a)}registerOnDisabledChange(a){this._onDisabledChange.push(a)}_unregisterOnDisabledChange(a){tm(this._onDisabledChange,a)}_forEachChild(a){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(a){this._isBoxedValue(a)?(this.value=this._pendingValue=a.value,a.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=a}}class am extends om{constructor(a,l,f){super(im(l),rm(f,l)),this.controls=a,this._initObservables(),this._setUpdateStrategy(l),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(a,l){return this.controls[a]?this.controls[a]:(this.controls[a]=l,l.setParent(this),l._registerOnCollectionChange(this._onCollectionChange),l)}addControl(a,l,f={}){this.registerControl(a,l),this.updateValueAndValidity({emitEvent:f.emitEvent}),this._onCollectionChange()}removeControl(a,l={}){this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),delete this.controls[a],this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}setControl(a,l,f={}){this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),delete this.controls[a],l&&this.registerControl(a,l),this.updateValueAndValidity({emitEvent:f.emitEvent}),this._onCollectionChange()}contains(a){return this.controls.hasOwnProperty(a)&&this.controls[a].enabled}setValue(a,l={}){fD(this,a),Object.keys(a).forEach(f=>{dD(this,f),this.controls[f].setValue(a[f],{onlySelf:!0,emitEvent:l.emitEvent})}),this.updateValueAndValidity(l)}patchValue(a,l={}){null!=a&&(Object.keys(a).forEach(f=>{this.controls[f]&&this.controls[f].patchValue(a[f],{onlySelf:!0,emitEvent:l.emitEvent})}),this.updateValueAndValidity(l))}reset(a={},l={}){this._forEachChild((f,g)=>{f.reset(a[g],{onlySelf:!0,emitEvent:l.emitEvent})}),this._updatePristine(l),this._updateTouched(l),this.updateValueAndValidity(l)}getRawValue(){return this._reduceChildren({},(a,l,f)=>(a[f]=hD(l),a))}_syncPendingControls(){let a=this._reduceChildren(!1,(l,f)=>!!f._syncPendingControls()||l);return a&&this.updateValueAndValidity({onlySelf:!0}),a}_forEachChild(a){Object.keys(this.controls).forEach(l=>{const f=this.controls[l];f&&a(f,l)})}_setUpControls(){this._forEachChild(a=>{a.setParent(this),a._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(a){for(const l of Object.keys(this.controls)){const f=this.controls[l];if(this.contains(l)&&a(f))return!0}return!1}_reduceValue(){return this._reduceChildren({},(a,l,f)=>((l.enabled||this.disabled)&&(a[f]=l.value),a))}_reduceChildren(a,l){let f=a;return this._forEachChild((g,p)=>{f=l(f,g,p)}),f}_allControlsDisabled(){for(const a of Object.keys(this.controls))if(this.controls[a].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class r2 extends om{constructor(a,l,f){super(im(l),rm(f,l)),this.controls=a,this._initObservables(),this._setUpdateStrategy(l),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(a){return this.controls[a]}push(a,l={}){this.controls.push(a),this._registerControl(a),this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}insert(a,l,f={}){this.controls.splice(a,0,l),this._registerControl(l),this.updateValueAndValidity({emitEvent:f.emitEvent})}removeAt(a,l={}){this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),this.controls.splice(a,1),this.updateValueAndValidity({emitEvent:l.emitEvent})}setControl(a,l,f={}){this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),this.controls.splice(a,1),l&&(this.controls.splice(a,0,l),this._registerControl(l)),this.updateValueAndValidity({emitEvent:f.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(a,l={}){fD(this,a),a.forEach((f,g)=>{dD(this,g),this.at(g).setValue(f,{onlySelf:!0,emitEvent:l.emitEvent})}),this.updateValueAndValidity(l)}patchValue(a,l={}){null!=a&&(a.forEach((f,g)=>{this.at(g)&&this.at(g).patchValue(f,{onlySelf:!0,emitEvent:l.emitEvent})}),this.updateValueAndValidity(l))}reset(a=[],l={}){this._forEachChild((f,g)=>{f.reset(a[g],{onlySelf:!0,emitEvent:l.emitEvent})}),this._updatePristine(l),this._updateTouched(l),this.updateValueAndValidity(l)}getRawValue(){return this.controls.map(a=>hD(a))}clear(a={}){this.controls.length<1||(this._forEachChild(l=>l._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:a.emitEvent}))}_syncPendingControls(){let a=this.controls.reduce((l,f)=>!!f._syncPendingControls()||l,!1);return a&&this.updateValueAndValidity({onlySelf:!0}),a}_forEachChild(a){this.controls.forEach((l,f)=>{a(l,f)})}_updateValue(){this.value=this.controls.filter(a=>a.enabled||this.disabled).map(a=>a.value)}_anyControls(a){return this.controls.some(l=>l.enabled&&a(l))}_setUpControls(){this._forEachChild(a=>this._registerControl(a))}_allControlsDisabled(){for(const a of this.controls)if(a.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(a){a.setParent(this),a._registerOnCollectionChange(this._onCollectionChange)}}const a2={provide:Cs,useExisting:kt(()=>cm)},_D=(()=>Promise.resolve(null))();let cm=(()=>{class u extends Cs{constructor(l,f,g,p,_){super(),this._changeDetectorRef=_,this.control=new gD,this._registered=!1,this.update=new Zt,this._parent=l,this._setValidators(f),this._setAsyncValidators(g),this.valueAccessor=function em(u,a){if(!a)return null;let l,f,g;return Array.isArray(a),a.forEach(p=>{p.constructor===ph?l=p:function t2(u){return Object.getPrototypeOf(u.constructor)===Ks}(p)?f=p:g=p}),g||f||l||null}(0,p)}ngOnChanges(l){if(this._checkForErrors(),!this._registered||"name"in l){if(this._registered&&(this._checkName(),this.formDirective)){const f=l.name.previousValue;this.formDirective.removeControl({name:f,path:this._getPath(f)})}this._setUpControl()}"isDisabled"in l&&this._updateDisabled(l),function Jp(u,a){if(!u.hasOwnProperty("model"))return!1;const l=u.model;return!!l.isFirstChange()||!Object.is(a,l.currentValue)}(l,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(l){this.viewModel=l,this.update.emit(l)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){zl(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(l){_D.then(()=>{var f;this.control.setValue(l,{emitViewToModelChange:!1}),null===(f=this._changeDetectorRef)||void 0===f||f.markForCheck()})}_updateDisabled(l){const f=l.isDisabled.currentValue,g=""===f||f&&"false"!==f;_D.then(()=>{var p;g&&!this.control.disabled?this.control.disable():!g&&this.control.disabled&&this.control.enable(),null===(p=this._changeDetectorRef)||void 0===p||p.markForCheck()})}_getPath(l){return this._parent?function yh(u,a){return[...a.path,u]}(l,this._parent):[l]}}return u.\u0275fac=function(l){return new(l||u)(ve(Hn,9),ve(Nn,10),ve(ys,10),ve(_r,10),ve(Ku,8))},u.\u0275dir=He({type:u,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ht([a2]),St,yi]}),u})(),yD=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275mod=nr({type:u}),u.\u0275inj=Pi({}),u})(),L2=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275mod=nr({type:u}),u.\u0275inj=Pi({imports:[[yD]]}),u})(),F2=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275mod=nr({type:u}),u.\u0275inj=Pi({imports:[L2]}),u})();function it(...u){return wn(u,qa(u))}class Xi extends Sr{constructor(a){super(),this._value=a}get value(){return this.getValue()}_subscribe(a){const l=super._subscribe(a);return!l.closed&&a.next(this._value),l}getValue(){const{hasError:a,thrownError:l,_value:f}=this;if(a)throw l;return this._throwIfClosed(),f}next(a){super.next(this._value=a)}}function kD(u,a,l){u?Tr(l,u,a):a()}function Sh(u,a){const l=Pt(u)?u:()=>u,f=g=>g.error(l());return new sn(a?g=>a.schedule(f,0,g):f)}const Th=Ya(u=>function(){u(this),this.name="EmptyError",this.message="no elements in sequence"});function mm(...u){return function k2(){return Xa(1)}()(wn(u,qa(u)))}function BD(u){return new sn(a=>{er(u()).subscribe(a)})}function VD(){return Dn((u,a)=>{let l=null;u._refCount++;const f=Cn(a,void 0,void 0,void 0,()=>{if(!u||u._refCount<=0||0<--u._refCount)return void(l=null);const g=u._connection,p=l;l=null,g&&(!p||g===p)&&g.unsubscribe(),a.unsubscribe()});u.subscribe(f),f.closed||(l=u.connect())})}class B2 extends sn{constructor(a,l){super(),this.source=a,this.subjectFactory=l,this._subject=null,this._refCount=0,this._connection=null,q_(a)&&(this.lift=a.lift)}_subscribe(a){return this.getSubject().subscribe(a)}getSubject(){const a=this._subject;return(!a||a.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:a}=this;this._subject=this._connection=null,null==a||a.unsubscribe()}connect(){let a=this._connection;if(!a){a=this._connection=new mi;const l=this.getSubject();a.add(this.source.subscribe(Cn(l,void 0,()=>{this._teardown(),l.complete()},f=>{this._teardown(),l.error(f)},()=>this._teardown()))),a.closed&&(this._connection=null,a=mi.EMPTY)}return a}refCount(){return VD()(this)}}function Js(u,a){return Dn((l,f)=>{let g=null,p=0,_=!1;const y=()=>_&&!g&&f.complete();l.subscribe(Cn(f,b=>{null==g||g.unsubscribe();let O=0;const M=p++;er(u(b,M)).subscribe(g=Cn(f,P=>f.next(a?a(b,P,M,O++):P),()=>{g=null,y()}))},()=>{_=!0,y()}))})}function j2(u,a,l,f,g){return(p,_)=>{let y=l,b=a,O=0;p.subscribe(Cn(_,M=>{const P=O++;b=y?u(b,M,P):(y=!0,M),f&&_.next(b)},g&&(()=>{y&&_.next(b),_.complete()})))}}function jD(u,a){return Dn(j2(u,a,arguments.length>=2,!0))}function da(u,a){return Dn((l,f)=>{let g=0;l.subscribe(Cn(f,p=>u.call(a,p,g++)&&f.next(p)))})}function Es(u){return Dn((a,l)=>{let p,f=null,g=!1;f=a.subscribe(Cn(l,void 0,void 0,_=>{p=er(u(_,Es(u)(a))),f?(f.unsubscribe(),f=null,p.subscribe(l)):g=!0})),g&&(f.unsubscribe(),f=null,p.subscribe(l))})}function ql(u,a){return Pt(a)?En(u,a,1):En(u,1)}function _m(u){return u<=0?()=>Ir:Dn((a,l)=>{let f=[];a.subscribe(Cn(l,g=>{f.push(g),u<f.length&&f.shift()},()=>{for(const g of f)l.next(g);l.complete()},void 0,()=>{f=null}))})}function UD(u=U2){return Dn((a,l)=>{let f=!1;a.subscribe(Cn(l,g=>{f=!0,l.next(g)},()=>f?l.complete():l.error(u())))})}function U2(){return new Th}function GD(u){return Dn((a,l)=>{let f=!1;a.subscribe(Cn(l,g=>{f=!0,l.next(g)},()=>{f||l.next(u),l.complete()}))})}function fa(u,a){const l=arguments.length>=2;return f=>f.pipe(u?da((g,p)=>u(g,p,f)):Bs,qc(1),l?GD(a):UD(()=>new Th))}function ai(u,a,l){const f=Pt(u)||a||l?{next:u,error:a,complete:l}:u;return f?Dn((g,p)=>{var _;null===(_=f.subscribe)||void 0===_||_.call(f);let y=!0;g.subscribe(Cn(p,b=>{var O;null===(O=f.next)||void 0===O||O.call(f,b),p.next(b)},()=>{var b;y=!1,null===(b=f.complete)||void 0===b||b.call(f),p.complete()},b=>{var O;y=!1,null===(O=f.error)||void 0===O||O.call(f,b),p.error(b)},()=>{var b,O;y&&(null===(b=f.unsubscribe)||void 0===b||b.call(f)),null===(O=f.finalize)||void 0===O||O.call(f)}))}):Bs}class Vr{constructor(a,l){this.id=a,this.url=l}}class vm extends Vr{constructor(a,l,f="imperative",g=null){super(a,l),this.navigationTrigger=f,this.restoredState=g}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Zl extends Vr{constructor(a,l,f){super(a,l),this.urlAfterRedirects=f}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class HD extends Vr{constructor(a,l,f){super(a,l),this.reason=f}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class W2 extends Vr{constructor(a,l,f){super(a,l),this.error=f}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class z2 extends Vr{constructor(a,l,f,g){super(a,l),this.urlAfterRedirects=f,this.state=g}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Y2 extends Vr{constructor(a,l,f,g){super(a,l),this.urlAfterRedirects=f,this.state=g}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $2 extends Vr{constructor(a,l,f,g,p){super(a,l),this.urlAfterRedirects=f,this.state=g,this.shouldActivate=p}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class X2 extends Vr{constructor(a,l,f,g){super(a,l),this.urlAfterRedirects=f,this.state=g}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class q2 extends Vr{constructor(a,l,f,g){super(a,l),this.urlAfterRedirects=f,this.state=g}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class WD{constructor(a){this.route=a}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class zD{constructor(a){this.route=a}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Z2{constructor(a){this.snapshot=a}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class K2{constructor(a){this.snapshot=a}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Q2{constructor(a){this.snapshot=a}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class J2{constructor(a){this.snapshot=a}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class YD{constructor(a,l,f){this.routerEvent=a,this.position=l,this.anchor=f}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const ut="primary";class eB{constructor(a){this.params=a||{}}has(a){return Object.prototype.hasOwnProperty.call(this.params,a)}get(a){if(this.has(a)){const l=this.params[a];return Array.isArray(l)?l[0]:l}return null}getAll(a){if(this.has(a)){const l=this.params[a];return Array.isArray(l)?l:[l]}return[]}get keys(){return Object.keys(this.params)}}function ga(u){return new eB(u)}const $D="ngNavigationCancelingError";function ym(u){const a=Error("NavigationCancelingError: "+u);return a[$D]=!0,a}function nB(u,a,l){const f=l.path.split("/");if(f.length>u.length||"full"===l.pathMatch&&(a.hasChildren()||f.length<u.length))return null;const g={};for(let p=0;p<f.length;p++){const _=f[p],y=u[p];if(_.startsWith(":"))g[_.substring(1)]=y;else if(_!==y.path)return null}return{consumed:u.slice(0,f.length),posParams:g}}function vr(u,a){const l=u?Object.keys(u):void 0,f=a?Object.keys(a):void 0;if(!l||!f||l.length!=f.length)return!1;let g;for(let p=0;p<l.length;p++)if(g=l[p],!XD(u[g],a[g]))return!1;return!0}function XD(u,a){if(Array.isArray(u)&&Array.isArray(a)){if(u.length!==a.length)return!1;const l=[...u].sort(),f=[...a].sort();return l.every((g,p)=>f[p]===g)}return u===a}function qD(u){return Array.prototype.concat.apply([],u)}function ZD(u){return u.length>0?u[u.length-1]:null}function xn(u,a){for(const l in u)u.hasOwnProperty(l)&&a(u[l],l)}function yr(u){return Fg(u)?u:Tl(u)?wn(Promise.resolve(u)):it(u)}const sB={exact:function JD(u,a,l){if(!to(u.segments,a.segments)||!Ih(u.segments,a.segments,l)||u.numberOfChildren!==a.numberOfChildren)return!1;for(const f in a.children)if(!u.children[f]||!JD(u.children[f],a.children[f],l))return!1;return!0},subset:eS},KD={exact:function oB(u,a){return vr(u,a)},subset:function aB(u,a){return Object.keys(a).length<=Object.keys(u).length&&Object.keys(a).every(l=>XD(u[l],a[l]))},ignored:()=>!0};function QD(u,a,l){return sB[l.paths](u.root,a.root,l.matrixParams)&&KD[l.queryParams](u.queryParams,a.queryParams)&&!("exact"===l.fragment&&u.fragment!==a.fragment)}function eS(u,a,l){return tS(u,a,a.segments,l)}function tS(u,a,l,f){if(u.segments.length>l.length){const g=u.segments.slice(0,l.length);return!(!to(g,l)||a.hasChildren()||!Ih(g,l,f))}if(u.segments.length===l.length){if(!to(u.segments,l)||!Ih(u.segments,l,f))return!1;for(const g in a.children)if(!u.children[g]||!eS(u.children[g],a.children[g],f))return!1;return!0}{const g=l.slice(0,u.segments.length),p=l.slice(u.segments.length);return!!(to(u.segments,g)&&Ih(u.segments,g,f)&&u.children[ut])&&tS(u.children[ut],a,p,f)}}function Ih(u,a,l){return a.every((f,g)=>KD[l](u[g].parameters,f.parameters))}class eo{constructor(a,l,f){this.root=a,this.queryParams=l,this.fragment=f}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ga(this.queryParams)),this._queryParamMap}toString(){return uB.serialize(this)}}class _t{constructor(a,l){this.segments=a,this.children=l,this.parent=null,xn(l,(f,g)=>f.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return xh(this)}}class Kl{constructor(a,l){this.path=a,this.parameters=l}get parameterMap(){return this._parameterMap||(this._parameterMap=ga(this.parameters)),this._parameterMap}toString(){return oS(this)}}function to(u,a){return u.length===a.length&&u.every((l,f)=>l.path===a[f].path)}class nS{}class iS{parse(a){const l=new yB(a);return new eo(l.parseRootSegment(),l.parseQueryParams(),l.parseFragment())}serialize(a){const l=`/${Ql(a.root,!0)}`,f=function fB(u){const a=Object.keys(u).map(l=>{const f=u[l];return Array.isArray(f)?f.map(g=>`${Ah(l)}=${Ah(g)}`).join("&"):`${Ah(l)}=${Ah(f)}`}).filter(l=>!!l);return a.length?`?${a.join("&")}`:""}(a.queryParams);return`${l}${f}${"string"==typeof a.fragment?`#${function hB(u){return encodeURI(u)}(a.fragment)}`:""}`}}const uB=new iS;function xh(u){return u.segments.map(a=>oS(a)).join("/")}function Ql(u,a){if(!u.hasChildren())return xh(u);if(a){const l=u.children[ut]?Ql(u.children[ut],!1):"",f=[];return xn(u.children,(g,p)=>{p!==ut&&f.push(`${p}:${Ql(g,!1)}`)}),f.length>0?`${l}(${f.join("//")})`:l}{const l=function cB(u,a){let l=[];return xn(u.children,(f,g)=>{g===ut&&(l=l.concat(a(f,g)))}),xn(u.children,(f,g)=>{g!==ut&&(l=l.concat(a(f,g)))}),l}(u,(f,g)=>g===ut?[Ql(u.children[ut],!1)]:[`${g}:${Ql(f,!1)}`]);return 1===Object.keys(u.children).length&&null!=u.children[ut]?`${xh(u)}/${l[0]}`:`${xh(u)}/(${l.join("//")})`}}function rS(u){return encodeURIComponent(u).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ah(u){return rS(u).replace(/%3B/gi,";")}function Cm(u){return rS(u).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Rh(u){return decodeURIComponent(u)}function sS(u){return Rh(u.replace(/\+/g,"%20"))}function oS(u){return`${Cm(u.path)}${function dB(u){return Object.keys(u).map(a=>`;${Cm(a)}=${Cm(u[a])}`).join("")}(u.parameters)}`}const gB=/^[^\/()?;=#]+/;function Oh(u){const a=u.match(gB);return a?a[0]:""}const pB=/^[^=?&#]+/,_B=/^[^&#]+/;class yB{constructor(a){this.url=a,this.remaining=a}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new _t([],{}):new _t([],this.parseChildren())}parseQueryParams(){const a={};if(this.consumeOptional("?"))do{this.parseQueryParam(a)}while(this.consumeOptional("&"));return a}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const a=[];for(this.peekStartsWith("(")||a.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),a.push(this.parseSegment());let l={};this.peekStartsWith("/(")&&(this.capture("/"),l=this.parseParens(!0));let f={};return this.peekStartsWith("(")&&(f=this.parseParens(!1)),(a.length>0||Object.keys(l).length>0)&&(f[ut]=new _t(a,l)),f}parseSegment(){const a=Oh(this.remaining);if(""===a&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(a),new Kl(Rh(a),this.parseMatrixParams())}parseMatrixParams(){const a={};for(;this.consumeOptional(";");)this.parseParam(a);return a}parseParam(a){const l=Oh(this.remaining);if(!l)return;this.capture(l);let f="";if(this.consumeOptional("=")){const g=Oh(this.remaining);g&&(f=g,this.capture(f))}a[Rh(l)]=Rh(f)}parseQueryParam(a){const l=function mB(u){const a=u.match(pB);return a?a[0]:""}(this.remaining);if(!l)return;this.capture(l);let f="";if(this.consumeOptional("=")){const _=function vB(u){const a=u.match(_B);return a?a[0]:""}(this.remaining);_&&(f=_,this.capture(f))}const g=sS(l),p=sS(f);if(a.hasOwnProperty(g)){let _=a[g];Array.isArray(_)||(_=[_],a[g]=_),_.push(p)}else a[g]=p}parseParens(a){const l={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const f=Oh(this.remaining),g=this.remaining[f.length];if("/"!==g&&")"!==g&&";"!==g)throw new Error(`Cannot parse url '${this.url}'`);let p;f.indexOf(":")>-1?(p=f.substr(0,f.indexOf(":")),this.capture(p),this.capture(":")):a&&(p=ut);const _=this.parseChildren();l[p]=1===Object.keys(_).length?_[ut]:new _t([],_),this.consumeOptional("//")}return l}peekStartsWith(a){return this.remaining.startsWith(a)}consumeOptional(a){return!!this.peekStartsWith(a)&&(this.remaining=this.remaining.substring(a.length),!0)}capture(a){if(!this.consumeOptional(a))throw new Error(`Expected "${a}".`)}}class aS{constructor(a){this._root=a}get root(){return this._root.value}parent(a){const l=this.pathFromRoot(a);return l.length>1?l[l.length-2]:null}children(a){const l=Em(a,this._root);return l?l.children.map(f=>f.value):[]}firstChild(a){const l=Em(a,this._root);return l&&l.children.length>0?l.children[0].value:null}siblings(a){const l=wm(a,this._root);return l.length<2?[]:l[l.length-2].children.map(g=>g.value).filter(g=>g!==a)}pathFromRoot(a){return wm(a,this._root).map(l=>l.value)}}function Em(u,a){if(u===a.value)return a;for(const l of a.children){const f=Em(u,l);if(f)return f}return null}function wm(u,a){if(u===a.value)return[a];for(const l of a.children){const f=wm(u,l);if(f.length)return f.unshift(a),f}return[]}class jr{constructor(a,l){this.value=a,this.children=l}toString(){return`TreeNode(${this.value})`}}function pa(u){const a={};return u&&u.children.forEach(l=>a[l.value.outlet]=l),a}class lS extends aS{constructor(a,l){super(a),this.snapshot=l,bm(this,a)}toString(){return this.snapshot.toString()}}function cS(u,a){const l=function CB(u,a){const _=new Mh([],{},{},"",{},ut,a,null,u.root,-1,{});return new hS("",new jr(_,[]))}(u,a),f=new Xi([new Kl("",{})]),g=new Xi({}),p=new Xi({}),_=new Xi({}),y=new Xi(""),b=new ma(f,g,_,y,p,ut,a,l.root);return b.snapshot=l.root,new lS(new jr(b,[]),l)}class ma{constructor(a,l,f,g,p,_,y,b){this.url=a,this.params=l,this.queryParams=f,this.fragment=g,this.data=p,this.outlet=_,this.component=y,this._futureSnapshot=b}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Nt(a=>ga(a)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Nt(a=>ga(a)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function uS(u,a="emptyOnly"){const l=u.pathFromRoot;let f=0;if("always"!==a)for(f=l.length-1;f>=1;){const g=l[f],p=l[f-1];if(g.routeConfig&&""===g.routeConfig.path)f--;else{if(p.component)break;f--}}return function EB(u){return u.reduce((a,l)=>({params:Object.assign(Object.assign({},a.params),l.params),data:Object.assign(Object.assign({},a.data),l.data),resolve:Object.assign(Object.assign({},a.resolve),l._resolvedData)}),{params:{},data:{},resolve:{}})}(l.slice(f))}class Mh{constructor(a,l,f,g,p,_,y,b,O,M,P){this.url=a,this.params=l,this.queryParams=f,this.fragment=g,this.data=p,this.outlet=_,this.component=y,this.routeConfig=b,this._urlSegment=O,this._lastPathIndex=M,this._resolve=P}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ga(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ga(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(f=>f.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class hS extends aS{constructor(a,l){super(l),this.url=a,bm(this,l)}toString(){return dS(this._root)}}function bm(u,a){a.value._routerState=u,a.children.forEach(l=>bm(u,l))}function dS(u){const a=u.children.length>0?` { ${u.children.map(dS).join(", ")} } `:"";return`${u.value}${a}`}function Dm(u){if(u.snapshot){const a=u.snapshot,l=u._futureSnapshot;u.snapshot=l,vr(a.queryParams,l.queryParams)||u.queryParams.next(l.queryParams),a.fragment!==l.fragment&&u.fragment.next(l.fragment),vr(a.params,l.params)||u.params.next(l.params),function iB(u,a){if(u.length!==a.length)return!1;for(let l=0;l<u.length;++l)if(!vr(u[l],a[l]))return!1;return!0}(a.url,l.url)||u.url.next(l.url),vr(a.data,l.data)||u.data.next(l.data)}else u.snapshot=u._futureSnapshot,u.data.next(u._futureSnapshot.data)}function Sm(u,a){const l=vr(u.params,a.params)&&function lB(u,a){return to(u,a)&&u.every((l,f)=>vr(l.parameters,a[f].parameters))}(u.url,a.url);return l&&!(!u.parent!=!a.parent)&&(!u.parent||Sm(u.parent,a.parent))}function Jl(u,a,l){if(l&&u.shouldReuseRoute(a.value,l.value.snapshot)){const f=l.value;f._futureSnapshot=a.value;const g=function bB(u,a,l){return a.children.map(f=>{for(const g of l.children)if(u.shouldReuseRoute(f.value,g.value.snapshot))return Jl(u,f,g);return Jl(u,f)})}(u,a,l);return new jr(f,g)}{if(u.shouldAttach(a.value)){const p=u.retrieve(a.value);if(null!==p){const _=p.route;return _.value._futureSnapshot=a.value,_.children=a.children.map(y=>Jl(u,y)),_}}const f=function DB(u){return new ma(new Xi(u.url),new Xi(u.params),new Xi(u.queryParams),new Xi(u.fragment),new Xi(u.data),u.outlet,u.component,u)}(a.value),g=a.children.map(p=>Jl(u,p));return new jr(f,g)}}function Lh(u){return"object"==typeof u&&null!=u&&!u.outlets&&!u.segmentPath}function ec(u){return"object"==typeof u&&null!=u&&u.outlets}function Tm(u,a,l,f,g){let p={};if(f&&xn(f,(y,b)=>{p[b]=Array.isArray(y)?y.map(O=>`${O}`):`${y}`}),u===a)return new eo(l,p,g);const _=fS(u,a,l);return new eo(_,p,g)}function fS(u,a,l){const f={};return xn(u.children,(g,p)=>{f[p]=g===a?l:fS(g,a,l)}),new _t(u.segments,f)}class gS{constructor(a,l,f){if(this.isAbsolute=a,this.numberOfDoubleDots=l,this.commands=f,a&&f.length>0&&Lh(f[0]))throw new Error("Root segment cannot have matrix parameters");const g=f.find(ec);if(g&&g!==ZD(f))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Im{constructor(a,l,f){this.segmentGroup=a,this.processChildren=l,this.index=f}}function pS(u,a,l){if(u||(u=new _t([],{})),0===u.segments.length&&u.hasChildren())return Fh(u,a,l);const f=function RB(u,a,l){let f=0,g=a;const p={match:!1,pathIndex:0,commandIndex:0};for(;g<u.segments.length;){if(f>=l.length)return p;const _=u.segments[g],y=l[f];if(ec(y))break;const b=`${y}`,O=f<l.length-1?l[f+1]:null;if(g>0&&void 0===b)break;if(b&&O&&"object"==typeof O&&void 0===O.outlets){if(!_S(b,O,_))return p;f+=2}else{if(!_S(b,{},_))return p;f++}g++}return{match:!0,pathIndex:g,commandIndex:f}}(u,a,l),g=l.slice(f.commandIndex);if(f.match&&f.pathIndex<u.segments.length){const p=new _t(u.segments.slice(0,f.pathIndex),{});return p.children[ut]=new _t(u.segments.slice(f.pathIndex),u.children),Fh(p,0,g)}return f.match&&0===g.length?new _t(u.segments,{}):f.match&&!u.hasChildren()?xm(u,a,l):f.match?Fh(u,0,g):xm(u,a,l)}function Fh(u,a,l){if(0===l.length)return new _t(u.segments,{});{const f=function AB(u){return ec(u[0])?u[0].outlets:{[ut]:u}}(l),g={};return xn(f,(p,_)=>{"string"==typeof p&&(p=[p]),null!==p&&(g[_]=pS(u.children[_],a,p))}),xn(u.children,(p,_)=>{void 0===f[_]&&(g[_]=p)}),new _t(u.segments,g)}}function xm(u,a,l){const f=u.segments.slice(0,a);let g=0;for(;g<l.length;){const p=l[g];if(ec(p)){const b=OB(p.outlets);return new _t(f,b)}if(0===g&&Lh(l[0])){f.push(new Kl(u.segments[a].path,mS(l[0]))),g++;continue}const _=ec(p)?p.outlets[ut]:`${p}`,y=g<l.length-1?l[g+1]:null;_&&y&&Lh(y)?(f.push(new Kl(_,mS(y))),g+=2):(f.push(new Kl(_,{})),g++)}return new _t(f,{})}function OB(u){const a={};return xn(u,(l,f)=>{"string"==typeof l&&(l=[l]),null!==l&&(a[f]=xm(new _t([],{}),0,l))}),a}function mS(u){const a={};return xn(u,(l,f)=>a[f]=`${l}`),a}function _S(u,a,l){return u==l.path&&vr(a,l.parameters)}class LB{constructor(a,l,f,g){this.routeReuseStrategy=a,this.futureState=l,this.currState=f,this.forwardEvent=g}activate(a){const l=this.futureState._root,f=this.currState?this.currState._root:null;this.deactivateChildRoutes(l,f,a),Dm(this.futureState.root),this.activateChildRoutes(l,f,a)}deactivateChildRoutes(a,l,f){const g=pa(l);a.children.forEach(p=>{const _=p.value.outlet;this.deactivateRoutes(p,g[_],f),delete g[_]}),xn(g,(p,_)=>{this.deactivateRouteAndItsChildren(p,f)})}deactivateRoutes(a,l,f){const g=a.value,p=l?l.value:null;if(g===p)if(g.component){const _=f.getContext(g.outlet);_&&this.deactivateChildRoutes(a,l,_.children)}else this.deactivateChildRoutes(a,l,f);else p&&this.deactivateRouteAndItsChildren(l,f)}deactivateRouteAndItsChildren(a,l){a.value.component&&this.routeReuseStrategy.shouldDetach(a.value.snapshot)?this.detachAndStoreRouteSubtree(a,l):this.deactivateRouteAndOutlet(a,l)}detachAndStoreRouteSubtree(a,l){const f=l.getContext(a.value.outlet),g=f&&a.value.component?f.children:l,p=pa(a);for(const _ of Object.keys(p))this.deactivateRouteAndItsChildren(p[_],g);if(f&&f.outlet){const _=f.outlet.detach(),y=f.children.onOutletDeactivated();this.routeReuseStrategy.store(a.value.snapshot,{componentRef:_,route:a,contexts:y})}}deactivateRouteAndOutlet(a,l){const f=l.getContext(a.value.outlet),g=f&&a.value.component?f.children:l,p=pa(a);for(const _ of Object.keys(p))this.deactivateRouteAndItsChildren(p[_],g);f&&f.outlet&&(f.outlet.deactivate(),f.children.onOutletDeactivated(),f.attachRef=null,f.resolver=null,f.route=null)}activateChildRoutes(a,l,f){const g=pa(l);a.children.forEach(p=>{this.activateRoutes(p,g[p.value.outlet],f),this.forwardEvent(new J2(p.value.snapshot))}),a.children.length&&this.forwardEvent(new K2(a.value.snapshot))}activateRoutes(a,l,f){const g=a.value,p=l?l.value:null;if(Dm(g),g===p)if(g.component){const _=f.getOrCreateContext(g.outlet);this.activateChildRoutes(a,l,_.children)}else this.activateChildRoutes(a,l,f);else if(g.component){const _=f.getOrCreateContext(g.outlet);if(this.routeReuseStrategy.shouldAttach(g.snapshot)){const y=this.routeReuseStrategy.retrieve(g.snapshot);this.routeReuseStrategy.store(g.snapshot,null),_.children.onOutletReAttached(y.contexts),_.attachRef=y.componentRef,_.route=y.route.value,_.outlet&&_.outlet.attach(y.componentRef,y.route.value),Dm(y.route.value),this.activateChildRoutes(a,null,_.children)}else{const y=function FB(u){for(let a=u.parent;a;a=a.parent){const l=a.routeConfig;if(l&&l._loadedConfig)return l._loadedConfig;if(l&&l.component)return null}return null}(g.snapshot),b=y?y.module.componentFactoryResolver:null;_.attachRef=null,_.route=g,_.resolver=b,_.outlet&&_.outlet.activateWith(g,b),this.activateChildRoutes(a,null,_.children)}}else this.activateChildRoutes(a,null,f)}}class Am{constructor(a,l){this.routes=a,this.module=l}}function ws(u){return"function"==typeof u}function no(u){return u instanceof eo}const tc=Symbol("INITIAL_VALUE");function nc(){return Js(u=>function P2(...u){const a=qa(u),l=cv(u),{args:f,keys:g}=xb(u);if(0===f.length)return wn([],a);const p=new sn(function N2(u,a,l=Bs){return f=>{kD(a,()=>{const{length:g}=u,p=new Array(g);let _=g,y=g;for(let b=0;b<g;b++)kD(a,()=>{const O=wn(u[b],a);let M=!1;O.subscribe(Cn(f,P=>{p[b]=P,M||(M=!0,y--),y||f.next(l(p.slice()))},()=>{--_||f.complete()}))},f)},f)}}(f,a,g?_=>Rb(g,_):Bs));return l?p.pipe(Ab(l)):p}(u.map(a=>a.pipe(qc(1),function V2(...u){const a=qa(u);return Dn((l,f)=>{(a?mm(u,l,a):mm(u,l)).subscribe(f)})}(tc)))).pipe(jD((a,l)=>{let f=!1;return l.reduce((g,p,_)=>g!==tc?g:(p===tc&&(f=!0),f||!1!==p&&_!==l.length-1&&!no(p)?g:p),a)},tc),da(a=>a!==tc),Nt(a=>no(a)?a:!0===a),qc(1)))}class jB{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new ic,this.attachRef=null}}class ic{constructor(){this.contexts=new Map}onChildOutletCreated(a,l){const f=this.getOrCreateContext(a);f.outlet=l,this.contexts.set(a,f)}onChildOutletDestroyed(a){const l=this.getContext(a);l&&(l.outlet=null,l.attachRef=null)}onOutletDeactivated(){const a=this.contexts;return this.contexts=new Map,a}onOutletReAttached(a){this.contexts=a}getOrCreateContext(a){let l=this.getContext(a);return l||(l=new jB,this.contexts.set(a,l)),l}getContext(a){return this.contexts.get(a)||null}}let Rm=(()=>{class u{constructor(l,f,g,p,_){this.parentContexts=l,this.location=f,this.resolver=g,this.changeDetector=_,this.activated=null,this._activatedRoute=null,this.activateEvents=new Zt,this.deactivateEvents=new Zt,this.attachEvents=new Zt,this.detachEvents=new Zt,this.name=p||ut,l.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const l=this.parentContexts.getContext(this.name);l&&l.route&&(l.attachRef?this.attach(l.attachRef,l.route):this.activateWith(l.route,l.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const l=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(l.instance),l}attach(l,f){this.activated=l,this._activatedRoute=f,this.location.insert(l.hostView),this.attachEvents.emit(l.instance)}deactivate(){if(this.activated){const l=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(l)}}activateWith(l,f){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=l;const _=(f=f||this.resolver).resolveComponentFactory(l._futureSnapshot.routeConfig.component),y=this.parentContexts.getOrCreateContext(this.name).children,b=new UB(l,y,this.location.injector);this.activated=this.location.createComponent(_,this.location.length,b),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return u.\u0275fac=function(l){return new(l||u)(ve(ic),ve(zi),ve(Ll),function sl(u){return function Jx(u,a){if("class"===a)return u.classes;if("style"===a)return u.styles;const l=u.attrs;if(l){const f=l.length;let g=0;for(;g<f;){const p=l[g];if(Gv(p))break;if(0===p)g+=2;else if("number"==typeof p)for(g++;g<f&&"string"==typeof l[g];)g++;else{if(p===a)return l[g+1];g+=2}}}return null}(pn(),u)}("name"),ve(Ku))},u.\u0275dir=He({type:u,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),u})();class UB{constructor(a,l,f){this.route=a,this.childContexts=l,this.parent=f}get(a,l){return a===ma?this.route:a===ic?this.childContexts:this.parent.get(a,l)}}let vS=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275cmp=os({type:u,selectors:[["ng-component"]],decls:1,vars:0,template:function(l,f){1&l&&ps(0,"router-outlet")},directives:[Rm],encapsulation:2}),u})();function yS(u,a=""){for(let l=0;l<u.length;l++){const f=u[l];GB(f,HB(a,f))}}function GB(u,a){u.children&&yS(u.children,a)}function HB(u,a){return a?u||a.path?u&&!a.path?`${u}/`:!u&&a.path?a.path:`${u}/${a.path}`:"":u}function Om(u){const a=u.children&&u.children.map(Om),l=a?Object.assign(Object.assign({},u),{children:a}):Object.assign({},u);return!l.component&&(a||l.loadChildren)&&l.outlet&&l.outlet!==ut&&(l.component=vS),l}function Ii(u){return u.outlet||ut}function CS(u,a){const l=u.filter(f=>Ii(f)===a);return l.push(...u.filter(f=>Ii(f)!==a)),l}const ES={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ph(u,a,l){var f;if(""===a.path)return"full"===a.pathMatch&&(u.hasChildren()||l.length>0)?Object.assign({},ES):{matched:!0,consumedSegments:[],remainingSegments:l,parameters:{},positionalParamSegments:{}};const p=(a.matcher||nB)(l,u,a);if(!p)return Object.assign({},ES);const _={};xn(p.posParams,(b,O)=>{_[O]=b.path});const y=p.consumed.length>0?Object.assign(Object.assign({},_),p.consumed[p.consumed.length-1].parameters):_;return{matched:!0,consumedSegments:p.consumed,remainingSegments:l.slice(p.consumed.length),parameters:y,positionalParamSegments:null!==(f=p.posParams)&&void 0!==f?f:{}}}function Nh(u,a,l,f,g="corrected"){if(l.length>0&&function YB(u,a,l){return l.some(f=>kh(u,a,f)&&Ii(f)!==ut)}(u,l,f)){const _=new _t(a,function zB(u,a,l,f){const g={};g[ut]=f,f._sourceSegment=u,f._segmentIndexShift=a.length;for(const p of l)if(""===p.path&&Ii(p)!==ut){const _=new _t([],{});_._sourceSegment=u,_._segmentIndexShift=a.length,g[Ii(p)]=_}return g}(u,a,f,new _t(l,u.children)));return _._sourceSegment=u,_._segmentIndexShift=a.length,{segmentGroup:_,slicedSegments:[]}}if(0===l.length&&function $B(u,a,l){return l.some(f=>kh(u,a,f))}(u,l,f)){const _=new _t(u.segments,function WB(u,a,l,f,g,p){const _={};for(const y of f)if(kh(u,l,y)&&!g[Ii(y)]){const b=new _t([],{});b._sourceSegment=u,b._segmentIndexShift="legacy"===p?u.segments.length:a.length,_[Ii(y)]=b}return Object.assign(Object.assign({},g),_)}(u,a,l,f,u.children,g));return _._sourceSegment=u,_._segmentIndexShift=a.length,{segmentGroup:_,slicedSegments:l}}const p=new _t(u.segments,u.children);return p._sourceSegment=u,p._segmentIndexShift=a.length,{segmentGroup:p,slicedSegments:l}}function kh(u,a,l){return(!(u.hasChildren()||a.length>0)||"full"!==l.pathMatch)&&""===l.path}function wS(u,a,l,f){return!!(Ii(u)===f||f!==ut&&kh(a,l,u))&&("**"===u.path||Ph(a,u,l).matched)}function bS(u,a,l){return 0===a.length&&!u.children[l]}class Bh{constructor(a){this.segmentGroup=a||null}}class DS{constructor(a){this.urlTree=a}}function rc(u){return Sh(new Bh(u))}function SS(u){return Sh(new DS(u))}class KB{constructor(a,l,f,g,p){this.configLoader=l,this.urlSerializer=f,this.urlTree=g,this.config=p,this.allowRedirects=!0,this.ngModule=a.get(Pr)}apply(){const a=Nh(this.urlTree.root,[],[],this.config).segmentGroup,l=new _t(a.segments,a.children);return this.expandSegmentGroup(this.ngModule,this.config,l,ut).pipe(Nt(p=>this.createUrlTree(Mm(p),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Es(p=>{if(p instanceof DS)return this.allowRedirects=!1,this.match(p.urlTree);throw p instanceof Bh?this.noMatchError(p):p}))}match(a){return this.expandSegmentGroup(this.ngModule,this.config,a.root,ut).pipe(Nt(g=>this.createUrlTree(Mm(g),a.queryParams,a.fragment))).pipe(Es(g=>{throw g instanceof Bh?this.noMatchError(g):g}))}noMatchError(a){return new Error(`Cannot match any routes. URL Segment: '${a.segmentGroup}'`)}createUrlTree(a,l,f){const g=a.segments.length>0?new _t([],{[ut]:a}):a;return new eo(g,l,f)}expandSegmentGroup(a,l,f,g){return 0===f.segments.length&&f.hasChildren()?this.expandChildren(a,l,f).pipe(Nt(p=>new _t([],p))):this.expandSegment(a,f,l,f.segments,g,!0)}expandChildren(a,l,f){const g=[];for(const p of Object.keys(f.children))"primary"===p?g.unshift(p):g.push(p);return wn(g).pipe(ql(p=>{const _=f.children[p],y=CS(l,p);return this.expandSegmentGroup(a,y,_,p).pipe(Nt(b=>({segment:b,outlet:p})))}),jD((p,_)=>(p[_.outlet]=_.segment,p),{}),function G2(u,a){const l=arguments.length>=2;return f=>f.pipe(u?da((g,p)=>u(g,p,f)):Bs,_m(1),l?GD(a):UD(()=>new Th))}())}expandSegment(a,l,f,g,p,_){return wn(f).pipe(ql(y=>this.expandSegmentAgainstRoute(a,l,f,y,g,p,_).pipe(Es(O=>{if(O instanceof Bh)return it(null);throw O}))),fa(y=>!!y),Es((y,b)=>{if(y instanceof Th||"EmptyError"===y.name)return bS(l,g,p)?it(new _t([],{})):rc(l);throw y}))}expandSegmentAgainstRoute(a,l,f,g,p,_,y){return wS(g,l,p,_)?void 0===g.redirectTo?this.matchSegmentAgainstRoute(a,l,g,p,_):y&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(a,l,f,g,p,_):rc(l):rc(l)}expandSegmentAgainstRouteUsingRedirect(a,l,f,g,p,_){return"**"===g.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(a,f,g,_):this.expandRegularSegmentAgainstRouteUsingRedirect(a,l,f,g,p,_)}expandWildCardWithParamsAgainstRouteUsingRedirect(a,l,f,g){const p=this.applyRedirectCommands([],f.redirectTo,{});return f.redirectTo.startsWith("/")?SS(p):this.lineralizeSegments(f,p).pipe(En(_=>{const y=new _t(_,{});return this.expandSegment(a,y,l,_,g,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(a,l,f,g,p,_){const{matched:y,consumedSegments:b,remainingSegments:O,positionalParamSegments:M}=Ph(l,g,p);if(!y)return rc(l);const P=this.applyRedirectCommands(b,g.redirectTo,M);return g.redirectTo.startsWith("/")?SS(P):this.lineralizeSegments(g,P).pipe(En(k=>this.expandSegment(a,l,f,k.concat(O),_,!1)))}matchSegmentAgainstRoute(a,l,f,g,p){if("**"===f.path)return f.loadChildren?(f._loadedConfig?it(f._loadedConfig):this.configLoader.load(a.injector,f)).pipe(Nt(P=>(f._loadedConfig=P,new _t(g,{})))):it(new _t(g,{}));const{matched:_,consumedSegments:y,remainingSegments:b}=Ph(l,f,g);return _?this.getChildConfig(a,f,g).pipe(En(M=>{const P=M.module,k=M.routes,{segmentGroup:V,slicedSegments:H}=Nh(l,y,b,k),z=new _t(V.segments,V.children);if(0===H.length&&z.hasChildren())return this.expandChildren(P,k,z).pipe(Nt(K=>new _t(y,K)));if(0===k.length&&0===H.length)return it(new _t(y,{}));const Y=Ii(f)===p;return this.expandSegment(P,z,k,H,Y?ut:p,!0).pipe(Nt($=>new _t(y.concat($.segments),$.children)))})):rc(l)}getChildConfig(a,l,f){return l.children?it(new Am(l.children,a)):l.loadChildren?void 0!==l._loadedConfig?it(l._loadedConfig):this.runCanLoadGuards(a.injector,l,f).pipe(En(g=>g?this.configLoader.load(a.injector,l).pipe(Nt(p=>(l._loadedConfig=p,p))):function qB(u){return Sh(ym(`Cannot load children because the guard of the route "path: '${u.path}'" returned false`))}(l))):it(new Am([],a))}runCanLoadGuards(a,l,f){const g=l.canLoad;return g&&0!==g.length?it(g.map(_=>{const y=a.get(_);let b;if(function NB(u){return u&&ws(u.canLoad)}(y))b=y.canLoad(l,f);else{if(!ws(y))throw new Error("Invalid CanLoad guard");b=y(l,f)}return yr(b)})).pipe(nc(),ai(_=>{if(!no(_))return;const y=ym(`Redirecting to "${this.urlSerializer.serialize(_)}"`);throw y.url=_,y}),Nt(_=>!0===_)):it(!0)}lineralizeSegments(a,l){let f=[],g=l.root;for(;;){if(f=f.concat(g.segments),0===g.numberOfChildren)return it(f);if(g.numberOfChildren>1||!g.children[ut])return Sh(new Error(`Only absolute redirects can have named outlets. redirectTo: '${a.redirectTo}'`));g=g.children[ut]}}applyRedirectCommands(a,l,f){return this.applyRedirectCreatreUrlTree(l,this.urlSerializer.parse(l),a,f)}applyRedirectCreatreUrlTree(a,l,f,g){const p=this.createSegmentGroup(a,l.root,f,g);return new eo(p,this.createQueryParams(l.queryParams,this.urlTree.queryParams),l.fragment)}createQueryParams(a,l){const f={};return xn(a,(g,p)=>{if("string"==typeof g&&g.startsWith(":")){const y=g.substring(1);f[p]=l[y]}else f[p]=g}),f}createSegmentGroup(a,l,f,g){const p=this.createSegments(a,l.segments,f,g);let _={};return xn(l.children,(y,b)=>{_[b]=this.createSegmentGroup(a,y,f,g)}),new _t(p,_)}createSegments(a,l,f,g){return l.map(p=>p.path.startsWith(":")?this.findPosParam(a,p,g):this.findOrReturn(p,f))}findPosParam(a,l,f){const g=f[l.path.substring(1)];if(!g)throw new Error(`Cannot redirect to '${a}'. Cannot find '${l.path}'.`);return g}findOrReturn(a,l){let f=0;for(const g of l){if(g.path===a.path)return l.splice(f),g;f++}return a}}function Mm(u){const a={};for(const f of Object.keys(u.children)){const p=Mm(u.children[f]);(p.segments.length>0||p.hasChildren())&&(a[f]=p)}return function QB(u){if(1===u.numberOfChildren&&u.children[ut]){const a=u.children[ut];return new _t(u.segments.concat(a.segments),a.children)}return u}(new _t(u.segments,a))}class TS{constructor(a){this.path=a,this.route=this.path[this.path.length-1]}}class Vh{constructor(a,l){this.component=a,this.route=l}}function eV(u,a,l){const f=u._root;return sc(f,a?a._root:null,l,[f.value])}function jh(u,a,l){const f=function nV(u){if(!u)return null;for(let a=u.parent;a;a=a.parent){const l=a.routeConfig;if(l&&l._loadedConfig)return l._loadedConfig}return null}(a);return(f?f.module.injector:l).get(u)}function sc(u,a,l,f,g={canDeactivateChecks:[],canActivateChecks:[]}){const p=pa(a);return u.children.forEach(_=>{(function iV(u,a,l,f,g={canDeactivateChecks:[],canActivateChecks:[]}){const p=u.value,_=a?a.value:null,y=l?l.getContext(u.value.outlet):null;if(_&&p.routeConfig===_.routeConfig){const b=function rV(u,a,l){if("function"==typeof l)return l(u,a);switch(l){case"pathParamsChange":return!to(u.url,a.url);case"pathParamsOrQueryParamsChange":return!to(u.url,a.url)||!vr(u.queryParams,a.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Sm(u,a)||!vr(u.queryParams,a.queryParams);default:return!Sm(u,a)}}(_,p,p.routeConfig.runGuardsAndResolvers);b?g.canActivateChecks.push(new TS(f)):(p.data=_.data,p._resolvedData=_._resolvedData),sc(u,a,p.component?y?y.children:null:l,f,g),b&&y&&y.outlet&&y.outlet.isActivated&&g.canDeactivateChecks.push(new Vh(y.outlet.component,_))}else _&&oc(a,y,g),g.canActivateChecks.push(new TS(f)),sc(u,null,p.component?y?y.children:null:l,f,g)})(_,p[_.value.outlet],l,f.concat([_.value]),g),delete p[_.value.outlet]}),xn(p,(_,y)=>oc(_,l.getContext(y),g)),g}function oc(u,a,l){const f=pa(u),g=u.value;xn(f,(p,_)=>{oc(p,g.component?a?a.children.getContext(_):null:a,l)}),l.canDeactivateChecks.push(new Vh(g.component&&a&&a.outlet&&a.outlet.isActivated?a.outlet.component:null,g))}class fV{}function IS(u){return new sn(a=>a.error(u))}class pV{constructor(a,l,f,g,p,_){this.rootComponentType=a,this.config=l,this.urlTree=f,this.url=g,this.paramsInheritanceStrategy=p,this.relativeLinkResolution=_}recognize(){const a=Nh(this.urlTree.root,[],[],this.config.filter(_=>void 0===_.redirectTo),this.relativeLinkResolution).segmentGroup,l=this.processSegmentGroup(this.config,a,ut);if(null===l)return null;const f=new Mh([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},ut,this.rootComponentType,null,this.urlTree.root,-1,{}),g=new jr(f,l),p=new hS(this.url,g);return this.inheritParamsAndData(p._root),p}inheritParamsAndData(a){const l=a.value,f=uS(l,this.paramsInheritanceStrategy);l.params=Object.freeze(f.params),l.data=Object.freeze(f.data),a.children.forEach(g=>this.inheritParamsAndData(g))}processSegmentGroup(a,l,f){return 0===l.segments.length&&l.hasChildren()?this.processChildren(a,l):this.processSegment(a,l,l.segments,f)}processChildren(a,l){const f=[];for(const p of Object.keys(l.children)){const _=l.children[p],y=CS(a,p),b=this.processSegmentGroup(y,_,p);if(null===b)return null;f.push(...b)}const g=xS(f);return function mV(u){u.sort((a,l)=>a.value.outlet===ut?-1:l.value.outlet===ut?1:a.value.outlet.localeCompare(l.value.outlet))}(g),g}processSegment(a,l,f,g){for(const p of a){const _=this.processSegmentAgainstRoute(p,l,f,g);if(null!==_)return _}return bS(l,f,g)?[]:null}processSegmentAgainstRoute(a,l,f,g){if(a.redirectTo||!wS(a,l,f,g))return null;let p,_=[],y=[];if("**"===a.path){const V=f.length>0?ZD(f).parameters:{};p=new Mh(f,V,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,OS(a),Ii(a),a.component,a,AS(l),RS(l)+f.length,MS(a))}else{const V=Ph(l,a,f);if(!V.matched)return null;_=V.consumedSegments,y=V.remainingSegments,p=new Mh(_,V.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,OS(a),Ii(a),a.component,a,AS(l),RS(l)+_.length,MS(a))}const b=function _V(u){return u.children?u.children:u.loadChildren?u._loadedConfig.routes:[]}(a),{segmentGroup:O,slicedSegments:M}=Nh(l,_,y,b.filter(V=>void 0===V.redirectTo),this.relativeLinkResolution);if(0===M.length&&O.hasChildren()){const V=this.processChildren(b,O);return null===V?null:[new jr(p,V)]}if(0===b.length&&0===M.length)return[new jr(p,[])];const P=Ii(a)===g,k=this.processSegment(b,O,M,P?ut:g);return null===k?null:[new jr(p,k)]}}function vV(u){const a=u.value.routeConfig;return a&&""===a.path&&void 0===a.redirectTo}function xS(u){const a=[],l=new Set;for(const f of u){if(!vV(f)){a.push(f);continue}const g=a.find(p=>f.value.routeConfig===p.value.routeConfig);void 0!==g?(g.children.push(...f.children),l.add(g)):a.push(f)}for(const f of l){const g=xS(f.children);a.push(new jr(f.value,g))}return a.filter(f=>!l.has(f))}function AS(u){let a=u;for(;a._sourceSegment;)a=a._sourceSegment;return a}function RS(u){let a=u,l=a._segmentIndexShift?a._segmentIndexShift:0;for(;a._sourceSegment;)a=a._sourceSegment,l+=a._segmentIndexShift?a._segmentIndexShift:0;return l-1}function OS(u){return u.data||{}}function MS(u){return u.resolve||{}}function LS(u){return[...Object.keys(u),...Object.getOwnPropertySymbols(u)]}function Lm(u){return Js(a=>{const l=u(a);return l?wn(l).pipe(Nt(()=>a)):it(a)})}class TV extends class SV{shouldDetach(a){return!1}store(a,l){}shouldAttach(a){return!1}retrieve(a){return null}shouldReuseRoute(a,l){return a.routeConfig===l.routeConfig}}{}const Fm=new ct("ROUTES");class FS{constructor(a,l,f,g){this.injector=a,this.compiler=l,this.onLoadStartListener=f,this.onLoadEndListener=g}load(a,l){if(l._loader$)return l._loader$;this.onLoadStartListener&&this.onLoadStartListener(l);const g=this.loadModuleFactory(l.loadChildren).pipe(Nt(p=>{this.onLoadEndListener&&this.onLoadEndListener(l);const _=p.create(a);return new Am(qD(_.injector.get(Fm,void 0,ze.Self|ze.Optional)).map(Om),_)}),Es(p=>{throw l._loader$=void 0,p}));return l._loader$=new B2(g,()=>new Sr).pipe(VD()),l._loader$}loadModuleFactory(a){return yr(a()).pipe(En(l=>l instanceof WE?it(l):wn(this.compiler.compileModuleAsync(l))))}}class xV{shouldProcessUrl(a){return!0}extract(a){return a}merge(a,l){return a}}function AV(u){throw u}function RV(u,a,l){return a.parse("/")}function PS(u,a){return it(null)}const OV={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},MV={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let li=(()=>{class u{constructor(l,f,g,p,_,y,b){this.rootComponentType=l,this.urlSerializer=f,this.rootContexts=g,this.location=p,this.config=b,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Sr,this.errorHandler=AV,this.malformedUriErrorHandler=RV,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:PS,afterPreactivation:PS},this.urlHandlingStrategy=new xV,this.routeReuseStrategy=new TV,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=_.get(Pr),this.console=_.get(OF);const P=_.get(In);this.isNgZoneEnabled=P instanceof In&&In.isInAngularZone(),this.resetConfig(b),this.currentUrlTree=function rB(){return new eo(new _t([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new FS(_,y,k=>this.triggerEvent(new WD(k)),k=>this.triggerEvent(new zD(k))),this.routerState=cS(this.currentUrlTree,this.rootComponentType),this.transitions=new Xi({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var l;return null===(l=this.location.getState())||void 0===l?void 0:l.\u0275routerPageId}setupNavigations(l){const f=this.events;return l.pipe(da(g=>0!==g.id),Nt(g=>Object.assign(Object.assign({},g),{extractedUrl:this.urlHandlingStrategy.extract(g.rawUrl)})),Js(g=>{let p=!1,_=!1;return it(g).pipe(ai(y=>{this.currentNavigation={id:y.id,initialUrl:y.currentRawUrl,extractedUrl:y.extractedUrl,trigger:y.source,extras:y.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Js(y=>{const b=this.browserUrlTree.toString(),O=!this.navigated||y.extractedUrl.toString()!==b||b!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||O)&&this.urlHandlingStrategy.shouldProcessUrl(y.rawUrl))return NS(y.source)&&(this.browserUrlTree=y.extractedUrl),it(y).pipe(Js(P=>{const k=this.transitions.getValue();return f.next(new vm(P.id,this.serializeUrl(P.extractedUrl),P.source,P.restoredState)),k!==this.transitions.getValue()?Ir:Promise.resolve(P)}),function JB(u,a,l,f){return Js(g=>function ZB(u,a,l,f,g){return new KB(u,a,l,f,g).apply()}(u,a,l,g.extractedUrl,f).pipe(Nt(p=>Object.assign(Object.assign({},g),{urlAfterRedirects:p}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),ai(P=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:P.urlAfterRedirects})}),function yV(u,a,l,f,g){return En(p=>function gV(u,a,l,f,g="emptyOnly",p="legacy"){try{const _=new pV(u,a,l,f,g,p).recognize();return null===_?IS(new fV):it(_)}catch(_){return IS(_)}}(u,a,p.urlAfterRedirects,l(p.urlAfterRedirects),f,g).pipe(Nt(_=>Object.assign(Object.assign({},p),{targetSnapshot:_}))))}(this.rootComponentType,this.config,P=>this.serializeUrl(P),this.paramsInheritanceStrategy,this.relativeLinkResolution),ai(P=>{if("eager"===this.urlUpdateStrategy){if(!P.extras.skipLocationChange){const V=this.urlHandlingStrategy.merge(P.urlAfterRedirects,P.rawUrl);this.setBrowserUrl(V,P)}this.browserUrlTree=P.urlAfterRedirects}const k=new z2(P.id,this.serializeUrl(P.extractedUrl),this.serializeUrl(P.urlAfterRedirects),P.targetSnapshot);f.next(k)}));if(O&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:k,extractedUrl:V,source:H,restoredState:z,extras:Y}=y,X=new vm(k,this.serializeUrl(V),H,z);f.next(X);const $=cS(V,this.rootComponentType).snapshot;return it(Object.assign(Object.assign({},y),{targetSnapshot:$,urlAfterRedirects:V,extras:Object.assign(Object.assign({},Y),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=y.rawUrl,y.resolve(null),Ir}),Lm(y=>{const{targetSnapshot:b,id:O,extractedUrl:M,rawUrl:P,extras:{skipLocationChange:k,replaceUrl:V}}=y;return this.hooks.beforePreactivation(b,{navigationId:O,appliedUrlTree:M,rawUrlTree:P,skipLocationChange:!!k,replaceUrl:!!V})}),ai(y=>{const b=new Y2(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot);this.triggerEvent(b)}),Nt(y=>Object.assign(Object.assign({},y),{guards:eV(y.targetSnapshot,y.currentSnapshot,this.rootContexts)})),function sV(u,a){return En(l=>{const{targetSnapshot:f,currentSnapshot:g,guards:{canActivateChecks:p,canDeactivateChecks:_}}=l;return 0===_.length&&0===p.length?it(Object.assign(Object.assign({},l),{guardsResult:!0})):function oV(u,a,l,f){return wn(u).pipe(En(g=>function dV(u,a,l,f,g){const p=a&&a.routeConfig?a.routeConfig.canDeactivate:null;return p&&0!==p.length?it(p.map(y=>{const b=jh(y,a,g);let O;if(function VB(u){return u&&ws(u.canDeactivate)}(b))O=yr(b.canDeactivate(u,a,l,f));else{if(!ws(b))throw new Error("Invalid CanDeactivate guard");O=yr(b(u,a,l,f))}return O.pipe(fa())})).pipe(nc()):it(!0)}(g.component,g.route,l,a,f)),fa(g=>!0!==g,!0))}(_,f,g,u).pipe(En(y=>y&&function PB(u){return"boolean"==typeof u}(y)?function aV(u,a,l,f){return wn(a).pipe(ql(g=>mm(function cV(u,a){return null!==u&&a&&a(new Z2(u)),it(!0)}(g.route.parent,f),function lV(u,a){return null!==u&&a&&a(new Q2(u)),it(!0)}(g.route,f),function hV(u,a,l){const f=a[a.length-1],p=a.slice(0,a.length-1).reverse().map(_=>function tV(u){const a=u.routeConfig?u.routeConfig.canActivateChild:null;return a&&0!==a.length?{node:u,guards:a}:null}(_)).filter(_=>null!==_).map(_=>BD(()=>it(_.guards.map(b=>{const O=jh(b,_.node,l);let M;if(function BB(u){return u&&ws(u.canActivateChild)}(O))M=yr(O.canActivateChild(f,u));else{if(!ws(O))throw new Error("Invalid CanActivateChild guard");M=yr(O(f,u))}return M.pipe(fa())})).pipe(nc())));return it(p).pipe(nc())}(u,g.path,l),function uV(u,a,l){const f=a.routeConfig?a.routeConfig.canActivate:null;if(!f||0===f.length)return it(!0);const g=f.map(p=>BD(()=>{const _=jh(p,a,l);let y;if(function kB(u){return u&&ws(u.canActivate)}(_))y=yr(_.canActivate(a,u));else{if(!ws(_))throw new Error("Invalid CanActivate guard");y=yr(_(a,u))}return y.pipe(fa())}));return it(g).pipe(nc())}(u,g.route,l))),fa(g=>!0!==g,!0))}(f,p,u,a):it(y)),Nt(y=>Object.assign(Object.assign({},l),{guardsResult:y})))})}(this.ngModule.injector,y=>this.triggerEvent(y)),ai(y=>{if(no(y.guardsResult)){const O=ym(`Redirecting to "${this.serializeUrl(y.guardsResult)}"`);throw O.url=y.guardsResult,O}const b=new $2(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot,!!y.guardsResult);this.triggerEvent(b)}),da(y=>!!y.guardsResult||(this.restoreHistory(y),this.cancelNavigationTransition(y,""),!1)),Lm(y=>{if(y.guards.canActivateChecks.length)return it(y).pipe(ai(b=>{const O=new X2(b.id,this.serializeUrl(b.extractedUrl),this.serializeUrl(b.urlAfterRedirects),b.targetSnapshot);this.triggerEvent(O)}),Js(b=>{let O=!1;return it(b).pipe(function CV(u,a){return En(l=>{const{targetSnapshot:f,guards:{canActivateChecks:g}}=l;if(!g.length)return it(l);let p=0;return wn(g).pipe(ql(_=>function EV(u,a,l,f){return function wV(u,a,l,f){const g=LS(u);if(0===g.length)return it({});const p={};return wn(g).pipe(En(_=>function bV(u,a,l,f){const g=jh(u,a,f);return yr(g.resolve?g.resolve(a,l):g(a,l))}(u[_],a,l,f).pipe(ai(y=>{p[_]=y}))),_m(1),En(()=>LS(p).length===g.length?it(p):Ir))}(u._resolve,u,a,f).pipe(Nt(p=>(u._resolvedData=p,u.data=Object.assign(Object.assign({},u.data),uS(u,l).resolve),null)))}(_.route,f,u,a)),ai(()=>p++),_m(1),En(_=>p===g.length?it(l):Ir))})}(this.paramsInheritanceStrategy,this.ngModule.injector),ai({next:()=>O=!0,complete:()=>{O||(this.restoreHistory(b),this.cancelNavigationTransition(b,"At least one route resolver didn't emit any value."))}}))}),ai(b=>{const O=new q2(b.id,this.serializeUrl(b.extractedUrl),this.serializeUrl(b.urlAfterRedirects),b.targetSnapshot);this.triggerEvent(O)}))}),Lm(y=>{const{targetSnapshot:b,id:O,extractedUrl:M,rawUrl:P,extras:{skipLocationChange:k,replaceUrl:V}}=y;return this.hooks.afterPreactivation(b,{navigationId:O,appliedUrlTree:M,rawUrlTree:P,skipLocationChange:!!k,replaceUrl:!!V})}),Nt(y=>{const b=function wB(u,a,l){const f=Jl(u,a._root,l?l._root:void 0);return new lS(f,a)}(this.routeReuseStrategy,y.targetSnapshot,y.currentRouterState);return Object.assign(Object.assign({},y),{targetRouterState:b})}),ai(y=>{this.currentUrlTree=y.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(y.urlAfterRedirects,y.rawUrl),this.routerState=y.targetRouterState,"deferred"===this.urlUpdateStrategy&&(y.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,y),this.browserUrlTree=y.urlAfterRedirects)}),((u,a,l)=>Nt(f=>(new LB(a,f.targetRouterState,f.currentRouterState,l).activate(u),f)))(this.rootContexts,this.routeReuseStrategy,y=>this.triggerEvent(y)),ai({next(){p=!0},complete(){p=!0}}),function H2(u){return Dn((a,l)=>{try{a.subscribe(l)}finally{l.add(u)}})}(()=>{var y;p||_||this.cancelNavigationTransition(g,`Navigation ID ${g.id} is not equal to the current navigation id ${this.navigationId}`),(null===(y=this.currentNavigation)||void 0===y?void 0:y.id)===g.id&&(this.currentNavigation=null)}),Es(y=>{if(_=!0,function tB(u){return u&&u[$D]}(y)){const b=no(y.url);b||(this.navigated=!0,this.restoreHistory(g,!0));const O=new HD(g.id,this.serializeUrl(g.extractedUrl),y.message);f.next(O),b?setTimeout(()=>{const M=this.urlHandlingStrategy.merge(y.url,this.rawUrlTree),P={skipLocationChange:g.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||NS(g.source)};this.scheduleNavigation(M,"imperative",null,P,{resolve:g.resolve,reject:g.reject,promise:g.promise})},0):g.resolve(!1)}else{this.restoreHistory(g,!0);const b=new W2(g.id,this.serializeUrl(g.extractedUrl),y);f.next(b);try{g.resolve(this.errorHandler(y))}catch(O){g.reject(O)}}return Ir}))}))}resetRootComponentType(l){this.rootComponentType=l,this.routerState.root.component=this.rootComponentType}setTransition(l){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),l))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(l=>{const f="popstate"===l.type?"popstate":"hashchange";"popstate"===f&&setTimeout(()=>{var g;const p={replaceUrl:!0},_=(null===(g=l.state)||void 0===g?void 0:g.navigationId)?l.state:null;if(_){const b=Object.assign({},_);delete b.navigationId,delete b.\u0275routerPageId,0!==Object.keys(b).length&&(p.state=b)}const y=this.parseUrl(l.url);this.scheduleNavigation(y,f,_,p)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(l){this.events.next(l)}resetConfig(l){yS(l),this.config=l.map(Om),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(l,f={}){const{relativeTo:g,queryParams:p,fragment:_,queryParamsHandling:y,preserveFragment:b}=f,O=g||this.routerState.root,M=b?this.currentUrlTree.fragment:_;let P=null;switch(y){case"merge":P=Object.assign(Object.assign({},this.currentUrlTree.queryParams),p);break;case"preserve":P=this.currentUrlTree.queryParams;break;default:P=p||null}return null!==P&&(P=this.removeEmptyProps(P)),function SB(u,a,l,f,g){if(0===l.length)return Tm(a.root,a.root,a.root,f,g);const p=function TB(u){if("string"==typeof u[0]&&1===u.length&&"/"===u[0])return new gS(!0,0,u);let a=0,l=!1;const f=u.reduce((g,p,_)=>{if("object"==typeof p&&null!=p){if(p.outlets){const y={};return xn(p.outlets,(b,O)=>{y[O]="string"==typeof b?b.split("/"):b}),[...g,{outlets:y}]}if(p.segmentPath)return[...g,p.segmentPath]}return"string"!=typeof p?[...g,p]:0===_?(p.split("/").forEach((y,b)=>{0==b&&"."===y||(0==b&&""===y?l=!0:".."===y?a++:""!=y&&g.push(y))}),g):[...g,p]},[]);return new gS(l,a,f)}(l);if(p.toRoot())return Tm(a.root,a.root,new _t([],{}),f,g);const _=function IB(u,a,l){if(u.isAbsolute)return new Im(a.root,!0,0);if(-1===l.snapshot._lastPathIndex){const p=l.snapshot._urlSegment;return new Im(p,p===a.root,0)}const f=Lh(u.commands[0])?0:1;return function xB(u,a,l){let f=u,g=a,p=l;for(;p>g;){if(p-=g,f=f.parent,!f)throw new Error("Invalid number of '../'");g=f.segments.length}return new Im(f,!1,g-p)}(l.snapshot._urlSegment,l.snapshot._lastPathIndex+f,u.numberOfDoubleDots)}(p,a,u),y=_.processChildren?Fh(_.segmentGroup,_.index,p.commands):pS(_.segmentGroup,_.index,p.commands);return Tm(a.root,_.segmentGroup,y,f,g)}(O,this.currentUrlTree,l,P,null!=M?M:null)}navigateByUrl(l,f={skipLocationChange:!1}){const g=no(l)?l:this.parseUrl(l),p=this.urlHandlingStrategy.merge(g,this.rawUrlTree);return this.scheduleNavigation(p,"imperative",null,f)}navigate(l,f={skipLocationChange:!1}){return function LV(u){for(let a=0;a<u.length;a++){const l=u[a];if(null==l)throw new Error(`The requested path contains ${l} segment at index ${a}`)}}(l),this.navigateByUrl(this.createUrlTree(l,f),f)}serializeUrl(l){return this.urlSerializer.serialize(l)}parseUrl(l){let f;try{f=this.urlSerializer.parse(l)}catch(g){f=this.malformedUriErrorHandler(g,this.urlSerializer,l)}return f}isActive(l,f){let g;if(g=!0===f?Object.assign({},OV):!1===f?Object.assign({},MV):f,no(l))return QD(this.currentUrlTree,l,g);const p=this.parseUrl(l);return QD(this.currentUrlTree,p,g)}removeEmptyProps(l){return Object.keys(l).reduce((f,g)=>{const p=l[g];return null!=p&&(f[g]=p),f},{})}processNavigations(){this.navigations.subscribe(l=>{this.navigated=!0,this.lastSuccessfulId=l.id,this.currentPageId=l.targetPageId,this.events.next(new Zl(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,l.resolve(!0)},l=>{this.console.warn(`Unhandled Navigation Error: ${l}`)})}scheduleNavigation(l,f,g,p,_){var y,b;if(this.disposed)return Promise.resolve(!1);let O,M,P;_?(O=_.resolve,M=_.reject,P=_.promise):P=new Promise((H,z)=>{O=H,M=z});const k=++this.navigationId;let V;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(g=this.location.getState()),V=g&&g.\u0275routerPageId?g.\u0275routerPageId:p.replaceUrl||p.skipLocationChange?null!==(y=this.browserPageId)&&void 0!==y?y:0:(null!==(b=this.browserPageId)&&void 0!==b?b:0)+1):V=0,this.setTransition({id:k,targetPageId:V,source:f,restoredState:g,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:l,extras:p,resolve:O,reject:M,promise:P,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),P.catch(H=>Promise.reject(H))}setBrowserUrl(l,f){const g=this.urlSerializer.serialize(l),p=Object.assign(Object.assign({},f.extras.state),this.generateNgRouterState(f.id,f.targetPageId));this.location.isCurrentPathEqualTo(g)||f.extras.replaceUrl?this.location.replaceState(g,"",p):this.location.go(g,"",p)}restoreHistory(l,f=!1){var g,p;if("computed"===this.canceledNavigationResolution){const _=this.currentPageId-l.targetPageId;"popstate"!==l.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(g=this.currentNavigation)||void 0===g?void 0:g.finalUrl)||0===_?this.currentUrlTree===(null===(p=this.currentNavigation)||void 0===p?void 0:p.finalUrl)&&0===_&&(this.resetState(l),this.browserUrlTree=l.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(_)}else"replace"===this.canceledNavigationResolution&&(f&&this.resetState(l),this.resetUrlToCurrentUrlTree())}resetState(l){this.routerState=l.currentRouterState,this.currentUrlTree=l.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,l.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(l,f){const g=new HD(l.id,this.serializeUrl(l.extractedUrl),f);this.triggerEvent(g),l.resolve(!1)}generateNgRouterState(l,f){return"computed"===this.canceledNavigationResolution?{navigationId:l,\u0275routerPageId:f}:{navigationId:l}}}return u.\u0275fac=function(l){Rg()},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();function NS(u){return"imperative"!==u}let ac=(()=>{class u{constructor(l,f,g){this.router=l,this.route=f,this.locationStrategy=g,this.commands=null,this.href=null,this.onChanges=new Sr,this.subscription=l.events.subscribe(p=>{p instanceof Zl&&this.updateTargetUrlAndHref()})}set routerLink(l){this.commands=null!=l?Array.isArray(l)?l:[l]:null}ngOnChanges(l){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(l,f,g,p,_){if(0!==l||f||g||p||_||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const y={skipLocationChange:_a(this.skipLocationChange),replaceUrl:_a(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,y),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:_a(this.preserveFragment)})}}return u.\u0275fac=function(l){return new(l||u)(ve(li),ve(ma),ve(ua))},u.\u0275dir=He({type:u,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(l,f){1&l&&Tn("click",function(p){return f.onClick(p.button,p.ctrlKey,p.shiftKey,p.altKey,p.metaKey)}),2&l&&hr("target",f.target)("href",f.href,Ff)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[yi]}),u})();function _a(u){return""===u||!!u}class kS{}class BS{preload(a,l){return it(null)}}let VS=(()=>{class u{constructor(l,f,g,p){this.router=l,this.injector=g,this.preloadingStrategy=p,this.loader=new FS(g,f,b=>l.triggerEvent(new WD(b)),b=>l.triggerEvent(new zD(b)))}setUpPreloading(){this.subscription=this.router.events.pipe(da(l=>l instanceof Zl),ql(()=>this.preload())).subscribe(()=>{})}preload(){const l=this.injector.get(Pr);return this.processRoutes(l,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(l,f){const g=[];for(const p of f)if(p.loadChildren&&!p.canLoad&&p._loadedConfig){const _=p._loadedConfig;g.push(this.processRoutes(_.module,_.routes))}else p.loadChildren&&!p.canLoad?g.push(this.preloadConfig(l,p)):p.children&&g.push(this.processRoutes(l,p.children));return wn(g).pipe(Xa(),Nt(p=>{}))}preloadConfig(l,f){return this.preloadingStrategy.preload(f,()=>(f._loadedConfig?it(f._loadedConfig):this.loader.load(l.injector,f)).pipe(En(p=>(f._loadedConfig=p,this.processRoutes(p.module,p.routes)))))}}return u.\u0275fac=function(l){return new(l||u)(We(li),We(xw),We(Xn),We(kS))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})(),Nm=(()=>{class u{constructor(l,f,g={}){this.router=l,this.viewportScroller=f,this.options=g,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},g.scrollPositionRestoration=g.scrollPositionRestoration||"disabled",g.anchorScrolling=g.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(l=>{l instanceof vm?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=l.navigationTrigger,this.restoredId=l.restoredState?l.restoredState.navigationId:0):l instanceof Zl&&(this.lastId=l.id,this.scheduleScrollEvent(l,this.router.parseUrl(l.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(l=>{l instanceof YD&&(l.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(l.position):l.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(l.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(l,f){this.router.triggerEvent(new YD(l,"popstate"===this.lastSource?this.store[this.restoredId]:null,f))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return u.\u0275fac=function(l){Rg()},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();const io=new ct("ROUTER_CONFIGURATION"),jS=new ct("ROUTER_FORROOT_GUARD"),kV=[Tp,{provide:nS,useClass:iS},{provide:li,useFactory:function GV(u,a,l,f,g,p,_={},y,b){const O=new li(null,u,a,l,f,g,qD(p));return y&&(O.urlHandlingStrategy=y),b&&(O.routeReuseStrategy=b),function HV(u,a){u.errorHandler&&(a.errorHandler=u.errorHandler),u.malformedUriErrorHandler&&(a.malformedUriErrorHandler=u.malformedUriErrorHandler),u.onSameUrlNavigation&&(a.onSameUrlNavigation=u.onSameUrlNavigation),u.paramsInheritanceStrategy&&(a.paramsInheritanceStrategy=u.paramsInheritanceStrategy),u.relativeLinkResolution&&(a.relativeLinkResolution=u.relativeLinkResolution),u.urlUpdateStrategy&&(a.urlUpdateStrategy=u.urlUpdateStrategy),u.canceledNavigationResolution&&(a.canceledNavigationResolution=u.canceledNavigationResolution)}(_,O),_.enableTracing&&O.events.subscribe(M=>{var P,k;null===(P=console.group)||void 0===P||P.call(console,`Router Event: ${M.constructor.name}`),console.log(M.toString()),console.log(M),null===(k=console.groupEnd)||void 0===k||k.call(console)}),O},deps:[nS,ic,Tp,Xn,xw,Fm,io,[class IV{},new hs],[class DV{},new hs]]},ic,{provide:ma,useFactory:function WV(u){return u.routerState.root},deps:[li]},VS,BS,class NV{preload(a,l){return l().pipe(Es(()=>it(null)))}},{provide:io,useValue:{enableTracing:!1}}];function BV(){return new Lw("Router",li)}let US=(()=>{class u{constructor(l,f){}static forRoot(l,f){return{ngModule:u,providers:[kV,GS(l),{provide:jS,useFactory:UV,deps:[[li,new hs,new dl]]},{provide:io,useValue:f||{}},{provide:ua,useFactory:jV,deps:[Zs,[new Cu(Sp),new hs],io]},{provide:Nm,useFactory:VV,deps:[li,HN,io]},{provide:kS,useExisting:f&&f.preloadingStrategy?f.preloadingStrategy:BS},{provide:Lw,multi:!0,useFactory:BV},[km,{provide:cp,multi:!0,useFactory:zV,deps:[km]},{provide:HS,useFactory:YV,deps:[km]},{provide:Iw,multi:!0,useExisting:HS}]]}}static forChild(l){return{ngModule:u,providers:[GS(l)]}}}return u.\u0275fac=function(l){return new(l||u)(We(jS,8),We(li,8))},u.\u0275mod=nr({type:u}),u.\u0275inj=Pi({}),u})();function VV(u,a,l){return l.scrollOffset&&a.setOffset(l.scrollOffset),new Nm(u,a,l)}function jV(u,a,l={}){return l.useHash?new bP(u,a):new Qw(u,a)}function UV(u){return"guarded"}function GS(u){return[{provide:rA,multi:!0,useValue:u},{provide:Fm,multi:!0,useValue:u}]}let km=(()=>{class u{constructor(l){this.injector=l,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Sr}appInitializer(){return this.injector.get(CP,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let f=null;const g=new Promise(y=>f=y),p=this.injector.get(li),_=this.injector.get(io);return"disabled"===_.initialNavigation?(p.setUpLocationChangeListener(),f(!0)):"enabled"===_.initialNavigation||"enabledBlocking"===_.initialNavigation?(p.hooks.afterPreactivation=()=>this.initNavigation?it(null):(this.initNavigation=!0,f(!0),this.resultOfPreactivationDone),p.initialNavigation()):f(!0),g})}bootstrapListener(l){const f=this.injector.get(io),g=this.injector.get(VS),p=this.injector.get(Nm),_=this.injector.get(li),y=this.injector.get(vp);l===y.components[0]&&(("enabledNonBlocking"===f.initialNavigation||void 0===f.initialNavigation)&&_.initialNavigation(),g.setUpPreloading(),p.init(),_.resetRootComponentType(y.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return u.\u0275fac=function(l){return new(l||u)(We(Xn))},u.\u0275prov=mt({token:u,factory:u.\u0275fac}),u})();function zV(u){return u.appInitializer.bind(u)}function YV(u){return u.bootstrapListener.bind(u)}const HS=new ct("Router Initializer");function WS(u,a,l,f,g,p,_){try{var y=u[p](_),b=y.value}catch(O){return void l(O)}y.done?a(b):Promise.resolve(b).then(f,g)}function ae(u){return function(){var a=this,l=arguments;return new Promise(function(f,g){var p=u.apply(a,l);function _(b){WS(p,f,g,_,y,"next",b)}function y(b){WS(p,f,g,_,y,"throw",b)}_(void 0)})}}const XV=[{id:"reader",name:"Barcode and QR Code Reader",description:"Scan barcode and QR code from image files"},{id:"scanner",name:"Barcode and QR Code Scanner",description:"Scan barcode and QR code from camera stream"}];function at(u,a,l,f){if("a"===l&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof a?u!==a||!f:!a.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===l?f:"a"===l?f.call(u):f?f.value:a.get(u)}function ro(u,a,l,f,g){if("m"===f)throw new TypeError("Private method is not writable");if("a"===f&&!g)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof a?u!==a||!g:!a.has(u))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===f?g.call(u,l):g?g.value=l:a.set(u,l),l}var so,Cr,Ve,u;"function"==typeof SuppressedError&&SuppressedError,(u=so||(so={}))[u.BOPM_BLOCK=0]="BOPM_BLOCK",u[u.BOPM_UPDATE=1]="BOPM_UPDATE",function(u){u[u.CCUT_AUTO=0]="CCUT_AUTO",u[u.CCUT_FULL_CHANNEL=1]="CCUT_FULL_CHANNEL",u[u.CCUT_Y_CHANNEL_ONLY=2]="CCUT_Y_CHANNEL_ONLY",u[u.CCUT_RGB_R_CHANNEL_ONLY=3]="CCUT_RGB_R_CHANNEL_ONLY",u[u.CCUT_RGB_G_CHANNEL_ONLY=4]="CCUT_RGB_G_CHANNEL_ONLY",u[u.CCUT_RGB_B_CHANNEL_ONLY=5]="CCUT_RGB_B_CHANNEL_ONLY"}(Cr||(Cr={})),function(u){u[u.IPF_BINARY=0]="IPF_BINARY",u[u.IPF_BINARYINVERTED=1]="IPF_BINARYINVERTED",u[u.IPF_GRAYSCALED=2]="IPF_GRAYSCALED",u[u.IPF_NV21=3]="IPF_NV21",u[u.IPF_RGB_565=4]="IPF_RGB_565",u[u.IPF_RGB_555=5]="IPF_RGB_555",u[u.IPF_RGB_888=6]="IPF_RGB_888",u[u.IPF_ARGB_8888=7]="IPF_ARGB_8888",u[u.IPF_RGB_161616=8]="IPF_RGB_161616",u[u.IPF_ARGB_16161616=9]="IPF_ARGB_16161616",u[u.IPF_ABGR_8888=10]="IPF_ABGR_8888",u[u.IPF_ABGR_16161616=11]="IPF_ABGR_16161616",u[u.IPF_BGR_888=12]="IPF_BGR_888",u[u.IPF_BINARY_8=13]="IPF_BINARY_8",u[u.IPF_NV12=14]="IPF_NV12",u[u.IPF_BINARY_8_INVERTED=15]="IPF_BINARY_8_INVERTED"}(Ve||(Ve={}));const zS=u=>Object.prototype.toString.call(u),Bm=u=>Array.isArray?Array.isArray(u):"[object Array]"===zS(u),Vm=u=>"[object Boolean]"===zS(u),Kt=u=>"number"==typeof u&&!Number.isNaN(u),qi=u=>null!==u&&"object"==typeof u&&!Array.isArray(u),YS=u=>!(!qi(u)||!(u.bytes instanceof Uint8Array)||!Kt(u.width)||u.width<=0||!Kt(u.height)||u.height<=0||!Kt(u.stride)||u.stride<=0||!("format"in u)||"tag"in u&&!ZV(u.tag)),ZV=u=>!!qi(u)&&!!Kt(u.imageId)&&"type"in u,va=u=>!!qi(u)&&!!Kt(u.x)&&!!Kt(u.y);function $S(u,a){return jm.apply(this,arguments)}function jm(){return jm=ae(function*(u,a){return yield new Promise((l,f)=>{let g=new XMLHttpRequest;g.open("GET",u,!0),g.responseType=a,g.send(),g.onloadend=ae(function*(){g.status<200||g.status>=300?f(u+" "+g.status):l(g.response)}),g.onerror=()=>{f(new Error("Network Error: "+g.statusText))}})}),jm.apply(this,arguments)}const oo=(u,a)=>{let l=u.split("."),f=a.split(".");for(let g=0;g<l.length&&g<f.length;++g){let p=l[g],_=f[g];if(p===_)continue;let y=parseInt(l[g]),b=parseInt(f[g]);return y===b||Number.isNaN(y)&&Number.isNaN(b)?p<_?-1:1:y<b||Number.isNaN(y)&&Number.isInteger(b)?-1:1}return l.length===f.length?0:l.length<f.length?-1:1},ej="function"==typeof BigInt;var Uh,hn,ao,lc,cc,xi,lo,Um;class Ai{get _isFetchingStarted(){return at(this,cc,"f")}constructor(){Uh.add(this),hn.set(this,[]),ao.set(this,1),lc.set(this,so.BOPM_BLOCK),cc.set(this,!1),xi.set(this,void 0),lo.set(this,Cr.CCUT_AUTO)}setErrorListener(a){}addImageToBuffer(a){var l;if(!YS(a))throw new TypeError("Invalid 'image'.");if((null===(l=a.tag)||void 0===l?void 0:l.hasOwnProperty("imageId"))&&"number"==typeof a.tag.imageId&&this.hasImage(a.tag.imageId))throw new Error("Existed imageId.");if(at(this,hn,"f").length>=at(this,ao,"f"))switch(at(this,lc,"f")){case so.BOPM_BLOCK:break;case so.BOPM_UPDATE:if(at(this,hn,"f").push(a),qi(at(this,xi,"f"))&&Kt(at(this,xi,"f").imageId)&&1==at(this,xi,"f").keepInBuffer)for(;at(this,hn,"f").length>at(this,ao,"f");){const f=at(this,hn,"f").findIndex(g=>{var p;return(null===(p=g.tag)||void 0===p?void 0:p.imageId)!==at(this,xi,"f").imageId});at(this,hn,"f").splice(f,1)}else at(this,hn,"f").splice(0,at(this,hn,"f").length-at(this,ao,"f"))}else at(this,hn,"f").push(a)}getImage(){if(0===at(this,hn,"f").length)return null;let a;if(at(this,xi,"f")&&Kt(at(this,xi,"f").imageId)){const l=at(this,Uh,"m",Um).call(this,at(this,xi,"f").imageId);if(l<0)throw new Error(`Image with id ${at(this,xi,"f").imageId} doesn't exist.`);a=at(this,hn,"f").slice(l,l+1)[0]}else a=at(this,hn,"f").pop();if([Ve.IPF_RGB_565,Ve.IPF_RGB_555,Ve.IPF_RGB_888,Ve.IPF_ARGB_8888,Ve.IPF_RGB_161616,Ve.IPF_ARGB_16161616,Ve.IPF_ABGR_8888,Ve.IPF_ABGR_16161616,Ve.IPF_BGR_888].includes(a.format)){if(at(this,lo,"f")===Cr.CCUT_RGB_R_CHANNEL_ONLY){Ai._onLog&&Ai._onLog("only get R channel data.");const l=new Uint8Array(a.width*a.height);for(let f=0;f<l.length;f++)switch(a.format){case Ve.IPF_RGB_565:case Ve.IPF_RGB_555:case Ve.IPF_RGB_888:case Ve.IPF_RGB_161616:l[f]=a.bytes[3*f+2];break;case Ve.IPF_ARGB_8888:case Ve.IPF_ARGB_16161616:l[f]=a.bytes[4*f+2];break;case Ve.IPF_BGR_888:l[f]=a.bytes[3*f];break;case Ve.IPF_ABGR_8888:case Ve.IPF_ABGR_16161616:l[f]=a.bytes[4*f]}a.bytes=l,a.stride=a.width,a.format=Ve.IPF_GRAYSCALED}else if(at(this,lo,"f")===Cr.CCUT_RGB_G_CHANNEL_ONLY){Ai._onLog&&Ai._onLog("only get G channel data.");const l=new Uint8Array(a.width*a.height);for(let f=0;f<l.length;f++)switch(a.format){case Ve.IPF_RGB_565:case Ve.IPF_RGB_555:case Ve.IPF_RGB_888:case Ve.IPF_RGB_161616:case Ve.IPF_BGR_888:l[f]=a.bytes[3*f+1];break;case Ve.IPF_ARGB_8888:case Ve.IPF_ARGB_16161616:case Ve.IPF_ABGR_8888:case Ve.IPF_ABGR_16161616:l[f]=a.bytes[4*f+1]}a.bytes=l,a.stride=a.width,a.format=Ve.IPF_GRAYSCALED}else if(at(this,lo,"f")===Cr.CCUT_RGB_B_CHANNEL_ONLY){Ai._onLog&&Ai._onLog("only get B channel data.");const l=new Uint8Array(a.width*a.height);for(let f=0;f<l.length;f++)switch(a.format){case Ve.IPF_RGB_565:case Ve.IPF_RGB_555:case Ve.IPF_RGB_888:case Ve.IPF_RGB_161616:l[f]=a.bytes[3*f];break;case Ve.IPF_ARGB_8888:case Ve.IPF_ARGB_16161616:l[f]=a.bytes[4*f];break;case Ve.IPF_BGR_888:l[f]=a.bytes[3*f+2];break;case Ve.IPF_ABGR_8888:case Ve.IPF_ABGR_16161616:l[f]=a.bytes[4*f+2]}a.bytes=l,a.stride=a.width,a.format=Ve.IPF_GRAYSCALED}}else[Ve.IPF_NV21,Ve.IPF_NV12].includes(a.format)&&Ai._onLog&&Ai._onLog("NV21 or NV12 is not supported.");return a}setNextImageToReturn(a,l){if(!((...f)=>0!==f.length&&f.every(g=>Kt(g)))(a))throw new TypeError("Invalid 'imageId'.");if(void 0!==l&&!Vm(l))throw new TypeError("Invalid 'keepInBuffer'.");ro(this,xi,{imageId:a,keepInBuffer:l},"f")}_resetNextReturnedImage(){ro(this,xi,null,"f")}hasImage(a){return at(this,Uh,"m",Um).call(this,a)>=0}startFetching(){ro(this,cc,!0,"f")}stopFetching(){ro(this,cc,!1,"f")}setMaxImageCount(a){if("number"!=typeof a)throw new TypeError("Invalid 'count'.");if(a<1||Math.round(a)!==a)throw new Error("Invalid 'count'.");for(ro(this,ao,a,"f");at(this,hn,"f")&&at(this,hn,"f").length>a;)at(this,hn,"f").shift()}getMaxImageCount(){return at(this,ao,"f")}getImageCount(){return at(this,hn,"f").length}clearBuffer(){at(this,hn,"f").length=0}isBufferEmpty(){return 0===at(this,hn,"f").length}setBufferOverflowProtectionMode(a){ro(this,lc,a,"f")}getBufferOverflowProtectionMode(){return at(this,lc,"f")}setColourChannelUsageType(a){ro(this,lo,a,"f")}getColourChannelUsageType(){return at(this,lo,"f")}}hn=new WeakMap,ao=new WeakMap,lc=new WeakMap,cc=new WeakMap,xi=new WeakMap,lo=new WeakMap,Uh=new WeakSet,Um=function(u){if("number"!=typeof u)throw new TypeError("Invalid 'imageId'.");return at(this,hn,"f").findIndex(a=>{var l;return(null===(l=a.tag)||void 0===l?void 0:l.imageId)===u})};const Gh="undefined"==typeof self,XS=(()=>{if(!Gh&&document.currentScript){let u=document.currentScript.src,a=u.indexOf("?");if(-1!=a)u=u.substring(0,a);else{let l=u.indexOf("#");-1!=l&&(u=u.substring(0,l))}return u.substring(0,u.lastIndexOf("/")+1)}return"./"})(),qS=u=>{if(null==u&&(u="./"),!Gh){let a=document.createElement("a");a.href=u,u=a.href}return u.endsWith("/")||(u+="/"),u};let uc,Ur,Hh,Wh,Zn;"undefined"!=typeof navigator&&(uc=navigator,Ur=uc.userAgent,Hh=uc.platform,Wh=uc.mediaDevices),function(){if(!Gh){const u={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:uc.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},a={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:Hh,search:"Win"},Mac:{str:Hh},Linux:{str:Hh}};let l="unknownBrowser",f=0,g="unknownOS";for(let p in u){const _=u[p]||{};let O=_.verStr||Ur,M=_.verSearch||p;if(M instanceof Array||(M=[M]),-1!=(_.str||Ur).indexOf(_.search||p)){l=p;for(let P of M){let k=O.indexOf(P);if(-1!=k){f=parseFloat(O.substring(k+P.length+1));break}}break}}for(let p in a){const _=a[p]||{};if(-1!=(_.str||Ur).indexOf(_.search||p)){g=p;break}}"Linux"==g&&-1!=Ur.indexOf("Windows NT")&&(g="HarmonyOS"),Zn={browser:l,version:f,OS:g}}Gh&&(Zn={browser:"ssr",version:0,OS:"ssr"})}();const tj="undefined"!=typeof WebAssembly&&Ur&&!(/Safari/.test(Ur)&&!/Chrome/.test(Ur)&&/\(.+\s11_2_([2-6]).*\)/.test(Ur)),nj="undefined"!=typeof Worker,ZS=!(!Wh||!Wh.getUserMedia),ij=function(){var u=ae(function*(){let a=!1;if(ZS)try{(yield Wh.getUserMedia({video:!0})).getTracks().forEach(l=>{l.stop()}),a=!0}catch(l){}return a});return function(){return u.apply(this,arguments)}}(),KS=u=>u&&"object"==typeof u&&"function"==typeof u.then;class zh extends Promise{constructor(a){let l,f;super((g,p)=>{l=g,f=p}),this._s="pending",this.resolve=g=>{this.isPending&&(KS(g)?this.task=g:(this._s="fulfilled",l(g)))},this.reject=g=>{this.isPending&&(this._s="rejected",f(g))},this.task=a}get status(){return this._s}get isPending(){return"pending"===this._s}get isFulfilled(){return"fulfilled"===this._s}get isRejected(){return"rejected"===this._s}get task(){return this._task}set task(a){var l=this;let f;this._task=a,KS(a)?f=a:"function"==typeof a&&(f=new Promise(a)),f&&ae(function*(){try{const g=yield f;a===l._task&&l.resolve(g)}catch(g){a===l._task&&l.reject(g)}})()}get isEmpty(){return null==this._task}}const Ri={},QS=function(){var u=ae(function*(a){let l="string"==typeof a?[a]:a,f=[];for(let g of l)f.push(Ri[g]=Ri[g]||new zh);yield Promise.all(f)});return function(l){return u.apply(this,arguments)}}(),Yh=function(){var u=ae(function*(a,l){let f,g="string"==typeof a?[a]:a,p=[];for(let _ of g){let y;p.push(y=Ri[_]=Ri[_]||new zh(f=f||l())),y.isEmpty&&(y.task=f=f||l())}yield Promise.all(p)});return function(l,f){return u.apply(this,arguments)}}();let ht,JS=0;const Tt=()=>JS++,Et={};let bs,Gm=!1;const co={},yn={},Ke={std:{version:"1.2.10",path:qS(XS+"../../dynamsoft-capture-vision-std@1.2.10/dist/")},core:{version:"3.2.30",path:XS}},hc=new Proxy(Ke,{get(u,a,l){let f=Reflect.get(u,a,l);return f&&f.path&&(f=f.path),f}}),Ds={dip:{wasm:!0}},Er=function(){var u=ae(function*(a){let l;a instanceof Array||(a=a?[a]:[]);{let p=Ri.core;l=!p||p.isEmpty}let f=new Map;for(let p of a){if(p=p.toLowerCase(),"std"==p||"core"==p)continue;if(!Ds[p])throw Error("The '"+p+"' module cannot be found.");let _=Ds[p].deps;if(null==_?void 0:_.length)for(let b of _){let O=Ri[b];f.has(b)||f.set(b,!O||O.isEmpty)}let y=Ri[p];f.has(p)||f.set(p,!y||y.isEmpty)}let g=[];l&&g.push("core"),g.push(...f.keys()),yield Yh(g,ae(function*(){const p=[...f.entries()].filter(P=>P[1]).map(P=>P[0]),_={};for(let P in hc){if("rootDirectory"==P)continue;let k=hc[P];hc.rootDirectory&&(k.startsWith("http://")||k.startsWith("https://")||(k=hc.rootDirectory+"/"+k)),_[P]=qS(k)}const y={};for(let P of p)y[P]=Ds[P];const b={engineResourcePaths:_,autoResources:y,names:p};let O=new zh;if(l){b.needLoadCore=!0;let P=_.core+Qt._workerName;_.rootDirectory&&(P=_.rootDirectory+P),P.startsWith(location.origin)||(P=yield fetch(P).then(k=>k.blob()).then(k=>URL.createObjectURL(k))),ht=new Worker(P),ht.onerror=k=>{let V=new Error(k.message);O.reject(V)},ht.addEventListener("message",k=>{let V=k.data?k.data:k,z=V.id,Y=V.body;switch(V.type){case"log":bs&&bs(V.message);break;case"task":try{Et[z](Y),delete Et[z]}catch(X){throw delete Et[z],X}break;case"event":try{Et[z](Y)}catch(X){throw X}break;default:console.log(k)}}),b.bLog=!!bs,b.bd=Gm,b.dm=location.origin.startsWith("http")?location.origin:"https://localhost"}else yield QS("worker");let M=JS++;Et[M]=P=>{if(P.success)Object.assign(co,P.versions),"{}"!==JSON.stringify(P.versions)&&(Qt._versions=P.versions),O.resolve(void 0);else{const k=Error(P.message);P.stack&&(k.stack=P.stack),O.reject(k)}},ht.postMessage({type:"loadWasm",body:b,id:M}),l&&Yh("worker",()=>Promise.resolve()),yield O}))});return function(l){return u.apply(this,arguments)}}();class Qt{static get engineResourcePaths(){return hc}static set engineResourcePaths(a){Object.assign(Ke,a)}static get bSupportDce4Module(){return this._bSupportDce4Module}static get bSupportIRTModule(){return this._bSupportIRTModule}static get versions(){return this._versions}static get _onLog(){return bs}static set _onLog(a){(u=>{bs=u,ht&&ht.postMessage({type:"setBLog",body:{value:!!u}})})(a)}static get _bDebug(){return Gm}static set _bDebug(a){(u=>{Gm=u,ht&&ht.postMessage({type:"setBDebug",body:{value:!!u}})})(a)}static isModuleLoaded(a){return a=(a=a||"core").toLowerCase(),!!Ri[a]&&Ri[a].isFulfilled}static loadWasm(a){return ae(function*(){return yield Er(a)})()}static detectEnvironment(){return ae(function*(){return yield ae(function*(){return{wasm:tj,worker:nj,getUserMedia:ZS,camera:yield ij(),browser:Zn.browser,version:Zn.version,OS:Zn.OS}})()})()}static getModuleVersion(){return ae(function*(){return yield new Promise((a,l)=>{let f=Tt();Et[f]=function(){var g=ae(function*(p){if(p.success)return a(p.versions);{let _=new Error(p.message);return _.stack=p.stack+"\n"+_.stack,l(_)}});return function(p){return g.apply(this,arguments)}}(),ht.postMessage({type:"getModuleVersion",id:f})})})()}static getVersion(){return`3.2.30(Worker: ${co.core&&co.core.worker||"Not Loaded"}, Wasm: ${co.core&&co.core.wasm||"Not Loaded"})`}static enableLogging(){Ai._onLog=console.log,Qt._onLog=console.log}static disableLogging(){Ai._onLog=null,Qt._onLog=null}static cfd(a){return ae(function*(){return yield new Promise((l,f)=>{let g=Tt();Et[g]=function(){var p=ae(function*(_){if(_.success)return l();{let y=new Error(_.message);return y.stack=_.stack+"\n"+y.stack,f(y)}});return function(_){return p.apply(this,arguments)}}(),ht.postMessage({type:"cfd",id:g,body:{count:a}})})})()}}var Jt,eT,Hm,tT,nT,$h,iT,rT,ya,sT,oT;Qt._bSupportDce4Module=-1,Qt._bSupportIRTModule=-1,Qt._versions=null,Qt._workerName="core.worker.js",Qt.browserInfo=Zn,function(u){u[u.CRIT_ORIGINAL_IMAGE=1]="CRIT_ORIGINAL_IMAGE",u[u.CRIT_BARCODE=2]="CRIT_BARCODE",u[u.CRIT_TEXT_LINE=4]="CRIT_TEXT_LINE",u[u.CRIT_DETECTED_QUAD=8]="CRIT_DETECTED_QUAD",u[u.CRIT_NORMALIZED_IMAGE=16]="CRIT_NORMALIZED_IMAGE",u[u.CRIT_PARSED_RESULT=32]="CRIT_PARSED_RESULT"}(Jt||(Jt={})),function(u){u[u.CT_NORMAL_INTERSECTED=0]="CT_NORMAL_INTERSECTED",u[u.CT_T_INTERSECTED=1]="CT_T_INTERSECTED",u[u.CT_CROSS_INTERSECTED=2]="CT_CROSS_INTERSECTED",u[u.CT_NOT_INTERSECTED=3]="CT_NOT_INTERSECTED"}(eT||(eT={})),function(u){u[u.EC_OK=0]="EC_OK",u[u.EC_UNKNOWN=-1e4]="EC_UNKNOWN",u[u.EC_NO_MEMORY=-10001]="EC_NO_MEMORY",u[u.EC_NULL_POINTER=-10002]="EC_NULL_POINTER",u[u.EC_LICENSE_INVALID=-10003]="EC_LICENSE_INVALID",u[u.EC_LICENSE_EXPIRED=-10004]="EC_LICENSE_EXPIRED",u[u.EC_FILE_NOT_FOUND=-10005]="EC_FILE_NOT_FOUND",u[u.EC_FILE_TYPE_NOT_SUPPORTED=-10006]="EC_FILE_TYPE_NOT_SUPPORTED",u[u.EC_BPP_NOT_SUPPORTED=-10007]="EC_BPP_NOT_SUPPORTED",u[u.EC_INDEX_INVALID=-10008]="EC_INDEX_INVALID",u[u.EC_CUSTOM_REGION_INVALID=-10010]="EC_CUSTOM_REGION_INVALID",u[u.EC_IMAGE_READ_FAILED=-10012]="EC_IMAGE_READ_FAILED",u[u.EC_TIFF_READ_FAILED=-10013]="EC_TIFF_READ_FAILED",u[u.EC_DIB_BUFFER_INVALID=-10018]="EC_DIB_BUFFER_INVALID",u[u.EC_PDF_READ_FAILED=-10021]="EC_PDF_READ_FAILED",u[u.EC_PDF_DLL_MISSING=-10022]="EC_PDF_DLL_MISSING",u[u.EC_PAGE_NUMBER_INVALID=-10023]="EC_PAGE_NUMBER_INVALID",u[u.EC_CUSTOM_SIZE_INVALID=-10024]="EC_CUSTOM_SIZE_INVALID",u[u.EC_TIMEOUT=-10026]="EC_TIMEOUT",u[u.EC_JSON_PARSE_FAILED=-10030]="EC_JSON_PARSE_FAILED",u[u.EC_JSON_TYPE_INVALID=-10031]="EC_JSON_TYPE_INVALID",u[u.EC_JSON_KEY_INVALID=-10032]="EC_JSON_KEY_INVALID",u[u.EC_JSON_VALUE_INVALID=-10033]="EC_JSON_VALUE_INVALID",u[u.EC_JSON_NAME_KEY_MISSING=-10034]="EC_JSON_NAME_KEY_MISSING",u[u.EC_JSON_NAME_VALUE_DUPLICATED=-10035]="EC_JSON_NAME_VALUE_DUPLICATED",u[u.EC_TEMPLATE_NAME_INVALID=-10036]="EC_TEMPLATE_NAME_INVALID",u[u.EC_JSON_NAME_REFERENCE_INVALID=-10037]="EC_JSON_NAME_REFERENCE_INVALID",u[u.EC_PARAMETER_VALUE_INVALID=-10038]="EC_PARAMETER_VALUE_INVALID",u[u.EC_DOMAIN_NOT_MATCH=-10039]="EC_DOMAIN_NOT_MATCH",u[u.EC_RESERVED_INFO_NOT_MATCH=-10040]="EC_RESERVED_INFO_NOT_MATCH",u[u.EC_LICENSE_KEY_NOT_MATCH=-10043]="EC_LICENSE_KEY_NOT_MATCH",u[u.EC_REQUEST_FAILED=-10044]="EC_REQUEST_FAILED",u[u.EC_LICENSE_INIT_FAILED=-10045]="EC_LICENSE_INIT_FAILED",u[u.EC_SET_MODE_ARGUMENT_ERROR=-10051]="EC_SET_MODE_ARGUMENT_ERROR",u[u.EC_LICENSE_CONTENT_INVALID=-10052]="EC_LICENSE_CONTENT_INVALID",u[u.EC_LICENSE_KEY_INVALID=-10053]="EC_LICENSE_KEY_INVALID",u[u.EC_LICENSE_DEVICE_RUNS_OUT=-10054]="EC_LICENSE_DEVICE_RUNS_OUT",u[u.EC_GET_MODE_ARGUMENT_ERROR=-10055]="EC_GET_MODE_ARGUMENT_ERROR",u[u.EC_IRT_LICENSE_INVALID=-10056]="EC_IRT_LICENSE_INVALID",u[u.EC_FILE_SAVE_FAILED=-10058]="EC_FILE_SAVE_FAILED",u[u.EC_STAGE_TYPE_INVALID=-10059]="EC_STAGE_TYPE_INVALID",u[u.EC_IMAGE_ORIENTATION_INVALID=-10060]="EC_IMAGE_ORIENTATION_INVALID",u[u.EC_CONVERT_COMPLEX_TEMPLATE_ERROR=-10061]="EC_CONVERT_COMPLEX_TEMPLATE_ERROR",u[u.EC_CALL_REJECTED_WHEN_CAPTURING=-10062]="EC_CALL_REJECTED_WHEN_CAPTURING",u[u.EC_NO_IMAGE_SOURCE=-10063]="EC_NO_IMAGE_SOURCE",u[u.EC_READ_DIRECTORY_FAILED=-10064]="EC_READ_DIRECTORY_FAILED",u[u.EC_MODULE_NOT_FOUND=-10065]="EC_MODULE_NOT_FOUND",u[u.EC_MULTI_PAGES_NOT_SUPPORTED=-10066]="EC_MULTI_PAGES_NOT_SUPPORTED",u[u.EC_FILE_ALREADY_EXISTS=-10067]="EC_FILE_ALREADY_EXISTS",u[u.EC_CREATE_FILE_FAILED=-10068]="EC_CREATE_FILE_FAILED",u[u.EC_IMGAE_DATA_INVALID=-10069]="EC_IMGAE_DATA_INVALID",u[u.EC_IMAGE_SIZE_NOT_MATCH=-10070]="EC_IMAGE_SIZE_NOT_MATCH",u[u.EC_IMAGE_PIXEL_FORMAT_NOT_MATCH=-10071]="EC_IMAGE_PIXEL_FORMAT_NOT_MATCH",u[u.EC_SECTION_LEVEL_RESULT_IRREPLACEABLE=-10072]="EC_SECTION_LEVEL_RESULT_IRREPLACEABLE",u[u.EC_AXIS_DEFINITION_INCORRECT=-10073]="EC_AXIS_DEFINITION_INCORRECT",u[u.EC_RESULT_TYPE_MISMATCH_IRREPLACEABLE=-10074]="EC_RESULT_TYPE_MISMATCH_IRREPLACEABLE",u[u.EC_PDF_LIBRARY_LOAD_FAILED=-10075]="EC_PDF_LIBRARY_LOAD_FAILED",u[u.EC_NO_LICENSE=-2e4]="EC_NO_LICENSE",u[u.EC_HANDSHAKE_CODE_INVALID=-20001]="EC_HANDSHAKE_CODE_INVALID",u[u.EC_LICENSE_BUFFER_FAILED=-20002]="EC_LICENSE_BUFFER_FAILED",u[u.EC_LICENSE_SYNC_FAILED=-20003]="EC_LICENSE_SYNC_FAILED",u[u.EC_DEVICE_NOT_MATCH=-20004]="EC_DEVICE_NOT_MATCH",u[u.EC_BIND_DEVICE_FAILED=-20005]="EC_BIND_DEVICE_FAILED",u[u.EC_INSTANCE_COUNT_OVER_LIMIT=-20008]="EC_INSTANCE_COUNT_OVER_LIMIT",u[u.EC_LICENSE_INIT_SEQUENCE_FAILED=-20009]="EC_LICENSE_INIT_SEQUENCE_FAILED",u[u.EC_TRIAL_LICENSE=-20010]="EC_TRIAL_LICENSE",u[u.EC_FAILED_TO_REACH_DLS=-20200]="EC_FAILED_TO_REACH_DLS",u[u.EC_LICENSE_CACHE_USED=-20012]="EC_LICENSE_CACHE_USED",u[u.EC_BARCODE_FORMAT_INVALID=-30009]="EC_BARCODE_FORMAT_INVALID",u[u.EC_QR_LICENSE_INVALID=-30016]="EC_QR_LICENSE_INVALID",u[u.EC_1D_LICENSE_INVALID=-30017]="EC_1D_LICENSE_INVALID",u[u.EC_PDF417_LICENSE_INVALID=-30019]="EC_PDF417_LICENSE_INVALID",u[u.EC_DATAMATRIX_LICENSE_INVALID=-30020]="EC_DATAMATRIX_LICENSE_INVALID",u[u.EC_CUSTOM_MODULESIZE_INVALID=-30025]="EC_CUSTOM_MODULESIZE_INVALID",u[u.EC_AZTEC_LICENSE_INVALID=-30041]="EC_AZTEC_LICENSE_INVALID",u[u.EC_PATCHCODE_LICENSE_INVALID=-30046]="EC_PATCHCODE_LICENSE_INVALID",u[u.EC_POSTALCODE_LICENSE_INVALID=-30047]="EC_POSTALCODE_LICENSE_INVALID",u[u.EC_DPM_LICENSE_INVALID=-30048]="EC_DPM_LICENSE_INVALID",u[u.EC_FRAME_DECODING_THREAD_EXISTS=-30049]="EC_FRAME_DECODING_THREAD_EXISTS",u[u.EC_STOP_DECODING_THREAD_FAILED=-30050]="EC_STOP_DECODING_THREAD_FAILED",u[u.EC_MAXICODE_LICENSE_INVALID=-30057]="EC_MAXICODE_LICENSE_INVALID",u[u.EC_GS1_DATABAR_LICENSE_INVALID=-30058]="EC_GS1_DATABAR_LICENSE_INVALID",u[u.EC_GS1_COMPOSITE_LICENSE_INVALID=-30059]="EC_GS1_COMPOSITE_LICENSE_INVALID",u[u.EC_DOTCODE_LICENSE_INVALID=-30061]="EC_DOTCODE_LICENSE_INVALID",u[u.EC_PHARMACODE_LICENSE_INVALID=-30062]="EC_PHARMACODE_LICENSE_INVALID",u[u.EC_CHARACTER_MODEL_FILE_NOT_FOUND=-40100]="EC_CHARACTER_MODEL_FILE_NOT_FOUND",u[u.EC_TEXT_LINE_GROUP_LAYOUT_CONFLICT=-40101]="EC_TEXT_LINE_GROUP_LAYOUT_CONFLICT",u[u.EC_TEXT_LINE_GROUP_REGEX_CONFLICT=-40102]="EC_TEXT_LINE_GROUP_REGEX_CONFLICT",u[u.EC_QUADRILATERAL_INVALID=-50057]="EC_QUADRILATERAL_INVALID",u[u.EC_PANORAMA_LICENSE_INVALID=-70060]="EC_PANORAMA_LICENSE_INVALID",u[u.EC_RESOURCE_PATH_NOT_EXIST=-90001]="EC_RESOURCE_PATH_NOT_EXIST",u[u.EC_RESOURCE_LOAD_FAILED=-90002]="EC_RESOURCE_LOAD_FAILED",u[u.EC_CODE_SPECIFICATION_NOT_FOUND=-90003]="EC_CODE_SPECIFICATION_NOT_FOUND",u[u.EC_FULL_CODE_EMPTY=-90004]="EC_FULL_CODE_EMPTY",u[u.EC_FULL_CODE_PREPROCESS_FAILED=-90005]="EC_FULL_CODE_PREPROCESS_FAILED",u[u.EC_ZA_DL_LICENSE_INVALID=-90006]="EC_ZA_DL_LICENSE_INVALID",u[u.EC_AAMVA_DL_ID_LICENSE_INVALID=-90007]="EC_AAMVA_DL_ID_LICENSE_INVALID",u[u.EC_AADHAAR_LICENSE_INVALID=-90008]="EC_AADHAAR_LICENSE_INVALID",u[u.EC_MRTD_LICENSE_INVALID=-90009]="EC_MRTD_LICENSE_INVALID",u[u.EC_VIN_LICENSE_INVALID=-90010]="EC_VIN_LICENSE_INVALID",u[u.EC_CUSTOMIZED_CODE_TYPE_LICENSE_INVALID=-90011]="EC_CUSTOMIZED_CODE_TYPE_LICENSE_INVALID"}(Hm||(Hm={})),function(u){u[u.GEM_SKIP=0]="GEM_SKIP",u[u.GEM_AUTO=1]="GEM_AUTO",u[u.GEM_GENERAL=2]="GEM_GENERAL",u[u.GEM_GRAY_EQUALIZE=4]="GEM_GRAY_EQUALIZE",u[u.GEM_GRAY_SMOOTH=8]="GEM_GRAY_SMOOTH",u[u.GEM_SHARPEN_SMOOTH=16]="GEM_SHARPEN_SMOOTH",u[u.GEM_REV=-2147483648]="GEM_REV"}(tT||(tT={})),function(u){u[u.GTM_SKIP=0]="GTM_SKIP",u[u.GTM_INVERTED=1]="GTM_INVERTED",u[u.GTM_ORIGINAL=2]="GTM_ORIGINAL",u[u.GTM_AUTO=4]="GTM_AUTO",u[u.GTM_REV=-2147483648]="GTM_REV"}(nT||(nT={})),function(u){u[u.ITT_FILE_IMAGE=0]="ITT_FILE_IMAGE",u[u.ITT_VIDEO_FRAME=1]="ITT_VIDEO_FRAME"}($h||($h={})),function(u){u[u.PDFRM_VECTOR=1]="PDFRM_VECTOR",u[u.PDFRM_RASTER=2]="PDFRM_RASTER",u[u.PDFRM_REV=-2147483648]="PDFRM_REV"}(iT||(iT={})),function(u){u[u.RDS_RASTERIZED_PAGES=0]="RDS_RASTERIZED_PAGES",u[u.RDS_EXTRACTED_IMAGES=1]="RDS_EXTRACTED_IMAGES"}(rT||(rT={})),function(u){u[u.IRUT_NULL=0]="IRUT_NULL",u[u.IRUT_COLOUR_IMAGE=1]="IRUT_COLOUR_IMAGE",u[u.IRUT_SCALED_DOWN_COLOUR_IMAGE=2]="IRUT_SCALED_DOWN_COLOUR_IMAGE",u[u.IRUT_GRAYSCALE_IMAGE=4]="IRUT_GRAYSCALE_IMAGE",u[u.IRUT_TRANSOFORMED_GRAYSCALE_IMAGE=8]="IRUT_TRANSOFORMED_GRAYSCALE_IMAGE",u[u.IRUT_ENHANCED_GRAYSCALE_IMAGE=16]="IRUT_ENHANCED_GRAYSCALE_IMAGE",u[u.IRUT_PREDETECTED_REGIONS=32]="IRUT_PREDETECTED_REGIONS",u[u.IRUT_BINARY_IMAGE=64]="IRUT_BINARY_IMAGE",u[u.IRUT_TEXTURE_DETECTION_RESULT=128]="IRUT_TEXTURE_DETECTION_RESULT",u[u.IRUT_TEXTURE_REMOVED_GRAYSCALE_IMAGE=256]="IRUT_TEXTURE_REMOVED_GRAYSCALE_IMAGE",u[u.IRUT_TEXTURE_REMOVED_BINARY_IMAGE=512]="IRUT_TEXTURE_REMOVED_BINARY_IMAGE",u[u.IRUT_CONTOURS=1024]="IRUT_CONTOURS",u[u.IRUT_LINE_SEGMENTS=2048]="IRUT_LINE_SEGMENTS",u[u.IRUT_TEXT_ZONES=4096]="IRUT_TEXT_ZONES",u[u.IRUT_TEXT_REMOVED_BINARY_IMAGE=8192]="IRUT_TEXT_REMOVED_BINARY_IMAGE",u[u.IRUT_CANDIDATE_BARCODE_ZONES=16384]="IRUT_CANDIDATE_BARCODE_ZONES",u[u.IRUT_LOCALIZED_BARCODES=32768]="IRUT_LOCALIZED_BARCODES",u[u.IRUT_SCALED_UP_BARCODE_IMAGE=65536]="IRUT_SCALED_UP_BARCODE_IMAGE",u[u.IRUT_DEFORMATION_RESISTED_BARCODE_IMAGE=131072]="IRUT_DEFORMATION_RESISTED_BARCODE_IMAGE",u[u.IRUT_COMPLEMENTED_BARCODE_IMAGE=262144]="IRUT_COMPLEMENTED_BARCODE_IMAGE",u[u.IRUT_DECODED_BARCODES=524288]="IRUT_DECODED_BARCODES",u[u.IRUT_LONG_LINES=1048576]="IRUT_LONG_LINES",u[u.IRUT_CORNERS=2097152]="IRUT_CORNERS",u[u.IRUT_CANDIDATE_QUAD_EDGES=4194304]="IRUT_CANDIDATE_QUAD_EDGES",u[u.IRUT_DETECTED_QUADS=8388608]="IRUT_DETECTED_QUADS",u[u.IRUT_LOCALIZED_TEXT_LINES=16777216]="IRUT_LOCALIZED_TEXT_LINES",u[u.IRUT_RECOGNIZED_TEXT_LINES=33554432]="IRUT_RECOGNIZED_TEXT_LINES",u[u.IRUT_NORMALIZED_IMAGES=67108864]="IRUT_NORMALIZED_IMAGES",u[u.IRUT_SHORT_LINES=134217728]="IRUT_SHORT_LINES",u[u.IRUT_ALL=268435455]="IRUT_ALL"}(ya||(ya={})),function(u){u[u.ROET_PREDETECTED_REGION=0]="ROET_PREDETECTED_REGION",u[u.ROET_LOCALIZED_BARCODE=1]="ROET_LOCALIZED_BARCODE",u[u.ROET_DECODED_BARCODE=2]="ROET_DECODED_BARCODE",u[u.ROET_LOCALIZED_TEXT_LINE=3]="ROET_LOCALIZED_TEXT_LINE",u[u.ROET_RECOGNIZED_TEXT_LINE=4]="ROET_RECOGNIZED_TEXT_LINE",u[u.ROET_DETECTED_QUAD=5]="ROET_DETECTED_QUAD",u[u.ROET_NORMALIZED_IMAGE=6]="ROET_NORMALIZED_IMAGE",u[u.ROET_SOURCE_IMAGE=7]="ROET_SOURCE_IMAGE",u[u.ROET_TARGET_ROI=8]="ROET_TARGET_ROI"}(sT||(sT={})),function(u){u[u.ST_NULL=0]="ST_NULL",u[u.ST_REGION_PREDETECTION=1]="ST_REGION_PREDETECTION",u[u.ST_BARCODE_LOCALIZATION=2]="ST_BARCODE_LOCALIZATION",u[u.ST_BARCODE_DECODING=3]="ST_BARCODE_DECODING",u[u.ST_TEXT_LINE_LOCALIZATION=4]="ST_TEXT_LINE_LOCALIZATION",u[u.ST_TEXT_LINE_RECOGNITION=5]="ST_TEXT_LINE_RECOGNITION",u[u.ST_DOCUMENT_DETECTION=6]="ST_DOCUMENT_DETECTION",u[u.ST_DOCUMENT_NORMALIZATION=7]="ST_DOCUMENT_NORMALIZATION"}(oT||(oT={}));const Ss="undefined"==typeof self,aT=Ss?{}:self,lT=(()=>{if(!Ss&&document.currentScript){let u=document.currentScript.src,a=u.indexOf("?");if(-1!=a)u=u.substring(0,a);else{let l=u.indexOf("#");-1!=l&&(u=u.substring(0,l))}return u.substring(0,u.lastIndexOf("/")+1)}return"./"})(),cT=u=>{if(null==u&&(u="./"),!Ss){let a=document.createElement("a");a.href=u,u=a.href}return u.endsWith("/")||(u+="/"),u},uT=u=>u&&"object"==typeof u&&"function"==typeof u.then;class Wm extends Promise{constructor(a){let l,f;super((g,p)=>{l=g,f=p}),this._s="pending",this.resolve=g=>{this.isPending&&(uT(g)?this.task=g:(this._s="fulfilled",l(g)))},this.reject=g=>{this.isPending&&(this._s="rejected",f(g))},this.task=a}get status(){return this._s}get isPending(){return"pending"===this._s}get isFulfilled(){return"fulfilled"===this._s}get isRejected(){return"rejected"===this._s}get task(){return this._task}set task(a){var l=this;let f;this._task=a,uT(a)?f=a:"function"==typeof a&&(f=new Promise(a)),f&&ae(function*(){try{const g=yield f;a===l._task&&l.resolve(g)}catch(g){a===l._task&&l.reject(g)}})()}get isEmpty(){return null==this._task}}const Xh=" is not allowed to change after `createInstance` or `loadWasm` is called.",oj=!Ss&&document.currentScript&&(document.currentScript.getAttribute("data-license")||document.currentScript.getAttribute("data-productKeys")||document.currentScript.getAttribute("data-licenseKey")||document.currentScript.getAttribute("data-handshakeCode")||document.currentScript.getAttribute("data-organizationID"))||"",hT=(u,a)=>{const l=u;if(!l._pLoad.isEmpty)throw new Error("`license`"+Xh);l._license=a};!Ss&&document.currentScript&&document.currentScript.getAttribute("data-sessionPassword");const dT=u=>{if(null==u)u=[];else{u=u instanceof Array?[...u]:[u];for(let a=0;a<u.length;++a){if(!Ss){let l=document.createElement("a");l.href=u[a],u[a]=l.href}u[a].endsWith("/")||(u[a]+="/")}}return u},fT=(u,a)=>{const l=u;if(!l._pLoad.isEmpty)throw new Error("`licenseServer`"+Xh);l._licenseServer=dT(a)},gT=(u,a)=>{const l=u;if(!l._pLoad.isEmpty)throw new Error("`deviceFriendlyName`"+Xh);l._deviceFriendlyName=a||""};let dc,fc,qh,zm,Zi;"undefined"!=typeof navigator&&(dc=navigator,fc=dc.userAgent,qh=dc.platform,zm=dc.mediaDevices),function(){if(!Ss){const u={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:dc.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},a={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:qh,search:"Win"},Mac:{str:qh},Linux:{str:qh}};let l="unknownBrowser",f=0,g="unknownOS";for(let p in u){const _=u[p]||{};let O=_.verStr||fc,M=_.verSearch||p;if(M instanceof Array||(M=[M]),-1!=(_.str||fc).indexOf(_.search||p)){l=p;for(let P of M){let k=O.indexOf(P);if(-1!=k){f=parseFloat(O.substring(k+P.length+1));break}}break}}for(let p in a){const _=a[p]||{};if(-1!=(_.str||fc).indexOf(_.search||p)){g=p;break}}"Linux"==g&&-1!=fc.indexOf("Windows NT")&&(g="HarmonyOS"),Zi={browser:l,version:f,OS:g}}Ss&&(Zi={browser:"ssr",version:0,OS:"ssr"})}();const pT=function(){var u=ae(function*(){return Er("license"),Yh("dynamsoft_inited",ae(function*(){let{lt:a,l,ls:f,sp:g,rmk:p,cv:_}=((O,M=!1)=>{const P=O;if(P._pLoad.isEmpty){let k,V,H,z=P._license||"",Y=JSON.parse(JSON.stringify(P._licenseServer)),X=P._sessionPassword,$=0;if(z.startsWith("t")||z.startsWith("f"))$=0;else if(0===z.length||z.startsWith("P")||z.startsWith("L")||z.startsWith("Y")||z.startsWith("A"))$=1;else{$=2;const K=z.indexOf(":");-1!=K&&(z=z.substring(K+1));const ge=z.indexOf("?");if(-1!=ge&&(V=z.substring(ge+1),z=z.substring(0,ge)),z.startsWith("DLC2"))$=0;else{if(z.startsWith("DLS2")){let _e;try{let Te=z.substring(4);Te=atob(Te),_e=JSON.parse(Te)}catch(Te){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if(z=_e.handshakeCode?_e.handshakeCode:_e.organizationID?_e.organizationID:"","number"==typeof z&&(z=JSON.stringify(z)),0===Y.length){let Te=[];_e.mainServerURL&&(Te[0]=_e.mainServerURL),_e.standbyServerURL&&(Te[1]=_e.standbyServerURL),Y=dT(Te)}!X&&_e.sessionPassword&&(X=_e.sessionPassword),k=_e.remark}z&&"200001"!==z&&!z.startsWith("200001-")||($=1)}}if($&&(M||(aT.crypto||(H="Please upgrade your browser to support online key."),aT.crypto.subtle||(H="Require https to use online key in this browser."))),H){if(1!==$)throw new Error(H);$=0,console.warn(H),P._lastErrorCode=-1,P._lastErrorString=H}return 1===$&&(z="",console.warn("Applying for a public trial license ...")),{lt:$,l:z,ls:Y,sp:X,rmk:k,cv:V}}throw new Error("Can't preprocess license again"+Xh)})(Ft),y=new Wm;Ft._pLoad.task=y,ae(function*(){try{yield Ft._pLoad}catch(O){}})();let b=Tt();Et[b]=O=>{if(O.message&&Ft._onAuthMessage){let k=Ft._onAuthMessage(O.message);null!=k&&(O.message=k)}let M,P=!1;if(1===a&&(P=!0),O.success?(bs&&bs("init license success"),O.message&&console.warn(O.message),Qt._bSupportIRTModule=O.bSupportIRTModule,Qt._bSupportDce4Module=O.bSupportDce4Module,Ft.bPassValidation=!0):(M=Error(O.message),O.stack&&(M.stack=O.stack),O.ltsErrorCode&&(M.ltsErrorCode=O.ltsErrorCode),P||111==O.ltsErrorCode&&-1!=O.message.toLowerCase().indexOf("trial license")&&(P=!0)),P){let k=Ke.license;Ke.rootDirectory&&(k=Ke.rootDirectory+"/"+k),k=cT(k),(V=ae(function*(H,z,Y){if(!H._bNeverShowDialog)try{let X=yield fetch(H.engineResourcePath+"dls.license.dialog.html");if(!X.ok)throw Error("Get license dialog fail. Network Error: "+X.statusText);let $=yield X.text();if(!$.trim().startsWith("<"))throw Error("Get license dialog fail. Can't get valid HTMLElement.");let K=document.createElement("div");K.innerHTML=$;let ge=[];for(let C=0;C<K.childElementCount;++C){let w=K.children[C];w instanceof HTMLStyleElement&&(ge.push(w),document.head.append(w))}let _e=1==K.childElementCount?K.children[0]:K;_e.remove();let Te,xe,F,Ee,ke,Qe=[_e],D=_e.children;for(let C of D)Qe.push(C);for(let C=0;C<Qe.length;++C)for(let w of Qe[C].children)Qe.push(w);for(let C of Qe)if(!Te&&C.classList.contains("dls-license-mask"))Te=C,C.addEventListener("click",w=>{if(C==w.target){_e.remove();for(let T of ge)T.remove()}});else if(!xe&&C.classList.contains("dls-license-icon-close"))xe=C,C.addEventListener("click",()=>{_e.remove();for(let w of ge)w.remove()});else if(!F&&C.classList.contains("dls-license-icon-error"))F=C,"error"!=z&&C.remove();else if(!Ee&&C.classList.contains("dls-license-icon-warn"))Ee=C,"warn"!=z&&C.remove();else if(!ke&&C.classList.contains("dls-license-msg-content")){ke=C;let w=Y;for(;w;){let T=w.indexOf("["),m=w.indexOf("]",T),v=w.indexOf("(",m),S=w.indexOf(")",v);if(-1==T||-1==m||-1==v||-1==S){C.appendChild(new Text(w));break}T>0&&C.appendChild(new Text(w.substring(0,T)));let A=document.createElement("a"),I=w.substring(T+1,m);A.innerText=I;let x=w.substring(v+1,S);A.setAttribute("href",x),A.setAttribute("target","_blank"),C.appendChild(A),w=w.substring(S+1)}}document.body.appendChild(_e)}catch(X){H._onLog&&H._onLog(X.message||X)}}),function(H,z,Y){return V.apply(this,arguments)})({_bNeverShowDialog:Ft._bNeverShowDialog,engineResourcePath:k,_onLog:bs},O.success?"warn":"error",O.message)}var V;O.success?y.resolve(void 0):y.reject(M)},yield QS("worker"),ht.postMessage({type:"dynamsoft",body:{v:"3.2.21",brtk:!!a,bptk:1===a,l,os:Zi,fn:Ft.deviceFriendlyName,ls:f,sp:g,rmk:p,cv:_},id:b}),Ft.bCallInitLicense=!0,yield y}))});return function(){return u.apply(this,arguments)}}();let mT;yn.license={},yn.license.dynamsoft=pT,yn.license.getAR=ae(function*(){{let u=Ri.dynamsoft_inited;u&&u.isRejected&&(yield u)}return ht?new Promise((u,a)=>{let l=Tt();Et[l]=function(){var f=ae(function*(g){if(g.success){delete g.success;{let p=Ft.license;p&&(p.startsWith("t")||p.startsWith("f"))&&(g.pk=p)}if(Object.keys(g).length){if(g.lem){let p=Error(g.lem);p.ltsErrorCode=g.lec,delete g.lem,delete g.lec,g.ae=p}u(g)}else u(null)}else{let p=Error(g.message);g.stack&&(p.stack=g.stack),a(p)}});return function(g){return f.apply(this,arguments)}}(),ht.postMessage({type:"getAR",id:l})}):null});class Ft{static setLicenseServer(a){fT(Ft,a)}static get license(){return this._license}static set license(a){hT(Ft,a)}static get licenseServer(){return this._licenseServer}static set licenseServer(a){fT(Ft,a)}static get deviceFriendlyName(){return this._deviceFriendlyName}static set deviceFriendlyName(a){gT(Ft,a)}static initLicense(a,l){if(hT(Ft,a),Ft.bCallInitLicense=!0,l)return pT()}static setDeviceFriendlyName(a){gT(Ft,a)}static getDeviceFriendlyName(){return Ft._deviceFriendlyName}static getDeviceUUID(){return ae(function*(){return yield Yh("dynamsoft_uuid",ae(function*(){yield Er();let a=new Wm,l=Tt();Et[l]=f=>{if(f.success)a.resolve(f.uuid);else{const g=Error(f.message);f.stack&&(g.stack=f.stack),a.reject(g)}},ht.postMessage({type:"getDeviceUUID",id:l}),mT=yield a})),mT})()}}Ft._pLoad=new Wm,Ft.bPassValidation=!1,Ft.bCallInitLicense=!1,Ft._license=oj,Ft._licenseServer=[],Ft._deviceFriendlyName="",null==Ke.license&&(Ke.license=lT),Ds.license={wasm:!0},yn.license.LicenseManager=Ft;const Ym="1.2.10";"string"!=typeof Ke.std&&oo(Ke.std.version,Ym)<0&&(Ke.std={version:Ym,path:cT(lT+`../../dynamsoft-capture-vision-std@${Ym}/dist/`)});const _T=u=>u&&"object"==typeof u&&"function"==typeof u.then;class Ca extends Promise{constructor(a){let l,f;super((g,p)=>{l=g,f=p}),this._s="pending",this.resolve=g=>{this.isPending&&(_T(g)?this.task=g:(this._s="fulfilled",l(g)))},this.reject=g=>{this.isPending&&(this._s="rejected",f(g))},this.task=a}get status(){return this._s}get isPending(){return"pending"===this._s}get isFulfilled(){return"fulfilled"===this._s}get isRejected(){return"rejected"===this._s}get task(){return this._task}set task(a){var l=this;let f;this._task=a,_T(a)?f=a:"function"==typeof a&&(f=new Promise(a)),f&&ae(function*(){try{const g=yield f;a===l._task&&l.resolve(g)}catch(g){a===l._task&&l.reject(g)}})()}get isEmpty(){return null==this._task}}class aj{constructor(a){this._cvr=a}getMaxBufferedItems(){var a=this;return ae(function*(){return yield new Promise((l,f)=>{let g=Tt();Et[g]=function(){var p=ae(function*(_){if(_.success)return l(_.count);{let y=new Error(_.message);return y.stack=_.stack+"\n"+y.stack,f(y)}});return function(_){return p.apply(this,arguments)}}(),ht.postMessage({type:"cvr_getMaxBufferedItems",id:g,instanceID:a._cvr._instanceID})})})()}setMaxBufferedItems(a){var l=this;return ae(function*(){return yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success)return f();{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_setMaxBufferedItems",id:p,instanceID:l._cvr._instanceID,body:{count:a}})})})()}getBufferedCharacterItemSet(){var a=this;return ae(function*(){return yield new Promise((l,f)=>{let g=Tt();Et[g]=function(){var p=ae(function*(_){if(_.success)return l(_.itemSet);{let y=new Error(_.message);return y.stack=_.stack+"\n"+y.stack,f(y)}});return function(_){return p.apply(this,arguments)}}(),ht.postMessage({type:"cvr_getBufferedCharacterItemSet",id:g,instanceID:a._cvr._instanceID})})})()}}var lj={onTaskResultsReceived:!1,onTaskResultsReceivedForDce:!1,onPredetectedRegionsReceived:!1,onLocalizedBarcodesReceived:!1,onDecodedBarcodesReceived:!1,onLocalizedTextLinesReceived:!1,onRecognizedTextLinesReceived:!1,onDetectedQuadsReceived:!1,onNormalizedImagesReceived:!1,onColourImageUnitReceived:!1,onScaledDownColourImageUnitReceived:!1,onGrayscaleImageUnitReceived:!1,onTransformedGrayscaleImageUnitReceived:!1,onEnhancedGrayscaleImageUnitReceived:!1,onBinaryImageUnitReceived:!1,onTextureDetectionResultUnitReceived:!1,onTextureRemovedGrayscaleImageUnitReceived:!1,onTextureRemovedBinaryImageUnitReceived:!1,onContoursUnitReceived:!1,onLineSegmentsUnitReceived:!1,onTextZonesUnitReceived:!1,onTextRemovedBinaryImageUnitReceived:!1,onLongLinesUnitReceived:!1,onCornersUnitReceived:!1,onCandidateQuadEdgesUnitReceived:!1,onCandidateBarcodeZonesUnitReceived:!1,onScaledUpBarcodeImageUnitReceived:!1,onDeformationResistedBarcodeImageUnitReceived:!1,onComplementedBarcodeImageUnitReceived:!1,onShortLinesUnitReceived:!1};const vT=(u,a)=>{for(let l in a._irrRegistryState)a._irrRegistryState[l]=!1;for(let l of u._intermediateResultReceiverSet)if(l.isDce)a._irrRegistryState.onTaskResultsReceivedForDce=!0;else for(let f in l)a._irrRegistryState[f]||(a._irrRegistryState[f]=!!l[f])};class cj{constructor(a){this._irrRegistryState=lj,this._cvr=a}addResultReceiver(a){var l=this;return ae(function*(){if("object"!=typeof a)throw new Error("Invalid receiver.");l._cvr._intermediateResultReceiverSet.add(a),vT(l._cvr,l);let f=-1,g={};if(!a.isDce){if(!a._observedResultUnitTypes||!a._observedTaskMap)throw new Error("Invalid Intermediate Result Receiver.");f=a._observedResultUnitTypes,a._observedTaskMap.forEach((p,_)=>{g[_]=p}),a._observedTaskMap.clear()}return yield new Promise((p,_)=>{let y=Tt();Et[y]=function(){var b=ae(function*(O){if(O.success)return p();{let M=new Error(O.message);return M.stack=O.stack+"\n"+M.stack,_(M)}});return function(O){return b.apply(this,arguments)}}(),ht.postMessage({type:"cvr_setIrrRegistry",id:y,instanceID:l._cvr._instanceID,body:{receiverObj:l._irrRegistryState,observedResultUnitTypes:String(f),observedTaskMap:g}})})})()}removeResultReceiver(a){var l=this;return ae(function*(){return l._cvr._intermediateResultReceiverSet.delete(a),vT(l._cvr,l),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success)return f();{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_setIrrRegistry",id:p,instanceID:l._cvr._instanceID,body:{receiverObj:l._irrRegistryState}})})})()}getOriginalImage(){return this._cvr._dsImage}}const yT="undefined"==typeof self,$m=(()=>{if(!yT&&document.currentScript){let u=document.currentScript.src,a=u.indexOf("?");if(-1!=a)u=u.substring(0,a);else{let l=u.indexOf("#");-1!=l&&(u=u.substring(0,l))}return u.substring(0,u.lastIndexOf("/")+1)}return"./"})(),CT=u=>{if(null==u&&(u="./"),!yT){let a=document.createElement("a");a.href=u,u=a.href}return u.endsWith("/")||(u+="/"),u};var Xm;null==Ke.cvr&&(Ke.cvr=$m),Ds.cvr={js:!0,wasm:!0,deps:["license","dip"]},yn.cvr={};const qm="1.2.10";"string"!=typeof Ke.std&&oo(Ke.std.version,qm)<0&&(Ke.std={version:qm,path:CT($m+`../../dynamsoft-capture-vision-std@${qm}/dist/`)});const Zm="2.2.30";(!Ke.dip||"string"!=typeof Ke.dip&&oo(Ke.dip.version,Zm)<0)&&(Ke.dip={version:Zm,path:CT($m+`../../dynamsoft-image-processing@${Zm}/dist/`)});class ET{static getVersion(){return this._version}}var Zh,wT;function bT(u,a){if(u&&u.location){const l=u.location.points;for(let f of l)f.x=f.x/a,f.y=f.y/a;bT(u.referencedItem,a)}}ET._version=`2.2.30(Worker: ${null===(Xm=co.cvr)||void 0===Xm?void 0:Xm.worker}, Wasm: loading...`,function(u){u[u.ISS_BUFFER_EMPTY=0]="ISS_BUFFER_EMPTY",u[u.ISS_EXHAUSTED=1]="ISS_EXHAUSTED"}(Zh||(Zh={})),function(u){u[u.IRUT_NULL=0]="IRUT_NULL",u[u.IRUT_COLOUR_IMAGE=1]="IRUT_COLOUR_IMAGE",u[u.IRUT_SCALED_DOWN_COLOUR_IMAGE=2]="IRUT_SCALED_DOWN_COLOUR_IMAGE",u[u.IRUT_GRAYSCALE_IMAGE=4]="IRUT_GRAYSCALE_IMAGE",u[u.IRUT_TRANSOFORMED_GRAYSCALE_IMAGE=8]="IRUT_TRANSOFORMED_GRAYSCALE_IMAGE",u[u.IRUT_ENHANCED_GRAYSCALE_IMAGE=16]="IRUT_ENHANCED_GRAYSCALE_IMAGE",u[u.IRUT_PREDETECTED_REGIONS=32]="IRUT_PREDETECTED_REGIONS",u[u.IRUT_BINARY_IMAGE=64]="IRUT_BINARY_IMAGE",u[u.IRUT_TEXTURE_DETECTION_RESULT=128]="IRUT_TEXTURE_DETECTION_RESULT",u[u.IRUT_TEXTURE_REMOVED_GRAYSCALE_IMAGE=256]="IRUT_TEXTURE_REMOVED_GRAYSCALE_IMAGE",u[u.IRUT_TEXTURE_REMOVED_BINARY_IMAGE=512]="IRUT_TEXTURE_REMOVED_BINARY_IMAGE",u[u.IRUT_CONTOURS=1024]="IRUT_CONTOURS",u[u.IRUT_LINE_SEGMENTS=2048]="IRUT_LINE_SEGMENTS",u[u.IRUT_TEXT_ZONES=4096]="IRUT_TEXT_ZONES",u[u.IRUT_TEXT_REMOVED_BINARY_IMAGE=8192]="IRUT_TEXT_REMOVED_BINARY_IMAGE",u[u.IRUT_CANDIDATE_BARCODE_ZONES=16384]="IRUT_CANDIDATE_BARCODE_ZONES",u[u.IRUT_LOCALIZED_BARCODES=32768]="IRUT_LOCALIZED_BARCODES",u[u.IRUT_SCALED_UP_BARCODE_IMAGE=65536]="IRUT_SCALED_UP_BARCODE_IMAGE",u[u.IRUT_DEFORMATION_RESISTED_BARCODE_IMAGE=131072]="IRUT_DEFORMATION_RESISTED_BARCODE_IMAGE",u[u.IRUT_COMPLEMENTED_BARCODE_IMAGE=262144]="IRUT_COMPLEMENTED_BARCODE_IMAGE",u[u.IRUT_DECODED_BARCODES=524288]="IRUT_DECODED_BARCODES",u[u.IRUT_LONG_LINES=1048576]="IRUT_LONG_LINES",u[u.IRUT_CORNERS=2097152]="IRUT_CORNERS",u[u.IRUT_CANDIDATE_QUAD_EDGES=4194304]="IRUT_CANDIDATE_QUAD_EDGES",u[u.IRUT_DETECTED_QUADS=8388608]="IRUT_DETECTED_QUADS",u[u.IRUT_LOCALIZED_TEXT_LINES=16777216]="IRUT_LOCALIZED_TEXT_LINES",u[u.IRUT_RECOGNIZED_TEXT_LINES=33554432]="IRUT_RECOGNIZED_TEXT_LINES",u[u.IRUT_NORMALIZED_IMAGES=67108864]="IRUT_NORMALIZED_IMAGES",u[u.IRUT_SHORT_LINES=134217728]="IRUT_SHORT_LINES",u[u.IRUT_ALL=134217727]="IRUT_ALL"}(wT||(wT={}));class wt{constructor(){this.maxCvsSideLength=["iPhone","Android","HarmonyOS"].includes(Qt.browserInfo.OS)?2048:4096,this._isa=null,this._dsImage=null,this._instanceID=void 0,this._bPauseScan=!0,this._bNeedOutputOriginalImage=!1,this._canvas=null,this._resultReceiverSet=new Set,this._isaStateListenerSet=new Set,this._resultFilterSet=new Set,this._intermediateResultReceiverSet=new Set,this._intermediateResultManager=null,this._bufferdItemsManager=null,this._bOpenDetectVerify=!1,this._bOpenNormalizeVerify=!1,this._bOpenBarcodeVerify=!1,this._bOpenLabelVerify=!1,this._minImageCaptureInterval=0,this._averageProcessintTimeArray=[],this._averageFetchImageTimeArray=[],this._currentSettings=null,this._averageTime=999,this._compressRate=0,this._dynamsoft=!1,this.captureInParallel=!0,this.bDestroyed=!1,this._singleFrameModeCallbackBind=this._singleFrameModeCallback.bind(this),this._promiseStartScan=null}get disposed(){return this.bDestroyed}static createInstance(){return ae(function*(){if(!yn.license)throw Error("Module `license` is not existed.");yield yn.license.dynamsoft(),yield Er(["cvr"]);const a=new wt,l=new Ca;let f=Tt();return Et[f]=function(){var g=ae(function*(p){var _;if(p.success)a._instanceID=p.instanceID,a._currentSettings=JSON.parse(p.outputSettings),ET._version=`2.2.30(Worker: ${null===(_=co.cvr)||void 0===_?void 0:_.worker}, Wasm: ${p.version})`,0===Qt.bSupportDce4Module&&(a._intermediateResultManager=a.getIntermediateResultManager(!0)),l.resolve(a);else{const y=Error(p.message);p.stack&&(y.stack=p.stack),l.reject(y)}});return function(p){return g.apply(this,arguments)}}(),ht.postMessage({type:"cvr_createInstance",id:f}),l})()}_singleFrameModeCallback(a){var l=this;return ae(function*(){l._isa.getCameraView().setScanLaserVisible(!0);for(let _ of l._resultReceiverSet)l._bNeedOutputOriginalImage&&_.onOriginalImageResultReceived&&_.onOriginalImageResultReceived({imageData:a});const f={bytes:new Uint8Array(a.bytes),width:a.width,height:a.height,stride:a.stride,format:a.format,tag:a.tag};l._templateName||(l._templateName=l._currentSettings.CaptureVisionTemplates[0].Name);const g=yield l.capture(f,l._templateName);g.originalImageTag=a.tag;for(let _ of l._resultReceiverSet)_.isDce&&_.onCapturedResultReceived(g,{isDetectVerifyOpen:!1,isNormalizeVerifyOpen:!1,isBarcodeVerifyOpen:!1,isLabelVerifyOpen:!1});const p={originalImageHashId:g.originalImageHashId,originalImageTag:g.originalImageTag,errorCode:g.errorCode,errorString:g.errorString};for(let _ of l._resultReceiverSet)if(_.onDecodedBarcodesReceived&&g.barcodeResultItems&&_.onDecodedBarcodesReceived(Object.assign(Object.assign({},p),{barcodeResultItems:g.barcodeResultItems})),_.onRecognizedTextLinesReceived&&g.textLineResultItems&&_.onRecognizedTextLinesReceived(Object.assign(Object.assign({},p),{textLineResultItems:g.textLineResultItems})),_.onDetectedQuadsReceived&&g.detectedQuadResultItems&&_.onDetectedQuadsReceived(Object.assign(Object.assign({},p),{detectedQuadResultItems:g.detectedQuadResultItems})),_.onNormalizedImagesReceived&&g.normalizedImageResultItems&&_.onNormalizedImagesReceived(Object.assign(Object.assign({},p),{normalizedImageResultItems:g.normalizedImageResultItems})),_.onParsedResultsReceived&&g.parsedResultItems&&_.onParsedResultsReceived(Object.assign(Object.assign({},p),{parsedResultItems:g.parsedResultItems})),_.onCapturedResultReceived&&!_.isDce){if(l._bNeedOutputOriginalImage){const y=g.items.findIndex(b=>1===b.type);-1!==y&&(g.items[y].imageData=a)}_.onCapturedResultReceived(g)}})()}setInput(a){if(this._checkIsDisposed(),a){if(this._isa=a,a.isCameraEnhancer){this._intermediateResultManager&&(this._isa._intermediateResultReceiver.isDce=!0,this._intermediateResultManager.addResultReceiver(this._isa._intermediateResultReceiver));const l=this._isa.getCameraView();if(l){const f=l._capturedResultReceiver;f.isDce=!0,this._resultReceiverSet.add(f)}}}else this._isa=null}getInput(){return this._isa}addImageSourceStateListener(a){if(this._checkIsDisposed(),"object"!=typeof a)return console.warn("Invalid ISA state listener.");a&&Object.keys(a)&&this._isaStateListenerSet.add(a)}removeImageSourceStateListener(a){return this._checkIsDisposed(),this._isaStateListenerSet.delete(a)}addResultReceiver(a){if(this._checkIsDisposed(),"object"!=typeof a)throw new Error("Invalid receiver.");a&&Object.keys(a).length&&(this._resultReceiverSet.add(a),this._setCrrRegistry())}removeResultReceiver(a){this._checkIsDisposed(),this._resultReceiverSet.delete(a),this._setCrrRegistry()}_setCrrRegistry(){var a=this;return ae(function*(){const l={onCapturedResultReceived:!1,onDecodedBarcodesReceived:!1,onRecognizedTextLinesReceived:!1,onDetectedQuadsReceived:!1,onNormalizedImagesReceived:!1,onParsedResultsReceived:!1};for(let p of a._resultReceiverSet)p.isDce||(l.onCapturedResultReceived=!!p.onCapturedResultReceived,l.onDecodedBarcodesReceived=!!p.onDecodedBarcodesReceived,l.onRecognizedTextLinesReceived=!!p.onRecognizedTextLinesReceived,l.onDetectedQuadsReceived=!!p.onDetectedQuadsReceived,l.onNormalizedImagesReceived=!!p.onNormalizedImagesReceived,l.onParsedResultsReceived=!!p.onParsedResultsReceived);const f=new Ca;let g=Tt();return Et[g]=function(){var p=ae(function*(_){if(_.success)f.resolve();else{let y=new Error(_.message);y.stack=_.stack+"\n"+y.stack,f.reject()}});return function(_){return p.apply(this,arguments)}}(),ht.postMessage({type:"cvr_setCrrRegistry",id:g,instanceID:a._instanceID,body:{receiver:JSON.stringify(l)}}),f})()}addResultFilter(a){var l=this;return ae(function*(){if(l._checkIsDisposed(),"object"!=typeof a)return console.warn("Invalid filter.");if(a&&Object.keys(a)){l._resultFilterSet.add(a),l._handleFilterSwitch();for(let f of l._resultFilterSet)yield l._enableResultCrossVerification(f.verificationEnabled),yield l._enableResultDeduplication(f.duplicateFilterEnabled),yield l._setDuplicateForgetTime(f.duplicateForgetTime)}})()}removeResultFilter(a){var l=this;return ae(function*(){l._checkIsDisposed(),l._resultFilterSet.delete(a),l._handleFilterSwitch();for(let f of l._resultFilterSet)yield l._enableResultCrossVerification(f.verificationEnabled),yield l._enableResultDeduplication(f.duplicateFilterEnabled),yield l._setDuplicateForgetTime(f.duplicateForgetTime)})()}_handleFilterSwitch(){this._bOpenBarcodeVerify=!1,this._bOpenLabelVerify=!1,this._bOpenDetectVerify=!1,this._bOpenNormalizeVerify=!1;for(let a of this._resultFilterSet)a.isResultCrossVerificationEnabled(Jt.CRIT_BARCODE)&&(this._bOpenBarcodeVerify=!0),a.isResultCrossVerificationEnabled(Jt.CRIT_TEXT_LINE)&&(this._bOpenLabelVerify=!0),a.isResultCrossVerificationEnabled(Jt.CRIT_DETECTED_QUAD)&&(this._bOpenDetectVerify=!0),a.isResultCrossVerificationEnabled(Jt.CRIT_NORMALIZED_IMAGE)&&(this._bOpenNormalizeVerify=!0)}startCapturing(a){var l=this;return ae(function*(){var f,g;if(l._checkIsDisposed(),!l._bPauseScan)return;if(!l._isa)throw new Error("'ImageSourceAdapter' is not set. call 'setInput' before 'startCapturing'");a||(a=l._currentSettings.CaptureVisionTemplates[0].Name);const p=yield l.containsTask(a);return yield Er(p),p.includes("dlr")&&!(null===(f=yn.dlr)||void 0===f?void 0:f.bLoadConfusableCharsData)&&(yield null===(g=yn.dlr)||void 0===g?void 0:g.loadRecognitionData("ConfusableChars",Ke.dlr)),l._isa.isCameraEnhancer&&(p.includes("ddn")?l._isa.setPixelFormat(Ve.IPF_ABGR_8888):l._isa.setPixelFormat(Ve.IPF_GRAYSCALED)),void 0!==l._isa.singleFrameMode&&"disabled"!==l._isa.singleFrameMode?(l._templateName=a,void l._isa.on("singleFrameAcquired",l._singleFrameModeCallbackBind)):(l._isa.getColourChannelUsageType()===Cr.CCUT_AUTO&&l._isa.setColourChannelUsageType(p.includes("ddn")?Cr.CCUT_FULL_CHANNEL:Cr.CCUT_Y_CHANNEL_ONLY),l._promiseStartScan&&l._promiseStartScan.isPending?l._promiseStartScan:(l._promiseStartScan=new Ca((_,y)=>{if(l.disposed)return;let b=Tt();Et[b]=function(){var O=ae(function*(M){if(l._promiseStartScan&&!l._promiseStartScan.isFulfilled){if(!M.success){let P=new Error(M.message);return P.stack=M.stack+"\n"+P.stack,y(P)}for(let P of l._resultFilterSet)yield l.addResultFilter(P);l._bPauseScan=!1,l._bNeedOutputOriginalImage=M.bNeedOutputOriginalImage,l._loopReadVideoTimeoutId&&clearTimeout(l._loopReadVideoTimeoutId),l._loopReadVideoTimeoutId=setTimeout(ae(function*(){-1!==l._minImageCaptureInterval&&l._isa.startFetching(),l._loopReadVideo(a),_()}),0),l._isa.isCameraEnhancer&&l._isa.getCameraView().setScanLaserVisible(!0)}});return function(M){return O.apply(this,arguments)}}(),ht.postMessage({type:"cvr_startCapturing",id:b,instanceID:l._instanceID,body:{templateName:a}})}),yield l._promiseStartScan))})()}stopCapturing(){this._checkIsDisposed(),this._isa&&(this._isa.isCameraEnhancer&&(this._isa.getCameraView().setScanLaserVisible(!1),void 0!==this._isa.singleFrameMode&&"disabled"!==this._isa.singleFrameMode)?this._isa.off("singleFrameAcquired",this._singleFrameModeCallbackBind):(this._isa.stopFetching(),this._clearVerifyList(),this._averageProcessintTimeArray=[],this._averageTime=999,this._bPauseScan=!0,this._promiseStartScan=null,this._isa.setColourChannelUsageType(Cr.CCUT_AUTO)))}_clearVerifyList(){var a=this;return ae(function*(){let l=Tt();const f=new Ca;return Et[l]=function(){var g=ae(function*(p){if(p.success)return f.resolve();{let _=new Error(p.message);return _.stack=p.stack+"\n"+_.stack,f.reject(_)}});return function(p){return g.apply(this,arguments)}}(),ht.postMessage({type:"cvr_clearVerifyList",id:l,instanceID:a._instanceID}),f})()}_getIntermediateResult(){var a=this;return ae(function*(){a._checkIsDisposed();let l=Tt();const f=new Ca;return Et[l]=function(){var g=ae(function*(p){if(p.success)f.resolve(p.result);else{let _=new Error(p.message);_.stack=p.stack+"\n"+_.stack,f.reject(_)}});return function(p){return g.apply(this,arguments)}}(),ht.postMessage({type:"cvr_getIntermediateResult",id:l,instanceID:a._instanceID}),f})()}containsTask(a){var l=this;return ae(function*(){return l._checkIsDisposed(),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success)return f(JSON.parse(y.tasks));{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_containsTask",id:p,instanceID:l._instanceID,body:{templateName:a}})})})()}_loopReadVideo(a){var l=this;return ae(function*(){if(l._dynamsoft=!0,l.disposed||l._bPauseScan)return;if(l._isa.isBufferEmpty())if(l._isa.hasNextImageToFetch())for(let g of l._isaStateListenerSet)g.onImageSourceStateReceived&&g.onImageSourceStateReceived(Zh.ISS_BUFFER_EMPTY);else if(!l._isa.hasNextImageToFetch())for(let g of l._isaStateListenerSet)g.onImageSourceStateReceived&&g.onImageSourceStateReceived(Zh.ISS_EXHAUSTED);if(-1===l._minImageCaptureInterval||l._isa.isBufferEmpty())try{l._isa.isBufferEmpty()&&wt._onLog&&wt._onLog("buffer is empty so fetch image"),wt._onLog&&wt._onLog(`DCE: start fetching a frame: ${Date.now()}`),l._dsImage=l._isa.fetchImage(),wt._onLog&&wt._onLog(`DCE: finish fetching a frame: ${Date.now()}`),l._isa.setImageFetchInterval(l._averageTime)}catch(g){return void l._reRunCurrnetFunc(a)}else if(l._isa.setImageFetchInterval(l._averageTime-(l._dsImage&&l._dsImage.tag?l._dsImage.tag.timeSpent:0)),l._dsImage=l._isa.getImage(),l._dsImage.tag&&Date.now()-l._dsImage.tag.timeStamp>200)return void l._reRunCurrnetFunc(a);if(!l._dsImage)return void l._reRunCurrnetFunc(a);for(let g of l._resultReceiverSet)l._bNeedOutputOriginalImage&&g.onOriginalImageResultReceived&&g.onOriginalImageResultReceived({imageData:l._dsImage});const f=Date.now();l._captureDsimage(l._dsImage,a).then(function(){var g=ae(function*(p){if(wt._onLog&&wt._onLog("no js handle time: "+(Date.now()-f)),l._bPauseScan)return void l._reRunCurrnetFunc(a);p.originalImageTag=l._dsImage.tag?l._dsImage.tag:null;for(let b of l._resultReceiverSet)if(b.isDce){const O=Date.now();if(b.onCapturedResultReceived(p,{isDetectVerifyOpen:l._bOpenDetectVerify,isNormalizeVerifyOpen:l._bOpenNormalizeVerify,isBarcodeVerifyOpen:l._bOpenBarcodeVerify,isLabelVerifyOpen:l._bOpenLabelVerify}),wt._onLog){const M=Date.now()-O;M>10&&wt._onLog(`draw result time: ${M}`)}}const _={originalImageHashId:p.originalImageHashId,originalImageTag:p.originalImageTag,errorCode:p.errorCode,errorString:p.errorString};for(let b of l._resultReceiverSet)b.onDecodedBarcodesReceived&&p.barcodeResultItems&&b.onDecodedBarcodesReceived(Object.assign(Object.assign({},_),{barcodeResultItems:p.barcodeResultItems.filter(O=>!O.isFilter)})),b.onRecognizedTextLinesReceived&&p.textLineResultItems&&b.onRecognizedTextLinesReceived(Object.assign(Object.assign({},_),{textLineResultItems:p.textLineResultItems.filter(O=>!O.isFilter)})),b.onDetectedQuadsReceived&&p.detectedQuadResultItems&&b.onDetectedQuadsReceived(Object.assign(Object.assign({},_),{detectedQuadResultItems:p.detectedQuadResultItems.filter(O=>!O.isFilter)})),b.onNormalizedImagesReceived&&p.normalizedImageResultItems&&b.onNormalizedImagesReceived(Object.assign(Object.assign({},_),{normalizedImageResultItems:p.normalizedImageResultItems.filter(O=>!O.isFilter)})),b.onParsedResultsReceived&&p.parsedResultItems&&b.onParsedResultsReceived(Object.assign(Object.assign({},_),{parsedResultItems:p.parsedResultItems.filter(O=>!O.isFilter)})),b.onCapturedResultReceived&&!b.isDce&&(p.items=p.items.filter(O=>!O.isFilter),p.barcodeResultItems&&(p.barcodeResultItems=p.barcodeResultItems.filter(O=>!O.isFilter)),p.textLineResultItems&&(p.textLineResultItems=p.textLineResultItems.filter(O=>!O.isFilter)),p.detectedQuadResultItems&&(p.detectedQuadResultItems=p.detectedQuadResultItems.filter(O=>!O.isFilter)),p.normalizedImageResultItems&&(p.normalizedImageResultItems=p.normalizedImageResultItems.filter(O=>!O.isFilter)),p.parsedResultItems&&(p.parsedResultItems=p.parsedResultItems.filter(O=>!O.isFilter)),b.onCapturedResultReceived(p));const y=Date.now();if(l._minImageCaptureInterval>-1&&(5===l._averageProcessintTimeArray.length&&l._averageProcessintTimeArray.shift(),5===l._averageFetchImageTimeArray.length&&l._averageFetchImageTimeArray.shift(),l._averageProcessintTimeArray.push(Date.now()-f),l._averageFetchImageTimeArray.push(l._dsImage&&l._dsImage.tag?l._dsImage.tag.timeSpent:0),l._averageTime=Math.min(...l._averageProcessintTimeArray)-Math.max(...l._averageFetchImageTimeArray),l._averageTime=l._averageTime>0?l._averageTime:0,wt._onLog&&(wt._onLog(`minImageCaptureInterval: ${l._minImageCaptureInterval}`),wt._onLog(`averageProcessintTimeArray: ${l._averageProcessintTimeArray}`),wt._onLog(`averageFetchImageTimeArray: ${l._averageFetchImageTimeArray}`),wt._onLog(`averageTime: ${l._averageTime}`))),wt._onLog){const b=Date.now()-y;b>10&&wt._onLog(`fetch image calculate time: ${b}`)}wt._onLog&&wt._onLog(`time finish decode: ${Date.now()}`),wt._onLog&&wt._onLog("main time: "+(Date.now()-f)),wt._onLog&&wt._onLog("===================================================="),l._loopReadVideoTimeoutId&&clearTimeout(l._loopReadVideoTimeoutId),l._loopReadVideoTimeoutId=l._minImageCaptureInterval>0&&l._minImageCaptureInterval>=l._averageTime?setTimeout(()=>{l._loopReadVideo(a)},l._minImageCaptureInterval-l._averageTime):setTimeout(()=>{l._loopReadVideo(a)},Math.max(l._minImageCaptureInterval,0))});return function(p){return g.apply(this,arguments)}}()).catch(g=>{l._isa.stopFetching(),l._loopReadVideoTimeoutId&&clearTimeout(l._loopReadVideoTimeoutId),l._loopReadVideoTimeoutId=setTimeout(()=>{l._isa.startFetching(),l._loopReadVideo(a)},Math.max(l._minImageCaptureInterval,1e3)),"platform error"!==g.message&&setTimeout(()=>{throw g},0)})})()}_reRunCurrnetFunc(a){this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo(a)},0)}capture(a,l){var f=this;return ae(function*(){var g,p;f._checkIsDisposed(),l||(l=f._currentSettings.CaptureVisionTemplates[0].Name);const _=yield f.containsTask(l);let y;if(yield Er(_),_.includes("dlr")&&!(null===(g=yn.dlr)||void 0===g?void 0:g.bLoadConfusableCharsData)&&(yield null===(p=yn.dlr)||void 0===p?void 0:p.loadRecognitionData("ConfusableChars",Ke.dlr)),f._dynamsoft=!1,YS(a))y=yield f._captureDsimage(a,l);else if("string"==typeof a)y="data:image/"==a.substring(0,11)?yield f._captureBase64(a,l):yield f._captureUrl(a,l);else if(a instanceof Blob)y=yield f._captureBlob(a,l);else if(a instanceof HTMLImageElement)y=yield f._captureImage(a,l);else if(a instanceof HTMLCanvasElement)y=yield f._captureCanvas(a,l);else{if(!(a instanceof HTMLVideoElement))throw new TypeError("'capture(imageOrFile, templateName)': Type of 'imageOrFile' should be 'DSImageData', 'Url', 'Base64', 'Blob', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement'.");y=yield f._captureVideo(a,l)}return y})()}_captureDsimage(a,l){var f=this;return ae(function*(){return yield f._captureInWorker(a,l)})()}_captureUrl(a,l){var f=this;return ae(function*(){let g=yield $S(a,"blob");return yield f._captureBlob(g,l)})()}_captureBase64(a,l){var f=this;return ae(function*(){a=a.substring(a.indexOf(",")+1);let g=atob(a),p=g.length,_=new Uint8Array(p);for(;p--;)_[p]=g.charCodeAt(p);return yield f._captureBlob(new Blob([_]),l)})()}_captureBlob(a,l){var f=this;return ae(function*(){let g=null,p=null;if("undefined"!=typeof createImageBitmap)try{g=yield createImageBitmap(a)}catch(y){}var y;g||(p=yield(y=ae(function*(b){return yield new Promise((O,M)=>{let P=URL.createObjectURL(b),k=new Image;k.src=P,k.onload=()=>{URL.revokeObjectURL(k.dbrObjUrl),O(k)},k.onerror=V=>{M(new Error("Can't convert blob to image : "+(V instanceof Event?V.type:V)))}})}),function(b){return y.apply(this,arguments)})(a));let _=yield f._captureImage(g||p,l);return g&&g.close(),_})()}_captureImage(a,l){var f=this;return ae(function*(){let g,p,_=a instanceof HTMLImageElement?a.naturalWidth:a.width,y=a instanceof HTMLImageElement?a.naturalHeight:a.height,b=Math.max(_,y);b>f.maxCvsSideLength?(f._compressRate=f.maxCvsSideLength/b,g=Math.round(_*f._compressRate),p=Math.round(y*f._compressRate)):(g=_,p=y),f._canvas||(f._canvas=document.createElement("canvas"));const O=f._canvas;return O.width===g&&O.height===p||(O.width=g,O.height=p),O.ctx2d||(O.ctx2d=O.getContext("2d",{willReadFrequently:!0})),O.ctx2d.drawImage(a,0,0,_,y,0,0,g,p),a.dbrObjUrl&&URL.revokeObjectURL(a.dbrObjUrl),yield f._captureCanvas(O,l)})()}_captureCanvas(a,l){var f=this;return ae(function*(){if(a.crossOrigin&&"anonymous"!=a.crossOrigin)throw"cors";if([a.width,a.height].includes(0))throw Error("The width or height of the 'canvas' is 0.");const g=a.ctx2d||a.getContext("2d",{willReadFrequently:!0}),p={bytes:Uint8Array.from(g.getImageData(0,0,a.width,a.height).data),width:a.width,height:a.height,stride:4*a.width,format:10};return yield f._captureInWorker(p,l)})()}_captureVideo(a,l){var f=this;return ae(function*(){if(a.crossOrigin&&"anonymous"!=a.crossOrigin)throw"cors";let g,p,_=a.videoWidth,y=a.videoHeight,b=Math.max(_,y);b>f.maxCvsSideLength?(f._compressRate=f.maxCvsSideLength/b,g=Math.round(_*f._compressRate),p=Math.round(y*f._compressRate)):(g=_,p=y),f._canvas||(f._canvas=document.createElement("canvas"));const O=f._canvas;return O.width===g&&O.height===p||(O.width=g,O.height=p),O.ctx2d||(O.ctx2d=O.getContext("2d",{willReadFrequently:!0})),O.ctx2d.drawImage(a,0,0,_,y,0,0,g,p),yield f._captureCanvas(O,l)})()}_captureInWorker(a,l){var f=this;return ae(function*(){const{bytes:g,width:p,height:_,stride:y,format:b}=a;let O=Tt();const M=new Ca;return Et[O]=function(){var P=ae(function*(k){var V,H;if(!k.success){let z=new Error(k.message);return z.stack=k.stack+"\n"+z.stack,M.reject(z)}{const z=Date.now();wt._onLog&&(wt._onLog(`get result time from worker: ${z}`),wt._onLog("worker to main time consume: "+(z-k.workerReturnMsgTime)));try{const Y=k.captureResult;a.bytes=k.bytes;for(let $ of Y.items)0!==f._compressRate&&bT($,f._compressRate),$.type===Jt.CRIT_ORIGINAL_IMAGE?$.imageData=a:$.type===Jt.CRIT_NORMALIZED_IMAGE?null===(V=yn.ddn)||void 0===V||V.handleNormalizedImageResultItem($):$.type===Jt.CRIT_PARSED_RESULT&&(null===(H=yn.dcp)||void 0===H||H.handleParsedResultItem($));if(f._dynamsoft)for(let $ of f._resultFilterSet)$.onDecodedBarcodesReceived(Y.items),$.onRecognizedTextLinesReceived(Y.items),$.onDetectedQuadsReceived(Y.items),$.onNormalizedImagesReceived(Y.items);const X=function($){const K={barcodeResultItems:[],textLineResultItems:[],detectedQuadResultItems:[],normalizedImageResultItems:[],parsedResultItems:[]};return $.items.forEach(ge=>{ge.type===Jt.CRIT_BARCODE?K.barcodeResultItems.push(ge):ge.type===Jt.CRIT_TEXT_LINE?K.textLineResultItems.push(ge):ge.type===Jt.CRIT_DETECTED_QUAD?K.detectedQuadResultItems.push(ge):ge.type===Jt.CRIT_NORMALIZED_IMAGE?K.normalizedImageResultItems.push(ge):ge.type===Jt.CRIT_PARSED_RESULT&&K.parsedResultItems.push(ge)}),K}(Y);if(X.barcodeResultItems.length&&(Y.barcodeResultItems=X.barcodeResultItems),X.textLineResultItems.length&&(Y.textLineResultItems=X.textLineResultItems),X.detectedQuadResultItems.length&&(Y.detectedQuadResultItems=X.detectedQuadResultItems),X.normalizedImageResultItems.length&&(Y.normalizedImageResultItems=X.normalizedImageResultItems),X.parsedResultItems.length&&(Y.parsedResultItems=X.parsedResultItems),!f._bPauseScan||!f._dynamsoft){const $=Y.intermediateResult;if($){let K=0;for(let ge of f._intermediateResultReceiverSet){K++;for(let _e of $){if("onTaskResultsReceived"===_e.info.callbackName){for(let Te of _e.intermediateResultUnits)Te.originalImageTag=a.tag?a.tag:null;ge[_e.info.callbackName]&&ge[_e.info.callbackName]({intermediateResultUnits:_e.intermediateResultUnits},_e.info)}else ge[_e.info.callbackName]&&ge[_e.info.callbackName](_e.result,_e.info);K===f._intermediateResultReceiverSet.size&&delete _e.info.callbackName}}}Y&&Y.intermediateResult&&delete Y.intermediateResult}return f._compressRate=0,M.resolve(Y)}catch(Y){return M.reject(Y)}}});return function(k){return P.apply(this,arguments)}}(),wt._onLog&&wt._onLog(`send buffer to worker: ${Date.now()}`),ht.postMessage({type:"cvr_capture",id:O,instanceID:f._instanceID,body:{bytes:g,width:p,height:_,stride:y,format:b,templateName:l||"",dynamsoft:f._dynamsoft}},[g.buffer]),M})()}initSettings(a){var l=this;return ae(function*(){return l._checkIsDisposed(),a&&["string","object"].includes(typeof a)?("string"==typeof a?a.startsWith("{")?l._currentSettings=JSON.parse(a):a=yield $S(a,"text"):"object"==typeof a&&(l._currentSettings=a,a=JSON.stringify(a)),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success){const b=JSON.parse(y.response);if(0!==b.exception){let P=new Error(b.description?b.description:"Init Settings Failed.");return P.errorCode=b.exception,g(P)}let O=[],M=JSON.parse(a).CaptureVisionTemplates;for(let P=0;P<M.length;P++){let k=yield l.containsTask(M[P].Name);O=O.concat(k)}return yield Er([...new Set(O)]),l._bNeedOutputOriginalImage=1===l._currentSettings.CaptureVisionTemplates[0].OutputOriginalImage,f(b)}{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_initSettings",id:p,instanceID:l._instanceID,body:{settings:a}})})):console.error("Invalid template.")})()}outputSettings(a){var l=this;return ae(function*(){return l._checkIsDisposed(),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success){const b=JSON.parse(y.settings);if(0!==b.errorCode){let O=new Error(b.errorString);return O.errorCode=b.errorCode,g(O)}return delete b.errorCode,delete b.errorString,f(b)}{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_outputSettings",id:p,instanceID:l._instanceID,body:{templateName:a||"*"}})})})()}outputSettingsToFile(a,l,f){var g=this;return ae(function*(){const p=yield g.outputSettings(a),_=new Blob([JSON.stringify(p,null,2,function(y,b){return b instanceof Array?JSON.stringify(b):b},2)],{type:"application/json"});if(f){const y=document.createElement("a");y.href=URL.createObjectURL(_),l.endsWith(".json")&&(l=l.replace(".json","")),y.download=`${l}.json`,y.onclick=()=>{setTimeout(()=>{URL.revokeObjectURL(y.href)},500)},y.click()}return _})()}getSimplifiedSettings(a){var l=this;return ae(function*(){l._checkIsDisposed(),a||(a=l._currentSettings.CaptureVisionTemplates[0].Name);const f=yield l.containsTask(a);return yield Er(f),yield new Promise((g,p)=>{let _=Tt();Et[_]=function(){var y=ae(function*(b){if(b.success){const O=JSON.parse(b.settings,(M,P)=>ej&&"barcodeFormatIds"===M?BigInt(P):P);if(O.minImageCaptureInterval=l._minImageCaptureInterval,0!==O.code){let M=new Error(O.codeString);return M.errorCode=O.errorCode,p(M)}return delete O.code,delete O.codeString,g(O)}{let O=new Error(b.message);return O.stack=b.stack+"\n"+O.stack,p(O)}});return function(b){return y.apply(this,arguments)}}(),ht.postMessage({type:"cvr_getSimplifiedSettings",id:_,instanceID:l._instanceID,body:{templateName:a}})})})()}updateSettings(a,l){var f=this;return ae(function*(){f._checkIsDisposed();const g=yield f.containsTask(a);return yield Er(g),yield new Promise((p,_)=>{let y=Tt();Et[y]=function(){var b=ae(function*(O){if(O.success){const M=JSON.parse(O.response);if(l.minImageCaptureInterval&&l.minImageCaptureInterval>=-1&&(f._minImageCaptureInterval=l.minImageCaptureInterval),f._bNeedOutputOriginalImage=O.bNeedOutputOriginalImage,0!==M.exception){let P=new Error(M.description?M.description:"Update Settings Failed.");return P.errorCode=M.exception,_(P)}return f._currentSettings=yield f.outputSettings("*"),p(M)}{let M=new Error(O.message);return M.stack=O.stack+"\n"+M.stack,_(M)}});return function(O){return b.apply(this,arguments)}}(),ht.postMessage({type:"cvr_updateSettings",id:y,instanceID:f._instanceID,body:{settings:l,templateName:a}})})})()}resetSettings(){var a=this;return ae(function*(){return a._checkIsDisposed(),yield new Promise((l,f)=>{let g=Tt();Et[g]=function(){var p=ae(function*(_){if(_.success){const y=JSON.parse(_.response);if(0!==y.exception){let b=new Error(y.description?y.description:"Reset Settings Failed.");return b.errorCode=y.exception,f(b)}return a._currentSettings=yield a.outputSettings("*"),l(y)}{let y=new Error(_.message);return y.stack=_.stack+"\n"+y.stack,f(y)}});return function(_){return p.apply(this,arguments)}}(),ht.postMessage({type:"cvr_resetSettings",id:g,instanceID:a._instanceID})})})()}getBufferedItemsManager(){return this._bufferdItemsManager||(this._bufferdItemsManager=new aj(this)),this._bufferdItemsManager}getIntermediateResultManager(a){if(this._checkIsDisposed(),!a&&0!==Qt.bSupportIRTModule)throw new Error("The current license does not support the use of intermediate results.");return this._intermediateResultManager||(this._intermediateResultManager=new cj(this)),this._intermediateResultManager}contains(a,l){return function(f,g){let p=g.x,_=g.y,y=f[0].x,b=f[0].y,O=f[1].x,M=f[1].y,P=f[2].x,k=f[2].y,V=f[3].x,H=f[3].y,z=K(p,_,y,b,O,M),Y=K(p,_,O,M,P,k),X=K(p,_,P,k,V,H),$=K(p,_,V,H,y,b);function K(ge,_e,Te,xe,F,Ee){return(ge-Te)*(Ee-xe)-(_e-xe)*(F-Te)}return z>=0&&Y>=0&&X>=0&&$>=0||z<=0&&Y<=0&&X<=0&&$<=0}(a,l)}parseRequiredResources(a){var l=this;return ae(function*(){return l._checkIsDisposed(),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success)return f(JSON.parse(y.resources));{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_parseRequiredResources",id:p,instanceID:l._instanceID,body:{templateName:a}})})})()}dispose(){var a=this;return ae(function*(){a._checkIsDisposed(),a._promiseStartScan&&a.stopCapturing(),a._isa=null,a._resultReceiverSet.clear(),a._isaStateListenerSet.clear(),a._resultFilterSet.clear(),a.bDestroyed=!0;let l=Tt();Et[l]=f=>{if(!f.success){let g=new Error(f.message);throw g.stack=f.stack+"\n"+g.stack,g}},ht.postMessage({type:"cvr_dispose",id:l,instanceID:a._instanceID})})()}_enableResultCrossVerification(a){var l=this;return ae(function*(){return l._checkIsDisposed(),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success)return f(y.result);{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_enableResultCrossVerification",id:p,instanceID:l._instanceID,body:{verificationEnabled:a}})})})()}_enableResultDeduplication(a){var l=this;return ae(function*(){return l._checkIsDisposed(),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success)return f(y.result);{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_enableResultDeduplication",id:p,instanceID:l._instanceID,body:{duplicateFilterEnabled:a}})})})()}_setDuplicateForgetTime(a){var l=this;return ae(function*(){return l._checkIsDisposed(),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success)return f(y.result);{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_setDuplicateForgetTime",id:p,instanceID:l._instanceID,body:{duplicateForgetTime:a}})})})()}_getDuplicateForgetTime(a){var l=this;return ae(function*(){return l._checkIsDisposed(),yield new Promise((f,g)=>{let p=Tt();Et[p]=function(){var _=ae(function*(y){if(y.success)return f(y.time);{let b=new Error(y.message);return b.stack=y.stack+"\n"+b.stack,g(b)}});return function(y){return _.apply(this,arguments)}}(),ht.postMessage({type:"cvr_getDuplicateForgetTime",id:p,instanceID:l._instanceID,body:{type:a}})})})()}_setThresholdValue(a,l,f){var g=this;return ae(function*(){return yield Er("ddn"),yield new Promise((p,_)=>{let y=Tt();Et[y]=function(){var b=ae(function*(O){if(O.success)return p();{let M=new Error(O.message);return M.stack=O.stack+"\n"+M.stack,_(M)}});return function(O){return b.apply(this,arguments)}}(),ht.postMessage({type:"ddn_setThresholdValue",id:y,instanceID:g._instanceID,body:{threshold:a,leftLimit:l,rightLimit:f}})})})()}_checkIsDisposed(){if(this.disposed)throw new Error('"CaptureVisionRouter" instance has been disposed')}}const Km="undefined"==typeof self,uj=(()=>{if(!Km&&document.currentScript){let u=document.currentScript.src,a=u.indexOf("?");if(-1!=a)u=u.substring(0,a);else{let l=u.indexOf("#");-1!=l&&(u=u.substring(0,l))}return u.substring(0,u.lastIndexOf("/")+1)}return"./"})();function j(u,a,l,f){if("a"===l&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof a?u!==a||!f:!a.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===l?f:"a"===l?f.call(u):f?f.value:a.get(u)}function Me(u,a,l,f,g){if("m"===f)throw new TypeError("Private method is not writable");if("a"===f&&!g)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof a?u!==a||!g:!a.has(u))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===f?g.call(u,l):g?g.value=l:a.set(u,l),l}let gc,Gr,Kh,Qh,An;null==Ke.dce&&(Ke.dce=uj),Ds.dce={wasm:!1,js:!1},yn.dce={},"function"==typeof SuppressedError&&SuppressedError,"undefined"!=typeof navigator&&(gc=navigator,Gr=gc.userAgent,Kh=gc.platform,Qh=gc.mediaDevices),function(){if(!Km){const u={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:gc.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},a={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:Kh,search:"Win"},Mac:{str:Kh},Linux:{str:Kh}};let l="unknownBrowser",f=0,g="unknownOS";for(let p in u){const _=u[p]||{};let O=_.verStr||Gr,M=_.verSearch||p;if(M instanceof Array||(M=[M]),-1!=(_.str||Gr).indexOf(_.search||p)){l=p;for(let P of M){let k=O.indexOf(P);if(-1!=k){f=parseFloat(O.substring(k+P.length+1));break}}break}}for(let p in a){const _=a[p]||{};if(-1!=(_.str||Gr).indexOf(_.search||p)){g=p;break}}"Linux"==g&&-1!=Gr.indexOf("Windows NT")&&(g="HarmonyOS"),An={browser:l,version:f,OS:g}}Km&&(An={browser:"ssr",version:0,OS:"ssr"})}();const hj="undefined"!=typeof WebAssembly&&Gr&&!(/Safari/.test(Gr)&&!/Chrome/.test(Gr)&&/\(.+\s11_2_([2-6]).*\)/.test(Gr)),dj="undefined"!=typeof Worker,DT=!(!Qh||!Qh.getUserMedia),fj=function(){var u=ae(function*(){let a=!1;if(DT)try{(yield Qh.getUserMedia({video:!0})).getTracks().forEach(l=>{l.stop()}),a=!0}catch(l){}return a});return function(){return u.apply(this,arguments)}}();var gj={653:(u,a,l)=>{var f,g,p,_,y,b,O,M,P,k,H,z,Y,X,$,K,ge,_e,Te,xe,D,C,w,T,F=F||{version:"5.2.1"};if(a.fabric=F,"undefined"!=typeof document&&"undefined"!=typeof window)F.document=document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?document:document.implementation.createHTMLDocument(""),F.window=window;else{var Ee=new(l(192).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;F.document=Ee.document,F.jsdomImplForWrapper=l(898).implForWrapper,F.nodeCanvas=l(245).Canvas,F.window=Ee,DOMParser=F.window.DOMParser}function ke(D,C){var w=D.canvas,T=C.targetCanvas,m=T.getContext("2d");m.translate(0,T.height),m.scale(1,-1),m.drawImage(w,0,w.height-T.height,T.width,T.height,0,0,T.width,T.height)}function Qe(D,C){var w=C.targetCanvas.getContext("2d"),T=C.destinationWidth,m=C.destinationHeight,v=T*m*4,S=new Uint8Array(this.imageBuffer,0,v),A=new Uint8ClampedArray(this.imageBuffer,0,v);D.readPixels(0,0,T,m,D.RGBA,D.UNSIGNED_BYTE,S);var I=new ImageData(A,T,m);w.putImageData(I,0,0)}F.isTouchSupported="ontouchstart"in F.window||"ontouchstart"in F.document||F.window&&F.window.navigator&&F.window.navigator.maxTouchPoints>0,F.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,F.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],F.DPI=96,F.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",F.commaWsp="(?:\\s+,?\\s*|,\\s*)",F.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,F.reNonWord=/[ \n\.,;!\?\-]/,F.fontPaths={},F.iMatrix=[1,0,0,1,0,0],F.svgNS="http://www.w3.org/2000/svg",F.perfLimitSizeTotal=2097152,F.maxCacheSideLimit=4096,F.minCacheSideLimit=256,F.charWidthsCache={},F.textureSize=2048,F.disableStyleCopyPaste=!1,F.enableGLFiltering=!0,F.devicePixelRatio=F.window.devicePixelRatio||F.window.webkitDevicePixelRatio||F.window.mozDevicePixelRatio||1,F.browserShadowBlurConstant=1,F.arcToSegmentsCache={},F.boundsOfCurveCache={},F.cachesBoundsOfCurve=!0,F.forceGLPutImageData=!1,F.initFilterBackend=function(){return F.enableGLFiltering&&F.isWebglSupported&&F.isWebglSupported(F.textureSize)?(console.log("max texture size: "+F.maxTextureSize),new F.WebglFilterBackend({tileSize:F.textureSize})):F.Canvas2dFilterBackend?new F.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=F),function(){function D(w,T){if(this.__eventListeners[w]){var m=this.__eventListeners[w];T?m[m.indexOf(T)]=!1:F.util.array.fill(m,!1)}}function C(w,T){var m=function(){T.apply(this,arguments),this.off(w,m)}.bind(this);this.on(w,m)}F.Observable={fire:function(w,T){if(!this.__eventListeners)return this;var m=this.__eventListeners[w];if(!m)return this;for(var v=0,S=m.length;v<S;v++)m[v]&&m[v].call(this,T||{});return this.__eventListeners[w]=m.filter(function(A){return!1!==A}),this},on:function(w,T){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var m in w)this.on(m,w[m]);else this.__eventListeners[w]||(this.__eventListeners[w]=[]),this.__eventListeners[w].push(T);return this},once:function(w,T){if(1===arguments.length)for(var m in w)C.call(this,m,w[m]);else C.call(this,w,T);return this},off:function(w,T){if(!this.__eventListeners)return this;if(0===arguments.length)for(w in this.__eventListeners)D.call(this,w);else if(1===arguments.length&&"object"==typeof arguments[0])for(var m in w)D.call(this,m,w[m]);else D.call(this,w,T);return this}}}(),F.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var D=0,C=arguments.length;D<C;D++)this._onObjectAdded(arguments[D]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(D,C,w){var T=this._objects;return w?T[C]=D:T.splice(C,0,D),this._onObjectAdded&&this._onObjectAdded(D),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var D,C=this._objects,w=!1,T=0,m=arguments.length;T<m;T++)-1!==(D=C.indexOf(arguments[T]))&&(w=!0,C.splice(D,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[T]));return this.renderOnAddRemove&&w&&this.requestRenderAll(),this},forEachObject:function(D,C){for(var w=this.getObjects(),T=0,m=w.length;T<m;T++)D.call(C,w[T],T,w);return this},getObjects:function(D){return void 0===D?this._objects.concat():this._objects.filter(function(C){return C.type===D})},item:function(D){return this._objects[D]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(D,C){return this._objects.indexOf(D)>-1||!!C&&this._objects.some(function(w){return"function"==typeof w.contains&&w.contains(D,!0)})},complexity:function(){return this._objects.reduce(function(D,C){return D+(C.complexity?C.complexity():0)},0)}},F.CommonMethods={_setOptions:function(D){for(var C in D)this.set(C,D[C])},_initGradient:function(D,C){!D||!D.colorStops||D instanceof F.Gradient||this.set(C,new F.Gradient(D))},_initPattern:function(D,C,w){!D||!D.source||D instanceof F.Pattern?w&&w():this.set(C,new F.Pattern(D,w))},_setObject:function(D){for(var C in D)this._set(C,D[C])},set:function(D,C){return"object"==typeof D?this._setObject(D):this._set(D,C),this},_set:function(D,C){this[D]=C},toggle:function(D){var C=this.get(D);return"boolean"==typeof C&&this.set(D,!C),this},get:function(D){return this[D]}},f=a,g=Math.sqrt,p=Math.atan2,_=Math.pow,y=Math.PI/180,b=Math.PI/2,F.util={cos:function(D){if(0===D)return 1;switch(D<0&&(D=-D),D/b){case 1:case 3:return 0;case 2:return-1}return Math.cos(D)},sin:function(D){if(0===D)return 0;var C=1;switch(D<0&&(C=-1),D/b){case 1:return C;case 2:return 0;case 3:return-C}return Math.sin(D)},removeFromArray:function(D,C){var w=D.indexOf(C);return-1!==w&&D.splice(w,1),D},getRandomInt:function(D,C){return Math.floor(Math.random()*(C-D+1))+D},degreesToRadians:function(D){return D*y},radiansToDegrees:function(D){return D/y},rotatePoint:function(D,C,w){var T=new F.Point(D.x-C.x,D.y-C.y),m=F.util.rotateVector(T,w);return new F.Point(m.x,m.y).addEquals(C)},rotateVector:function(D,C){var w=F.util.sin(C),T=F.util.cos(C);return{x:D.x*T-D.y*w,y:D.x*w+D.y*T}},createVector:function(D,C){return new F.Point(C.x-D.x,C.y-D.y)},calcAngleBetweenVectors:function(D,C){return Math.acos((D.x*C.x+D.y*C.y)/(Math.hypot(D.x,D.y)*Math.hypot(C.x,C.y)))},getHatVector:function(D){return new F.Point(D.x,D.y).multiply(1/Math.hypot(D.x,D.y))},getBisector:function(D,C,w){var T=F.util.createVector(D,C),m=F.util.createVector(D,w),v=F.util.calcAngleBetweenVectors(T,m),S=v*(0===F.util.calcAngleBetweenVectors(F.util.rotateVector(T,v),m)?1:-1)/2;return{vector:F.util.getHatVector(F.util.rotateVector(T,S)),angle:v}},projectStrokeOnPoints:function(D,C,w){var T=[],m=C.strokeWidth/2,v=C.strokeUniform?new F.Point(1/C.scaleX,1/C.scaleY):new F.Point(1,1),S=function(A){var I=m/Math.hypot(A.x,A.y);return new F.Point(A.x*I*v.x,A.y*I*v.y)};return D.length<=1||D.forEach(function(A,I){var x,L,N=new F.Point(A.x,A.y);0===I?(L=D[I+1],x=w?S(F.util.createVector(L,N)).addEquals(N):D[D.length-1]):I===D.length-1?(x=D[I-1],L=w?S(F.util.createVector(x,N)).addEquals(N):D[0]):(x=D[I-1],L=D[I+1]);var B,G,U=F.util.getBisector(N,x,L),W=U.vector;if("miter"===C.strokeLineJoin&&(B=-m/Math.sin(U.angle/2),G=new F.Point(W.x*B*v.x,W.y*B*v.y),Math.hypot(G.x,G.y)/m<=C.strokeMiterLimit))return T.push(N.add(G)),void T.push(N.subtract(G));B=-m*Math.SQRT2,G=new F.Point(W.x*B*v.x,W.y*B*v.y),T.push(N.add(G)),T.push(N.subtract(G))}),T},transformPoint:function(D,C,w){return w?new F.Point(C[0]*D.x+C[2]*D.y,C[1]*D.x+C[3]*D.y):new F.Point(C[0]*D.x+C[2]*D.y+C[4],C[1]*D.x+C[3]*D.y+C[5])},makeBoundingBoxFromPoints:function(D,C){if(C)for(var w=0;w<D.length;w++)D[w]=F.util.transformPoint(D[w],C);var T=[D[0].x,D[1].x,D[2].x,D[3].x],m=F.util.array.min(T),v=F.util.array.max(T)-m,S=[D[0].y,D[1].y,D[2].y,D[3].y],A=F.util.array.min(S);return{left:m,top:A,width:v,height:F.util.array.max(S)-A}},invertTransform:function(D){var C=1/(D[0]*D[3]-D[1]*D[2]),w=[C*D[3],-C*D[1],-C*D[2],C*D[0]],T=F.util.transformPoint({x:D[4],y:D[5]},w,!0);return w[4]=-T.x,w[5]=-T.y,w},toFixed:function(D,C){return parseFloat(Number(D).toFixed(C))},parseUnit:function(D,C){var w=/\D{0,2}$/.exec(D),T=parseFloat(D);switch(C||(C=F.Text.DEFAULT_SVG_FONT_SIZE),w[0]){case"mm":return T*F.DPI/25.4;case"cm":return T*F.DPI/2.54;case"in":return T*F.DPI;case"pt":return T*F.DPI/72;case"pc":return T*F.DPI/72*12;case"em":return T*C;default:return T}},falseFunction:function(){return!1},getKlass:function(D,C){return D=F.util.string.camelize(D.charAt(0).toUpperCase()+D.slice(1)),F.util.resolveNamespace(C)[D]},getSvgAttributes:function(D){var C=["instantiated_by_use","style","id","class"];switch(D){case"linearGradient":C=C.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":C=C.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":C=C.concat(["offset","stop-color","stop-opacity"])}return C},resolveNamespace:function(D){if(!D)return F;var C,w=D.split("."),T=w.length,m=f||F.window;for(C=0;C<T;++C)m=m[w[C]];return m},loadImage:function(D,C,w,T){if(D){var m=F.util.createImage(),v=function(){C&&C.call(w,m,!1),m=m.onload=m.onerror=null};m.onload=v,m.onerror=function(){F.log("Error loading "+m.src),C&&C.call(w,null,!0),m=m.onload=m.onerror=null},0!==D.indexOf("data")&&null!=T&&(m.crossOrigin=T),"data:image/svg"===D.substring(0,14)&&(m.onload=null,F.util.loadImageInDom(m,v)),m.src=D}else C&&C.call(w,D)},loadImageInDom:function(D,C){var w=F.document.createElement("div");w.style.width=w.style.height="1px",w.style.left=w.style.top="-100%",w.style.position="absolute",w.appendChild(D),F.document.querySelector("body").appendChild(w),D.onload=function(){C(),w.parentNode.removeChild(w),w=null}},enlivenObjects:function(D,C,w,T){var m=[],v=0,S=(D=D||[]).length;function A(){++v===S&&C&&C(m.filter(function(I){return I}))}S?D.forEach(function(I,x){I&&I.type?F.util.getKlass(I.type,w).fromObject(I,function(L,N){N||(m[x]=L),T&&T(I,L,N),A()}):A()}):C&&C(m)},enlivenObjectEnlivables:function(D,C,w){var T=F.Object.ENLIVEN_PROPS.filter(function(m){return!!D[m]});F.util.enlivenObjects(T.map(function(m){return D[m]}),function(m){var v={};T.forEach(function(S,A){v[S]=m[A],C&&(C[S]=m[A])}),w&&w(v)})},enlivenPatterns:function(D,C){function w(){++m===v&&C&&C(T)}var T=[],m=0,v=(D=D||[]).length;v?D.forEach(function(S,A){S&&S.source?new F.Pattern(S,function(I){T[A]=I,w()}):(T[A]=S,w())}):C&&C(T)},groupSVGElements:function(D,C,w){var T;return D&&1===D.length?D[0]:(C&&(C.width&&C.height?C.centerPoint={x:C.width/2,y:C.height/2}:(delete C.width,delete C.height)),T=new F.Group(D,C),void 0!==w&&(T.sourcePath=w),T)},populateWithProperties:function(D,C,w){if(w&&Array.isArray(w))for(var T=0,m=w.length;T<m;T++)w[T]in D&&(C[w[T]]=D[w[T]])},createCanvasElement:function(){return F.document.createElement("canvas")},copyCanvasElement:function(D){var C=F.util.createCanvasElement();return C.width=D.width,C.height=D.height,C.getContext("2d").drawImage(D,0,0),C},toDataURL:function(D,C,w){return D.toDataURL("image/"+C,w)},createImage:function(){return F.document.createElement("img")},multiplyTransformMatrices:function(D,C,w){return[D[0]*C[0]+D[2]*C[1],D[1]*C[0]+D[3]*C[1],D[0]*C[2]+D[2]*C[3],D[1]*C[2]+D[3]*C[3],w?0:D[0]*C[4]+D[2]*C[5]+D[4],w?0:D[1]*C[4]+D[3]*C[5]+D[5]]},qrDecompose:function(D){var C=p(D[1],D[0]),w=_(D[0],2)+_(D[1],2),T=g(w),m=(D[0]*D[3]-D[2]*D[1])/T,v=p(D[0]*D[2]+D[1]*D[3],w);return{angle:C/y,scaleX:T,scaleY:m,skewX:v/y,skewY:0,translateX:D[4],translateY:D[5]}},calcRotateMatrix:function(D){if(!D.angle)return F.iMatrix.concat();var C=F.util.degreesToRadians(D.angle),w=F.util.cos(C),T=F.util.sin(C);return[w,T,-T,w,0,0]},calcDimensionsMatrix:function(D){var C=void 0===D.scaleX?1:D.scaleX,w=void 0===D.scaleY?1:D.scaleY,T=[D.flipX?-C:C,0,0,D.flipY?-w:w,0,0],m=F.util.multiplyTransformMatrices,v=F.util.degreesToRadians;return D.skewX&&(T=m(T,[1,0,Math.tan(v(D.skewX)),1],!0)),D.skewY&&(T=m(T,[1,Math.tan(v(D.skewY)),0,1],!0)),T},composeMatrix:function(D){var C=[1,0,0,1,D.translateX||0,D.translateY||0],w=F.util.multiplyTransformMatrices;return D.angle&&(C=w(C,F.util.calcRotateMatrix(D))),(1!==D.scaleX||1!==D.scaleY||D.skewX||D.skewY||D.flipX||D.flipY)&&(C=w(C,F.util.calcDimensionsMatrix(D))),C},resetObjectTransform:function(D){D.scaleX=1,D.scaleY=1,D.skewX=0,D.skewY=0,D.flipX=!1,D.flipY=!1,D.rotate(0)},saveObjectTransform:function(D){return{scaleX:D.scaleX,scaleY:D.scaleY,skewX:D.skewX,skewY:D.skewY,angle:D.angle,left:D.left,flipX:D.flipX,flipY:D.flipY,top:D.top}},isTransparent:function(D,C,w,T){T>0&&(C>T?C-=T:C=0,w>T?w-=T:w=0);var m,v=!0,S=D.getImageData(C,w,2*T||1,2*T||1),A=S.data.length;for(m=3;m<A&&0!=(v=S.data[m]<=0);m+=4);return S=null,v},parsePreserveAspectRatioAttribute:function(D){var C,w="meet",T=D.split(" ");return T&&T.length&&("meet"!==(w=T.pop())&&"slice"!==w?(C=w,w="meet"):T.length&&(C=T.pop())),{meetOrSlice:w,alignX:"none"!==C?C.slice(1,4):"none",alignY:"none"!==C?C.slice(5,8):"none"}},clearFabricFontCache:function(D){(D=(D||"").toLowerCase())?F.charWidthsCache[D]&&delete F.charWidthsCache[D]:F.charWidthsCache={}},limitDimsByArea:function(D,C){var w=Math.sqrt(C*D),T=Math.floor(C/w);return{x:Math.floor(w),y:T}},capValue:function(D,C,w){return Math.max(D,Math.min(C,w))},findScaleToFit:function(D,C){return Math.min(C.width/D.width,C.height/D.height)},findScaleToCover:function(D,C){return Math.max(C.width/D.width,C.height/D.height)},matrixToSVG:function(D){return"matrix("+D.map(function(C){return F.util.toFixed(C,F.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(D,C){var w=F.util.invertTransform(C),T=F.util.multiplyTransformMatrices(w,D.calcOwnMatrix());F.util.applyTransformToObject(D,T)},addTransformToObject:function(D,C){F.util.applyTransformToObject(D,F.util.multiplyTransformMatrices(C,D.calcOwnMatrix()))},applyTransformToObject:function(D,C){var w=F.util.qrDecompose(C),T=new F.Point(w.translateX,w.translateY);D.flipX=!1,D.flipY=!1,D.set("scaleX",w.scaleX),D.set("scaleY",w.scaleY),D.skewX=w.skewX,D.skewY=w.skewY,D.angle=w.angle,D.setPositionByOrigin(T,"center","center")},sizeAfterTransform:function(D,C,w){var T=D/2,m=C/2,v=[{x:-T,y:-m},{x:T,y:-m},{x:-T,y:m},{x:T,y:m}],S=F.util.calcDimensionsMatrix(w),A=F.util.makeBoundingBoxFromPoints(v,S);return{x:A.width,y:A.height}},mergeClipPaths:function(D,C){var w=D,T=C;w.inverted&&!T.inverted&&(w=C,T=D),F.util.applyTransformToObject(T,F.util.multiplyTransformMatrices(F.util.invertTransform(w.calcTransformMatrix()),T.calcTransformMatrix()));var m=w.inverted&&T.inverted;return m&&(w.inverted=T.inverted=!1),new F.Group([w],{clipPath:T,inverted:m})}},function(){var D=Array.prototype.join,C={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},w={m:"l",M:"L"};function T(G,U,W,q,ne,ie,he,le,oe,J,Q){var re=F.util.cos(G),ue=F.util.sin(G),de=F.util.cos(U),te=F.util.sin(U),ee=W*ne*de-q*ie*te+he,se=q*ne*de+W*ie*te+le;return["C",J+oe*(-W*ne*ue-q*ie*re),Q+oe*(-q*ne*ue+W*ie*re),ee+oe*(W*ne*te+q*ie*de),se+oe*(q*ne*te-W*ie*de),ee,se]}function m(G,U,W,q){var ne=Math.atan2(U,G),ie=Math.atan2(q,W);return ie>=ne?ie-ne:2*Math.PI-(ne-ie)}function v(G,U,W){for(var oe=function(re,ue,de,te,ee,se,fe){var ce=Math.PI,pe=fe*ce/180,Se=F.util.sin(pe),we=F.util.cos(pe),ye=0,De=0,be=-we*re*.5-Se*ue*.5,Ie=-we*ue*.5+Se*re*.5,Be=(de=Math.abs(de))*de,Oe=(te=Math.abs(te))*te,st=Ie*Ie,bt=be*be,Li=Be*Oe-Be*st-Oe*bt,is=0;if(Li<0){var Ha=Math.sqrt(1-Li/(Be*Oe));de*=Ha,te*=Ha}else is=(ee===se?-1:1)*Math.sqrt(Li/(Be*st+Oe*bt));var zt=is*de*Ie/te,Fi=-is*te*be/de,Uc=we*zt-Se*Fi+.5*re,Wa=Se*zt+we*Fi+.5*ue,Co=m(1,0,(be-zt)/de,(Ie-Fi)/te),za=m((be-zt)/de,(Ie-Fi)/te,(-be-zt)/de,(-Ie-Fi)/te);0===se&&za>0?za-=2*ce:1===se&&za<0&&(za+=2*ce);for(var cI=Math.ceil(Math.abs(za/ce*2)),Ld=[],Gc=za/cI,Wj=8/3*Math.sin(Gc/4)*Math.sin(Gc/4)/Math.sin(Gc/2),j_=Co+Gc,Hc=0;Hc<cI;Hc++)Ld[Hc]=T(Co,j_,we,Se,de,te,Uc,Wa,Wj,ye,De),ye=Ld[Hc][5],De=Ld[Hc][6],Co=j_,j_+=Gc;return Ld}(W[6]-G,W[7]-U,W[1],W[2],W[4],W[5],W[3]),J=0,Q=oe.length;J<Q;J++)oe[J][1]+=G,oe[J][2]+=U,oe[J][3]+=G,oe[J][4]+=U,oe[J][5]+=G,oe[J][6]+=U;return oe}function S(G,U,W,q){return Math.sqrt((W-G)*(W-G)+(q-U)*(q-U))}function A(G,U,W,q,ne,ie,he,le){return function(oe){var J,te,Q=(J=oe)*J*J,re=3*(te=oe)*te*(1-te),ue=function(te){return 3*te*(1-te)*(1-te)}(oe),de=function(te){return(1-te)*(1-te)*(1-te)}(oe);return{x:he*Q+ne*re+W*ue+G*de,y:le*Q+ie*re+q*ue+U*de}}}function I(G,U,W,q,ne,ie,he,le){return function(oe){var J=1-oe;return Math.atan2(3*J*J*(q-U)+6*J*oe*(ie-q)+3*oe*oe*(le-ie),3*J*J*(W-G)+6*J*oe*(ne-W)+3*oe*oe*(he-ne))}}function x(G,U,W,q,ne,ie){return function(he){var le,re,oe=(le=he)*le,J=2*(re=he)*(1-re),Q=function(re){return(1-re)*(1-re)}(he);return{x:ne*oe+W*J+G*Q,y:ie*oe+q*J+U*Q}}}function L(G,U,W,q,ne,ie){return function(he){var le=1-he;return Math.atan2(2*le*(q-U)+2*he*(ie-q),2*le*(W-G)+2*he*(ne-W))}}function N(G,U,W){var q,ne,ie={x:U,y:W},he=0;for(ne=1;ne<=100;ne+=1)q=G(ne/100),he+=S(ie.x,ie.y,q.x,q.y),ie=q;return he}function B(G){for(var U,W,q,ne,ie=0,he=G.length,le=0,oe=0,J=0,Q=0,re=[],ue=0;ue<he;ue++){switch(q={x:le,y:oe,command:(U=G[ue])[0]},U[0]){case"M":q.length=0,J=le=U[1],Q=oe=U[2];break;case"L":q.length=S(le,oe,U[1],U[2]),le=U[1],oe=U[2];break;case"C":W=A(le,oe,U[1],U[2],U[3],U[4],U[5],U[6]),ne=I(le,oe,U[1],U[2],U[3],U[4],U[5],U[6]),q.iterator=W,q.angleFinder=ne,q.length=N(W,le,oe),le=U[5],oe=U[6];break;case"Q":W=x(le,oe,U[1],U[2],U[3],U[4]),ne=L(le,oe,U[1],U[2],U[3],U[4]),q.iterator=W,q.angleFinder=ne,q.length=N(W,le,oe),le=U[3],oe=U[4];break;case"Z":case"z":q.destX=J,q.destY=Q,q.length=S(le,oe,J,Q),le=J,oe=Q}ie+=q.length,re.push(q)}return re.push({length:ie,x:le,y:oe}),re}F.util.joinPath=function(G){return G.map(function(U){return U.join(" ")}).join(" ")},F.util.parsePath=function(G){var U,W,q,ne,ie,he=[],le=[],oe=F.rePathCommand,J="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",Q="("+J+")"+F.commaWsp,re="([01])"+F.commaWsp+"?",ue=new RegExp(Q+"?"+Q+"?"+Q+re+re+Q+"?("+J+")","g");if(!G||!G.match)return he;for(var de,te=0,ee=(ie=G.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;te<ee;te++){ne=(U=ie[te]).slice(1).trim(),le.length=0;var se=U.charAt(0);if(de=[se],"a"===se.toLowerCase())for(var fe;fe=ue.exec(ne);)for(var ce=1;ce<fe.length;ce++)le.push(fe[ce]);else for(;q=oe.exec(ne);)le.push(q[0]);ce=0;for(var pe=le.length;ce<pe;ce++)W=parseFloat(le[ce]),isNaN(W)||de.push(W);var Se=C[se.toLowerCase()],we=w[se]||se;if(de.length-1>Se)for(var ye=1,De=de.length;ye<De;ye+=Se)he.push([se].concat(de.slice(ye,ye+Se))),se=we;else he.push(de)}return he},F.util.makePathSimpler=function(G){var U,W,q,ne,ie,he,le=0,oe=0,J=G.length,Q=0,re=0,ue=[];for(W=0;W<J;++W){switch(q=!1,(U=G[W].slice(0))[0]){case"l":U[0]="L",U[1]+=le,U[2]+=oe;case"L":le=U[1],oe=U[2];break;case"h":U[1]+=le;case"H":U[0]="L",U[2]=oe,le=U[1];break;case"v":U[1]+=oe;case"V":U[0]="L",oe=U[1],U[1]=le,U[2]=oe;break;case"m":U[0]="M",U[1]+=le,U[2]+=oe;case"M":le=U[1],oe=U[2],Q=U[1],re=U[2];break;case"c":U[0]="C",U[1]+=le,U[2]+=oe,U[3]+=le,U[4]+=oe,U[5]+=le,U[6]+=oe;case"C":ie=U[3],he=U[4],le=U[5],oe=U[6];break;case"s":U[0]="S",U[1]+=le,U[2]+=oe,U[3]+=le,U[4]+=oe;case"S":"C"===ne?(ie=2*le-ie,he=2*oe-he):(ie=le,he=oe),le=U[3],oe=U[4],U[0]="C",U[5]=U[3],U[6]=U[4],U[3]=U[1],U[4]=U[2],U[1]=ie,U[2]=he,ie=U[3],he=U[4];break;case"q":U[0]="Q",U[1]+=le,U[2]+=oe,U[3]+=le,U[4]+=oe;case"Q":ie=U[1],he=U[2],le=U[3],oe=U[4];break;case"t":U[0]="T",U[1]+=le,U[2]+=oe;case"T":"Q"===ne?(ie=2*le-ie,he=2*oe-he):(ie=le,he=oe),U[0]="Q",le=U[1],oe=U[2],U[1]=ie,U[2]=he,U[3]=le,U[4]=oe;break;case"a":U[0]="A",U[6]+=le,U[7]+=oe;case"A":q=!0,ue=ue.concat(v(le,oe,U)),le=U[6],oe=U[7];break;case"z":case"Z":le=Q,oe=re}q||ue.push(U),ne=U[0]}return ue},F.util.getSmoothPathFromPoints=function(G,U){var W,q=[],ne=new F.Point(G[0].x,G[0].y),ie=new F.Point(G[1].x,G[1].y),he=G.length,le=1,oe=0,J=he>2;for(J&&(le=G[2].x<ie.x?-1:G[2].x===ie.x?0:1,oe=G[2].y<ie.y?-1:G[2].y===ie.y?0:1),q.push(["M",ne.x-le*(U=U||0),ne.y-oe*U]),W=1;W<he;W++){if(!ne.eq(ie)){var Q=ne.midPointFrom(ie);q.push(["Q",ne.x,ne.y,Q.x,Q.y])}ne=G[W],W+1<G.length&&(ie=G[W+1])}return J&&(le=ne.x>G[W-2].x?1:ne.x===G[W-2].x?0:-1,oe=ne.y>G[W-2].y?1:ne.y===G[W-2].y?0:-1),q.push(["L",ne.x+le*U,ne.y+oe*U]),q},F.util.getPathSegmentsInfo=B,F.util.getBoundsOfCurve=function(G,U,W,q,ne,ie,he,le){var oe;if(F.cachesBoundsOfCurve&&(oe=D.call(arguments),F.boundsOfCurveCache[oe]))return F.boundsOfCurveCache[oe];var J,Q,re,ue,de,te,ee,se,fe=Math.sqrt,ce=Math.min,pe=Math.max,Se=Math.abs,we=[],ye=[[],[]];Q=6*G-12*W+6*ne,J=-3*G+9*W-9*ne+3*he,re=3*W-3*G;for(var De=0;De<2;++De)if(De>0&&(Q=6*U-12*q+6*ie,J=-3*U+9*q-9*ie+3*le,re=3*q-3*U),Se(J)<1e-12){if(Se(Q)<1e-12)continue;0<(ue=-re/Q)&&ue<1&&we.push(ue)}else(ee=Q*Q-4*re*J)<0||(0<(de=(-Q+(se=fe(ee)))/(2*J))&&de<1&&we.push(de),0<(te=(-Q-se)/(2*J))&&te<1&&we.push(te));for(var be,Be,Oe=we.length,st=Oe;Oe--;)be=(Be=1-(ue=we[Oe]))*Be*Be*G+3*Be*Be*ue*W+3*Be*ue*ue*ne+ue*ue*ue*he,ye[0][Oe]=be,ye[1][Oe]=Be*Be*Be*U+3*Be*Be*ue*q+3*Be*ue*ue*ie+ue*ue*ue*le;ye[0][st]=G,ye[1][st]=U,ye[0][st+1]=he,ye[1][st+1]=le;var bt=[{x:ce.apply(null,ye[0]),y:ce.apply(null,ye[1])},{x:pe.apply(null,ye[0]),y:pe.apply(null,ye[1])}];return F.cachesBoundsOfCurve&&(F.boundsOfCurveCache[oe]=bt),bt},F.util.getPointOnPath=function(G,U,W){W||(W=B(G));for(var q=0;U-W[q].length>0&&q<W.length-2;)U-=W[q].length,q++;var ne,ie=W[q],he=U/ie.length,oe=G[q];switch(ie.command){case"M":return{x:ie.x,y:ie.y,angle:0};case"Z":case"z":return(ne=new F.Point(ie.x,ie.y).lerp(new F.Point(ie.destX,ie.destY),he)).angle=Math.atan2(ie.destY-ie.y,ie.destX-ie.x),ne;case"L":return(ne=new F.Point(ie.x,ie.y).lerp(new F.Point(oe[1],oe[2]),he)).angle=Math.atan2(oe[2]-ie.y,oe[1]-ie.x),ne;case"C":case"Q":return function(J,Q){for(var re,ue,de,te=0,ee=0,se=J.iterator,fe={x:J.x,y:J.y},ce=.01,pe=J.angleFinder;ee<Q&&ce>1e-4;)re=se(te),de=te,(ue=S(fe.x,fe.y,re.x,re.y))+ee>Q?(te-=ce,ce/=2):(fe=re,te+=ce,ee+=ue);return re.angle=pe(de),re}(ie,U)}},F.util.transformPath=function(G,U,W){return W&&(U=F.util.multiplyTransformMatrices(U,[1,0,0,1,-W.x,-W.y])),G.map(function(q){for(var ne=q.slice(0),ie={},he=1;he<q.length-1;he+=2)ie.x=q[he],ie.y=q[he+1],ie=F.util.transformPoint(ie,U),ne[he]=ie.x,ne[he+1]=ie.y;return ne})}}(),function(){var D=Array.prototype.slice;function C(w,T,m){if(w&&0!==w.length){var v=w.length-1,S=T?w[v][T]:w[v];if(T)for(;v--;)m(w[v][T],S)&&(S=w[v][T]);else for(;v--;)m(w[v],S)&&(S=w[v]);return S}}F.util.array={fill:function(w,T){for(var m=w.length;m--;)w[m]=T;return w},invoke:function(w,T){for(var m=D.call(arguments,2),v=[],S=0,A=w.length;S<A;S++)v[S]=m.length?w[S][T].apply(w[S],m):w[S][T].call(w[S]);return v},min:function(w,T){return C(w,T,function(m,v){return m<v})},max:function(w,T){return C(w,T,function(m,v){return m>=v})}}}(),function(){function D(C,w,T){if(T)if(!F.isLikelyNode&&w instanceof Element)C=w;else if(w instanceof Array){C=[];for(var m=0,v=w.length;m<v;m++)C[m]=D({},w[m],T)}else if(w&&"object"==typeof w)for(var S in w)"canvas"===S||"group"===S?C[S]=null:w.hasOwnProperty(S)&&(C[S]=D({},w[S],T));else C=w;else for(var S in w)C[S]=w[S];return C}F.util.object={extend:D,clone:function(C,w){return D({},C,w)}},F.util.object.extend(F.util,F.Observable)}(),function(){function D(C,w){var T=C.charCodeAt(w);if(isNaN(T))return"";if(T<55296||T>57343)return C.charAt(w);if(55296<=T&&T<=56319){if(C.length<=w+1)throw"High surrogate without following low surrogate";var m=C.charCodeAt(w+1);if(56320>m||m>57343)throw"High surrogate without following low surrogate";return C.charAt(w)+C.charAt(w+1)}if(0===w)throw"Low surrogate without preceding high surrogate";var v=C.charCodeAt(w-1);if(55296>v||v>56319)throw"Low surrogate without preceding high surrogate";return!1}F.util.string={camelize:function(C){return C.replace(/-+(.)?/g,function(w,T){return T?T.toUpperCase():""})},capitalize:function(C,w){return C.charAt(0).toUpperCase()+(w?C.slice(1):C.slice(1).toLowerCase())},escapeXml:function(C){return C.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(C){var w,T=0,m=[];for(T=0;T<C.length;T++)!1!==(w=D(C,T))&&m.push(w);return m}}}(),function(){var D=Array.prototype.slice,C=function(){},w=function(){for(var S in{toString:1})if("toString"===S)return!1;return!0}(),T=function(S,A,I){for(var x in A)S.prototype[x]=x in S.prototype&&"function"==typeof S.prototype[x]&&(A[x]+"").indexOf("callSuper")>-1?function(L){return function(){var N=this.constructor.superclass;this.constructor.superclass=I;var B=A[L].apply(this,arguments);if(this.constructor.superclass=N,"initialize"!==L)return B}}(x):A[x],w&&(A.toString!==Object.prototype.toString&&(S.prototype.toString=A.toString),A.valueOf!==Object.prototype.valueOf&&(S.prototype.valueOf=A.valueOf))};function m(){}function v(S){for(var A=null,I=this;I.constructor.superclass;){var x=I.constructor.superclass.prototype[S];if(I[S]!==x){A=x;break}I=I.constructor.superclass.prototype}return A?arguments.length>1?A.apply(this,D.call(arguments,1)):A.call(this):console.log("tried to callSuper "+S+", method not found in prototype chain",this)}F.util.createClass=function(){var S=null,A=D.call(arguments,0);function I(){this.initialize.apply(this,arguments)}"function"==typeof A[0]&&(S=A.shift()),I.superclass=S,I.subclasses=[],S&&(m.prototype=S.prototype,I.prototype=new m,S.subclasses.push(I));for(var x=0,L=A.length;x<L;x++)T(I,A[x],S);return I.prototype.initialize||(I.prototype.initialize=C),I.prototype.constructor=I,I.prototype.callSuper=v,I}}(),O=!!F.document.createElement("div").attachEvent,M=["touchstart","touchmove","touchend"],F.util.addListener=function(D,C,w,T){D&&D.addEventListener(C,w,!O&&T)},F.util.removeListener=function(D,C,w,T){D&&D.removeEventListener(C,w,!O&&T)},F.util.getPointer=function(D){var m,v,w=F.util.getScrollLeftTop(D.target),T=(v=(m=D).changedTouches)&&v[0]?v[0]:m;return{x:T.clientX+w.left,y:T.clientY+w.top}},F.util.isTouchEvent=function(D){return M.indexOf(D.type)>-1||"touch"===D.pointerType},k="string"==typeof(P=F.document.createElement("div")).style.opacity,H=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,z=function(D){return D},k?z=function(D,C){return D.style.opacity=C,D}:"string"==typeof P.style.filter&&(z=function(D,C){var w=D.style;return D.currentStyle&&!D.currentStyle.hasLayout&&(w.zoom=1),H.test(w.filter)?w.filter=w.filter.replace(H,C=C>=.9999?"":"alpha(opacity="+100*C+")"):w.filter+=" alpha(opacity="+100*C+")",D}),F.util.setStyle=function(D,C){var w=D.style;if(!w)return D;if("string"==typeof C)return D.style.cssText+=";"+C,C.indexOf("opacity")>-1?z(D,C.match(/opacity:\s*(\d?\.?\d*)/)[1]):D;for(var T in C)"opacity"===T?z(D,C[T]):w["float"===T||"cssFloat"===T?void 0===w.styleFloat?"cssFloat":"styleFloat":T]=C[T];return D},function(){var D,C,w,T,m=Array.prototype.slice,v=function(I){return m.call(I,0)};try{D=v(F.document.childNodes)instanceof Array}catch(I){}function S(I,x){var L=F.document.createElement(I);for(var N in x)"class"===N?L.className=x[N]:"for"===N?L.htmlFor=x[N]:L.setAttribute(N,x[N]);return L}function A(I){for(var x=0,L=0,N=F.document.documentElement,B=F.document.body||{scrollLeft:0,scrollTop:0};I&&(I.parentNode||I.host)&&((I=I.parentNode||I.host)===F.document?(x=B.scrollLeft||N.scrollLeft||0,L=B.scrollTop||N.scrollTop||0):(x+=I.scrollLeft||0,L+=I.scrollTop||0),1!==I.nodeType||"fixed"!==I.style.position););return{left:x,top:L}}D||(v=function(I){for(var x=new Array(I.length),L=I.length;L--;)x[L]=I[L];return x}),C=F.document.defaultView&&F.document.defaultView.getComputedStyle?function(I,x){var L=F.document.defaultView.getComputedStyle(I,null);return L?L[x]:void 0}:function(I,x){var L=I.style[x];return!L&&I.currentStyle&&(L=I.currentStyle[x]),L},T="userSelect"in(w=F.document.documentElement.style)?"userSelect":"MozUserSelect"in w?"MozUserSelect":"WebkitUserSelect"in w?"WebkitUserSelect":"KhtmlUserSelect"in w?"KhtmlUserSelect":"",F.util.makeElementUnselectable=function(I){return void 0!==I.onselectstart&&(I.onselectstart=F.util.falseFunction),T?I.style[T]="none":"string"==typeof I.unselectable&&(I.unselectable="on"),I},F.util.makeElementSelectable=function(I){return void 0!==I.onselectstart&&(I.onselectstart=null),T?I.style[T]="":"string"==typeof I.unselectable&&(I.unselectable=""),I},F.util.setImageSmoothing=function(I,x){I.imageSmoothingEnabled=I.imageSmoothingEnabled||I.webkitImageSmoothingEnabled||I.mozImageSmoothingEnabled||I.msImageSmoothingEnabled||I.oImageSmoothingEnabled,I.imageSmoothingEnabled=x},F.util.getById=function(I){return"string"==typeof I?F.document.getElementById(I):I},F.util.toArray=v,F.util.addClass=function(I,x){I&&-1===(" "+I.className+" ").indexOf(" "+x+" ")&&(I.className+=(I.className?" ":"")+x)},F.util.makeElement=S,F.util.wrapElement=function(I,x,L){return"string"==typeof x&&(x=S(x,L)),I.parentNode&&I.parentNode.replaceChild(x,I),x.appendChild(I),x},F.util.getScrollLeftTop=A,F.util.getElementOffset=function(I){var x,L,N=I&&I.ownerDocument,B={left:0,top:0},G={left:0,top:0},U={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!N)return G;for(var W in U)G[U[W]]+=parseInt(C(I,W),10)||0;return x=N.documentElement,void 0!==I.getBoundingClientRect&&(B=I.getBoundingClientRect()),L=A(I),{left:B.left+L.left-(x.clientLeft||0)+G.left,top:B.top+L.top-(x.clientTop||0)+G.top}},F.util.getNodeCanvas=function(I){var x=F.jsdomImplForWrapper(I);return x._canvas||x._image},F.util.cleanUpJsdomNode=function(I){if(F.isLikelyNode){var x=F.jsdomImplForWrapper(I);x&&(x._image=null,x._canvas=null,x._currentSrc=null,x._attributes=null,x._classList=null)}}}(),function(){function D(){}F.util.request=function(C,w){w||(w={});var A,I,T=w.method?w.method.toUpperCase():"GET",m=w.onComplete||function(){},v=new F.window.XMLHttpRequest,S=w.body||w.parameters;return v.onreadystatechange=function(){4===v.readyState&&(m(v),v.onreadystatechange=D)},"GET"===T&&(S=null,"string"==typeof w.parameters&&(I=w.parameters,C=(A=C)+(/\?/.test(A)?"&":"?")+I)),v.open(T,C,!0),"POST"!==T&&"PUT"!==T||v.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),v.send(S),v}}(),F.log=console.log,F.warn=console.warn,function(){var D=F.util.object.extend,C=F.util.object.clone,w=[];function T(){return!1}function m(I,x,L,N){return-L*Math.cos(I/N*(Math.PI/2))+L+x}F.util.object.extend(w,{cancelAll:function(){var I=this.splice(0);return I.forEach(function(x){x.cancel()}),I},cancelByCanvas:function(I){if(!I)return[];var x=this.filter(function(L){return"object"==typeof L.target&&L.target.canvas===I});return x.forEach(function(L){L.cancel()}),x},cancelByTarget:function(I){var x=this.findAnimationsByTarget(I);return x.forEach(function(L){L.cancel()}),x},findAnimationIndex:function(I){return this.indexOf(this.findAnimation(I))},findAnimation:function(I){return this.find(function(x){return x.cancel===I})},findAnimationsByTarget:function(I){return I?this.filter(function(x){return x.target===I}):[]}});var v=F.window.requestAnimationFrame||F.window.webkitRequestAnimationFrame||F.window.mozRequestAnimationFrame||F.window.oRequestAnimationFrame||F.window.msRequestAnimationFrame||function(I){return F.window.setTimeout(I,1e3/60)},S=F.window.cancelAnimationFrame||F.window.clearTimeout;function A(){return v.apply(F.window,arguments)}F.util.animate=function(I){I||(I={});var x,L=!1,N=function(){var B=F.runningAnimations.indexOf(x);return B>-1&&F.runningAnimations.splice(B,1)[0]};return x=D(C(I),{cancel:function(){return L=!0,N()},currentValue:"startValue"in I?I.startValue:0,completionRate:0,durationRate:0}),F.runningAnimations.push(x),A(function(B){var G,U=B||+new Date,W=I.duration||500,q=U+W,ne=I.onChange||T,ie=I.abort||T,he=I.onComplete||T,le=I.easing||m,oe="startValue"in I&&I.startValue.length>0,J="startValue"in I?I.startValue:0,Q="endValue"in I?I.endValue:100,re=I.byValue||(oe?J.map(function(ue,de){return Q[de]-J[de]}):Q-J);I.onStart&&I.onStart(),function ue(de){var te=(G=de||+new Date)>q?W:G-U,ee=te/W,se=oe?J.map(function(ce,pe){return le(te,J[pe],re[pe],W)}):le(te,J,re,W),fe=Math.abs(oe?(se[0]-J[0])/re[0]:(se-J)/re);if(x.currentValue=oe?se.slice():se,x.completionRate=fe,x.durationRate=ee,!L){if(!ie(se,fe,ee))return G>q?(x.currentValue=oe?Q.slice():Q,x.completionRate=1,x.durationRate=1,ne(oe?Q.slice():Q,1,1),he(Q,1,1),void N()):(ne(se,fe,ee),void A(ue));N()}}(U)}),x.cancel},F.util.requestAnimFrame=A,F.util.cancelAnimFrame=function(){return S.apply(F.window,arguments)},F.runningAnimations=w}(),function(){function D(C,w,T){var m="rgba("+parseInt(C[0]+T*(w[0]-C[0]),10)+","+parseInt(C[1]+T*(w[1]-C[1]),10)+","+parseInt(C[2]+T*(w[2]-C[2]),10);return(m+=","+(C&&w?parseFloat(C[3]+T*(w[3]-C[3])):1))+")"}F.util.animateColor=function(C,w,T,m){var v=new F.Color(C).getSource(),S=new F.Color(w).getSource(),A=m.onComplete,I=m.onChange;return F.util.animate(F.util.object.extend(m=m||{},{duration:T||500,startValue:v,endValue:S,byValue:S,easing:function(x,L,N,B){return D(L,N,m.colorEasing?m.colorEasing(x,B):1-Math.cos(x/B*(Math.PI/2)))},onComplete:function(x,L,N){if(A)return A(D(S,S,0),L,N)},onChange:function(x,L,N){if(I){if(Array.isArray(x))return I(D(x,x,0),L,N);I(x,L,N)}}}))}}(),function(){function D(m,v,S,A){return m<Math.abs(v)?(m=v,A=S/4):A=0===v&&0===m?S/(2*Math.PI)*Math.asin(1):S/(2*Math.PI)*Math.asin(v/m),{a:m,c:v,p:S,s:A}}function C(m,v,S){return m.a*Math.pow(2,10*(v-=1))*Math.sin((v*S-m.s)*(2*Math.PI)/m.p)}function w(m,v,S,A){return S-T(A-m,0,S,A)+v}function T(m,v,S,A){return(m/=A)<1/2.75?S*(7.5625*m*m)+v:m<2/2.75?S*(7.5625*(m-=1.5/2.75)*m+.75)+v:m<2.5/2.75?S*(7.5625*(m-=2.25/2.75)*m+.9375)+v:S*(7.5625*(m-=2.625/2.75)*m+.984375)+v}F.util.ease={easeInQuad:function(m,v,S,A){return S*(m/=A)*m+v},easeOutQuad:function(m,v,S,A){return-S*(m/=A)*(m-2)+v},easeInOutQuad:function(m,v,S,A){return(m/=A/2)<1?S/2*m*m+v:-S/2*(--m*(m-2)-1)+v},easeInCubic:function(m,v,S,A){return S*(m/=A)*m*m+v},easeOutCubic:function(m,v,S,A){return S*((m=m/A-1)*m*m+1)+v},easeInOutCubic:function(m,v,S,A){return(m/=A/2)<1?S/2*m*m*m+v:S/2*((m-=2)*m*m+2)+v},easeInQuart:function(m,v,S,A){return S*(m/=A)*m*m*m+v},easeOutQuart:function(m,v,S,A){return-S*((m=m/A-1)*m*m*m-1)+v},easeInOutQuart:function(m,v,S,A){return(m/=A/2)<1?S/2*m*m*m*m+v:-S/2*((m-=2)*m*m*m-2)+v},easeInQuint:function(m,v,S,A){return S*(m/=A)*m*m*m*m+v},easeOutQuint:function(m,v,S,A){return S*((m=m/A-1)*m*m*m*m+1)+v},easeInOutQuint:function(m,v,S,A){return(m/=A/2)<1?S/2*m*m*m*m*m+v:S/2*((m-=2)*m*m*m*m+2)+v},easeInSine:function(m,v,S,A){return-S*Math.cos(m/A*(Math.PI/2))+S+v},easeOutSine:function(m,v,S,A){return S*Math.sin(m/A*(Math.PI/2))+v},easeInOutSine:function(m,v,S,A){return-S/2*(Math.cos(Math.PI*m/A)-1)+v},easeInExpo:function(m,v,S,A){return 0===m?v:S*Math.pow(2,10*(m/A-1))+v},easeOutExpo:function(m,v,S,A){return m===A?v+S:S*(1-Math.pow(2,-10*m/A))+v},easeInOutExpo:function(m,v,S,A){return 0===m?v:m===A?v+S:(m/=A/2)<1?S/2*Math.pow(2,10*(m-1))+v:S/2*(2-Math.pow(2,-10*--m))+v},easeInCirc:function(m,v,S,A){return-S*(Math.sqrt(1-(m/=A)*m)-1)+v},easeOutCirc:function(m,v,S,A){return S*Math.sqrt(1-(m=m/A-1)*m)+v},easeInOutCirc:function(m,v,S,A){return(m/=A/2)<1?-S/2*(Math.sqrt(1-m*m)-1)+v:S/2*(Math.sqrt(1-(m-=2)*m)+1)+v},easeInElastic:function(m,v,S,A){var I=0;return 0===m?v:1==(m/=A)?v+S:(I||(I=.3*A),-C(D(S,S,I,1.70158),m,A)+v)},easeOutElastic:function(m,v,S,A){var I=0;if(0===m)return v;if(1==(m/=A))return v+S;I||(I=.3*A);var x=D(S,S,I,1.70158);return x.a*Math.pow(2,-10*m)*Math.sin((m*A-x.s)*(2*Math.PI)/x.p)+x.c+v},easeInOutElastic:function(m,v,S,A){var I=0;if(0===m)return v;if(2==(m/=A/2))return v+S;I||(I=A*(.3*1.5));var x=D(S,S,I,1.70158);return m<1?-.5*C(x,m,A)+v:x.a*Math.pow(2,-10*(m-=1))*Math.sin((m*A-x.s)*(2*Math.PI)/x.p)*.5+x.c+v},easeInBack:function(m,v,S,A,I){return void 0===I&&(I=1.70158),S*(m/=A)*m*((I+1)*m-I)+v},easeOutBack:function(m,v,S,A,I){return void 0===I&&(I=1.70158),S*((m=m/A-1)*m*((I+1)*m+I)+1)+v},easeInOutBack:function(m,v,S,A,I){return void 0===I&&(I=1.70158),(m/=A/2)<1?S/2*(m*m*((1+(I*=1.525))*m-I))+v:S/2*((m-=2)*m*((1+(I*=1.525))*m+I)+2)+v},easeInBounce:w,easeOutBounce:T,easeInOutBounce:function(m,v,S,A){return m<A/2?.5*w(2*m,0,S,A)+v:.5*T(2*m-A,0,S,A)+.5*S+v}}}(),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.extend,T=C.util.object.clone,m=C.util.toFixed,v=C.util.parseUnit,S=C.util.multiplyTransformMatrices,A={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},I={stroke:"strokeOpacity",fill:"fillOpacity"},x="font-size",L="clip-path";function N(J){return J in A?A[J]:J}function B(J,Q,re,ue){var de,te=Array.isArray(Q);if("fill"!==J&&"stroke"!==J||"none"!==Q){if("strokeUniform"===J)return"non-scaling-stroke"===Q;if("strokeDashArray"===J)Q="none"===Q?null:Q.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===J)Q=re&&re.transformMatrix?S(re.transformMatrix,C.parseTransformAttribute(Q)):C.parseTransformAttribute(Q);else if("visible"===J)Q="none"!==Q&&"hidden"!==Q,re&&!1===re.visible&&(Q=!1);else if("opacity"===J)Q=parseFloat(Q),re&&void 0!==re.opacity&&(Q*=re.opacity);else if("textAnchor"===J)Q="start"===Q?"left":"end"===Q?"right":"center";else if("charSpacing"===J)de=v(Q,ue)/ue*1e3;else if("paintFirst"===J){var ee=Q.indexOf("fill"),se=Q.indexOf("stroke");Q="fill",(ee>-1&&se>-1&&se<ee||-1===ee&&se>-1)&&(Q="stroke")}else{if("href"===J||"xlink:href"===J||"font"===J)return Q;if("imageSmoothing"===J)return"optimizeQuality"===Q;de=te?Q.map(v):v(Q,ue)}}else Q="";return!te&&isNaN(de)?Q:de}function G(J){return new RegExp("^("+J.join("|")+")\\b","i")}function U(J,Q){var ue,de,te,ee=[];for(de=0,te=Q.length;de<te;de++)ue=J.getElementsByTagName(Q[de]),ee=ee.concat(Array.prototype.slice.call(ue));return ee}function W(J,Q){var re,ue=!0;return(re=q(J,Q.pop()))&&Q.length&&(ue=function(de,te){for(var ee,se=!0;de.parentNode&&1===de.parentNode.nodeType&&te.length;)se&&(ee=te.pop()),se=q(de=de.parentNode,ee);return 0===te.length}(J,Q)),re&&ue&&0===Q.length}function q(J,Q){var re,ue,de=J.nodeName,te=J.getAttribute("class"),ee=J.getAttribute("id");if(re=new RegExp("^"+de,"i"),Q=Q.replace(re,""),ee&&Q.length&&(re=new RegExp("#"+ee+"(?![a-zA-Z\\-]+)","i"),Q=Q.replace(re,"")),te&&Q.length)for(ue=(te=te.split(" ")).length;ue--;)re=new RegExp("\\."+te[ue]+"(?![a-zA-Z\\-]+)","i"),Q=Q.replace(re,"");return 0===Q.length}function ne(J,Q){var re;if(J.getElementById&&(re=J.getElementById(Q)),re)return re;var ue,de,te,ee=J.getElementsByTagName("*");for(de=0,te=ee.length;de<te;de++)if(Q===(ue=ee[de]).getAttribute("id"))return ue}C.svgValidTagNamesRegEx=G(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),C.svgViewBoxElementsRegEx=G(["symbol","image","marker","pattern","view","svg"]),C.svgInvalidAncestorsRegEx=G(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),C.svgValidParentsRegEx=G(["symbol","g","a","svg","clipPath","defs"]),C.cssRules={},C.gradientDefs={},C.clipPaths={},C.parseTransformAttribute=function(){function J(se,fe,ce){se[ce]=Math.tan(C.util.degreesToRadians(fe[0]))}var Q=C.iMatrix,re=C.reNum,ue=C.commaWsp,de="(?:(?:(matrix)\\s*\\(\\s*("+re+")"+ue+"("+re+")"+ue+"("+re+")"+ue+"("+re+")"+ue+"("+re+")"+ue+"("+re+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+re+")(?:"+ue+"("+re+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+re+")(?:"+ue+"("+re+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+re+")(?:"+ue+"("+re+")"+ue+"("+re+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+re+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+re+")\\s*\\)))",te=new RegExp("^\\s*(?:(?:"+de+"(?:"+ue+"*"+de+")*)?)\\s*$"),ee=new RegExp(de,"g");return function(se){var fe=Q.concat(),ce=[];if(!se||se&&!te.test(se))return fe;se.replace(ee,function(Se){var be,Ie,we=new RegExp(de).exec(Se).filter(function(be){return!!be}),ye=we[1],De=we.slice(2).map(parseFloat);switch(ye){case"translate":(be=fe)[4]=(Ie=De)[0],2===Ie.length&&(be[5]=Ie[1]);break;case"rotate":De[0]=C.util.degreesToRadians(De[0]),function(be,Ie){var Be=C.util.cos(Ie[0]),Oe=C.util.sin(Ie[0]),st=0,bt=0;3===Ie.length&&(st=Ie[1],bt=Ie[2]),be[0]=Be,be[1]=Oe,be[2]=-Oe,be[3]=Be,be[4]=st-(Be*st-Oe*bt),be[5]=bt-(Oe*st+Be*bt)}(fe,De);break;case"scale":!function(be,Ie){var Oe=2===Ie.length?Ie[1]:Ie[0];be[0]=Ie[0],be[3]=Oe}(fe,De);break;case"skewX":J(fe,De,2);break;case"skewY":J(fe,De,1);break;case"matrix":fe=De}ce.push(fe.concat()),fe=Q.concat()});for(var pe=ce[0];ce.length>1;)ce.shift(),pe=C.util.multiplyTransformMatrices(pe,ce[0]);return pe}}();var ie=new RegExp("^\\s*("+C.reNum+"+)\\s*,?\\s*("+C.reNum+"+)\\s*,?\\s*("+C.reNum+"+)\\s*,?\\s*("+C.reNum+"+)\\s*$");function he(J){if(!C.svgViewBoxElementsRegEx.test(J.nodeName))return{};var Q,re,ue,de,te,ee,se=J.getAttribute("viewBox"),fe=1,ce=1,pe=J.getAttribute("width"),Se=J.getAttribute("height"),we=J.getAttribute("x")||0,ye=J.getAttribute("y")||0,De=J.getAttribute("preserveAspectRatio")||"",be=!se||!(se=se.match(ie)),Ie=!pe||!Se||"100%"===pe||"100%"===Se,Be=be&&Ie,Oe={},st="",bt=0,Li=0;if(Oe.width=0,Oe.height=0,Oe.toBeParsed=Be,be&&(we||ye)&&J.parentNode&&"#document"!==J.parentNode.nodeName&&(st=" translate("+v(we)+" "+v(ye)+") ",te=(J.getAttribute("transform")||"")+st,J.setAttribute("transform",te),J.removeAttribute("x"),J.removeAttribute("y")),Be)return Oe;if(be)return Oe.width=v(pe),Oe.height=v(Se),Oe;if(Q=-parseFloat(se[1]),re=-parseFloat(se[2]),ue=parseFloat(se[3]),de=parseFloat(se[4]),Oe.minX=Q,Oe.minY=re,Oe.viewBoxWidth=ue,Oe.viewBoxHeight=de,Ie?(Oe.width=ue,Oe.height=de):(Oe.width=v(pe),Oe.height=v(Se),fe=Oe.width/ue,ce=Oe.height/de),"none"!==(De=C.util.parsePreserveAspectRatioAttribute(De)).alignX&&("meet"===De.meetOrSlice&&(ce=fe=fe>ce?ce:fe),"slice"===De.meetOrSlice&&(ce=fe=fe>ce?fe:ce),bt=Oe.width-ue*fe,Li=Oe.height-de*fe,"Mid"===De.alignX&&(bt/=2),"Mid"===De.alignY&&(Li/=2),"Min"===De.alignX&&(bt=0),"Min"===De.alignY&&(Li=0)),1===fe&&1===ce&&0===Q&&0===re&&0===we&&0===ye)return Oe;if((we||ye)&&"#document"!==J.parentNode.nodeName&&(st=" translate("+v(we)+" "+v(ye)+") "),te=st+" matrix("+fe+" 0 0 "+ce+" "+(Q*fe+bt)+" "+(re*ce+Li)+") ","svg"===J.nodeName){for(ee=J.ownerDocument.createElementNS(C.svgNS,"g");J.firstChild;)ee.appendChild(J.firstChild);J.appendChild(ee)}else(ee=J).removeAttribute("x"),ee.removeAttribute("y"),te=ee.getAttribute("transform")+te;return ee.setAttribute("transform",te),Oe}function le(J,Q){var re="xlink:href",ue=ne(J,Q.getAttribute(re).slice(1));if(ue&&ue.getAttribute(re)&&le(J,ue),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(te){ue&&!Q.hasAttribute(te)&&ue.hasAttribute(te)&&Q.setAttribute(te,ue.getAttribute(te))}),!Q.children.length)for(var de=ue.cloneNode(!0);de.firstChild;)Q.appendChild(de.firstChild);Q.removeAttribute(re)}C.parseSVGDocument=function(J,Q,re,ue){if(J){!function(we){for(var ye=U(we,["use","svg:use"]),De=0;ye.length&&De<ye.length;){var be=ye[De],Ie=be.getAttribute("xlink:href")||be.getAttribute("href");if(null===Ie)return;var Be,Oe,st,bt,Li=Ie.slice(1),is=be.getAttribute("x")||0,Ha=be.getAttribute("y")||0,zt=ne(we,Li).cloneNode(!0),Fi=(zt.getAttribute("transform")||"")+" translate("+is+", "+Ha+")",Uc=ye.length,Wa=C.svgNS;if(he(zt),/^svg$/i.test(zt.nodeName)){var Co=zt.ownerDocument.createElementNS(Wa,"g");for(Oe=0,bt=(st=zt.attributes).length;Oe<bt;Oe++)Be=st.item(Oe),Co.setAttributeNS(Wa,Be.nodeName,Be.nodeValue);for(;zt.firstChild;)Co.appendChild(zt.firstChild);zt=Co}for(Oe=0,bt=(st=be.attributes).length;Oe<bt;Oe++)"x"!==(Be=st.item(Oe)).nodeName&&"y"!==Be.nodeName&&"xlink:href"!==Be.nodeName&&"href"!==Be.nodeName&&("transform"===Be.nodeName?Fi=Be.nodeValue+" "+Fi:zt.setAttribute(Be.nodeName,Be.nodeValue));zt.setAttribute("transform",Fi),zt.setAttribute("instantiated_by_use","1"),zt.removeAttribute("id"),be.parentNode.replaceChild(zt,be),ye.length===Uc&&De++}}(J);var de,te,ee=C.Object.__uid++,se=he(J),fe=C.util.toArray(J.getElementsByTagName("*"));if(se.crossOrigin=ue&&ue.crossOrigin,se.svgUid=ee,0===fe.length&&C.isLikelyNode){var ce=[];for(de=0,te=(fe=J.selectNodes('//*[name(.)!="svg"]')).length;de<te;de++)ce[de]=fe[de];fe=ce}var pe=fe.filter(function(we){return he(we),C.svgValidTagNamesRegEx.test(we.nodeName.replace("svg:",""))&&!function(ye,De){for(;ye&&(ye=ye.parentNode);)if(ye.nodeName&&De.test(ye.nodeName.replace("svg:",""))&&!ye.getAttribute("instantiated_by_use"))return!0;return!1}(we,C.svgInvalidAncestorsRegEx)});if(!pe||pe&&!pe.length)Q&&Q([],{});else{var Se={};fe.filter(function(we){return"clipPath"===we.nodeName.replace("svg:","")}).forEach(function(we){var ye=we.getAttribute("id");Se[ye]=C.util.toArray(we.getElementsByTagName("*")).filter(function(De){return C.svgValidTagNamesRegEx.test(De.nodeName.replace("svg:",""))})}),C.gradientDefs[ee]=C.getGradientDefs(J),C.cssRules[ee]=C.getCSSRules(J),C.clipPaths[ee]=Se,C.parseElements(pe,function(we,ye){Q&&(Q(we,se,ye,fe),delete C.gradientDefs[ee],delete C.cssRules[ee],delete C.clipPaths[ee])},T(se),re,ue)}}};var oe=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+C.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+C.reNum+"))?\\s+(.*)");w(C,{parseFontDeclaration:function(J,Q){var re=J.match(oe);if(re){var ue=re[1],de=re[3],te=re[4],ee=re[5],se=re[6];ue&&(Q.fontStyle=ue),de&&(Q.fontWeight=isNaN(parseFloat(de))?de:parseFloat(de)),te&&(Q.fontSize=v(te)),se&&(Q.fontFamily=se),ee&&(Q.lineHeight="normal"===ee?1:ee)}},getGradientDefs:function(J){var Q,re=U(J,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),ue=0,de={};for(ue=re.length;ue--;)(Q=re[ue]).getAttribute("xlink:href")&&le(J,Q),de[Q.getAttribute("id")]=Q;return de},parseAttributes:function(J,Q,re){if(J){var ue,de,te,ee={};void 0===re&&(re=J.getAttribute("svgUid")),J.parentNode&&C.svgValidParentsRegEx.test(J.parentNode.nodeName)&&(ee=C.parseAttributes(J.parentNode,Q,re));var se=Q.reduce(function(De,be){return(ue=J.getAttribute(be))&&(De[be]=ue),De},{}),fe=w(function(De,be){var Ie={};for(var Be in C.cssRules[be])if(W(De,Be.split(" ")))for(var Oe in C.cssRules[be][Be])Ie[Oe]=C.cssRules[be][Be][Oe];return Ie}(J,re),C.parseStyleAttribute(J));se=w(se,fe),fe[L]&&J.setAttribute(L,fe[L]),de=te=ee.fontSize||C.Text.DEFAULT_SVG_FONT_SIZE,se[x]&&(se[x]=de=v(se[x],te));var ce,pe,Se={};for(var we in se)pe=B(ce=N(we),se[we],ee,de),Se[ce]=pe;Se&&Se.font&&C.parseFontDeclaration(Se.font,Se);var ye=w(ee,Se);return C.svgValidParentsRegEx.test(J.nodeName)?ye:function(De){for(var be in I)if(void 0!==De[I[be]]&&""!==De[be]){if(void 0===De[be]){if(!C.Object.prototype[be])continue;De[be]=C.Object.prototype[be]}if(0!==De[be].indexOf("url(")){var Ie=new C.Color(De[be]);De[be]=Ie.setAlpha(m(Ie.getAlpha()*De[I[be]],2)).toRgba()}}return De}(ye)}},parseElements:function(J,Q,re,ue,de){new C.ElementsParser(J,Q,re,ue,de).parse()},parseStyleAttribute:function(J){var de,te,ee,Q={},re=J.getAttribute("style");return re&&("string"==typeof re?(de=Q,re.replace(/;\s*$/,"").split(";").forEach(function(se){var fe=se.split(":");te=fe[0].trim().toLowerCase(),ee=fe[1].trim(),de[te]=ee})):function(ue,de){for(var se in ue)void 0!==ue[se]&&(de[se.toLowerCase()]=ue[se])}(re,Q)),Q},parsePointsAttribute:function(J){if(!J)return null;var Q,re,ue=[];for(Q=0,re=(J=(J=J.replace(/,/g," ").trim()).split(/\s+/)).length;Q<re;Q+=2)ue.push({x:parseFloat(J[Q]),y:parseFloat(J[Q+1])});return ue},getCSSRules:function(J){var Q,re,ue=J.getElementsByTagName("style"),de={};for(Q=0,re=ue.length;Q<re;Q++){var te=ue[Q].textContent;""!==(te=te.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&te.split("}").filter(function(ee){return ee.trim()}).forEach(function(ee){var se=ee.split("{"),fe={},ce=se[1].trim().split(";").filter(function(ye){return ye.trim()});for(Q=0,re=ce.length;Q<re;Q++){var pe=ce[Q].split(":"),Se=pe[0].trim(),we=pe[1].trim();fe[Se]=we}(ee=se[0].trim()).split(",").forEach(function(ye){""!==(ye=ye.replace(/^svg/i,"").trim())&&(de[ye]?C.util.object.extend(de[ye],fe):de[ye]=C.util.object.clone(fe))})})}return de},loadSVGFromURL:function(J,Q,re,ue){J=J.replace(/^\n\s*/,"").trim(),new C.util.request(J,{method:"get",onComplete:function(de){var te=de.responseXML;if(!te||!te.documentElement)return Q&&Q(null),!1;C.parseSVGDocument(te.documentElement,function(ee,se,fe,ce){Q&&Q(ee,se,fe,ce)},re,ue)}})},loadSVGFromString:function(J,Q,re,ue){var de=(new C.window.DOMParser).parseFromString(J.trim(),"text/xml");C.parseSVGDocument(de.documentElement,function(te,ee,se,fe){Q(te,ee,se,fe)},re,ue)}})}(a),F.ElementsParser=function(D,C,w,T,m,v){this.elements=D,this.callback=C,this.options=w,this.reviver=T,this.svgUid=w&&w.svgUid||0,this.parsingOptions=m,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=v},(Y=F.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},Y.createObjects=function(){var D=this;this.elements.forEach(function(C,w){C.setAttribute("svgUid",D.svgUid),D.createObject(C,w)})},Y.findTag=function(D){return F[F.util.string.capitalize(D.tagName.replace("svg:",""))]},Y.createObject=function(D,C){var w=this.findTag(D);if(w&&w.fromElement)try{w.fromElement(D,this.createCallback(C,D),this.options)}catch(T){F.log(T)}else this.checkIfDone()},Y.createCallback=function(D,C){var w=this;return function(T){var m;w.resolveGradient(T,C,"fill"),w.resolveGradient(T,C,"stroke"),T instanceof F.Image&&T._originalElement&&(m=T.parsePreserveAspectRatioAttribute(C)),T._removeTransformMatrix(m),w.resolveClipPath(T,C),w.reviver&&w.reviver(C,T),w.instances[D]=T,w.checkIfDone()}},Y.extractPropertyDefinition=function(D,C,w){var T=D[C],m=this.regexUrl;if(m.test(T)){m.lastIndex=0;var v=m.exec(T)[1];return m.lastIndex=0,F[w][this.svgUid][v]}},Y.resolveGradient=function(D,C,w){var T=this.extractPropertyDefinition(D,w,"gradientDefs");if(T){var m=C.getAttribute(w+"-opacity"),v=F.Gradient.fromElement(T,D,m,this.options);D.set(w,v)}},Y.createClipPathCallback=function(D,C){return function(w){w._removeTransformMatrix(),w.fillRule=w.clipRule,C.push(w)}},Y.resolveClipPath=function(D,C){var w,T,m,v,S=this.extractPropertyDefinition(D,"clipPath","clipPaths");if(S){m=[],T=F.util.invertTransform(D.calcTransformMatrix());for(var A=S[0].parentNode,I=C;I.parentNode&&I.getAttribute("clip-path")!==D.clipPath;)I=I.parentNode;I.parentNode.appendChild(A);for(var x=0;x<S.length;x++)this.findTag(w=S[x]).fromElement(w,this.createClipPathCallback(D,m),this.options);S=1===m.length?m[0]:new F.Group(m),v=F.util.multiplyTransformMatrices(T,S.calcTransformMatrix()),S.clipPath&&this.resolveClipPath(S,I);var L=F.util.qrDecompose(v);S.flipX=!1,S.flipY=!1,S.set("scaleX",L.scaleX),S.set("scaleY",L.scaleY),S.angle=L.angle,S.skewX=L.skewX,S.skewY=0,S.setPositionByOrigin({x:L.translateX,y:L.translateY},"center","center"),D.clipPath=S}else delete D.clipPath},Y.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter(function(D){return null!=D}),this.callback(this.instances,this.elements))},function(D){var C=D.fabric||(D.fabric={});function w(T,m){this.x=T,this.y=m}C.Point?C.warn("fabric.Point is already defined"):(C.Point=w,w.prototype={type:"point",constructor:w,add:function(T){return new w(this.x+T.x,this.y+T.y)},addEquals:function(T){return this.x+=T.x,this.y+=T.y,this},scalarAdd:function(T){return new w(this.x+T,this.y+T)},scalarAddEquals:function(T){return this.x+=T,this.y+=T,this},subtract:function(T){return new w(this.x-T.x,this.y-T.y)},subtractEquals:function(T){return this.x-=T.x,this.y-=T.y,this},scalarSubtract:function(T){return new w(this.x-T,this.y-T)},scalarSubtractEquals:function(T){return this.x-=T,this.y-=T,this},multiply:function(T){return new w(this.x*T,this.y*T)},multiplyEquals:function(T){return this.x*=T,this.y*=T,this},divide:function(T){return new w(this.x/T,this.y/T)},divideEquals:function(T){return this.x/=T,this.y/=T,this},eq:function(T){return this.x===T.x&&this.y===T.y},lt:function(T){return this.x<T.x&&this.y<T.y},lte:function(T){return this.x<=T.x&&this.y<=T.y},gt:function(T){return this.x>T.x&&this.y>T.y},gte:function(T){return this.x>=T.x&&this.y>=T.y},lerp:function(T,m){return void 0===m&&(m=.5),m=Math.max(Math.min(1,m),0),new w(this.x+(T.x-this.x)*m,this.y+(T.y-this.y)*m)},distanceFrom:function(T){var m=this.x-T.x,v=this.y-T.y;return Math.sqrt(m*m+v*v)},midPointFrom:function(T){return this.lerp(T)},min:function(T){return new w(Math.min(this.x,T.x),Math.min(this.y,T.y))},max:function(T){return new w(Math.max(this.x,T.x),Math.max(this.y,T.y))},toString:function(){return this.x+","+this.y},setXY:function(T,m){return this.x=T,this.y=m,this},setX:function(T){return this.x=T,this},setY:function(T){return this.y=T,this},setFromPoint:function(T){return this.x=T.x,this.y=T.y,this},swap:function(T){var m=this.x,v=this.y;this.x=T.x,this.y=T.y,T.x=m,T.y=v},clone:function(){return new w(this.x,this.y)}})}(a),function(D){var C=D.fabric||(D.fabric={});function w(T){this.status=T,this.points=[]}C.Intersection?C.warn("fabric.Intersection is already defined"):(C.Intersection=w,C.Intersection.prototype={constructor:w,appendPoint:function(T){return this.points.push(T),this},appendPoints:function(T){return this.points=this.points.concat(T),this}},C.Intersection.intersectLineLine=function(T,m,v,S){var A,I=(S.x-v.x)*(T.y-v.y)-(S.y-v.y)*(T.x-v.x),x=(m.x-T.x)*(T.y-v.y)-(m.y-T.y)*(T.x-v.x),L=(S.y-v.y)*(m.x-T.x)-(S.x-v.x)*(m.y-T.y);if(0!==L){var N=I/L,B=x/L;0<=N&&N<=1&&0<=B&&B<=1?(A=new w("Intersection")).appendPoint(new C.Point(T.x+N*(m.x-T.x),T.y+N*(m.y-T.y))):A=new w}else A=new w(0===I||0===x?"Coincident":"Parallel");return A},C.Intersection.intersectLinePolygon=function(T,m,v){var I,x,L=new w,N=v.length;for(x=0;x<N;x++)I=w.intersectLineLine(T,m,v[x],v[(x+1)%N]),L.appendPoints(I.points);return L.points.length>0&&(L.status="Intersection"),L},C.Intersection.intersectPolygonPolygon=function(T,m){var v,S=new w,A=T.length;for(v=0;v<A;v++){var L=w.intersectLinePolygon(T[v],T[(v+1)%A],m);S.appendPoints(L.points)}return S.points.length>0&&(S.status="Intersection"),S},C.Intersection.intersectPolygonRectangle=function(T,m,v){var S=m.min(v),A=m.max(v),I=new C.Point(A.x,S.y),x=new C.Point(S.x,A.y),L=w.intersectLinePolygon(S,I,T),N=w.intersectLinePolygon(I,A,T),B=w.intersectLinePolygon(A,x,T),G=w.intersectLinePolygon(x,S,T),U=new w;return U.appendPoints(L.points),U.appendPoints(N.points),U.appendPoints(B.points),U.appendPoints(G.points),U.points.length>0&&(U.status="Intersection"),U})}(a),function(D){var C=D.fabric||(D.fabric={});function w(m){m?this._tryParsingColor(m):this.setSource([0,0,0,1])}function T(m,v,S){return S<0&&(S+=1),S>1&&(S-=1),S<1/6?m+6*(v-m)*S:S<.5?v:S<2/3?m+(v-m)*(2/3-S)*6:m}C.Color?C.warn("fabric.Color is already defined."):(C.Color=w,C.Color.prototype={_tryParsingColor:function(m){var v;m in w.colorNameMap&&(m=w.colorNameMap[m]),"transparent"===m&&(v=[255,255,255,0]),v||(v=w.sourceFromHex(m)),v||(v=w.sourceFromRgb(m)),v||(v=w.sourceFromHsl(m)),v||(v=[0,0,0,1]),v&&this.setSource(v)},_rgbToHsl:function(m,v,S){var A,I,x,L=C.util.array.max([m/=255,v/=255,S/=255]),N=C.util.array.min([m,v,S]);if(x=(L+N)/2,L===N)A=I=0;else{var B=L-N;switch(I=x>.5?B/(2-L-N):B/(L+N),L){case m:A=(v-S)/B+(v<S?6:0);break;case v:A=(S-m)/B+2;break;case S:A=(m-v)/B+4}A/=6}return[Math.round(360*A),Math.round(100*I),Math.round(100*x)]},getSource:function(){return this._source},setSource:function(m){this._source=m},toRgb:function(){var m=this.getSource();return"rgb("+m[0]+","+m[1]+","+m[2]+")"},toRgba:function(){var m=this.getSource();return"rgba("+m[0]+","+m[1]+","+m[2]+","+m[3]+")"},toHsl:function(){var m=this.getSource(),v=this._rgbToHsl(m[0],m[1],m[2]);return"hsl("+v[0]+","+v[1]+"%,"+v[2]+"%)"},toHsla:function(){var m=this.getSource(),v=this._rgbToHsl(m[0],m[1],m[2]);return"hsla("+v[0]+","+v[1]+"%,"+v[2]+"%,"+m[3]+")"},toHex:function(){var m,v,S,A=this.getSource();return m=1===(m=A[0].toString(16)).length?"0"+m:m,v=1===(v=A[1].toString(16)).length?"0"+v:v,S=1===(S=A[2].toString(16)).length?"0"+S:S,m.toUpperCase()+v.toUpperCase()+S.toUpperCase()},toHexa:function(){var m,v=this.getSource();return m=1===(m=(m=Math.round(255*v[3])).toString(16)).length?"0"+m:m,this.toHex()+m.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(m){var v=this.getSource();return v[3]=m,this.setSource(v),this},toGrayscale:function(){var m=this.getSource(),v=parseInt((.3*m[0]+.59*m[1]+.11*m[2]).toFixed(0),10);return this.setSource([v,v,v,m[3]]),this},toBlackWhite:function(m){var v=this.getSource(),S=(.3*v[0]+.59*v[1]+.11*v[2]).toFixed(0),A=v[3];return m=m||127,S=Number(S)<Number(m)?0:255,this.setSource([S,S,S,A]),this},overlayWith:function(m){m instanceof w||(m=new w(m));var v,S=[],A=this.getAlpha(),I=this.getSource(),x=m.getSource();for(v=0;v<3;v++)S.push(Math.round(.5*I[v]+.5*x[v]));return S[3]=A,this.setSource(S),this}},C.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,C.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,C.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,C.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},C.Color.fromRgb=function(m){return w.fromSource(w.sourceFromRgb(m))},C.Color.sourceFromRgb=function(m){var v=m.match(w.reRGBa);if(v){var S=parseInt(v[1],10)/(/%$/.test(v[1])?100:1)*(/%$/.test(v[1])?255:1),A=parseInt(v[2],10)/(/%$/.test(v[2])?100:1)*(/%$/.test(v[2])?255:1),I=parseInt(v[3],10)/(/%$/.test(v[3])?100:1)*(/%$/.test(v[3])?255:1);return[parseInt(S,10),parseInt(A,10),parseInt(I,10),v[4]?parseFloat(v[4]):1]}},C.Color.fromRgba=w.fromRgb,C.Color.fromHsl=function(m){return w.fromSource(w.sourceFromHsl(m))},C.Color.sourceFromHsl=function(m){var v=m.match(w.reHSLa);if(v){var S,A,I,x=(parseFloat(v[1])%360+360)%360/360,L=parseFloat(v[2])/(/%$/.test(v[2])?100:1),N=parseFloat(v[3])/(/%$/.test(v[3])?100:1);if(0===L)S=A=I=N;else{var B=N<=.5?N*(L+1):N+L-N*L,G=2*N-B;S=T(G,B,x+1/3),A=T(G,B,x),I=T(G,B,x-1/3)}return[Math.round(255*S),Math.round(255*A),Math.round(255*I),v[4]?parseFloat(v[4]):1]}},C.Color.fromHsla=w.fromHsl,C.Color.fromHex=function(m){return w.fromSource(w.sourceFromHex(m))},C.Color.sourceFromHex=function(m){if(m.match(w.reHex)){var v=m.slice(m.indexOf("#")+1),S=3===v.length||4===v.length,A=8===v.length||4===v.length,I=S?v.charAt(0)+v.charAt(0):v.substring(0,2),x=S?v.charAt(1)+v.charAt(1):v.substring(2,4),L=S?v.charAt(2)+v.charAt(2):v.substring(4,6),N=A?S?v.charAt(3)+v.charAt(3):v.substring(6,8):"FF";return[parseInt(I,16),parseInt(x,16),parseInt(L,16),parseFloat((parseInt(N,16)/255).toFixed(2))]}},C.Color.fromSource=function(m){var v=new w;return v.setSource(m),v})}(a),function(D){var C=D.fabric||(D.fabric={}),w=["e","se","s","sw","w","nw","n","ne","e"],T=["ns","nesw","ew","nwse"],m={},v="left",S="top",A="right",I="bottom",x="center",L={top:I,bottom:S,left:A,right:v,center:x},N=C.util.radiansToDegrees,B=Math.sign||function(te){return(te>0)-(te<0)||+te};function G(te,ee){var se=te.angle+N(Math.atan2(ee.y,ee.x))+360;return Math.round(se%360/45)}function U(te,ee){var se=ee.transform.target,fe=se.canvas,ce=C.util.object.clone(ee);ce.target=se,fe&&fe.fire("object:"+te,ce),se.fire(te,ee)}function W(te,ee){var se=ee.canvas,fe=te[se.uniScaleKey];return se.uniformScaling&&!fe||!se.uniformScaling&&fe}function q(te){return te.originX===x&&te.originY===x}function ne(te,ee,se){var fe=te.lockScalingX,ce=te.lockScalingY;return!((!fe||!ce)&&(ee||!fe&&!ce||!se)&&(!fe||"x"!==ee)&&(!ce||"y"!==ee))}function ie(te,ee,se,fe){return{e:te,transform:ee,pointer:{x:se,y:fe}}}function he(te){return function(ee,se,fe,ce){var pe=se.target,Se=pe.getCenterPoint(),we=pe.translateToOriginPoint(Se,se.originX,se.originY),ye=te(ee,se,fe,ce);return pe.setPositionByOrigin(we,se.originX,se.originY),ye}}function le(te,ee){return function(se,fe,ce,pe){var Se=ee(se,fe,ce,pe);return Se&&U(te,ie(se,fe,ce,pe)),Se}}function oe(te,ee,se,fe,ce){var pe=te.target,Se=pe.controls[te.corner],we=pe.canvas.getZoom(),ye=pe.padding/we,De=pe.toLocalPoint(new C.Point(fe,ce),ee,se);return De.x>=ye&&(De.x-=ye),De.x<=-ye&&(De.x+=ye),De.y>=ye&&(De.y-=ye),De.y<=ye&&(De.y+=ye),De.x-=Se.offsetX,De.y-=Se.offsetY,De}function J(te){return te.flipX!==te.flipY}function Q(te,ee,se,fe,ce){if(0!==te[ee]){var pe=ce/te._getTransformedDimensions()[fe]*te[se];te.set(se,pe)}}function re(te,ee,se,fe){var ce,pe=ee.target,Se=pe._getTransformedDimensions(0,pe.skewY),we=oe(ee,ee.originX,ee.originY,se,fe),ye=Math.abs(2*we.x)-Se.x,De=pe.skewX;ye<2?ce=0:(ce=N(Math.atan2(ye/pe.scaleX,Se.y/pe.scaleY)),ee.originX===v&&ee.originY===I&&(ce=-ce),ee.originX===A&&ee.originY===S&&(ce=-ce),J(pe)&&(ce=-ce));var be=De!==ce;if(be){var Ie=pe._getTransformedDimensions().y;pe.set("skewX",ce),Q(pe,"skewY","scaleY","y",Ie)}return be}function ue(te,ee,se,fe){var ce,pe=ee.target,Se=pe._getTransformedDimensions(pe.skewX,0),we=oe(ee,ee.originX,ee.originY,se,fe),ye=Math.abs(2*we.y)-Se.y,De=pe.skewY;ye<2?ce=0:(ce=N(Math.atan2(ye/pe.scaleY,Se.x/pe.scaleX)),ee.originX===v&&ee.originY===I&&(ce=-ce),ee.originX===A&&ee.originY===S&&(ce=-ce),J(pe)&&(ce=-ce));var be=De!==ce;if(be){var Ie=pe._getTransformedDimensions().x;pe.set("skewY",ce),Q(pe,"skewX","scaleX","x",Ie)}return be}function de(te,ee,se,fe,ce){var pe,Se,we,ye,De,be,Ie=ee.target,Be=Ie.lockScalingX,Oe=Ie.lockScalingY,st=(ce=ce||{}).by,bt=W(te,Ie),Li=ne(Ie,st,bt),is=ee.gestureScale;if(Li)return!1;if(is)Se=ee.scaleX*is,we=ee.scaleY*is;else{if(pe=oe(ee,ee.originX,ee.originY,se,fe),De="y"!==st?B(pe.x):1,be="x"!==st?B(pe.y):1,ee.signX||(ee.signX=De),ee.signY||(ee.signY=be),Ie.lockScalingFlip&&(ee.signX!==De||ee.signY!==be))return!1;if(ye=Ie._getTransformedDimensions(),bt&&!st){var Ha=Math.abs(pe.x)+Math.abs(pe.y),zt=ee.original,Fi=Ha/(Math.abs(ye.x*zt.scaleX/Ie.scaleX)+Math.abs(ye.y*zt.scaleY/Ie.scaleY));Se=zt.scaleX*Fi,we=zt.scaleY*Fi}else Se=Math.abs(pe.x*Ie.scaleX/ye.x),we=Math.abs(pe.y*Ie.scaleY/ye.y);q(ee)&&(Se*=2,we*=2),ee.signX!==De&&"y"!==st&&(ee.originX=L[ee.originX],Se*=-1,ee.signX=De),ee.signY!==be&&"x"!==st&&(ee.originY=L[ee.originY],we*=-1,ee.signY=be)}var Uc=Ie.scaleX,Wa=Ie.scaleY;return st?("x"===st&&Ie.set("scaleX",Se),"y"===st&&Ie.set("scaleY",we)):(!Be&&Ie.set("scaleX",Se),!Oe&&Ie.set("scaleY",we)),Uc!==Ie.scaleX||Wa!==Ie.scaleY}m.scaleCursorStyleHandler=function(te,ee,se){var fe=W(te,se),ce="";if(0!==ee.x&&0===ee.y?ce="x":0===ee.x&&0!==ee.y&&(ce="y"),ne(se,ce,fe))return"not-allowed";var pe=G(se,ee);return w[pe]+"-resize"},m.skewCursorStyleHandler=function(te,ee,se){if(0!==ee.x&&se.lockSkewingY||0!==ee.y&&se.lockSkewingX)return"not-allowed";var ce=G(se,ee)%4;return T[ce]+"-resize"},m.scaleSkewCursorStyleHandler=function(te,ee,se){return te[se.canvas.altActionKey]?m.skewCursorStyleHandler(te,ee,se):m.scaleCursorStyleHandler(te,ee,se)},m.rotationWithSnapping=le("rotating",he(function(te,ee,se,fe){var ce=ee,pe=ce.target,Se=pe.translateToOriginPoint(pe.getCenterPoint(),ce.originX,ce.originY);if(pe.lockRotation)return!1;var we,ye=Math.atan2(ce.ey-Se.y,ce.ex-Se.x),De=Math.atan2(fe-Se.y,se-Se.x),be=N(De-ye+ce.theta);if(pe.snapAngle>0){var Ie=pe.snapAngle,Be=pe.snapThreshold||Ie,Oe=Math.ceil(be/Ie)*Ie,st=Math.floor(be/Ie)*Ie;Math.abs(be-st)<Be?be=st:Math.abs(be-Oe)<Be&&(be=Oe)}return be<0&&(be=360+be),we=pe.angle!==(be%=360),pe.angle=be,we})),m.scalingEqually=le("scaling",he(function(te,ee,se,fe){return de(te,ee,se,fe)})),m.scalingX=le("scaling",he(function(te,ee,se,fe){return de(te,ee,se,fe,{by:"x"})})),m.scalingY=le("scaling",he(function(te,ee,se,fe){return de(te,ee,se,fe,{by:"y"})})),m.scalingYOrSkewingX=function(te,ee,se,fe){return te[ee.target.canvas.altActionKey]?m.skewHandlerX(te,ee,se,fe):m.scalingY(te,ee,se,fe)},m.scalingXOrSkewingY=function(te,ee,se,fe){return te[ee.target.canvas.altActionKey]?m.skewHandlerY(te,ee,se,fe):m.scalingX(te,ee,se,fe)},m.changeWidth=le("resizing",he(function(te,ee,se,fe){var ce=ee.target,pe=oe(ee,ee.originX,ee.originY,se,fe),Se=ce.strokeWidth/(ce.strokeUniform?ce.scaleX:1),we=q(ee)?2:1,ye=ce.width,De=Math.abs(pe.x*we/ce.scaleX)-Se;return ce.set("width",Math.max(De,0)),ye!==De})),m.skewHandlerX=function(te,ee,se,fe){var ce,pe=ee.target,Se=pe.skewX,we=ee.originY;return!pe.lockSkewingX&&(0===Se?ce=oe(ee,x,x,se,fe).x>0?v:A:(Se>0&&(ce=we===S?v:A),Se<0&&(ce=we===S?A:v),J(pe)&&(ce=ce===v?A:v)),ee.originX=ce,le("skewing",he(re))(te,ee,se,fe))},m.skewHandlerY=function(te,ee,se,fe){var ce,pe=ee.target,Se=pe.skewY,we=ee.originX;return!pe.lockSkewingY&&(0===Se?ce=oe(ee,x,x,se,fe).y>0?S:I:(Se>0&&(ce=we===v?S:I),Se<0&&(ce=we===v?I:S),J(pe)&&(ce=ce===S?I:S)),ee.originY=ce,le("skewing",he(ue))(te,ee,se,fe))},m.dragHandler=function(te,ee,se,fe){var ce=ee.target,pe=se-ee.offsetX,Se=fe-ee.offsetY,we=!ce.get("lockMovementX")&&ce.left!==pe,ye=!ce.get("lockMovementY")&&ce.top!==Se;return we&&ce.set("left",pe),ye&&ce.set("top",Se),(we||ye)&&U("moving",ie(te,ee,se,fe)),we||ye},m.scaleOrSkewActionName=function(te,ee,se){var fe=te[se.canvas.altActionKey];return 0===ee.x?fe?"skewX":"scaleY":0===ee.y?fe?"skewY":"scaleX":void 0},m.rotationStyleHandler=function(te,ee,se){return se.lockRotation?"not-allowed":ee.cursorStyle},m.fireEvent=U,m.wrapWithFixedAnchor=he,m.wrapWithFireEvent=le,m.getLocalPoint=oe,C.controlsUtils=m}(a),C=(D=a).fabric||(D.fabric={}),w=C.util.degreesToRadians,(T=C.controlsUtils).renderCircleControl=function(m,v,S,A,I){A=A||{};var x,L=this.sizeX||A.cornerSize||I.cornerSize,N=this.sizeY||A.cornerSize||I.cornerSize,B=void 0!==A.transparentCorners?A.transparentCorners:I.transparentCorners,G=B?"stroke":"fill",U=!B&&(A.cornerStrokeColor||I.cornerStrokeColor),W=v,q=S;m.save(),m.fillStyle=A.cornerColor||I.cornerColor,m.strokeStyle=A.cornerStrokeColor||I.cornerStrokeColor,L>N?(x=L,m.scale(1,N/L),q=S*L/N):N>L?(x=N,m.scale(L/N,1),W=v*N/L):x=L,m.lineWidth=1,m.beginPath(),m.arc(W,q,x/2,0,2*Math.PI,!1),m[G](),U&&m.stroke(),m.restore()},T.renderSquareControl=function(m,v,S,A,I){A=A||{};var x=this.sizeX||A.cornerSize||I.cornerSize,L=this.sizeY||A.cornerSize||I.cornerSize,N=void 0!==A.transparentCorners?A.transparentCorners:I.transparentCorners,B=N?"stroke":"fill",G=!N&&(A.cornerStrokeColor||I.cornerStrokeColor),U=x/2,W=L/2;m.save(),m.fillStyle=A.cornerColor||I.cornerColor,m.strokeStyle=A.cornerStrokeColor||I.cornerStrokeColor,m.lineWidth=1,m.translate(v,S),m.rotate(w(I.angle)),m[B+"Rect"](-U,-W,x,L),G&&m.strokeRect(-U,-W,x,L),m.restore()},function(D){var C=D.fabric||(D.fabric={});C.Control=function(w){for(var T in w)this[T]=w[T]},C.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(w,T){return T.cursorStyle},getActionName:function(w,T){return T.actionName},getVisibility:function(w,T){var m=w._controlsVisibility;return m&&void 0!==m[T]?m[T]:this.visible},setVisibility:function(w){this.visible=w},positionHandler:function(w,T){return C.util.transformPoint({x:this.x*w.x+this.offsetX,y:this.y*w.y+this.offsetY},T)},calcCornerCoords:function(w,T,m,v,S){var A,I,x,L,N=S?this.touchSizeX:this.sizeX,B=S?this.touchSizeY:this.sizeY;if(N&&B&&N!==B){var G=Math.atan2(B,N),U=Math.sqrt(N*N+B*B)/2,W=G-C.util.degreesToRadians(w),q=Math.PI/2-G-C.util.degreesToRadians(w);A=U*C.util.cos(W),I=U*C.util.sin(W),x=U*C.util.cos(q),L=U*C.util.sin(q)}else U=.7071067812*(N&&B?N:T),W=C.util.degreesToRadians(45-w),A=x=U*C.util.cos(W),I=L=U*C.util.sin(W);return{tl:{x:m-L,y:v-x},tr:{x:m+A,y:v-I},bl:{x:m-A,y:v+I},br:{x:m+L,y:v+x}}},render:function(w,T,m,v,S){"circle"===((v=v||{}).cornerStyle||S.cornerStyle)?C.controlsUtils.renderCircleControl.call(this,w,T,m,v,S):C.controlsUtils.renderSquareControl.call(this,w,T,m,v,S)}}}(a),function(){function D(w,T){var m,v,S,A,I=w.getAttribute("style"),x=w.getAttribute("offset")||0;if(x=(x=parseFloat(x)/(/%$/.test(x)?100:1))<0?0:x>1?1:x,I){var L=I.split(/\s*;\s*/);for(""===L[L.length-1]&&L.pop(),A=L.length;A--;){var N=L[A].split(/\s*:\s*/),B=N[0].trim(),G=N[1].trim();"stop-color"===B?m=G:"stop-opacity"===B&&(S=G)}}return m||(m=w.getAttribute("stop-color")||"rgb(0,0,0)"),S||(S=w.getAttribute("stop-opacity")),v=(m=new F.Color(m)).getAlpha(),S=isNaN(parseFloat(S))?1:parseFloat(S),S*=v*T,{offset:x,color:m.toRgb(),opacity:S}}var C=F.util.object.clone;F.Gradient=F.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(w){w||(w={}),w.coords||(w.coords={});var T,m=this;Object.keys(w).forEach(function(v){m[v]=w[v]}),this.id?this.id+="_"+F.Object.__uid++:this.id=F.Object.__uid++,T={x1:w.coords.x1||0,y1:w.coords.y1||0,x2:w.coords.x2||0,y2:w.coords.y2||0},"radial"===this.type&&(T.r1=w.coords.r1||0,T.r2=w.coords.r2||0),this.coords=T,this.colorStops=w.colorStops.slice()},addColorStop:function(w){for(var T in w){var m=new F.Color(w[T]);this.colorStops.push({offset:parseFloat(T),color:m.toRgb(),opacity:m.getAlpha()})}return this},toObject:function(w){var T={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return F.util.populateWithProperties(this,T,w),T},toSVG:function(w,T){var m,v,S,A,I=C(this.coords,!0),x=(T=T||{},C(this.colorStops,!0)),L=I.r1>I.r2,N=this.gradientTransform?this.gradientTransform.concat():F.iMatrix.concat(),B=-this.offsetX,G=-this.offsetY,U=!!T.additionalTransform,W="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(x.sort(function(he,le){return he.offset-le.offset}),"objectBoundingBox"===W?(B/=w.width,G/=w.height):(B+=w.width/2,G+=w.height/2),"path"===w.type&&"percentage"!==this.gradientUnits&&(B-=w.pathOffset.x,G-=w.pathOffset.y),N[4]-=B,N[5]-=G,A='id="SVGID_'+this.id+'" gradientUnits="'+W+'"',A+=' gradientTransform="'+(U?T.additionalTransform+" ":"")+F.util.matrixToSVG(N)+'" ',"linear"===this.type?S=["<linearGradient ",A,' x1="',I.x1,'" y1="',I.y1,'" x2="',I.x2,'" y2="',I.y2,'">\n']:"radial"===this.type&&(S=["<radialGradient ",A,' cx="',L?I.x1:I.x2,'" cy="',L?I.y1:I.y2,'" r="',L?I.r1:I.r2,'" fx="',L?I.x2:I.x1,'" fy="',L?I.y2:I.y1,'">\n']),"radial"===this.type){if(L)for((x=x.concat()).reverse(),m=0,v=x.length;m<v;m++)x[m].offset=1-x[m].offset;var q=Math.min(I.r1,I.r2);if(q>0){var ne=q/Math.max(I.r1,I.r2);for(m=0,v=x.length;m<v;m++)x[m].offset+=ne*(1-x[m].offset)}}for(m=0,v=x.length;m<v;m++){var ie=x[m];S.push("<stop ",'offset="',100*ie.offset+"%",'" style="stop-color:',ie.color,void 0!==ie.opacity?";stop-opacity: "+ie.opacity:";",'"/>\n')}return S.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),S.join("")},toLive:function(w){var T,m,v,S=F.util.object.clone(this.coords);if(this.type){for("linear"===this.type?T=w.createLinearGradient(S.x1,S.y1,S.x2,S.y2):"radial"===this.type&&(T=w.createRadialGradient(S.x1,S.y1,S.r1,S.x2,S.y2,S.r2)),m=0,v=this.colorStops.length;m<v;m++){var A=this.colorStops[m].color,I=this.colorStops[m].opacity,x=this.colorStops[m].offset;void 0!==I&&(A=new F.Color(A).setAlpha(I).toRgba()),T.addColorStop(x,A)}return T}}}),F.util.object.extend(F.Gradient,{fromElement:function(w,T,m,v){var S=parseFloat(m)/(/%$/.test(m)?100:1);S=S<0?0:S>1?1:S,isNaN(S)&&(S=1);var A,I,x,L,ne,ie,he,le,oe,J,N=w.getElementsByTagName("stop"),B="userSpaceOnUse"===w.getAttribute("gradientUnits")?"pixels":"percentage",G=w.getAttribute("gradientTransform")||"",U=[],W=0,q=0;for("linearGradient"===w.nodeName||"LINEARGRADIENT"===w.nodeName?(A="linear",I={x1:(ne=w).getAttribute("x1")||0,y1:ne.getAttribute("y1")||0,x2:ne.getAttribute("x2")||"100%",y2:ne.getAttribute("y2")||0}):(A="radial",I=function(ne){return{x1:ne.getAttribute("fx")||ne.getAttribute("cx")||"50%",y1:ne.getAttribute("fy")||ne.getAttribute("cy")||"50%",r1:0,x2:ne.getAttribute("cx")||"50%",y2:ne.getAttribute("cy")||"50%",r2:ne.getAttribute("r")||"50%"}}(w)),x=N.length;x--;)U.push(D(N[x],S));return L=F.parseTransformAttribute(G),ie=I,he=v,le=B,Object.keys(ie).forEach(function(Q){"Infinity"===(oe=ie[Q])?J=1:"-Infinity"===oe?J=0:(J=parseFloat(ie[Q],10),"string"==typeof oe&&/^(\d+\.\d+)%|(\d+)%$/.test(oe)&&(J*=.01,"pixels"===le&&("x1"!==Q&&"x2"!==Q&&"r2"!==Q||(J*=he.viewBoxWidth||he.width),"y1"!==Q&&"y2"!==Q||(J*=he.viewBoxHeight||he.height)))),ie[Q]=J}),"pixels"===B&&(W=-T.left,q=-T.top),new F.Gradient({id:w.getAttribute("id"),type:A,coords:I,colorStops:U,gradientUnits:B,gradientTransform:L,offsetX:W,offsetY:q})}})}(),X=F.util.toFixed,F.Pattern=F.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(D,C){if(D||(D={}),this.id=F.Object.__uid++,this.setOptions(D),!D.source||D.source&&"string"!=typeof D.source)C&&C(this);else{var w=this;this.source=F.util.createImage(),F.util.loadImage(D.source,function(T,m){w.source=T,C&&C(w,m)},null,this.crossOrigin)}},toObject:function(D){var C,w,T=F.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?C=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(C=this.source.toDataURL()),w={type:"pattern",source:C,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:X(this.offsetX,T),offsetY:X(this.offsetY,T),patternTransform:this.patternTransform?this.patternTransform.concat():null},F.util.populateWithProperties(this,w,D),w},toSVG:function(D){var C="function"==typeof this.source?this.source():this.source,w=C.width/D.width,T=C.height/D.height,m=this.offsetX/D.width,v=this.offsetY/D.height,S="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(T=1,v&&(T+=Math.abs(v))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(w=1,m&&(w+=Math.abs(m))),C.src?S=C.src:C.toDataURL&&(S=C.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+m+'" y="'+v+'" width="'+w+'" height="'+T+'">\n<image x="0" y="0" width="'+C.width+'" height="'+C.height+'" xlink:href="'+S+'"></image>\n</pattern>\n'},setOptions:function(D){for(var C in D)this[C]=D[C]},toLive:function(D){var C=this.source;return C&&(void 0===C.src||C.complete&&0!==C.naturalWidth&&0!==C.naturalHeight)?D.createPattern(C,this.repeat):""}}),function(D){var C=D.fabric||(D.fabric={}),w=C.util.toFixed;C.Shadow?C.warn("fabric.Shadow is already defined."):(C.Shadow=C.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(T){for(var m in"string"==typeof T&&(T=this._parseShadow(T)),T)this[m]=T[m];this.id=C.Object.__uid++},_parseShadow:function(T){var m=T.trim(),v=C.Shadow.reOffsetsAndBlur.exec(m)||[];return{color:(m.replace(C.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(v[1],10)||0,offsetY:parseFloat(v[2],10)||0,blur:parseFloat(v[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(T){var m=40,v=40,S=C.Object.NUM_FRACTION_DIGITS,A=C.util.rotateVector({x:this.offsetX,y:this.offsetY},C.util.degreesToRadians(-T.angle)),I=new C.Color(this.color);return T.width&&T.height&&(m=100*w((Math.abs(A.x)+this.blur)/T.width,S)+20,v=100*w((Math.abs(A.y)+this.blur)/T.height,S)+20),T.flipX&&(A.x*=-1),T.flipY&&(A.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+v+'%" height="'+(100+2*v)+'%" x="-'+m+'%" width="'+(100+2*m)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+w(this.blur?this.blur/2:0,S)+'"></feGaussianBlur>\n\t<feOffset dx="'+w(A.x,S)+'" dy="'+w(A.y,S)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+I.toRgb()+'" flood-opacity="'+I.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var T={},m=C.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(v){this[v]!==m[v]&&(T[v]=this[v])},this),T}}),C.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(a),function(){if(F.StaticCanvas)F.warn("fabric.StaticCanvas is already defined.");else{var D=F.util.object.extend,C=F.util.getElementOffset,w=F.util.removeFromArray,T=F.util.toFixed,m=F.util.transformPoint,v=F.util.invertTransform,S=F.util.getNodeCanvas,A=F.util.createCanvasElement,I=new Error("Could not initialize `canvas` element");F.StaticCanvas=F.util.createClass(F.CommonMethods,{initialize:function(x,L){L||(L={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(x,L)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:F.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(x,L){var N=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(x),this._initOptions(L),this.interactive||this._initRetinaScaling(),L.overlayImage&&this.setOverlayImage(L.overlayImage,N),L.backgroundImage&&this.setBackgroundImage(L.backgroundImage,N),L.backgroundColor&&this.setBackgroundColor(L.backgroundColor,N),L.overlayColor&&this.setOverlayColor(L.overlayColor,N),this.calcOffset()},_isRetinaScaling:function(){return F.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,F.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var x=F.devicePixelRatio;this.__initRetinaScaling(x,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(x,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(x,L,N){L.setAttribute("width",this.width*x),L.setAttribute("height",this.height*x),N.scale(x,x)},calcOffset:function(){return this._offset=C(this.lowerCanvasEl),this},setOverlayImage:function(x,L,N){return this.__setBgOverlayImage("overlayImage",x,L,N)},setBackgroundImage:function(x,L,N){return this.__setBgOverlayImage("backgroundImage",x,L,N)},setOverlayColor:function(x,L){return this.__setBgOverlayColor("overlayColor",x,L)},setBackgroundColor:function(x,L){return this.__setBgOverlayColor("backgroundColor",x,L)},__setBgOverlayImage:function(x,L,N,B){return"string"==typeof L?F.util.loadImage(L,function(G,U){if(G){var W=new F.Image(G,B);this[x]=W,W.canvas=this}N&&N(G,U)},this,B&&B.crossOrigin):(B&&L.setOptions(B),this[x]=L,L&&(L.canvas=this),N&&N(L,!1)),this},__setBgOverlayColor:function(x,L,N){return this[x]=L,this._initGradient(L,x),this._initPattern(L,x,N),this},_createCanvasElement:function(){var x=A();if(!x||(x.style||(x.style={}),void 0===x.getContext))throw I;return x},_initOptions:function(x){var L=this.lowerCanvasEl;this._setOptions(x),this.width=this.width||parseInt(L.width,10)||0,this.height=this.height||parseInt(L.height,10)||0,this.lowerCanvasEl.style&&(L.width=this.width,L.height=this.height,L.style.width=this.width+"px",L.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(x){this.lowerCanvasEl=x&&x.getContext?x:F.util.getById(x)||this._createCanvasElement(),F.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(x,L){return this.setDimensions({width:x},L)},setHeight:function(x,L){return this.setDimensions({height:x},L)},setDimensions:function(x,L){var N;for(var B in L=L||{},x)N=x[B],L.cssOnly||(this._setBackstoreDimension(B,x[B]),N+="px",this.hasLostContext=!0),L.backstoreOnly||this._setCssDimension(B,N);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),L.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(x,L){return this.lowerCanvasEl[x]=L,this.upperCanvasEl&&(this.upperCanvasEl[x]=L),this.cacheCanvasEl&&(this.cacheCanvasEl[x]=L),this[x]=L,this},_setCssDimension:function(x,L){return this.lowerCanvasEl.style[x]=L,this.upperCanvasEl&&(this.upperCanvasEl.style[x]=L),this.wrapperEl&&(this.wrapperEl.style[x]=L),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(x){var L,N,B,G=this._activeObject,U=this.backgroundImage,W=this.overlayImage;for(this.viewportTransform=x,N=0,B=this._objects.length;N<B;N++)(L=this._objects[N]).group||L.setCoords(!0);return G&&G.setCoords(),U&&U.setCoords(!0),W&&W.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(x,L){var N=x,B=this.viewportTransform.slice(0);x=m(x,v(this.viewportTransform)),B[0]=L,B[3]=L;var G=m(x,B);return B[4]+=N.x-G.x,B[5]+=N.y-G.y,this.setViewportTransform(B)},setZoom:function(x){return this.zoomToPoint(new F.Point(0,0),x),this},absolutePan:function(x){var L=this.viewportTransform.slice(0);return L[4]=-x.x,L[5]=-x.y,this.setViewportTransform(L)},relativePan:function(x){return this.absolutePan(new F.Point(-x.x-this.viewportTransform[4],-x.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(x){this.stateful&&x.setupState(),x._set("canvas",this),x.setCoords(),this.fire("object:added",{target:x}),x.fire("added")},_onObjectRemoved:function(x){this.fire("object:removed",{target:x}),x.fire("removed"),delete x.canvas},clearContext:function(x){return x.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){return this.renderCanvas(this.contextContainer,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=F.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var x={},L=this.width,N=this.height,B=v(this.viewportTransform);return x.tl=m({x:0,y:0},B),x.br=m({x:L,y:N},B),x.tr=new F.Point(x.br.x,x.tl.y),x.bl=new F.Point(x.tl.x,x.br.y),this.vptCoords=x,x},cancelRequestedRender:function(){this.isRendering&&(F.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(x,L){var N=this.viewportTransform,B=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(x),F.util.setImageSmoothing(x,this.imageSmoothingEnabled),this.fire("before:render",{ctx:x}),this._renderBackground(x),x.save(),x.transform(N[0],N[1],N[2],N[3],N[4],N[5]),this._renderObjects(x,L),x.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(x),B&&(B.canvas=this,B.shouldCache(),B._transformDone=!0,B.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(x)),this._renderOverlay(x),this.controlsAboveOverlay&&this.interactive&&this.drawControls(x),this.fire("after:render",{ctx:x})},drawClipPathOnCanvas:function(x){var L=this.viewportTransform,N=this.clipPath;x.save(),x.transform(L[0],L[1],L[2],L[3],L[4],L[5]),x.globalCompositeOperation="destination-in",N.transform(x),x.scale(1/N.zoomX,1/N.zoomY),x.drawImage(N._cacheCanvas,-N.cacheTranslationX,-N.cacheTranslationY),x.restore()},_renderObjects:function(x,L){var N,B;for(N=0,B=L.length;N<B;++N)L[N]&&L[N].render(x)},_renderBackgroundOrOverlay:function(x,L){var N=this[L+"Color"],B=this[L+"Image"],G=this.viewportTransform,U=this[L+"Vpt"];if(N||B){if(N){x.save(),x.beginPath(),x.moveTo(0,0),x.lineTo(this.width,0),x.lineTo(this.width,this.height),x.lineTo(0,this.height),x.closePath(),x.fillStyle=N.toLive?N.toLive(x,this):N,U&&x.transform(G[0],G[1],G[2],G[3],G[4],G[5]),x.transform(1,0,0,1,N.offsetX||0,N.offsetY||0);var W=N.gradientTransform||N.patternTransform;W&&x.transform(W[0],W[1],W[2],W[3],W[4],W[5]),x.fill(),x.restore()}B&&(x.save(),U&&x.transform(G[0],G[1],G[2],G[3],G[4],G[5]),B.render(x),x.restore())}},_renderBackground:function(x){this._renderBackgroundOrOverlay(x,"background")},_renderOverlay:function(x){this._renderBackgroundOrOverlay(x,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new F.Point(this.width/2,this.height/2)},centerObjectH:function(x){return this._centerObject(x,new F.Point(this.getCenterPoint().x,x.getCenterPoint().y))},centerObjectV:function(x){return this._centerObject(x,new F.Point(x.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(x){var L=this.getCenterPoint();return this._centerObject(x,L)},viewportCenterObject:function(x){var L=this.getVpCenter();return this._centerObject(x,L)},viewportCenterObjectH:function(x){var L=this.getVpCenter();return this._centerObject(x,new F.Point(L.x,x.getCenterPoint().y)),this},viewportCenterObjectV:function(x){var L=this.getVpCenter();return this._centerObject(x,new F.Point(x.getCenterPoint().x,L.y))},getVpCenter:function(){var x=this.getCenterPoint(),L=v(this.viewportTransform);return m(x,L)},_centerObject:function(x,L){return x.setPositionByOrigin(L,"center","center"),x.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(x){return this.toDatalessObject(x)},toObject:function(x){return this._toObjectMethod("toObject",x)},toDatalessObject:function(x){return this._toObjectMethod("toDatalessObject",x)},_toObjectMethod:function(x,L){var N=this.clipPath,B={version:F.version,objects:this._toObjects(x,L)};return N&&!N.excludeFromExport&&(B.clipPath=this._toObject(this.clipPath,x,L)),D(B,this.__serializeBgOverlay(x,L)),F.util.populateWithProperties(this,B,L),B},_toObjects:function(x,L){return this._objects.filter(function(N){return!N.excludeFromExport}).map(function(N){return this._toObject(N,x,L)},this)},_toObject:function(x,L,N){var B;this.includeDefaultValues||(B=x.includeDefaultValues,x.includeDefaultValues=!1);var G=x[L](N);return this.includeDefaultValues||(x.includeDefaultValues=B),G},__serializeBgOverlay:function(x,L){var N={},B=this.backgroundImage,G=this.overlayImage,U=this.backgroundColor,W=this.overlayColor;return U&&U.toObject?U.excludeFromExport||(N.background=U.toObject(L)):U&&(N.background=U),W&&W.toObject?W.excludeFromExport||(N.overlay=W.toObject(L)):W&&(N.overlay=W),B&&!B.excludeFromExport&&(N.backgroundImage=this._toObject(B,x,L)),G&&!G.excludeFromExport&&(N.overlayImage=this._toObject(G,x,L)),N},svgViewportTransformation:!0,toSVG:function(x,L){x||(x={}),x.reviver=L;var N=[];return this._setSVGPreamble(N,x),this._setSVGHeader(N,x),this.clipPath&&N.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(N,"background"),this._setSVGBgOverlayImage(N,"backgroundImage",L),this._setSVGObjects(N,L),this.clipPath&&N.push("</g>\n"),this._setSVGBgOverlayColor(N,"overlay"),this._setSVGBgOverlayImage(N,"overlayImage",L),N.push("</svg>"),N.join("")},_setSVGPreamble:function(x,L){L.suppressPreamble||x.push('<?xml version="1.0" encoding="',L.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(x,L){var N,B=L.width||this.width,G=L.height||this.height,U='viewBox="0 0 '+this.width+" "+this.height+'" ',W=F.Object.NUM_FRACTION_DIGITS;L.viewBox?U='viewBox="'+L.viewBox.x+" "+L.viewBox.y+" "+L.viewBox.width+" "+L.viewBox.height+'" ':this.svgViewportTransformation&&(U='viewBox="'+T(-(N=this.viewportTransform)[4]/N[0],W)+" "+T(-N[5]/N[3],W)+" "+T(this.width/N[0],W)+" "+T(this.height/N[3],W)+'" '),x.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',B,'" ','height="',G,'" ',U,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",F.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(L),"</defs>\n")},createSVGClipPathMarkup:function(x){var L=this.clipPath;return L?(L.clipPathId="CLIPPATH_"+F.Object.__uid++,'<clipPath id="'+L.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(x.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var x=this;return["background","overlay"].map(function(L){var N=x[L+"Color"];if(N&&N.toLive){var B=x[L+"Vpt"],G=x.viewportTransform;return N.toSVG({width:x.width/(B?G[0]:1),height:x.height/(B?G[3]:1)},{additionalTransform:B?F.util.matrixToSVG(G):""})}}).join("")},createSVGFontFacesMarkup:function(){var x,L,N,B,G,U,W,q,ne="",ie={},he=F.fontPaths,le=[];for(this._objects.forEach(function J(Q){le.push(Q),Q._objects&&Q._objects.forEach(J)}),W=0,q=le.length;W<q;W++)if(L=(x=le[W]).fontFamily,-1!==x.type.indexOf("text")&&!ie[L]&&he[L]&&(ie[L]=!0,x.styles))for(G in N=x.styles)for(U in B=N[G])!ie[L=B[U].fontFamily]&&he[L]&&(ie[L]=!0);for(var oe in ie)ne+=["\t\t@font-face {\n","\t\t\tfont-family: '",oe,"';\n","\t\t\tsrc: url('",he[oe],"');\n","\t\t}\n"].join("");return ne&&(ne=['\t<style type="text/css">',"<![CDATA[\n",ne,"]]>","</style>\n"].join("")),ne},_setSVGObjects:function(x,L){var N,B,G,U=this._objects;for(B=0,G=U.length;B<G;B++)(N=U[B]).excludeFromExport||this._setSVGObject(x,N,L)},_setSVGObject:function(x,L,N){x.push(L.toSVG(N))},_setSVGBgOverlayImage:function(x,L,N){this[L]&&!this[L].excludeFromExport&&this[L].toSVG&&x.push(this[L].toSVG(N))},_setSVGBgOverlayColor:function(x,L){var N=this[L+"Color"],G=this.width,U=this.height;if(N)if(N.toLive){var W=N.repeat,q=F.util.invertTransform(this.viewportTransform),ne=this[L+"Vpt"]?F.util.matrixToSVG(q):"";x.push('<rect transform="'+ne+" translate(",G/2,",",U/2,')"',' x="',N.offsetX-G/2,'" y="',N.offsetY-U/2,'" ','width="',"repeat-y"===W||"no-repeat"===W?N.source.width:G,'" height="',"repeat-x"===W||"no-repeat"===W?N.source.height:U,'" fill="url(#SVGID_'+N.id+')"',"></rect>\n")}else x.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',N,'"',"></rect>\n")},sendToBack:function(x){if(!x)return this;var L,N,B,G=this._activeObject;if(x===G&&"activeSelection"===x.type)for(L=(B=G._objects).length;L--;)w(this._objects,N=B[L]),this._objects.unshift(N);else w(this._objects,x),this._objects.unshift(x);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(x){if(!x)return this;var L,N,B,G=this._activeObject;if(x===G&&"activeSelection"===x.type)for(B=G._objects,L=0;L<B.length;L++)w(this._objects,N=B[L]),this._objects.push(N);else w(this._objects,x),this._objects.push(x);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(x,L){if(!x)return this;var N,B,G,U,W,q=this._activeObject,ne=0;if(x===q&&"activeSelection"===x.type)for(W=q._objects,N=0;N<W.length;N++)(G=this._objects.indexOf(B=W[N]))>0+ne&&(U=G-1,w(this._objects,B),this._objects.splice(U,0,B)),ne++;else 0!==(G=this._objects.indexOf(x))&&(U=this._findNewLowerIndex(x,G,L),w(this._objects,x),this._objects.splice(U,0,x));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(x,L,N){var B,G;if(N){for(B=L,G=L-1;G>=0;--G)if(x.intersectsWithObject(this._objects[G])||x.isContainedWithinObject(this._objects[G])||this._objects[G].isContainedWithinObject(x)){B=G;break}}else B=L-1;return B},bringForward:function(x,L){if(!x)return this;var N,B,G,U,W,q=this._activeObject,ne=0;if(x===q&&"activeSelection"===x.type)for(N=(W=q._objects).length;N--;)(G=this._objects.indexOf(B=W[N]))<this._objects.length-1-ne&&(U=G+1,w(this._objects,B),this._objects.splice(U,0,B)),ne++;else(G=this._objects.indexOf(x))!==this._objects.length-1&&(U=this._findNewUpperIndex(x,G,L),w(this._objects,x),this._objects.splice(U,0,x));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(x,L,N){var B,G,U;if(N){for(B=L,G=L+1,U=this._objects.length;G<U;++G)if(x.intersectsWithObject(this._objects[G])||x.isContainedWithinObject(this._objects[G])||this._objects[G].isContainedWithinObject(x)){B=G;break}}else B=L+1;return B},moveTo:function(x,L){return w(this._objects,x),this._objects.splice(L,0,x),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(F.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(x){x.dispose&&x.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),F.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),F.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),D(F.StaticCanvas.prototype,F.Observable),D(F.StaticCanvas.prototype,F.Collection),D(F.StaticCanvas.prototype,F.DataURLExporter),D(F.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(x){var L=A();if(!L||!L.getContext)return null;var N=L.getContext("2d");return N&&"setLineDash"===x?void 0!==N.setLineDash:null}}),F.StaticCanvas.prototype.toJSON=F.StaticCanvas.prototype.toObject,F.isLikelyNode&&(F.StaticCanvas.prototype.createPNGStream=function(){var x=S(this.lowerCanvasEl);return x&&x.createPNGStream()},F.StaticCanvas.prototype.createJPEGStream=function(x){var L=S(this.lowerCanvasEl);return L&&L.createJPEGStream(x)})}}(),F.BaseBrush=F.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(D){D.strokeStyle=this.color,D.lineWidth=this.width,D.lineCap=this.strokeLineCap,D.miterLimit=this.strokeMiterLimit,D.lineJoin=this.strokeLineJoin,D.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(D){var C=this.canvas.viewportTransform;D.save(),D.transform(C[0],C[1],C[2],C[3],C[4],C[5])},_setShadow:function(){if(this.shadow){var D=this.canvas,C=this.shadow,w=D.contextTop,T=D.getZoom();D&&D._isRetinaScaling()&&(T*=F.devicePixelRatio),w.shadowColor=C.color,w.shadowBlur=C.blur*T,w.shadowOffsetX=C.offsetX*T,w.shadowOffsetY=C.offsetY*T}},needsFullRender:function(){return new F.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var D=this.canvas.contextTop;D.shadowColor="",D.shadowBlur=D.shadowOffsetX=D.shadowOffsetY=0},_isOutSideCanvas:function(D){return D.x<0||D.x>this.canvas.getWidth()||D.y<0||D.y>this.canvas.getHeight()}}),F.PencilBrush=F.util.createClass(F.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(D){this.canvas=D,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(D,C,w){var T=C.midPointFrom(w);return D.quadraticCurveTo(C.x,C.y,T.x,T.y),T},onMouseDown:function(D,C){this.canvas._isMainEvent(C.e)&&(this.drawStraightLine=C.e[this.straightLineKey],this._prepareForDrawing(D),this._captureDrawingPath(D),this._render())},onMouseMove:function(D,C){if(this.canvas._isMainEvent(C.e)&&(this.drawStraightLine=C.e[this.straightLineKey],(!0!==this.limitedToCanvasSize||!this._isOutSideCanvas(D))&&this._captureDrawingPath(D)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var w=this._points,T=w.length,m=this.canvas.contextTop;this._saveAndTransform(m),this.oldEnd&&(m.beginPath(),m.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(m,w[T-2],w[T-1],!0),m.stroke(),m.restore()}},onMouseUp:function(D){return!this.canvas._isMainEvent(D.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(D){var C=new F.Point(D.x,D.y);this._reset(),this._addPoint(C),this.canvas.contextTop.moveTo(C.x,C.y)},_addPoint:function(D){return!(this._points.length>1&&D.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(D),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(D){var C=new F.Point(D.x,D.y);return this._addPoint(C)},_render:function(D){var C,w,T=this._points[0],m=this._points[1];if(this._saveAndTransform(D=D||this.canvas.contextTop),D.beginPath(),2===this._points.length&&T.x===m.x&&T.y===m.y){var v=this.width/1e3;T=new F.Point(T.x,T.y),m=new F.Point(m.x,m.y),T.x-=v,m.x+=v}for(D.moveTo(T.x,T.y),C=1,w=this._points.length;C<w;C++)this._drawSegment(D,T,m),T=this._points[C],m=this._points[C+1];D.lineTo(T.x,T.y),D.stroke(),D.restore()},convertPointsToSVGPath:function(D){return F.util.getSmoothPathFromPoints(D,this.width/1e3)},_isEmptySVGPath:function(D){return"M 0 0 Q 0 0 0 0 L 0 0"===F.util.joinPath(D)},createPath:function(D){var C=new F.Path(D,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,C.shadow=new F.Shadow(this.shadow)),C},decimatePoints:function(D,C){if(D.length<=2)return D;var w,T=this.canvas.getZoom(),m=Math.pow(C/T,2),v=D.length-1,S=D[0],A=[S];for(w=1;w<v-1;w++)Math.pow(S.x-D[w].x,2)+Math.pow(S.y-D[w].y,2)>=m&&A.push(S=D[w]);return A.push(D[v]),A},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var D=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(D))this.canvas.requestRenderAll();else{var C=this.createPath(D);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:C}),this.canvas.add(C),this.canvas.requestRenderAll(),C.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:C})}}}),F.CircleBrush=F.util.createClass(F.BaseBrush,{width:10,initialize:function(D){this.canvas=D,this.points=[]},drawDot:function(D){var C=this.addPoint(D),w=this.canvas.contextTop;this._saveAndTransform(w),this.dot(w,C),w.restore()},dot:function(D,C){D.fillStyle=C.fill,D.beginPath(),D.arc(C.x,C.y,C.radius,0,2*Math.PI,!1),D.closePath(),D.fill()},onMouseDown:function(D){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(D)},_render:function(){var D,C,w=this.canvas.contextTop,T=this.points;for(this._saveAndTransform(w),D=0,C=T.length;D<C;D++)this.dot(w,T[D]);w.restore()},onMouseMove:function(D){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(D)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(D),this._render()):this.drawDot(D))},onMouseUp:function(){var D,C,w=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var T=[];for(D=0,C=this.points.length;D<C;D++){var m=this.points[D],v=new F.Circle({radius:m.radius,left:m.x,top:m.y,originX:"center",originY:"center",fill:m.fill});this.shadow&&(v.shadow=new F.Shadow(this.shadow)),T.push(v)}var S=new F.Group(T);S.canvas=this.canvas,this.canvas.fire("before:path:created",{path:S}),this.canvas.add(S),this.canvas.fire("path:created",{path:S}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=w,this.canvas.requestRenderAll()},addPoint:function(D){var C=new F.Point(D.x,D.y),w=F.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,T=new F.Color(this.color).setAlpha(F.util.getRandomInt(0,100)/100).toRgba();return C.radius=w,C.fill=T,this.points.push(C),C}}),F.SprayBrush=F.util.createClass(F.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(D){this.canvas=D,this.sprayChunks=[]},onMouseDown:function(D){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(D),this.render(this.sprayChunkPoints)},onMouseMove:function(D){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(D)||(this.addSprayChunk(D),this.render(this.sprayChunkPoints))},onMouseUp:function(){var D=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var C=[],w=0,T=this.sprayChunks.length;w<T;w++)for(var m=this.sprayChunks[w],v=0,S=m.length;v<S;v++){var A=new F.Rect({width:m[v].width,height:m[v].width,left:m[v].x+1,top:m[v].y+1,originX:"center",originY:"center",fill:this.color});C.push(A)}this.optimizeOverlapping&&(C=this._getOptimizedRects(C));var I=new F.Group(C);this.shadow&&I.set("shadow",new F.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:I}),this.canvas.add(I),this.canvas.fire("path:created",{path:I}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=D,this.canvas.requestRenderAll()},_getOptimizedRects:function(D){var C,w,T,m={};for(w=0,T=D.length;w<T;w++)m[C=D[w].left+""+D[w].top]||(m[C]=D[w]);var v=[];for(C in m)v.push(m[C]);return v},render:function(D){var C,w,T=this.canvas.contextTop;for(T.fillStyle=this.color,this._saveAndTransform(T),C=0,w=D.length;C<w;C++){var m=D[C];void 0!==m.opacity&&(T.globalAlpha=m.opacity),T.fillRect(m.x,m.y,m.width,m.width)}T.restore()},_render:function(){var D,C,w=this.canvas.contextTop;for(w.fillStyle=this.color,this._saveAndTransform(w),D=0,C=this.sprayChunks.length;D<C;D++)this.render(this.sprayChunks[D]);w.restore()},addSprayChunk:function(D){this.sprayChunkPoints=[];var C,w,T,m,v=this.width/2;for(m=0;m<this.density;m++){C=F.util.getRandomInt(D.x-v,D.x+v),w=F.util.getRandomInt(D.y-v,D.y+v),T=this.dotWidthVariance?F.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var S=new F.Point(C,w);S.width=T,this.randomOpacity&&(S.opacity=F.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(S)}this.sprayChunks.push(this.sprayChunkPoints)}}),F.PatternBrush=F.util.createClass(F.PencilBrush,{getPatternSrc:function(){var D=F.util.createCanvasElement(),C=D.getContext("2d");return D.width=D.height=25,C.fillStyle=this.color,C.beginPath(),C.arc(10,10,10,0,2*Math.PI,!1),C.closePath(),C.fill(),D},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(D){return D.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(D){this.callSuper("_setBrushStyles",D),D.strokeStyle=this.getPattern(D)},createPath:function(D){var C=this.callSuper("createPath",D),w=C._getLeftTopCoords().scalarAdd(C.strokeWidth/2);return C.stroke=new F.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-w.x,offsetY:-w.y}),C}}),function(){var D=F.util.getPointer,C=F.util.degreesToRadians,w=F.util.isTouchEvent;for(var T in F.Canvas=F.util.createClass(F.StaticCanvas,{initialize:function(m,v){v||(v={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(m,v),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=F.PencilBrush&&new F.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var m,v,S,A=this.getActiveObjects();if(A.length>0&&!this.preserveObjectStacking){v=[],S=[];for(var I=0,x=this._objects.length;I<x;I++)-1===A.indexOf(m=this._objects[I])?v.push(m):S.push(m);A.length>1&&(this._activeObject._objects=S),v.push.apply(v,S)}else v=this._objects;return v},renderAll:function(){return!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),this.renderCanvas(this.contextContainer,this._chooseObjectsToRender()),this},renderTopLayer:function(m){m.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(m),this.contextTopDirty=!0),m.restore()},renderTop:function(){var m=this.contextTop;return this.clearContext(m),this.renderTopLayer(m),this.fire("after:render"),this},_normalizePointer:function(m,v){var S=m.calcTransformMatrix(),A=F.util.invertTransform(S),I=this.restorePointerVpt(v);return F.util.transformPoint(I,A)},isTargetTransparent:function(m,v,S){if(m.shouldCache()&&m._cacheCanvas&&m!==this._activeObject){var A=this._normalizePointer(m,{x:v,y:S}),I=Math.max(m.cacheTranslationX+A.x*m.zoomX,0),x=Math.max(m.cacheTranslationY+A.y*m.zoomY,0);return F.util.isTransparent(m._cacheContext,Math.round(I),Math.round(x),this.targetFindTolerance)}var L=this.contextCache,N=m.selectionBackgroundColor,B=this.viewportTransform;return m.selectionBackgroundColor="",this.clearContext(L),L.save(),L.transform(B[0],B[1],B[2],B[3],B[4],B[5]),m.render(L),L.restore(),m.selectionBackgroundColor=N,F.util.isTransparent(L,v,S,this.targetFindTolerance)},_isSelectionKeyPressed:function(m){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(v){return!0===m[v]}):m[this.selectionKey]},_shouldClearSelection:function(m,v){var S=this.getActiveObjects(),A=this._activeObject;return!v||v&&A&&S.length>1&&-1===S.indexOf(v)&&A!==v&&!this._isSelectionKeyPressed(m)||v&&!v.evented||v&&!v.selectable&&A&&A!==v},_shouldCenterTransform:function(m,v,S){var A;if(m)return"scale"===v||"scaleX"===v||"scaleY"===v||"resizing"===v?A=this.centeredScaling||m.centeredScaling:"rotate"===v&&(A=this.centeredRotation||m.centeredRotation),A?!S:S},_getOriginFromCorner:function(m,v){var S={x:m.originX,y:m.originY};return"ml"===v||"tl"===v||"bl"===v?S.x="right":"mr"!==v&&"tr"!==v&&"br"!==v||(S.x="left"),"tl"===v||"mt"===v||"tr"===v?S.y="bottom":"bl"!==v&&"mb"!==v&&"br"!==v||(S.y="top"),S},_getActionFromCorner:function(m,v,S,A){if(!v||!m)return"drag";var I=A.controls[v];return I.getActionName(S,I,A)},_setupCurrentTransform:function(m,v,S){if(v){var A=this.getPointer(m),I=v.__corner,x=v.controls[I],L=S&&I?x.getActionHandler(m,v,x):F.controlsUtils.dragHandler,N=this._getActionFromCorner(S,I,m,v),B=this._getOriginFromCorner(v,I),G=m[this.centeredKey],U={target:v,action:N,actionHandler:L,corner:I,scaleX:v.scaleX,scaleY:v.scaleY,skewX:v.skewX,skewY:v.skewY,offsetX:A.x-v.left,offsetY:A.y-v.top,originX:B.x,originY:B.y,ex:A.x,ey:A.y,lastX:A.x,lastY:A.y,theta:C(v.angle),width:v.width*v.scaleX,shiftKey:m.shiftKey,altKey:G,original:F.util.saveObjectTransform(v)};this._shouldCenterTransform(v,N,G)&&(U.originX="center",U.originY="center"),U.original.originX=B.x,U.original.originY=B.y,this._currentTransform=U,this._beforeTransform(m)}},setCursor:function(m){this.upperCanvasEl.style.cursor=m},_drawSelection:function(m){var v=this._groupSelector,S=new F.Point(v.ex,v.ey),A=F.util.transformPoint(S,this.viewportTransform),I=new F.Point(v.ex+v.left,v.ey+v.top),x=F.util.transformPoint(I,this.viewportTransform),L=Math.min(A.x,x.x),N=Math.min(A.y,x.y),B=Math.max(A.x,x.x),G=Math.max(A.y,x.y),U=this.selectionLineWidth/2;this.selectionColor&&(m.fillStyle=this.selectionColor,m.fillRect(L,N,B-L,G-N)),this.selectionLineWidth&&this.selectionBorderColor&&(m.lineWidth=this.selectionLineWidth,m.strokeStyle=this.selectionBorderColor,L+=U,N+=U,B-=U,G-=U,F.Object.prototype._setLineDash.call(this,m,this.selectionDashArray),m.strokeRect(L,N,B-L,G-N))},findTarget:function(m,v){if(!this.skipTargetFind){var S,A,I=this.getPointer(m,!0),x=this._activeObject,L=this.getActiveObjects(),N=w(m),B=L.length>1&&!v||1===L.length;if(this.targets=[],B&&x._findTargetCorner(I,N)||L.length>1&&!v&&x===this._searchPossibleTargets([x],I))return x;if(1===L.length&&x===this._searchPossibleTargets([x],I)){if(!this.preserveObjectStacking)return x;S=x,A=this.targets,this.targets=[]}var G=this._searchPossibleTargets(this._objects,I);return m[this.altSelectionKey]&&G&&S&&G!==S&&(G=S,this.targets=A),G}},_checkTarget:function(m,v,S){if(v&&v.visible&&v.evented&&v.containsPoint(m)&&(!this.perPixelTargetFind&&!v.perPixelTargetFind||v.isEditing||!this.isTargetTransparent(v,S.x,S.y)))return!0},_searchPossibleTargets:function(m,v){for(var S,A,I=m.length;I--;){var x=m[I],L=x.group?this._normalizePointer(x.group,v):v;if(this._checkTarget(L,x,v)){(S=m[I]).subTargetCheck&&S instanceof F.Group&&(A=this._searchPossibleTargets(S._objects,v))&&this.targets.push(A);break}}return S},restorePointerVpt:function(m){return F.util.transformPoint(m,F.util.invertTransform(this.viewportTransform))},getPointer:function(m,v){if(this._absolutePointer&&!v)return this._absolutePointer;if(this._pointer&&v)return this._pointer;var S,A=D(m),I=this.upperCanvasEl,x=I.getBoundingClientRect(),L=x.width||0,N=x.height||0;L&&N||("top"in x&&"bottom"in x&&(N=Math.abs(x.top-x.bottom)),"right"in x&&"left"in x&&(L=Math.abs(x.right-x.left))),this.calcOffset(),A.x=A.x-this._offset.left,A.y=A.y-this._offset.top,v||(A=this.restorePointerVpt(A));var B=this.getRetinaScaling();return 1!==B&&(A.x/=B,A.y/=B),{x:A.x*(S=0===L||0===N?{width:1,height:1}:{width:I.width/L,height:I.height/N}).width,y:A.y*S.height}},_createUpperCanvas:function(){var m=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),v=this.lowerCanvasEl,S=this.upperCanvasEl;S?S.className="":(S=this._createCanvasElement(),this.upperCanvasEl=S),F.util.addClass(S,"upper-canvas "+m),this.wrapperEl.appendChild(S),this._copyCanvasStyle(v,S),this._applyCanvasStyle(S),this.contextTop=S.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=F.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),F.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),F.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(m){var v=this.width||m.width,S=this.height||m.height;F.util.setStyle(m,{position:"absolute",width:v+"px",height:S+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),m.width=v,m.height=S,F.util.makeElementUnselectable(m)},_copyCanvasStyle:function(m,v){v.style.cssText=m.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var m=this._activeObject;return m?"activeSelection"===m.type&&m._objects?m._objects.slice(0):[m]:[]},_onObjectRemoved:function(m){m===this._activeObject&&(this.fire("before:selection:cleared",{target:m}),this._discardActiveObject(),this.fire("selection:cleared",{target:m}),m.fire("deselected")),m===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",m)},_fireSelectionEvents:function(m,v){var S=!1,A=this.getActiveObjects(),I=[],x=[];m.forEach(function(L){-1===A.indexOf(L)&&(S=!0,L.fire("deselected",{e:v,target:L}),x.push(L))}),A.forEach(function(L){-1===m.indexOf(L)&&(S=!0,L.fire("selected",{e:v,target:L}),I.push(L))}),m.length>0&&A.length>0?S&&this.fire("selection:updated",{e:v,selected:I,deselected:x}):A.length>0?this.fire("selection:created",{e:v,selected:I}):m.length>0&&this.fire("selection:cleared",{e:v,deselected:x})},setActiveObject:function(m,v){var S=this.getActiveObjects();return this._setActiveObject(m,v),this._fireSelectionEvents(S,v),this},_setActiveObject:function(m,v){return this._activeObject!==m&&!!this._discardActiveObject(v,m)&&!m.onSelect({e:v})&&(this._activeObject=m,!0)},_discardActiveObject:function(m,v){var S=this._activeObject;if(S){if(S.onDeselect({e:m,object:v}))return!1;this._activeObject=null}return!0},discardActiveObject:function(m){var v=this.getActiveObjects(),S=this.getActiveObject();return v.length&&this.fire("before:selection:cleared",{target:S,e:m}),this._discardActiveObject(m),this._fireSelectionEvents(v,m),this},dispose:function(){var m=this.wrapperEl;return this.removeListeners(),m.removeChild(this.upperCanvasEl),m.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(v){F.util.cleanUpJsdomNode(this[v]),this[v]=void 0}.bind(this)),m.parentNode&&m.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,F.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(m){var v=this._activeObject;v&&v._renderControls(m)},_toObject:function(m,v,S){var A=this._realizeGroupTransformOnObject(m),I=this.callSuper("_toObject",m,v,S);return this._unwindGroupTransformOnObject(m,A),I},_realizeGroupTransformOnObject:function(m){if(m.group&&"activeSelection"===m.group.type&&this._activeObject===m.group){var v={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(S){v[S]=m[S]}),F.util.addTransformToObject(m,this._activeObject.calcOwnMatrix()),v}return null},_unwindGroupTransformOnObject:function(m,v){v&&m.set(v)},_setSVGObject:function(m,v,S){var A=this._realizeGroupTransformOnObject(v);this.callSuper("_setSVGObject",m,v,S),this._unwindGroupTransformOnObject(v,A)},setViewportTransform:function(m){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),F.StaticCanvas.prototype.setViewportTransform.call(this,m)}}),F.StaticCanvas)"prototype"!==T&&(F.Canvas[T]=F.StaticCanvas[T])}(),function(){var D=F.util.addListener,C=F.util.removeListener,w={passive:!1};function T(m,v){return m.button&&m.button===v-1}F.util.object.extend(F.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(D,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(m,v){var S=this.upperCanvasEl,A=this._getEventPrefix();m(F.window,"resize",this._onResize),m(S,A+"down",this._onMouseDown),m(S,A+"move",this._onMouseMove,w),m(S,A+"out",this._onMouseOut),m(S,A+"enter",this._onMouseEnter),m(S,"wheel",this._onMouseWheel),m(S,"contextmenu",this._onContextMenu),m(S,"dblclick",this._onDoubleClick),m(S,"dragover",this._onDragOver),m(S,"dragenter",this._onDragEnter),m(S,"dragleave",this._onDragLeave),m(S,"drop",this._onDrop),this.enablePointerEvents||m(S,"touchstart",this._onTouchStart,w),"undefined"!=typeof eventjs&&v in eventjs&&(eventjs[v](S,"gesture",this._onGesture),eventjs[v](S,"drag",this._onDrag),eventjs[v](S,"orientation",this._onOrientationChange),eventjs[v](S,"shake",this._onShake),eventjs[v](S,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(C,"remove");var m=this._getEventPrefix();C(F.document,m+"up",this._onMouseUp),C(F.document,"touchend",this._onTouchEnd,w),C(F.document,m+"move",this._onMouseMove,w),C(F.document,"touchmove",this._onMouseMove,w)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(m,v){this.__onTransformGesture&&this.__onTransformGesture(m,v)},_onDrag:function(m,v){this.__onDrag&&this.__onDrag(m,v)},_onMouseWheel:function(m){this.__onMouseWheel(m)},_onMouseOut:function(m){var v=this._hoveredTarget;this.fire("mouse:out",{target:v,e:m}),this._hoveredTarget=null,v&&v.fire("mouseout",{e:m});var S=this;this._hoveredTargets.forEach(function(A){S.fire("mouse:out",{target:v,e:m}),A&&v.fire("mouseout",{e:m})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(A){A.isEditing&&A.hiddenTextarea.focus()})},_onMouseEnter:function(m){this._currentTransform||this.findTarget(m)||(this.fire("mouse:over",{target:null,e:m}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(m,v){this.__onOrientationChange&&this.__onOrientationChange(m,v)},_onShake:function(m,v){this.__onShake&&this.__onShake(m,v)},_onLongPress:function(m,v){this.__onLongPress&&this.__onLongPress(m,v)},_onDragOver:function(m){m.preventDefault();var v=this._simpleEventHandler("dragover",m);this._fireEnterLeaveEvents(v,m)},_onDrop:function(m){return this._simpleEventHandler("drop:before",m),this._simpleEventHandler("drop",m)},_onContextMenu:function(m){return this.stopContextMenu&&(m.stopPropagation(),m.preventDefault()),!1},_onDoubleClick:function(m){this._cacheTransformEventData(m),this._handleEvent(m,"dblclick"),this._resetTransformEventData(m)},getPointerId:function(m){var v=m.changedTouches;return v?v[0]&&v[0].identifier:this.enablePointerEvents?m.pointerId:-1},_isMainEvent:function(m){return!0===m.isPrimary||!1!==m.isPrimary&&("touchend"===m.type&&0===m.touches.length||!m.changedTouches||m.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(m){m.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(m)),this.__onMouseDown(m),this._resetTransformEventData();var v=this.upperCanvasEl,S=this._getEventPrefix();D(F.document,"touchend",this._onTouchEnd,w),D(F.document,"touchmove",this._onMouseMove,w),C(v,S+"down",this._onMouseDown)},_onMouseDown:function(m){this.__onMouseDown(m),this._resetTransformEventData();var v=this.upperCanvasEl,S=this._getEventPrefix();C(v,S+"move",this._onMouseMove,w),D(F.document,S+"up",this._onMouseUp),D(F.document,S+"move",this._onMouseMove,w)},_onTouchEnd:function(m){if(!(m.touches.length>0)){this.__onMouseUp(m),this._resetTransformEventData(),this.mainTouchId=null;var v=this._getEventPrefix();C(F.document,"touchend",this._onTouchEnd,w),C(F.document,"touchmove",this._onMouseMove,w);var S=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){D(S.upperCanvasEl,v+"down",S._onMouseDown),S._willAddMouseDown=0},400)}},_onMouseUp:function(m){this.__onMouseUp(m),this._resetTransformEventData();var v=this.upperCanvasEl,S=this._getEventPrefix();this._isMainEvent(m)&&(C(F.document,S+"up",this._onMouseUp),C(F.document,S+"move",this._onMouseMove,w),D(v,S+"move",this._onMouseMove,w))},_onMouseMove:function(m){!this.allowTouchScrolling&&m.preventDefault&&m.preventDefault(),this.__onMouseMove(m)},_onResize:function(){this.calcOffset()},_shouldRender:function(m){var v=this._activeObject;return!!(!!v!=!!m||v&&m&&v!==m)||!1},__onMouseUp:function(m){var v,S=this._currentTransform,A=this._groupSelector,I=!1,x=!A||0===A.left&&0===A.top;if(this._cacheTransformEventData(m),v=this._target,this._handleEvent(m,"up:before"),T(m,3))this.fireRightClick&&this._handleEvent(m,"up",3,x);else{if(T(m,2))return this.fireMiddleClick&&this._handleEvent(m,"up",2,x),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(m);else if(this._isMainEvent(m)){if(S&&(this._finalizeCurrentTransform(m),I=S.actionPerformed),!x){var L=v===this._activeObject;this._maybeGroupObjects(m),I||(I=this._shouldRender(v)||!L&&v===this._activeObject)}var N,B;if(v){if(N=v._findTargetCorner(this.getPointer(m,!0),F.util.isTouchEvent(m)),v.selectable&&v!==this._activeObject&&"up"===v.activeOn)this.setActiveObject(v,m),I=!0;else{var G=v.controls[N],U=G&&G.getMouseUpHandler(m,v,G);U&&U(m,S,(B=this.getPointer(m)).x,B.y)}v.isMoving=!1}if(S&&(S.target!==v||S.corner!==N)){var W=S.target&&S.target.controls[S.corner],q=W&&W.getMouseUpHandler(m,v,G);B=B||this.getPointer(m),q&&q(m,S,B.x,B.y)}this._setCursorFromEvent(m,v),this._handleEvent(m,"up",1,x),this._groupSelector=null,this._currentTransform=null,v&&(v.__corner=0),I?this.requestRenderAll():x||this.renderTop()}}},_simpleEventHandler:function(m,v){var S=this.findTarget(v),A=this.targets,I={e:v,target:S,subTargets:A};if(this.fire(m,I),S&&S.fire(m,I),!A)return S;for(var x=0;x<A.length;x++)A[x].fire(m,I);return S},_handleEvent:function(m,v,S,A){var I=this._target,x=this.targets||[],L={e:m,target:I,subTargets:x,button:S||1,isClick:A||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===v&&(L.currentTarget=this.findTarget(m),L.currentSubTargets=this.targets),this.fire("mouse:"+v,L),I&&I.fire("mouse"+v,L);for(var N=0;N<x.length;N++)x[N].fire("mouse"+v,L)},_finalizeCurrentTransform:function(m){var v=this._currentTransform,S=v.target,A={e:m,target:S,transform:v,action:v.action};S._scaling&&(S._scaling=!1),S.setCoords(),(v.actionPerformed||this.stateful&&S.hasStateChanged())&&this._fire("modified",A)},_onMouseDownInDrawingMode:function(m){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(m).requestRenderAll();var v=this.getPointer(m);this.freeDrawingBrush.onMouseDown(v,{e:m,pointer:v}),this._handleEvent(m,"down")},_onMouseMoveInDrawingMode:function(m){if(this._isCurrentlyDrawing){var v=this.getPointer(m);this.freeDrawingBrush.onMouseMove(v,{e:m,pointer:v})}this.setCursor(this.freeDrawingCursor),this._handleEvent(m,"move")},_onMouseUpInDrawingMode:function(m){var v=this.getPointer(m);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:m,pointer:v}),this._handleEvent(m,"up")},__onMouseDown:function(m){this._cacheTransformEventData(m),this._handleEvent(m,"down:before");var v=this._target;if(T(m,3))this.fireRightClick&&this._handleEvent(m,"down",3);else if(T(m,2))this.fireMiddleClick&&this._handleEvent(m,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(m);else if(this._isMainEvent(m)&&!this._currentTransform){var S=this._pointer;this._previousPointer=S;var A=this._shouldRender(v),I=this._shouldGroup(m,v);if(this._shouldClearSelection(m,v)?this.discardActiveObject(m):I&&(this._handleGrouping(m,v),v=this._activeObject),!this.selection||v&&(v.selectable||v.isEditing||v===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),v){var x=v===this._activeObject;v.selectable&&"down"===v.activeOn&&this.setActiveObject(v,m);var L=v._findTargetCorner(this.getPointer(m,!0),F.util.isTouchEvent(m));if(v.__corner=L,v===this._activeObject&&(L||!I)){this._setupCurrentTransform(m,v,x);var N=v.controls[L],B=(S=this.getPointer(m),N&&N.getMouseDownHandler(m,v,N));B&&B(m,this._currentTransform,S.x,S.y)}}this._handleEvent(m,"down"),(A||I)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(m){this._resetTransformEventData(),this._pointer=this.getPointer(m,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(m)||null},_beforeTransform:function(m){var v=this._currentTransform;this.stateful&&v.target.saveState(),this.fire("before:transform",{e:m,transform:v})},__onMouseMove:function(m){var v,S;if(this._handleEvent(m,"move:before"),this._cacheTransformEventData(m),this.isDrawingMode)this._onMouseMoveInDrawingMode(m);else if(this._isMainEvent(m)){var A=this._groupSelector;A?(A.left=(S=this._absolutePointer).x-A.ex,A.top=S.y-A.ey,this.renderTop()):this._currentTransform?this._transformObject(m):(v=this.findTarget(m)||null,this._setCursorFromEvent(m,v),this._fireOverOutEvents(v,m)),this._handleEvent(m,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(m,v){var S=this._hoveredTarget,A=this._hoveredTargets,I=this.targets,x=Math.max(A.length,I.length);this.fireSyntheticInOutEvents(m,v,{oldTarget:S,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var L=0;L<x;L++)this.fireSyntheticInOutEvents(I[L],v,{oldTarget:A[L],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=m,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(m,v){var S=this._draggedoverTarget,A=this._hoveredTargets,I=this.targets,x=Math.max(A.length,I.length);this.fireSyntheticInOutEvents(m,v,{oldTarget:S,evtOut:"dragleave",evtIn:"dragenter"});for(var L=0;L<x;L++)this.fireSyntheticInOutEvents(I[L],v,{oldTarget:A[L],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=m},fireSyntheticInOutEvents:function(m,v,S){var A,I,x,L=S.oldTarget,N=L!==m,B=S.canvasEvtIn,G=S.canvasEvtOut;N&&(A={e:v,target:m,previousTarget:L},I={e:v,target:L,nextTarget:m}),x=m&&N,L&&N&&(G&&this.fire(G,I),L.fire(S.evtOut,I)),x&&(B&&this.fire(B,A),m.fire(S.evtIn,A))},__onMouseWheel:function(m){this._cacheTransformEventData(m),this._handleEvent(m,"wheel"),this._resetTransformEventData()},_transformObject:function(m){var v=this.getPointer(m),S=this._currentTransform;S.reset=!1,S.shiftKey=m.shiftKey,S.altKey=m[this.centeredKey],this._performTransformAction(m,S,v),S.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(m,v,S){var x=v.action,L=!1,N=v.actionHandler;N&&(L=N(m,v,S.x,S.y)),"drag"===x&&L&&(v.target.isMoving=!0,this.setCursor(v.target.moveCursor||this.moveCursor)),v.actionPerformed=v.actionPerformed||L},_fire:F.controlsUtils.fireEvent,_setCursorFromEvent:function(m,v){if(!v)return this.setCursor(this.defaultCursor),!1;var S=v.hoverCursor||this.hoverCursor,A=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,I=(!A||!A.contains(v))&&v._findTargetCorner(this.getPointer(m,!0));I?this.setCursor(this.getCornerCursor(I,v,m)):(v.subTargetCheck&&this.targets.concat().reverse().map(function(x){S=x.hoverCursor||S}),this.setCursor(S))},getCornerCursor:function(m,v,S){var A=v.controls[m];return A.cursorStyleHandler(S,A,v)}})}(),$=Math.min,K=Math.max,F.util.object.extend(F.Canvas.prototype,{_shouldGroup:function(D,C){var w=this._activeObject;return w&&this._isSelectionKeyPressed(D)&&C&&C.selectable&&this.selection&&(w!==C||"activeSelection"===w.type)&&!C.onSelect({e:D})},_handleGrouping:function(D,C){var w=this._activeObject;w.__corner||(C!==w||(C=this.findTarget(D,!0))&&C.selectable)&&(w&&"activeSelection"===w.type?this._updateActiveSelection(C,D):this._createActiveSelection(C,D))},_updateActiveSelection:function(D,C){var w=this._activeObject,T=w._objects.slice(0);w.contains(D)?(w.removeWithUpdate(D),this._hoveredTarget=D,this._hoveredTargets=this.targets.concat(),1===w.size()&&this._setActiveObject(w.item(0),C)):(w.addWithUpdate(D),this._hoveredTarget=w,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(T,C)},_createActiveSelection:function(D,C){var w=this.getActiveObjects(),T=this._createGroup(D);this._hoveredTarget=T,this._setActiveObject(T,C),this._fireSelectionEvents(w,C)},_createGroup:function(D){var C=this._objects,w=C.indexOf(this._activeObject)<C.indexOf(D)?[this._activeObject,D]:[D,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new F.ActiveSelection(w,{canvas:this})},_groupSelectedObjects:function(D){var C,w=this._collectObjects(D);1===w.length?this.setActiveObject(w[0],D):w.length>1&&(C=new F.ActiveSelection(w.reverse(),{canvas:this}),this.setActiveObject(C,D))},_collectObjects:function(D){for(var C,w=[],T=this._groupSelector.ex,m=this._groupSelector.ey,v=T+this._groupSelector.left,S=m+this._groupSelector.top,A=new F.Point($(T,v),$(m,S)),I=new F.Point(K(T,v),K(m,S)),x=!this.selectionFullyContained,L=T===v&&m===S,N=this._objects.length;N--&&!((C=this._objects[N])&&C.selectable&&C.visible&&(x&&C.intersectsWithRect(A,I,!0)||C.isContainedWithinRect(A,I,!0)||x&&C.containsPoint(A,null,!0)||x&&C.containsPoint(I,null,!0))&&(w.push(C),L)););return w.length>1&&(w=w.filter(function(B){return!B.onSelect({e:D})})),w},_maybeGroupObjects:function(D){this.selection&&this._groupSelector&&this._groupSelectedObjects(D),this.setCursor(this.defaultCursor),this._groupSelector=null}}),F.util.object.extend(F.StaticCanvas.prototype,{toDataURL:function(D){D||(D={});var C=D.format||"png",w=D.quality||1,T=(D.multiplier||1)*(D.enableRetinaScaling?this.getRetinaScaling():1),m=this.toCanvasElement(T,D);return F.util.toDataURL(m,C,w)},toCanvasElement:function(D,C){var w=((C=C||{}).width||this.width)*(D=D||1),T=(C.height||this.height)*D,m=this.getZoom(),v=this.width,S=this.height,A=m*D,I=this.viewportTransform,N=this.interactive,B=[A,0,0,A,(I[4]-(C.left||0))*D,(I[5]-(C.top||0))*D],G=this.enableRetinaScaling,U=F.util.createCanvasElement(),W=this.contextTop;return U.width=w,U.height=T,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=B,this.width=w,this.height=T,this.calcViewportBoundaries(),this.renderCanvas(U.getContext("2d"),this._objects),this.viewportTransform=I,this.width=v,this.height=S,this.calcViewportBoundaries(),this.interactive=N,this.enableRetinaScaling=G,this.contextTop=W,U}}),F.util.object.extend(F.StaticCanvas.prototype,{loadFromJSON:function(D,C,w){if(D){var T="string"==typeof D?JSON.parse(D):F.util.object.clone(D),m=this,v=T.clipPath,S=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete T.clipPath,this._enlivenObjects(T.objects,function(A){m.clear(),m._setBgOverlay(T,function(){v?m._enlivenObjects([v],function(I){m.clipPath=I[0],m.__setupCanvas.call(m,T,A,S,C)}):m.__setupCanvas.call(m,T,A,S,C)})},w),this}},__setupCanvas:function(D,C,w,T){var m=this;C.forEach(function(v,S){m.insertAt(v,S)}),this.renderOnAddRemove=w,delete D.objects,delete D.backgroundImage,delete D.overlayImage,delete D.background,delete D.overlay,this._setOptions(D),this.renderAll(),T&&T()},_setBgOverlay:function(D,C){var w={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(D.backgroundImage||D.overlayImage||D.background||D.overlay){var T=function(){w.backgroundImage&&w.overlayImage&&w.backgroundColor&&w.overlayColor&&C&&C()};this.__setBgOverlay("backgroundImage",D.backgroundImage,w,T),this.__setBgOverlay("overlayImage",D.overlayImage,w,T),this.__setBgOverlay("backgroundColor",D.background,w,T),this.__setBgOverlay("overlayColor",D.overlay,w,T)}else C&&C()},__setBgOverlay:function(D,C,w,T){var m=this;if(!C)return w[D]=!0,void(T&&T());"backgroundImage"===D||"overlayImage"===D?F.util.enlivenObjects([C],function(v){m[D]=v[0],w[D]=!0,T&&T()}):this["set"+F.util.string.capitalize(D,!0)](C,function(){w[D]=!0,T&&T()})},_enlivenObjects:function(D,C,w){D&&0!==D.length?F.util.enlivenObjects(D,function(T){C&&C(T)},null,w):C&&C([])},_toDataURL:function(D,C){this.clone(function(w){C(w.toDataURL(D))})},_toDataURLWithMultiplier:function(D,C,w){this.clone(function(T){w(T.toDataURLWithMultiplier(D,C))})},clone:function(D,C){var w=JSON.stringify(this.toJSON(C));this.cloneWithoutData(function(T){T.loadFromJSON(w,function(){D&&D(T)})})},cloneWithoutData:function(D){var C=F.util.createCanvasElement();C.width=this.width,C.height=this.height;var w=new F.Canvas(C);this.backgroundImage?(w.setBackgroundImage(this.backgroundImage.src,function(){w.renderAll(),D&&D(w)}),w.backgroundImageOpacity=this.backgroundImageOpacity,w.backgroundImageStretch=this.backgroundImageStretch):D&&D(w)}}),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.extend,T=C.util.object.clone,m=C.util.toFixed,v=C.util.string.capitalize,S=C.util.degreesToRadians;C.Object||(C.Object=C.util.createClass(C.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:!C.isLikelyNode,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(I){I&&this.setOptions(I)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=C.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(I){var x=C.perfLimitSizeTotal,L=I.width,N=I.height,B=C.maxCacheSideLimit,G=C.minCacheSideLimit;if(L<=B&&N<=B&&L*N<=x)return L<G&&(I.width=G),N<G&&(I.height=G),I;var W=C.util.limitDimsByArea(L/N,x),q=C.util.capValue,ne=q(G,W.x,B),ie=q(G,W.y,B);return L>ne&&(I.zoomX/=L/ne,I.width=ne,I.capped=!0),N>ie&&(I.zoomY/=N/ie,I.height=ie,I.capped=!0),I},_getCacheCanvasDimensions:function(){var I=this.getTotalObjectScaling(),x=this._getTransformedDimensions(0,0),L=x.x*I.scaleX/this.scaleX,N=x.y*I.scaleY/this.scaleY;return{width:L+2,height:N+2,zoomX:I.scaleX,zoomY:I.scaleY,x:L,y:N}},_updateCacheCanvas:function(){var I=this.canvas;if(this.noScaleCache&&I&&I._currentTransform){var L=I._currentTransform.action;if(this===I._currentTransform.target&&L.slice&&"scale"===L.slice(0,5))return!1}var N,B,G=this._cacheCanvas,U=this._limitCacheSize(this._getCacheCanvasDimensions()),W=C.minCacheSideLimit,q=U.width,ne=U.height,ie=U.zoomX,he=U.zoomY,le=q!==this.cacheWidth||ne!==this.cacheHeight,J=le||this.zoomX!==ie||this.zoomY!==he,Q=0,re=0,ue=!1;if(le){var de=this._cacheCanvas.width,te=this._cacheCanvas.height,ee=q>de||ne>te;ue=ee||(q<.9*de||ne<.9*te)&&de>W&&te>W,ee&&!U.capped&&(q>W||ne>W)&&(Q=.1*q,re=.1*ne)}return this instanceof C.Text&&this.path&&(J=!0,ue=!0,Q+=this.getHeightOfLine(0)*this.zoomX,re+=this.getHeightOfLine(0)*this.zoomY),!!J&&(ue?(G.width=Math.ceil(q+Q),G.height=Math.ceil(ne+re)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,G.width,G.height)),N=U.x/2,B=U.y/2,this.cacheTranslationX=Math.round(G.width/2-N)+N,this.cacheTranslationY=Math.round(G.height/2-B)+B,this.cacheWidth=q,this.cacheHeight=ne,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(ie,he),this.zoomX=ie,this.zoomY=he,!0)},setOptions:function(I){this._setOptions(I),this._initGradient(I.fill,"fill"),this._initGradient(I.stroke,"stroke"),this._initPattern(I.fill,"fill"),this._initPattern(I.stroke,"stroke")},transform:function(I){var L=this.calcTransformMatrix(!(this.group&&!this.group._transformDone||this.group&&this.canvas&&I===this.canvas.contextTop));I.transform(L[0],L[1],L[2],L[3],L[4],L[5])},toObject:function(I){var x=C.Object.NUM_FRACTION_DIGITS,L={type:this.type,version:C.version,originX:this.originX,originY:this.originY,left:m(this.left,x),top:m(this.top,x),width:m(this.width,x),height:m(this.height,x),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:m(this.strokeWidth,x),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:m(this.strokeMiterLimit,x),scaleX:m(this.scaleX,x),scaleY:m(this.scaleY,x),angle:m(this.angle,x),flipX:this.flipX,flipY:this.flipY,opacity:m(this.opacity,x),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:m(this.skewX,x),skewY:m(this.skewY,x)};return this.clipPath&&!this.clipPath.excludeFromExport&&(L.clipPath=this.clipPath.toObject(I),L.clipPath.inverted=this.clipPath.inverted,L.clipPath.absolutePositioned=this.clipPath.absolutePositioned),C.util.populateWithProperties(this,L,I),this.includeDefaultValues||(L=this._removeDefaultValues(L)),L},toDatalessObject:function(I){return this.toObject(I)},_removeDefaultValues:function(I){var x=C.util.getKlass(I.type).prototype;return x.stateProperties.forEach(function(L){"left"!==L&&"top"!==L&&(I[L]===x[L]&&delete I[L],Array.isArray(I[L])&&Array.isArray(x[L])&&0===I[L].length&&0===x[L].length&&delete I[L])}),I},toString:function(){return"#<fabric."+v(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var I=C.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(I.scaleX),scaleY:Math.abs(I.scaleY)}},getTotalObjectScaling:function(){var I=this.getObjectScaling(),x=I.scaleX,L=I.scaleY;if(this.canvas){var N=this.canvas.getZoom(),B=this.canvas.getRetinaScaling();x*=N*B,L*=N*B}return{scaleX:x,scaleY:L}},getObjectOpacity:function(){var I=this.opacity;return this.group&&(I*=this.group.getObjectOpacity()),I},_set:function(I,x){var N=this[I]!==x,B=!1;return("scaleX"===I||"scaleY"===I)&&(x=this._constrainScale(x)),"scaleX"===I&&x<0?(this.flipX=!this.flipX,x*=-1):"scaleY"===I&&x<0?(this.flipY=!this.flipY,x*=-1):"shadow"!==I||!x||x instanceof C.Shadow?"dirty"===I&&this.group&&this.group.set("dirty",x):x=new C.Shadow(x),this[I]=x,N&&(B=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(I)>-1?(this.dirty=!0,B&&this.group.set("dirty",!0)):B&&this.stateProperties.indexOf(I)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:C.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(I){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(I.save(),this._setupCompositeOperation(I),this.drawSelectionBackground(I),this.transform(I),this._setOpacity(I),this._setShadow(I,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(I)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(I),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),I.restore())},renderCache:function(I){I=I||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,I.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!=typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(I,x){if(I.save(),I.globalCompositeOperation=x.inverted?"destination-out":"destination-in",x.absolutePositioned){var L=C.util.invertTransform(this.calcTransformMatrix());I.transform(L[0],L[1],L[2],L[3],L[4],L[5])}x.transform(I),I.scale(1/x.zoomX,1/x.zoomY),I.drawImage(x._cacheCanvas,-x.cacheTranslationX,-x.cacheTranslationY),I.restore()},drawObject:function(I,x){var L=this.fill,N=this.stroke;x?(this.fill="black",this.stroke="",this._setClippingProperties(I)):this._renderBackground(I),this._render(I),this._drawClipPath(I,this.clipPath),this.fill=L,this.stroke=N},_drawClipPath:function(I,x){x&&(x.canvas=this.canvas,x.shouldCache(),x._transformDone=!0,x.renderCache({forClipping:!0}),this.drawClipPathOnCache(I,x))},drawCacheOnCanvas:function(I){I.scale(1/this.zoomX,1/this.zoomY),I.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(I){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!I&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!I){var x=this.cacheWidth/this.zoomX,L=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-x/2,-L/2,x,L)}return!0}return!1},_renderBackground:function(I){if(this.backgroundColor){var x=this._getNonTransformedDimensions();I.fillStyle=this.backgroundColor,I.fillRect(-x.x/2,-x.y/2,x.x,x.y),this._removeShadow(I)}},_setOpacity:function(I){this.group&&!this.group._transformDone?I.globalAlpha=this.getObjectOpacity():I.globalAlpha*=this.opacity},_setStrokeStyles:function(I,x){var L=x.stroke;L&&(I.lineWidth=x.strokeWidth,I.lineCap=x.strokeLineCap,I.lineDashOffset=x.strokeDashOffset,I.lineJoin=x.strokeLineJoin,I.miterLimit=x.strokeMiterLimit,L.toLive?"percentage"===L.gradientUnits||L.gradientTransform||L.patternTransform?this._applyPatternForTransformedGradient(I,L):(I.strokeStyle=L.toLive(I,this),this._applyPatternGradientTransform(I,L)):I.strokeStyle=x.stroke)},_setFillStyles:function(I,x){var L=x.fill;L&&(L.toLive?(I.fillStyle=L.toLive(I,this),this._applyPatternGradientTransform(I,x.fill)):I.fillStyle=L)},_setClippingProperties:function(I){I.globalAlpha=1,I.strokeStyle="transparent",I.fillStyle="#000000"},_setLineDash:function(I,x){x&&0!==x.length&&(1&x.length&&x.push.apply(x,x),I.setLineDash(x))},_renderControls:function(I,x){var L,N,B,G=this.getViewportTransform(),U=this.calcTransformMatrix();N=void 0!==(x=x||{}).hasBorders?x.hasBorders:this.hasBorders,B=void 0!==x.hasControls?x.hasControls:this.hasControls,U=C.util.multiplyTransformMatrices(G,U),L=C.util.qrDecompose(U),I.save(),I.translate(L.translateX,L.translateY),I.lineWidth=1*this.borderScaleFactor,this.group||(I.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(L.angle-=180),I.rotate(S(this.group?L.angle:this.angle)),x.forActiveSelection||this.group?N&&this.drawBordersInGroup(I,L,x):N&&this.drawBorders(I,x),B&&this.drawControls(I,x),I.restore()},_setShadow:function(I){if(this.shadow){var x,L=this.shadow,N=this.canvas,B=N&&N.viewportTransform[0]||1,G=N&&N.viewportTransform[3]||1;x=L.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),N&&N._isRetinaScaling()&&(B*=C.devicePixelRatio,G*=C.devicePixelRatio),I.shadowColor=L.color,I.shadowBlur=L.blur*C.browserShadowBlurConstant*(B+G)*(x.scaleX+x.scaleY)/4,I.shadowOffsetX=L.offsetX*B*x.scaleX,I.shadowOffsetY=L.offsetY*G*x.scaleY}},_removeShadow:function(I){this.shadow&&(I.shadowColor="",I.shadowBlur=I.shadowOffsetX=I.shadowOffsetY=0)},_applyPatternGradientTransform:function(I,x){if(!x||!x.toLive)return{offsetX:0,offsetY:0};var L=x.gradientTransform||x.patternTransform,N=-this.width/2+x.offsetX||0,B=-this.height/2+x.offsetY||0;return"percentage"===x.gradientUnits?I.transform(this.width,0,0,this.height,N,B):I.transform(1,0,0,1,N,B),L&&I.transform(L[0],L[1],L[2],L[3],L[4],L[5]),{offsetX:N,offsetY:B}},_renderPaintInOrder:function(I){"stroke"===this.paintFirst?(this._renderStroke(I),this._renderFill(I)):(this._renderFill(I),this._renderStroke(I))},_render:function(){},_renderFill:function(I){this.fill&&(I.save(),this._setFillStyles(I,this),"evenodd"===this.fillRule?I.fill("evenodd"):I.fill(),I.restore())},_renderStroke:function(I){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(I),I.save(),this.strokeUniform&&this.group){var x=this.getObjectScaling();I.scale(1/x.scaleX,1/x.scaleY)}else this.strokeUniform&&I.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(I,this.strokeDashArray),this._setStrokeStyles(I,this),I.stroke(),I.restore()}},_applyPatternForTransformedGradient:function(I,x){var L,N=this._limitCacheSize(this._getCacheCanvasDimensions()),B=C.util.createCanvasElement(),G=this.canvas.getRetinaScaling(),U=N.x/this.scaleX/G,W=N.y/this.scaleY/G;B.width=U,B.height=W,(L=B.getContext("2d")).beginPath(),L.moveTo(0,0),L.lineTo(U,0),L.lineTo(U,W),L.lineTo(0,W),L.closePath(),L.translate(U/2,W/2),L.scale(N.zoomX/this.scaleX/G,N.zoomY/this.scaleY/G),this._applyPatternGradientTransform(L,x),L.fillStyle=x.toLive(I),L.fill(),I.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),I.scale(G*this.scaleX/N.zoomX,G*this.scaleY/N.zoomY),I.strokeStyle=L.createPattern(B,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var I=C.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",I.scaleX),this.set("scaleY",I.scaleY),this.angle=I.angle,this.skewX=I.skewX,this.skewY=0}},_removeTransformMatrix:function(I){var x=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),x=C.util.transformPoint(x,this.transformMatrix)),this.transformMatrix=null,I&&(this.scaleX*=I.scaleX,this.scaleY*=I.scaleY,this.cropX=I.cropX,this.cropY=I.cropY,x.x+=I.offsetLeft,x.y+=I.offsetTop,this.width=I.width,this.height=I.height),this.setPositionByOrigin(x,"center","center")},clone:function(I,x){var L=this.toObject(x);this.constructor.fromObject?this.constructor.fromObject(L,I):C.Object._fromObject("Object",L,I)},cloneAsImage:function(I,x){var L=this.toCanvasElement(x);return I&&I(new C.Image(L)),this},toCanvasElement:function(I){I||(I={});var x=C.util,L=x.saveObjectTransform(this),N=this.group,B=this.shadow,G=Math.abs,U=(I.multiplier||1)*(I.enableRetinaScaling?C.devicePixelRatio:1);delete this.group,I.withoutTransform&&x.resetObjectTransform(this),I.withoutShadow&&(this.shadow=null);var W,q,ie,he=C.util.createCanvasElement(),le=this.getBoundingRect(!0,!0),oe=this.shadow,J={x:0,y:0};oe&&(q=oe.blur,W=oe.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),J.x=2*Math.round(G(oe.offsetX)+q)*G(W.scaleX),J.y=2*Math.round(G(oe.offsetY)+q)*G(W.scaleY)),ie=le.height+J.y,he.width=Math.ceil(le.width+J.x),he.height=Math.ceil(ie);var Q=new C.StaticCanvas(he,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===I.format&&(Q.backgroundColor="#fff"),this.setPositionByOrigin(new C.Point(Q.width/2,Q.height/2),"center","center");var re=this.canvas;Q.add(this);var ue=Q.toCanvasElement(U||1,I);return this.shadow=B,this.set("canvas",re),N&&(this.group=N),this.set(L).setCoords(),Q._objects=[],Q.dispose(),Q=null,ue},toDataURL:function(I){return I||(I={}),C.util.toDataURL(this.toCanvasElement(I),I.format||"png",I.quality||1)},isType:function(I){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===I},complexity:function(){return 1},toJSON:function(I){return this.toObject(I)},rotate:function(I){var x=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return x&&this._setOriginToCenter(),this.set("angle",I),x&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(I,x){x=x||this.canvas.getPointer(I);var L=new C.Point(x.x,x.y),N=this._getLeftTopCoords();return this.angle&&(L=C.util.rotatePoint(L,N,S(-this.angle))),{x:L.x-N.x,y:L.y-N.y}},_setupCompositeOperation:function(I){this.globalCompositeOperation&&(I.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){C.runningAnimations&&C.runningAnimations.cancelByTarget(this)}}),C.util.createAccessors&&C.util.createAccessors(C.Object),w(C.Object.prototype,C.Observable),C.Object.NUM_FRACTION_DIGITS=2,C.Object.ENLIVEN_PROPS=["clipPath"],C.Object._fromObject=function(I,x,L,N){var B=C[I];x=T(x,!0),C.util.enlivenPatterns([x.fill,x.stroke],function(G){void 0!==G[0]&&(x.fill=G[0]),void 0!==G[1]&&(x.stroke=G[1]),C.util.enlivenObjectEnlivables(x,x,function(){var U=N?new B(x[N],x):new B(x);L&&L(U)})})},C.Object.__uid=0)}(a),ge=F.util.degreesToRadians,_e={left:-.5,center:0,right:.5},Te={top:-.5,center:0,bottom:.5},F.util.object.extend(F.Object.prototype,{translateToGivenOrigin:function(D,C,w,T,m){var v,S,A,I=D.x,x=D.y;return"string"==typeof C?C=_e[C]:C-=.5,"string"==typeof T?T=_e[T]:T-=.5,"string"==typeof w?w=Te[w]:w-=.5,"string"==typeof m?m=Te[m]:m-=.5,S=m-w,((v=T-C)||S)&&(A=this._getTransformedDimensions(),I=D.x+v*A.x,x=D.y+S*A.y),new F.Point(I,x)},translateToCenterPoint:function(D,C,w){var T=this.translateToGivenOrigin(D,C,w,"center","center");return this.angle?F.util.rotatePoint(T,D,ge(this.angle)):T},translateToOriginPoint:function(D,C,w){var T=this.translateToGivenOrigin(D,"center","center",C,w);return this.angle?F.util.rotatePoint(T,D,ge(this.angle)):T},getCenterPoint:function(){var D=new F.Point(this.left,this.top);return this.translateToCenterPoint(D,this.originX,this.originY)},getPointByOrigin:function(D,C){var w=this.getCenterPoint();return this.translateToOriginPoint(w,D,C)},toLocalPoint:function(D,C,w){var T,m,v=this.getCenterPoint();return T=void 0!==C&&void 0!==w?this.translateToGivenOrigin(v,"center","center",C,w):new F.Point(this.left,this.top),m=new F.Point(D.x,D.y),this.angle&&(m=F.util.rotatePoint(m,v,-ge(this.angle))),m.subtractEquals(T)},setPositionByOrigin:function(D,C,w){var T=this.translateToCenterPoint(D,C,w),m=this.translateToOriginPoint(T,this.originX,this.originY);this.set("left",m.x),this.set("top",m.y)},adjustPosition:function(D){var C,w,T=ge(this.angle),m=this.getScaledWidth(),v=F.util.cos(T)*m,S=F.util.sin(T)*m;this.left+=v*((w="string"==typeof D?_e[D]:D-.5)-(C="string"==typeof this.originX?_e[this.originX]:this.originX-.5)),this.top+=S*(w-C),this.setCoords(),this.originX=D},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var D=this.getCenterPoint();this.originX="center",this.originY="center",this.left=D.x,this.top=D.y},_resetOrigin:function(){var D=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=D.x,this.top=D.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var D=F.util,C=D.degreesToRadians,w=D.multiplyTransformMatrices,T=D.transformPoint;D.object.extend(F.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(m,v){return v?m?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),m?this.aCoords:this.lineCoords)},getCoords:function(m,v){return S=this._getCoords(m,v),[new F.Point(S.tl.x,S.tl.y),new F.Point(S.tr.x,S.tr.y),new F.Point(S.br.x,S.br.y),new F.Point(S.bl.x,S.bl.y)];var S},intersectsWithRect:function(m,v,S,A){var I=this.getCoords(S,A);return"Intersection"===F.Intersection.intersectPolygonRectangle(I,m,v).status},intersectsWithObject:function(m,v,S){return"Intersection"===F.Intersection.intersectPolygonPolygon(this.getCoords(v,S),m.getCoords(v,S)).status||m.isContainedWithinObject(this,v,S)||this.isContainedWithinObject(m,v,S)},isContainedWithinObject:function(m,v,S){for(var A=this.getCoords(v,S),x=0,L=m._getImageLines(v?m.aCoords:m.lineCoords);x<4;x++)if(!m.containsPoint(A[x],L))return!1;return!0},isContainedWithinRect:function(m,v,S,A){var I=this.getBoundingRect(S,A);return I.left>=m.x&&I.left+I.width<=v.x&&I.top>=m.y&&I.top+I.height<=v.y},containsPoint:function(m,v,S,A){var I=this._getCoords(S,A),x=(v=v||this._getImageLines(I),this._findCrossPoints(m,v));return 0!==x&&x%2==1},isOnScreen:function(m){if(!this.canvas)return!1;var v=this.canvas.vptCoords.tl,S=this.canvas.vptCoords.br;return!!this.getCoords(!0,m).some(function(A){return A.x<=S.x&&A.x>=v.x&&A.y<=S.y&&A.y>=v.y})||!!this.intersectsWithRect(v,S,!0,m)||this._containsCenterOfCanvas(v,S,m)},_containsCenterOfCanvas:function(m,v,S){return!!this.containsPoint({x:(m.x+v.x)/2,y:(m.y+v.y)/2},null,!0,S)},isPartiallyOnScreen:function(m){if(!this.canvas)return!1;var v=this.canvas.vptCoords.tl,S=this.canvas.vptCoords.br;return!!this.intersectsWithRect(v,S,!0,m)||this.getCoords(!0,m).every(function(A){return(A.x>=S.x||A.x<=v.x)&&(A.y>=S.y||A.y<=v.y)})&&this._containsCenterOfCanvas(v,S,m)},_getImageLines:function(m){return{topline:{o:m.tl,d:m.tr},rightline:{o:m.tr,d:m.br},bottomline:{o:m.br,d:m.bl},leftline:{o:m.bl,d:m.tl}}},_findCrossPoints:function(m,v){var S,A,I,x=0;for(var L in v)if(!((I=v[L]).o.y<m.y&&I.d.y<m.y||I.o.y>=m.y&&I.d.y>=m.y||(I.o.x===I.d.x&&I.o.x>=m.x?A=I.o.x:(S=(I.d.y-I.o.y)/(I.d.x-I.o.x),A=-(m.y-0*m.x-(I.o.y-S*I.o.x))/(0-S)),A>=m.x&&(x+=1),2!==x)))break;return x},getBoundingRect:function(m,v){var S=this.getCoords(m,v);return D.makeBoundingBoxFromPoints(S)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(m){return Math.abs(m)<this.minScaleLimit?m<0?-this.minScaleLimit:this.minScaleLimit:0===m?1e-4:m},scale:function(m){return this._set("scaleX",m),this._set("scaleY",m),this.setCoords()},scaleToWidth:function(m,v){var S=this.getBoundingRect(v).width/this.getScaledWidth();return this.scale(m/this.width/S)},scaleToHeight:function(m,v){var S=this.getBoundingRect(v).height/this.getScaledHeight();return this.scale(m/this.height/S)},calcLineCoords:function(){var m=this.getViewportTransform(),v=this.padding,S=C(this.angle),A=D.cos(S)*v,I=D.sin(S)*v,x=A+I,L=A-I,N=this.calcACoords(),B={tl:T(N.tl,m),tr:T(N.tr,m),bl:T(N.bl,m),br:T(N.br,m)};return v&&(B.tl.x-=L,B.tl.y-=x,B.tr.x+=x,B.tr.y-=L,B.bl.x-=x,B.bl.y+=L,B.br.x+=L,B.br.y+=x),B},calcOCoords:function(){var m=this._calcRotateMatrix(),v=this._calcTranslateMatrix(),S=this.getViewportTransform(),A=w(S,v),I=w(A,m),x=(I=w(I,[1/S[0],0,0,1/S[3],0,0]),this._calculateCurrentDimensions()),L={};return this.forEachControl(function(N,B,G){L[B]=N.positionHandler(x,I,G)}),L},calcACoords:function(){var m=this._calcRotateMatrix(),v=this._calcTranslateMatrix(),S=w(v,m),A=this._getTransformedDimensions(),I=A.x/2,x=A.y/2;return{tl:T({x:-I,y:-x},S),tr:T({x:I,y:-x},S),bl:T({x:-I,y:x},S),br:T({x:I,y:x},S)}},setCoords:function(m){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),m||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return D.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var m=this.getCenterPoint();return[1,0,0,1,m.x,m.y]},transformMatrixKey:function(m){var v="_",S="";return!m&&this.group&&(S=this.group.transformMatrixKey(m)+v),S+this.top+v+this.left+v+this.scaleX+v+this.scaleY+v+this.skewX+v+this.skewY+v+this.angle+v+this.originX+v+this.originY+v+this.width+v+this.height+v+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(m){var v=this.calcOwnMatrix();if(m||!this.group)return v;var S=this.transformMatrixKey(m),A=this.matrixCache||(this.matrixCache={});return A.key===S?A.value:(this.group&&(v=w(this.group.calcTransformMatrix(!1),v)),A.key=S,A.value=v,v)},calcOwnMatrix:function(){var m=this.transformMatrixKey(!0),v=this.ownMatrixCache||(this.ownMatrixCache={});if(v.key===m)return v.value;var S=this._calcTranslateMatrix(),A={angle:this.angle,translateX:S[4],translateY:S[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return v.key=m,v.value=D.composeMatrix(A),v.value},_getNonTransformedDimensions:function(){var m=this.strokeWidth;return{x:this.width+m,y:this.height+m}},_getTransformedDimensions:function(m,v){void 0===m&&(m=this.skewX),void 0===v&&(v=this.skewY);var S,A,I,x=0===m&&0===v;if(this.strokeUniform?(A=this.width,I=this.height):(A=(S=this._getNonTransformedDimensions()).x,I=S.y),x)return this._finalizeDimensions(A*this.scaleX,I*this.scaleY);var L=D.sizeAfterTransform(A,I,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:m,skewY:v});return this._finalizeDimensions(L.x,L.y)},_finalizeDimensions:function(m,v){return this.strokeUniform?{x:m+this.strokeWidth,y:v+this.strokeWidth}:{x:m,y:v}},_calculateCurrentDimensions:function(){var m=this.getViewportTransform(),v=this._getTransformedDimensions();return T(v,m,!0).scalarAdd(2*this.padding)}})}(),F.util.object.extend(F.Object.prototype,{sendToBack:function(){return this.group?F.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?F.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(D){return this.group?F.StaticCanvas.prototype.sendBackwards.call(this.group,this,D):this.canvas&&this.canvas.sendBackwards(this,D),this},bringForward:function(D){return this.group?F.StaticCanvas.prototype.bringForward.call(this.group,this,D):this.canvas&&this.canvas.bringForward(this,D),this},moveTo:function(D){return this.group&&"activeSelection"!==this.group.type?F.StaticCanvas.prototype.moveTo.call(this.group,this,D):this.canvas&&this.canvas.moveTo(this,D),this}}),function(){function D(w,T){if(T){if(T.toLive)return w+": url(#SVGID_"+T.id+"); ";var m=new F.Color(T),v=w+": "+m.toRgb()+"; ",S=m.getAlpha();return 1!==S&&(v+=w+"-opacity: "+S.toString()+"; "),v}return w+": none; "}var C=F.util.toFixed;F.util.object.extend(F.Object.prototype,{getSvgStyles:function(w){var T=this.fillRule?this.fillRule:"nonzero",m=this.strokeWidth?this.strokeWidth:"0",v=this.strokeDashArray?this.strokeDashArray.join(" "):"none",S=this.strokeDashOffset?this.strokeDashOffset:"0",A=this.strokeLineCap?this.strokeLineCap:"butt",I=this.strokeLineJoin?this.strokeLineJoin:"miter",x=this.strokeMiterLimit?this.strokeMiterLimit:"4",L=void 0!==this.opacity?this.opacity:"1",N=this.visible?"":" visibility: hidden;",B=w?"":this.getSvgFilter(),G=D("fill",this.fill);return[D("stroke",this.stroke),"stroke-width: ",m,"; ","stroke-dasharray: ",v,"; ","stroke-linecap: ",A,"; ","stroke-dashoffset: ",S,"; ","stroke-linejoin: ",I,"; ","stroke-miterlimit: ",x,"; ",G,"fill-rule: ",T,"; ","opacity: ",L,";",B,N].join("")},getSvgSpanStyles:function(w,T){var m="; ",v=w.fontFamily?"font-family: "+(-1===w.fontFamily.indexOf("'")&&-1===w.fontFamily.indexOf('"')?"'"+w.fontFamily+"'":w.fontFamily)+m:"",S=w.strokeWidth?"stroke-width: "+w.strokeWidth+m:"",A=w.fontSize?"font-size: "+w.fontSize+"px"+m:"",I=w.fontStyle?"font-style: "+w.fontStyle+m:"",x=w.fontWeight?"font-weight: "+w.fontWeight+m:"",L=w.fill?D("fill",w.fill):"",N=w.stroke?D("stroke",w.stroke):"",B=this.getSvgTextDecoration(w);return B&&(B="text-decoration: "+B+m),[N,S,v,A,I,x,B,L,w.deltaY?"baseline-shift: "+-w.deltaY+"; ":"",T?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(w){return["overline","underline","line-through"].filter(function(T){return w[T.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(w,T){var m=w?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+F.util.matrixToSVG(m)+(T||"")+'" '},_setSVGBg:function(w){if(this.backgroundColor){var T=F.Object.NUM_FRACTION_DIGITS;w.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',C(-this.width/2,T),'" y="',C(-this.height/2,T),'" width="',C(this.width,T),'" height="',C(this.height,T),'"></rect>\n')}},toSVG:function(w){return this._createBaseSVGMarkup(this._toSVG(w),{reviver:w})},toClipPathSVG:function(w){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(w),{reviver:w})},_createBaseClipPathSVGMarkup:function(w,T){var m=(T=T||{}).reviver,S=[this.getSvgTransform(!0,T.additionalTransform||""),this.getSvgCommons()].join(""),A=w.indexOf("COMMON_PARTS");return w[A]=S,m?m(w.join("")):w.join("")},_createBaseSVGMarkup:function(w,T){var m,v,S=(T=T||{}).noStyle,A=T.reviver,I=S?"":'style="'+this.getSvgStyles()+'" ',x=T.withShadow?'style="'+this.getSvgFilter()+'" ':"",L=this.clipPath,N=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",B=L&&L.absolutePositioned,G=this.stroke,U=this.fill,W=this.shadow,q=[],ne=w.indexOf("COMMON_PARTS"),ie=T.additionalTransform;return L&&(L.clipPathId="CLIPPATH_"+F.Object.__uid++,v='<clipPath id="'+L.clipPathId+'" >\n'+L.toClipPathSVG(A)+"</clipPath>\n"),B&&q.push("<g ",x,this.getSvgCommons()," >\n"),q.push("<g ",this.getSvgTransform(!1),B?"":x+this.getSvgCommons()," >\n"),m=[I,N,S?"":this.addPaintOrder()," ",ie?'transform="'+ie+'" ':""].join(""),w[ne]=m,U&&U.toLive&&q.push(U.toSVG(this)),G&&G.toLive&&q.push(G.toSVG(this)),W&&q.push(W.toSVG(this)),L&&q.push(v),q.push(w.join("")),q.push("</g>\n"),B&&q.push("</g>\n"),A?A(q.join("")):q.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var D=F.util.object.extend,C="stateProperties";function w(m,v,S){var A={};S.forEach(function(I){A[I]=m[I]}),D(m[v],A,!0)}function T(m,v,S){if(m===v)return!0;if(Array.isArray(m)){if(!Array.isArray(v)||m.length!==v.length)return!1;for(var A=0,I=m.length;A<I;A++)if(!T(m[A],v[A]))return!1;return!0}if(m&&"object"==typeof m){var x,L=Object.keys(m);if(!v||"object"!=typeof v||!S&&L.length!==Object.keys(v).length)return!1;for(A=0,I=L.length;A<I;A++)if("canvas"!==(x=L[A])&&"group"!==x&&!T(m[x],v[x]))return!1;return!0}}F.util.object.extend(F.Object.prototype,{hasStateChanged:function(m){var v="_"+(m=m||C);return Object.keys(this[v]).length<this[m].length||!T(this[v],this,!0)},saveState:function(m){var v=m&&m.propertySet||C,S="_"+v;return this[S]?(w(this,S,this[v]),m&&m.stateProperties&&w(this,S,m.stateProperties),this):this.setupState(m)},setupState:function(m){var v=(m=m||{}).propertySet||C;return m.propertySet=v,this["_"+v]={},this.saveState(m),this}})}(),function(){var D=F.util.degreesToRadians;F.util.object.extend(F.Object.prototype,{_findTargetCorner:function(C,w){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var T,m,v,S=C.x,A=C.y,I=Object.keys(this.oCoords),x=I.length-1;for(this.__corner=0;x>=0;x--)if(this.isControlVisible(v=I[x])&&(m=this._getImageLines(w?this.oCoords[v].touchCorner:this.oCoords[v].corner),0!==(T=this._findCrossPoints({x:S,y:A},m))&&T%2==1))return this.__corner=v,v;return!1},forEachControl:function(C){for(var w in this.controls)C(this.controls[w],w,this)},_setCornerCoords:function(){var C=this.oCoords;for(var w in C){var T=this.controls[w];C[w].corner=T.calcCornerCoords(this.angle,this.cornerSize,C[w].x,C[w].y,!1),C[w].touchCorner=T.calcCornerCoords(this.angle,this.touchCornerSize,C[w].x,C[w].y,!0)}},drawSelectionBackground:function(C){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;C.save();var w=this.getCenterPoint(),T=this._calculateCurrentDimensions(),m=this.canvas.viewportTransform;return C.translate(w.x,w.y),C.scale(1/m[0],1/m[3]),C.rotate(D(this.angle)),C.fillStyle=this.selectionBackgroundColor,C.fillRect(-T.x/2,-T.y/2,T.x,T.y),C.restore(),this},drawBorders:function(C,w){w=w||{};var T=this._calculateCurrentDimensions(),m=this.borderScaleFactor,v=T.x+m,S=T.y+m,A=void 0!==w.hasControls?w.hasControls:this.hasControls,I=!1;return C.save(),C.strokeStyle=w.borderColor||this.borderColor,this._setLineDash(C,w.borderDashArray||this.borderDashArray),C.strokeRect(-v/2,-S/2,v,S),A&&(C.beginPath(),this.forEachControl(function(x,L,N){x.withConnection&&x.getVisibility(N,L)&&(I=!0,C.moveTo(x.x*v,x.y*S),C.lineTo(x.x*v+x.offsetX,x.y*S+x.offsetY))}),I&&C.stroke()),C.restore(),this},drawBordersInGroup:function(C,w,T){T=T||{};var m=F.util.sizeAfterTransform(this.width,this.height,w),v=this.strokeWidth,S=this.strokeUniform,A=this.borderScaleFactor,I=m.x+v*(S?this.canvas.getZoom():w.scaleX)+A,x=m.y+v*(S?this.canvas.getZoom():w.scaleY)+A;return C.save(),this._setLineDash(C,T.borderDashArray||this.borderDashArray),C.strokeStyle=T.borderColor||this.borderColor,C.strokeRect(-I/2,-x/2,I,x),C.restore(),this},drawControls:function(C,w){w=w||{},C.save();var T,m,v=this.canvas.getRetinaScaling();return C.setTransform(v,0,0,v,0,0),C.strokeStyle=C.fillStyle=w.cornerColor||this.cornerColor,this.transparentCorners||(C.strokeStyle=w.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(C,w.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(T=this.group.calcTransformMatrix()),this.forEachControl(function(S,A,I){m=I.oCoords[A],S.getVisibility(I,A)&&(T&&(m=F.util.transformPoint(m,T)),S.render(C,m.x,m.y,w,I))}),C.restore(),this},isControlVisible:function(C){return this.controls[C]&&this.controls[C].getVisibility(this,C)},setControlVisible:function(C,w){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[C]=w,this},setControlsVisibility:function(C){for(var w in C||(C={}),C)this.setControlVisible(w,C[w]);return this},onDeselect:function(){},onSelect:function(){}})}(),F.util.object.extend(F.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(D,C){var w=function(){},T=(C=C||{}).onComplete||w,m=C.onChange||w,v=this;return F.util.animate({target:this,startValue:D.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(S){D.set("left",S),v.requestRenderAll(),m()},onComplete:function(){D.setCoords(),T()}})},fxCenterObjectV:function(D,C){var w=function(){},T=(C=C||{}).onComplete||w,m=C.onChange||w,v=this;return F.util.animate({target:this,startValue:D.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(S){D.set("top",S),v.requestRenderAll(),m()},onComplete:function(){D.setCoords(),T()}})},fxRemove:function(D,C){var w=function(){},T=(C=C||{}).onComplete||w,m=C.onChange||w,v=this;return F.util.animate({target:this,startValue:D.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(S){D.set("opacity",S),v.requestRenderAll(),m()},onComplete:function(){v.remove(D),T()}})}}),F.util.object.extend(F.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var D,w=[],T=[];for(D in arguments[0])w.push(D);for(var m=0,v=w.length;m<v;m++)T.push(this._animate(D=w[m],arguments[0][D],arguments[1],m!==v-1));return T}return this._animate.apply(this,arguments)},_animate:function(D,C,w,T){var m,v=this;C=C.toString(),w=w?F.util.object.clone(w):{},~D.indexOf(".")&&(m=D.split("."));var S=v.colorProperties.indexOf(D)>-1||m&&v.colorProperties.indexOf(m[1])>-1,A=m?this.get(m[0])[m[1]]:this.get(D);"from"in w||(w.from=A),S||(C=~C.indexOf("=")?A+parseFloat(C.replace("=","")):parseFloat(C));var I={target:this,startValue:w.from,endValue:C,byValue:w.by,easing:w.easing,duration:w.duration,abort:w.abort&&function(x,L,N){return w.abort.call(v,x,L,N)},onChange:function(x,L,N){m?v[m[0]][m[1]]=x:v.set(D,x),T||w.onChange&&w.onChange(x,L,N)},onComplete:function(x,L,N){T||(v.setCoords(),w.onComplete&&w.onComplete(x,L,N))}};return S?F.util.animateColor(I.startValue,I.endValue,I.duration,I):F.util.animate(I)}}),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.extend,T=C.util.object.clone,m={x1:1,x2:1,y1:1,y2:1};function v(S,A){var I=S.origin,x=S.axis1,L=S.axis2,N=S.dimension,B=A.nearest,G=A.center,U=A.farthest;return function(){switch(this.get(I)){case B:return Math.min(this.get(x),this.get(L));case G:return Math.min(this.get(x),this.get(L))+.5*this.get(N);case U:return Math.max(this.get(x),this.get(L))}}}C.Line?C.warn("fabric.Line is already defined"):(C.Line=C.util.createClass(C.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:C.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(S,A){S||(S=[0,0,0,0]),this.callSuper("initialize",A),this.set("x1",S[0]),this.set("y1",S[1]),this.set("x2",S[2]),this.set("y2",S[3]),this._setWidthHeight(A)},_setWidthHeight:function(S){S||(S={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in S?S.left:this._getLeftToOriginX(),this.top="top"in S?S.top:this._getTopToOriginY()},_set:function(S,A){return this.callSuper("_set",S,A),void 0!==m[S]&&this._setWidthHeight(),this},_getLeftToOriginX:v({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:v({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(S){S.beginPath();var A=this.calcLinePoints();S.moveTo(A.x1,A.y1),S.lineTo(A.x2,A.y2),S.lineWidth=this.strokeWidth;var I=S.strokeStyle;S.strokeStyle=this.stroke||S.fillStyle,this.stroke&&this._renderStroke(S),S.strokeStyle=I},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(S){return w(this.callSuper("toObject",S),this.calcLinePoints())},_getNonTransformedDimensions:function(){var S=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(S.y-=this.strokeWidth),0===this.height&&(S.x-=this.strokeWidth)),S},calcLinePoints:function(){var S=this.x1<=this.x2?-1:1,A=this.y1<=this.y2?-1:1;return{x1:S*this.width*.5,x2:S*this.width*-.5,y1:A*this.height*.5,y2:A*this.height*-.5}},_toSVG:function(){var S=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',S.x1,'" y1="',S.y1,'" x2="',S.x2,'" y2="',S.y2,'" />\n']}}),C.Line.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),C.Line.fromElement=function(S,A,I){I=I||{};var x=C.parseAttributes(S,C.Line.ATTRIBUTE_NAMES);A(new C.Line([x.x1||0,x.y1||0,x.x2||0,x.y2||0],w(x,I)))},C.Line.fromObject=function(S,A){var I=T(S,!0);I.points=[S.x1,S.y1,S.x2,S.y2],C.Object._fromObject("Line",I,function(x){delete x.points,A&&A(x)},"points")})}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.degreesToRadians;C.Circle?C.warn("fabric.Circle is already defined."):(C.Circle=C.util.createClass(C.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:C.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(T,m){return this.callSuper("_set",T,m),"radius"===T&&this.setRadius(m),this},toObject:function(T){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(T))},_toSVG:function(){var T,m=(this.endAngle-this.startAngle)%360;if(0===m)T=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var v=w(this.startAngle),S=w(this.endAngle),A=this.radius;T=['<path d="M '+C.util.cos(v)*A+" "+C.util.sin(v)*A," A "+A+" "+A," 0 ",+(m>180?"1":"0")+" 1"," "+C.util.cos(S)*A+" "+C.util.sin(S)*A,'" ',"COMMON_PARTS"," />\n"]}return T},_render:function(T){T.beginPath(),T.arc(0,0,this.radius,w(this.startAngle),w(this.endAngle),!1),this._renderPaintInOrder(T)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(T){return this.radius=T,this.set("width",2*T).set("height",2*T)}}),C.Circle.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),C.Circle.fromElement=function(T,m){var v,S=C.parseAttributes(T,C.Circle.ATTRIBUTE_NAMES);if(!("radius"in(v=S)&&v.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");S.left=(S.left||0)-S.radius,S.top=(S.top||0)-S.radius,m(new C.Circle(S))},C.Circle.fromObject=function(T,m){C.Object._fromObject("Circle",T,m)})}(a),function(D){var C=D.fabric||(D.fabric={});C.Triangle?C.warn("fabric.Triangle is already defined"):(C.Triangle=C.util.createClass(C.Object,{type:"triangle",width:100,height:100,_render:function(w){var T=this.width/2,m=this.height/2;w.beginPath(),w.moveTo(-T,m),w.lineTo(0,-m),w.lineTo(T,m),w.closePath(),this._renderPaintInOrder(w)},_toSVG:function(){var w=this.width/2,T=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-w+" "+T,"0 "+-T,w+" "+T].join(","),'" />']}}),C.Triangle.fromObject=function(w,T){return C.Object._fromObject("Triangle",w,T)})}(a),function(D){var C=D.fabric||(D.fabric={}),w=2*Math.PI;C.Ellipse?C.warn("fabric.Ellipse is already defined."):(C.Ellipse=C.util.createClass(C.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:C.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(T){this.callSuper("initialize",T),this.set("rx",T&&T.rx||0),this.set("ry",T&&T.ry||0)},_set:function(T,m){switch(this.callSuper("_set",T,m),T){case"rx":this.rx=m,this.set("width",2*m);break;case"ry":this.ry=m,this.set("height",2*m)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(T){return this.callSuper("toObject",["rx","ry"].concat(T))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(T){T.beginPath(),T.save(),T.transform(1,0,0,this.ry/this.rx,0,0),T.arc(0,0,this.rx,0,w,!1),T.restore(),this._renderPaintInOrder(T)}}),C.Ellipse.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),C.Ellipse.fromElement=function(T,m){var v=C.parseAttributes(T,C.Ellipse.ATTRIBUTE_NAMES);v.left=(v.left||0)-v.rx,v.top=(v.top||0)-v.ry,m(new C.Ellipse(v))},C.Ellipse.fromObject=function(T,m){C.Object._fromObject("Ellipse",T,m)})}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.extend;C.Rect?C.warn("fabric.Rect is already defined"):(C.Rect=C.util.createClass(C.Object,{stateProperties:C.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:C.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(T){this.callSuper("initialize",T),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(T){var m=this.rx?Math.min(this.rx,this.width/2):0,v=this.ry?Math.min(this.ry,this.height/2):0,S=this.width,A=this.height,I=-this.width/2,x=-this.height/2,L=0!==m||0!==v,N=.4477152502;T.beginPath(),T.moveTo(I+m,x),T.lineTo(I+S-m,x),L&&T.bezierCurveTo(I+S-N*m,x,I+S,x+N*v,I+S,x+v),T.lineTo(I+S,x+A-v),L&&T.bezierCurveTo(I+S,x+A-N*v,I+S-N*m,x+A,I+S-m,x+A),T.lineTo(I+m,x+A),L&&T.bezierCurveTo(I+N*m,x+A,I,x+A-N*v,I,x+A-v),T.lineTo(I,x+v),L&&T.bezierCurveTo(I,x+N*v,I+N*m,x,I+m,x),T.closePath(),this._renderPaintInOrder(T)},toObject:function(T){return this.callSuper("toObject",["rx","ry"].concat(T))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),C.Rect.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),C.Rect.fromElement=function(T,m,v){if(!T)return m(null);v=v||{};var S=C.parseAttributes(T,C.Rect.ATTRIBUTE_NAMES);S.left=S.left||0,S.top=S.top||0,S.height=S.height||0,S.width=S.width||0;var A=new C.Rect(w(v?C.util.object.clone(v):{},S));A.visible=A.visible&&A.width>0&&A.height>0,m(A)},C.Rect.fromObject=function(T,m){return C.Object._fromObject("Rect",T,m)})}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.extend,T=C.util.array.min,m=C.util.array.max,v=C.util.toFixed,S=C.util.projectStrokeOnPoints;C.Polyline?C.warn("fabric.Polyline is already defined"):(C.Polyline=C.util.createClass(C.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:C.Object.prototype.cacheProperties.concat("points"),initialize:function(A,I){I=I||{},this.points=A||[],this.callSuper("initialize",I),this._setPositionDimensions(I)},_projectStrokeOnPoints:function(){return S(this.points,this,!0)},_setPositionDimensions:function(A){var I,x=this._calcDimensions(A),L=this.exactBoundingBox?this.strokeWidth:0;this.width=x.width-L,this.height=x.height-L,A.fromSVG||(I=this.translateToGivenOrigin({x:x.left-this.strokeWidth/2+L/2,y:x.top-this.strokeWidth/2+L/2},"left","top",this.originX,this.originY)),void 0===A.left&&(this.left=A.fromSVG?x.left:I.x),void 0===A.top&&(this.top=A.fromSVG?x.top:I.y),this.pathOffset={x:x.left+this.width/2+L/2,y:x.top+this.height/2+L/2}},_calcDimensions:function(){var A=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,I=T(A,"x")||0,x=T(A,"y")||0;return{left:I,top:x,width:(m(A,"x")||0)-I,height:(m(A,"y")||0)-x}},toObject:function(A){return w(this.callSuper("toObject",A),{points:this.points.concat()})},_toSVG:function(){for(var A=[],I=this.pathOffset.x,x=this.pathOffset.y,L=C.Object.NUM_FRACTION_DIGITS,N=0,B=this.points.length;N<B;N++)A.push(v(this.points[N].x-I,L),",",v(this.points[N].y-x,L)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',A.join(""),'" />\n']},commonRender:function(A){var I,x=this.points.length,L=this.pathOffset.x,N=this.pathOffset.y;if(!x||isNaN(this.points[x-1].y))return!1;A.beginPath(),A.moveTo(this.points[0].x-L,this.points[0].y-N);for(var B=0;B<x;B++)A.lineTo((I=this.points[B]).x-L,I.y-N);return!0},_render:function(A){this.commonRender(A)&&this._renderPaintInOrder(A)},complexity:function(){return this.get("points").length}}),C.Polyline.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat(),C.Polyline.fromElementGenerator=function(A){return function(I,x,L){if(!I)return x(null);L||(L={});var N=C.parsePointsAttribute(I.getAttribute("points")),B=C.parseAttributes(I,C[A].ATTRIBUTE_NAMES);B.fromSVG=!0,x(new C[A](N,w(B,L)))}},C.Polyline.fromElement=C.Polyline.fromElementGenerator("Polyline"),C.Polyline.fromObject=function(A,I){return C.Object._fromObject("Polyline",A,I,"points")})}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.projectStrokeOnPoints;C.Polygon?C.warn("fabric.Polygon is already defined"):(C.Polygon=C.util.createClass(C.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return w(this.points,this)},_render:function(T){this.commonRender(T)&&(T.closePath(),this._renderPaintInOrder(T))}}),C.Polygon.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat(),C.Polygon.fromElement=C.Polyline.fromElementGenerator("Polygon"),C.Polygon.fromObject=function(T,m){C.Object._fromObject("Polygon",T,m,"points")})}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.array.min,T=C.util.array.max,m=C.util.object.extend,v=C.util.object.clone,S=C.util.toFixed;C.Path?C.warn("fabric.Path is already defined"):(C.Path=C.util.createClass(C.Object,{type:"path",path:null,cacheProperties:C.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:C.Object.prototype.stateProperties.concat("path"),initialize:function(A,I){delete(I=v(I||{})).path,this.callSuper("initialize",I),this._setPath(A||[],I)},_setPath:function(A,I){this.path=C.util.makePathSimpler(Array.isArray(A)?A:C.util.parsePath(A)),C.Polyline.prototype._setPositionDimensions.call(this,I||{})},_renderPathCommands:function(A){var I,x=0,L=0,N=0,B=0,W=-this.pathOffset.x,q=-this.pathOffset.y;A.beginPath();for(var ne=0,ie=this.path.length;ne<ie;++ne)switch((I=this.path[ne])[0]){case"L":A.lineTo((N=I[1])+W,(B=I[2])+q);break;case"M":x=N=I[1],L=B=I[2],A.moveTo(N+W,B+q);break;case"C":A.bezierCurveTo(I[1]+W,I[2]+q,I[3]+W,I[4]+q,(N=I[5])+W,(B=I[6])+q);break;case"Q":A.quadraticCurveTo(I[1]+W,I[2]+q,I[3]+W,I[4]+q),N=I[3],B=I[4];break;case"z":case"Z":N=x,B=L,A.closePath()}},_render:function(A){this._renderPathCommands(A),this._renderPaintInOrder(A)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(A){return m(this.callSuper("toObject",A),{path:this.path.map(function(I){return I.slice()})})},toDatalessObject:function(A){var I=this.toObject(["sourcePath"].concat(A));return I.sourcePath&&delete I.path,I},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',C.util.joinPath(this.path),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var A=C.Object.NUM_FRACTION_DIGITS;return" translate("+S(-this.pathOffset.x,A)+", "+S(-this.pathOffset.y,A)+")"},toClipPathSVG:function(A){var I=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:A,additionalTransform:I})},toSVG:function(A){var I=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:A,additionalTransform:I})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var A,I,x=[],L=[],N=0,B=0,G=0,U=0,W=0,q=this.path.length;W<q;++W){switch((A=this.path[W])[0]){case"L":G=A[1],U=A[2],I=[];break;case"M":N=G=A[1],B=U=A[2],I=[];break;case"C":I=C.util.getBoundsOfCurve(G,U,A[1],A[2],A[3],A[4],A[5],A[6]),G=A[5],U=A[6];break;case"Q":I=C.util.getBoundsOfCurve(G,U,A[1],A[2],A[1],A[2],A[3],A[4]),G=A[3],U=A[4];break;case"z":case"Z":G=N,U=B}I.forEach(function(he){x.push(he.x),L.push(he.y)}),x.push(G),L.push(U)}var ne=w(x)||0,ie=w(L)||0;return{left:ne,top:ie,width:(T(x)||0)-ne,height:(T(L)||0)-ie}}}),C.Path.fromObject=function(A,I){"string"==typeof A.sourcePath?C.loadSVGFromURL(A.sourcePath,function(L){var N=L[0];N.setOptions(A),I&&I(N)}):C.Object._fromObject("Path",A,I,"path")},C.Path.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat(["d"]),C.Path.fromElement=function(A,I,x){var L=C.parseAttributes(A,C.Path.ATTRIBUTE_NAMES);L.fromSVG=!0,I(new C.Path(L.d,m(L,x)))})}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.array.min,T=C.util.array.max;C.Group||(C.Group=C.util.createClass(C.Object,C.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(m,v,S){v=v||{},this._objects=[],S&&this.callSuper("initialize",v),this._objects=m||[];for(var A=this._objects.length;A--;)this._objects[A].group=this;if(S)this._updateObjectsACoords();else{var I=v&&v.centerPoint;void 0!==v.originX&&(this.originX=v.originX),void 0!==v.originY&&(this.originY=v.originY),I||this._calcBounds(),this._updateObjectsCoords(I),delete v.centerPoint,this.callSuper("initialize",v)}this.setCoords()},_updateObjectsACoords:function(){for(var m=this._objects.length;m--;)this._objects[m].setCoords(!0)},_updateObjectsCoords:function(m){m=m||this.getCenterPoint();for(var v=this._objects.length;v--;)this._updateObjectCoords(this._objects[v],m)},_updateObjectCoords:function(m,v){m.set({left:m.left-v.x,top:m.top-v.y}),m.group=this,m.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(m){var v=!!this.group;return this._restoreObjectsState(),C.util.resetObjectTransform(this),m&&(v&&C.util.removeTransformFromObject(m,this.group.calcTransformMatrix()),this._objects.push(m),m.group=this,m._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,v?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(m){return this._restoreObjectsState(),C.util.resetObjectTransform(this),this.remove(m),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(m){this.dirty=!0,m.group=this,m._set("canvas",this.canvas)},_onObjectRemoved:function(m){this.dirty=!0,delete m.group},_set:function(m,v){var S=this._objects.length;if(this.useSetOnGroup)for(;S--;)this._objects[S].setOnGroup(m,v);if("canvas"===m)for(;S--;)this._objects[S]._set(m,v);C.Object.prototype._set.call(this,m,v)},toObject:function(m){var v=this.includeDefaultValues,S=this._objects.filter(function(I){return!I.excludeFromExport}).map(function(I){var x=I.includeDefaultValues;I.includeDefaultValues=v;var L=I.toObject(m);return I.includeDefaultValues=x,L}),A=C.Object.prototype.toObject.call(this,m);return A.objects=S,A},toDatalessObject:function(m){var v,S=this.sourcePath;if(S)v=S;else{var A=this.includeDefaultValues;v=this._objects.map(function(x){var L=x.includeDefaultValues;x.includeDefaultValues=A;var N=x.toDatalessObject(m);return x.includeDefaultValues=L,N})}var I=C.Object.prototype.toDatalessObject.call(this,m);return I.objects=v,I},render:function(m){this._transformDone=!0,this.callSuper("render",m),this._transformDone=!1},shouldCache:function(){var m=C.Object.prototype.shouldCache.call(this);if(m)for(var v=0,S=this._objects.length;v<S;v++)if(this._objects[v].willDrawShadow())return this.ownCaching=!1,!1;return m},willDrawShadow:function(){if(C.Object.prototype.willDrawShadow.call(this))return!0;for(var m=0,v=this._objects.length;m<v;m++)if(this._objects[m].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(m){for(var v=0,S=this._objects.length;v<S;v++)this._objects[v].render(m);this._drawClipPath(m,this.clipPath)},isCacheDirty:function(m){if(this.callSuper("isCacheDirty",m))return!0;if(!this.statefullCache)return!1;for(var v=0,S=this._objects.length;v<S;v++)if(this._objects[v].isCacheDirty(!0)){if(this._cacheCanvas){var A=this.cacheWidth/this.zoomX,I=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-A/2,-I/2,A,I)}return!0}return!1},_restoreObjectsState:function(){var m=this.calcOwnMatrix();return this._objects.forEach(function(v){C.util.addTransformToObject(v,m),delete v.group,v.setCoords()}),this},destroy:function(){return this._objects.forEach(function(m){m.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(m){m.dispose&&m.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var m=this._objects,v=this.canvas;this._objects=[];var S=this.toObject();delete S.objects;var A=new C.ActiveSelection([]);return A.set(S),A.type="activeSelection",v.remove(this),m.forEach(function(I){I.group=A,I.dirty=!0,v.add(I)}),A.canvas=v,A._objects=m,v._activeObject=A,A.setCoords(),A}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(m){m.setCoords(!0)}),this},_calcBounds:function(m){for(var v,S,A,I,x=[],L=[],N=["tr","br","bl","tl"],B=0,G=this._objects.length,U=N.length;B<G;++B){for(A=(v=this._objects[B]).calcACoords(),I=0;I<U;I++)x.push(A[S=N[I]].x),L.push(A[S].y);v.aCoords=A}this._getBounds(x,L,m)},_getBounds:function(m,v,S){var A=new C.Point(w(m),w(v)),I=new C.Point(T(m),T(v)),x=A.y||0,L=A.x||0,B=I.y-A.y||0;this.width=I.x-A.x||0,this.height=B,S||this.setPositionByOrigin({x:L,y:x},"left","top")},_toSVG:function(m){for(var v=["<g ","COMMON_PARTS"," >\n"],S=0,A=this._objects.length;S<A;S++)v.push("\t\t",this._objects[S].toSVG(m));return v.push("</g>\n"),v},getSvgStyles:function(){var v=this.visible?"":" visibility: hidden;";return[void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",this.getSvgFilter(),v].join("")},toClipPathSVG:function(m){for(var v=[],S=0,A=this._objects.length;S<A;S++)v.push("\t",this._objects[S].toClipPathSVG(m));return this._createBaseClipPathSVGMarkup(v,{reviver:m})}}),C.Group.fromObject=function(m,v){var S=m.objects,A=C.util.object.clone(m,!0);delete A.objects,"string"!=typeof S?C.util.enlivenObjects(S,function(I){var x=C.util.object.clone(m,!0);delete x.objects,C.util.enlivenObjectEnlivables(m,x,function(){v&&v(new C.Group(I,x,!0))})}):C.loadSVGFromURL(S,function(I){var x=C.util.groupSVGElements(I,m,S);x.set(A),v&&v(x)})})}(a),function(D){var C=D.fabric||(D.fabric={});C.ActiveSelection||(C.ActiveSelection=C.util.createClass(C.Group,{type:"activeSelection",initialize:function(w,T){T=T||{},this._objects=w||[];for(var m=this._objects.length;m--;)this._objects[m].group=this;T.originX&&(this.originX=T.originX),T.originY&&(this.originY=T.originY),this._calcBounds(),this._updateObjectsCoords(),C.Object.prototype.initialize.call(this,T),this.setCoords()},toGroup:function(){var w=this._objects.concat();this._objects=[];var T=C.Object.prototype.toObject.call(this),m=new C.Group([]);if(delete T.type,m.set(T),w.forEach(function(S){S.canvas.remove(S),S.group=m}),m._objects=w,!this.canvas)return m;var v=this.canvas;return v.add(m),v._activeObject=m,m.setCoords(),m},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(w,T,m){w.save(),w.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",w,T),void 0===(m=m||{}).hasControls&&(m.hasControls=!1),m.forActiveSelection=!0;for(var v=0,S=this._objects.length;v<S;v++)this._objects[v]._renderControls(w,m);w.restore()}}),C.ActiveSelection.fromObject=function(w,T){C.util.enlivenObjects(w.objects,function(m){delete w.objects,T&&T(new C.ActiveSelection(m,w,!0))})})}(a),function(D){var C=F.util.object.extend;D.fabric||(D.fabric={}),D.fabric.Image?F.warn("fabric.Image is already defined."):(F.Image=F.util.createClass(F.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:F.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:F.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(w,T){T||(T={}),this.filters=[],this.cacheKey="texture"+F.Object.__uid++,this.callSuper("initialize",T),this._initElement(w,T)},getElement:function(){return this._element||{}},setElement:function(w,T){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=w,this._originalElement=w,this._initConfig(T),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(w){var T=F.filterBackend;T&&T.evictCachesForKey&&T.evictCachesForKey(w)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(w){F.util.cleanUpJsdomNode(this[w]),this[w]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var w=this.getElement();return{width:w.naturalWidth||w.width,height:w.naturalHeight||w.height}},_stroke:function(w){if(this.stroke&&0!==this.strokeWidth){var T=this.width/2,m=this.height/2;w.beginPath(),w.moveTo(-T,-m),w.lineTo(T,-m),w.lineTo(T,m),w.lineTo(-T,m),w.lineTo(-T,-m),w.closePath()}},toObject:function(w){var T=[];this.filters.forEach(function(v){v&&T.push(v.toObject())});var m=C(this.callSuper("toObject",["cropX","cropY"].concat(w)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:T});return this.resizeFilter&&(m.resizeFilter=this.resizeFilter.toObject()),m},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var w,T=[],m=[],v=this._element,S=-this.width/2,A=-this.height/2,I="",x="";if(!v)return[];if(this.hasCrop()){var L=F.Object.__uid++;T.push('<clipPath id="imageCrop_'+L+'">\n','\t<rect x="'+S+'" y="'+A+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),I=' clip-path="url(#imageCrop_'+L+')" '}if(this.imageSmoothing||(x='" image-rendering="optimizeSpeed'),m.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',S-this.cropX,'" y="',A-this.cropY,'" width="',v.width||v.naturalWidth,'" height="',v.height||v.height,x,'"',I,"></image>\n"),this.stroke||this.strokeDashArray){var N=this.fill;this.fill=null,w=["\t<rect ",'x="',S,'" y="',A,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=N}return"fill"!==this.paintFirst?T.concat(w,m):T.concat(m,w)},getSrc:function(w){var T=w?this._element:this._originalElement;return T?T.toDataURL?T.toDataURL():this.srcFromAttribute?T.getAttribute("src"):T.src:this.src||""},setSrc:function(w,T,m){return F.util.loadImage(w,function(v,S){this.setElement(v,m),this._setWidthHeight(),T&&T(this,S)},this,m&&m.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var w=this.resizeFilter,T=this.minimumScaleTrigger,m=this.getTotalObjectScaling(),v=m.scaleX,S=m.scaleY,A=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!w||v>T&&S>T)return this._element=A,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=v,void(this._lastScaleY=S);F.filterBackend||(F.filterBackend=F.initFilterBackend());var I=F.util.createCanvasElement(),x=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,L=A.width,N=A.height;I.width=L,I.height=N,this._element=I,this._lastScaleX=w.scaleX=v,this._lastScaleY=w.scaleY=S,F.filterBackend.applyFilters([w],A,L,N,this._element,x),this._filterScalingX=I.width/this._originalElement.width,this._filterScalingY=I.height/this._originalElement.height},applyFilters:function(w){if(w=(w=w||this.filters||[]).filter(function(A){return A&&!A.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===w.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var T=this._originalElement,m=T.naturalWidth||T.width,v=T.naturalHeight||T.height;if(this._element===this._originalElement){var S=F.util.createCanvasElement();S.width=m,S.height=v,this._element=S,this._filteredEl=S}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,m,v),this._lastScaleX=1,this._lastScaleY=1;return F.filterBackend||(F.filterBackend=F.initFilterBackend()),F.filterBackend.applyFilters(w,this._originalElement,m,v,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(w){F.util.setImageSmoothing(w,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(w),this._renderPaintInOrder(w)},drawCacheOnCanvas:function(w){F.util.setImageSmoothing(w,this.imageSmoothing),F.Object.prototype.drawCacheOnCanvas.call(this,w)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(w){var T=this._element;if(T){var m=this._filterScalingX,v=this._filterScalingY,S=this.width,A=this.height,I=Math.min,x=Math.max,L=x(this.cropX,0),N=x(this.cropY,0),B=T.naturalWidth||T.width,G=T.naturalHeight||T.height,U=L*m,W=N*v,q=I(S*m,B-U),ne=I(A*v,G-W),ie=-S/2,he=-A/2,le=I(S,B/m-L),oe=I(A,G/v-N);T&&w.drawImage(T,U,W,q,ne,ie,he,le,oe)}},_needsResize:function(){var w=this.getTotalObjectScaling();return w.scaleX!==this._lastScaleX||w.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(w,T){this.setElement(F.util.getById(w),T),F.util.addClass(this.getElement(),F.Image.CSS_CANVAS)},_initConfig:function(w){w||(w={}),this.setOptions(w),this._setWidthHeight(w)},_initFilters:function(w,T){w&&w.length?F.util.enlivenObjects(w,function(m){T&&T(m)},"fabric.Image.filters"):T&&T()},_setWidthHeight:function(w){w||(w={});var T=this.getElement();this.width=w.width||T.naturalWidth||T.width||0,this.height=w.height||T.naturalHeight||T.height||0},parsePreserveAspectRatioAttribute:function(){var w,T=F.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),m=this._element.width,v=this._element.height,S=1,A=1,I=0,x=0,L=0,N=0,B=this.width,G=this.height,U={width:B,height:G};return!T||"none"===T.alignX&&"none"===T.alignY?(S=B/m,A=G/v):("meet"===T.meetOrSlice&&(w=(B-m*(S=A=F.util.findScaleToFit(this._element,U)))/2,"Min"===T.alignX&&(I=-w),"Max"===T.alignX&&(I=w),w=(G-v*A)/2,"Min"===T.alignY&&(x=-w),"Max"===T.alignY&&(x=w)),"slice"===T.meetOrSlice&&(w=m-B/(S=A=F.util.findScaleToCover(this._element,U)),"Mid"===T.alignX&&(L=w/2),"Max"===T.alignX&&(L=w),w=v-G/A,"Mid"===T.alignY&&(N=w/2),"Max"===T.alignY&&(N=w),m=B/S,v=G/A)),{width:m,height:v,scaleX:S,scaleY:A,offsetLeft:I,offsetTop:x,cropX:L,cropY:N}}}),F.Image.CSS_CANVAS="canvas-img",F.Image.prototype.getSvgSrc=F.Image.prototype.getSrc,F.Image.fromObject=function(w,T){var m=F.util.object.clone(w);F.util.loadImage(m.src,function(v,S){S?T&&T(null,!0):F.Image.prototype._initFilters.call(m,m.filters,function(A){m.filters=A||[],F.Image.prototype._initFilters.call(m,[m.resizeFilter],function(I){m.resizeFilter=I[0],F.util.enlivenObjectEnlivables(m,m,function(){var x=new F.Image(v,m);T(x,!1)})})})},null,m.crossOrigin)},F.Image.fromURL=function(w,T,m){F.util.loadImage(w,function(v,S){T&&T(new F.Image(v,m),S)},null,m&&m.crossOrigin)},F.Image.ATTRIBUTE_NAMES=F.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),F.Image.fromElement=function(w,T,m){var v=F.parseAttributes(w,F.Image.ATTRIBUTE_NAMES);F.Image.fromURL(v["xlink:href"],T,C(m?F.util.object.clone(m):{},v))})}(a),F.util.object.extend(F.Object.prototype,{_getAngleValueForStraighten:function(){var D=this.angle%360;return D>0?90*Math.round((D-1)/90):90*Math.round(D/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(D){var C=function(){},w=(D=D||{}).onComplete||C,T=D.onChange||C,m=this;return F.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(v){m.rotate(v),T()},onComplete:function(){m.setCoords(),w()}})}}),F.util.object.extend(F.StaticCanvas.prototype,{straightenObject:function(D){return D.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(D){return D.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function D(w,T){var m="precision "+T+" float;\nvoid main(){}",v=w.createShader(w.FRAGMENT_SHADER);return w.shaderSource(v,m),w.compileShader(v),!!w.getShaderParameter(v,w.COMPILE_STATUS)}function C(w){w&&w.tileSize&&(this.tileSize=w.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}F.isWebglSupported=function(w){if(F.isLikelyNode)return!1;w=w||F.WebglFilterBackend.prototype.tileSize;var T=document.createElement("canvas"),m=T.getContext("webgl")||T.getContext("experimental-webgl"),v=!1;if(m){F.maxTextureSize=m.getParameter(m.MAX_TEXTURE_SIZE),v=F.maxTextureSize>=w;for(var S=["highp","mediump","lowp"],A=0;A<3;A++)if(D(m,S[A])){F.webGlPrecision=S[A];break}}return this.isSupported=v,v},F.WebglFilterBackend=C,C.prototype={tileSize:2048,resources:{},setupGLContext:function(w,T){this.dispose(),this.createWebGLCanvas(w,T),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(w,T)},chooseFastestCopyGLTo2DMethod:function(w,T){var m,v=void 0!==window.performance;try{new ImageData(1,1),m=!0}catch(G){m=!1}var S="undefined"!=typeof ArrayBuffer,A="undefined"!=typeof Uint8ClampedArray;if(v&&m&&S&&A){var I=F.util.createCanvasElement(),x=new ArrayBuffer(w*T*4);if(F.forceGLPutImageData)return this.imageBuffer=x,void(this.copyGLTo2D=Qe);var L,N,B={imageBuffer:x,destinationWidth:w,destinationHeight:T,targetCanvas:I};I.width=w,I.height=T,L=window.performance.now(),ke.call(B,this.gl,B),N=window.performance.now()-L,L=window.performance.now(),Qe.call(B,this.gl,B),N>window.performance.now()-L?(this.imageBuffer=x,this.copyGLTo2D=Qe):this.copyGLTo2D=ke}},createWebGLCanvas:function(w,T){var m=F.util.createCanvasElement();m.width=w,m.height=T;var v={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},S=m.getContext("webgl",v);S||(S=m.getContext("experimental-webgl",v)),S&&(S.clearColor(0,0,0,0),this.canvas=m,this.gl=S)},applyFilters:function(w,T,m,v,S,A){var I,x=this.gl;A&&(I=this.getCachedTexture(A,T));var B,G,q,ne,L={originalWidth:T.width||T.originalWidth,originalHeight:T.height||T.originalHeight,sourceWidth:m,sourceHeight:v,destinationWidth:m,destinationHeight:v,context:x,sourceTexture:this.createTexture(x,m,v,!I&&T),targetTexture:this.createTexture(x,m,v),originalTexture:I||this.createTexture(x,m,v,!I&&T),passes:w.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:S},N=x.createFramebuffer();return x.bindFramebuffer(x.FRAMEBUFFER,N),w.forEach(function(B){B&&B.applyTo(L)}),ne=(B=L).destinationHeight,(G=B.targetCanvas).width===(q=B.destinationWidth)&&G.height===ne||(G.width=q,G.height=ne),this.copyGLTo2D(x,L),x.bindTexture(x.TEXTURE_2D,null),x.deleteTexture(L.sourceTexture),x.deleteTexture(L.targetTexture),x.deleteFramebuffer(N),S.getContext("2d").setTransform(1,0,0,1,0,0),L},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(w,T,m,v){var S=w.createTexture();return w.bindTexture(w.TEXTURE_2D,S),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),v?w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,v):w.texImage2D(w.TEXTURE_2D,0,w.RGBA,T,m,0,w.RGBA,w.UNSIGNED_BYTE,null),S},getCachedTexture:function(w,T){if(this.textureCache[w])return this.textureCache[w];var m=this.createTexture(this.gl,T.width,T.height,T);return this.textureCache[w]=m,m},evictCachesForKey:function(w){this.textureCache[w]&&(this.gl.deleteTexture(this.textureCache[w]),delete this.textureCache[w])},copyGLTo2D:ke,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var w=this.gl,T={renderer:"",vendor:""};if(!w)return T;var m=w.getExtension("WEBGL_debug_renderer_info");if(m){var v=w.getParameter(m.UNMASKED_RENDERER_WEBGL),S=w.getParameter(m.UNMASKED_VENDOR_WEBGL);v&&(T.renderer=v.toLowerCase()),S&&(T.vendor=S.toLowerCase())}return this.gpuInfo=T,T}}}(),function(){var D=function(){};function C(){}F.Canvas2dFilterBackend=C,C.prototype={evictCachesForKey:D,dispose:D,clearWebGLCaches:D,resources:{},applyFilters:function(w,T,m,v,S){var A=S.getContext("2d");A.drawImage(T,0,0,m,v);var I={sourceWidth:m,sourceHeight:v,imageData:A.getImageData(0,0,m,v),originalEl:T,originalImageData:A.getImageData(0,0,m,v),canvasEl:S,ctx:A,filterBackend:this};return w.forEach(function(x){x.applyTo(I)}),I.imageData.width===m&&I.imageData.height===v||(S.width=I.imageData.width,S.height=I.imageData.height),A.putImageData(I.imageData,0,0),I}}}(),F.Image=F.Image||{},F.Image.filters=F.Image.filters||{},F.Image.filters.BaseFilter=F.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(D){D&&this.setOptions(D)},setOptions:function(D){for(var C in D)this[C]=D[C]},createProgram:function(D,C,w){C=C||this.fragmentSource,w=w||this.vertexSource,"highp"!==F.webGlPrecision&&(C=C.replace(/precision highp float/g,"precision "+F.webGlPrecision+" float"));var T=D.createShader(D.VERTEX_SHADER);if(D.shaderSource(T,w),D.compileShader(T),!D.getShaderParameter(T,D.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+D.getShaderInfoLog(T));var m=D.createShader(D.FRAGMENT_SHADER);if(D.shaderSource(m,C),D.compileShader(m),!D.getShaderParameter(m,D.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+D.getShaderInfoLog(m));var v=D.createProgram();if(D.attachShader(v,T),D.attachShader(v,m),D.linkProgram(v),!D.getProgramParameter(v,D.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+D.getProgramInfoLog(v));var S=this.getAttributeLocations(D,v),A=this.getUniformLocations(D,v)||{};return A.uStepW=D.getUniformLocation(v,"uStepW"),A.uStepH=D.getUniformLocation(v,"uStepH"),{program:v,attributeLocations:S,uniformLocations:A}},getAttributeLocations:function(D,C){return{aPosition:D.getAttribLocation(C,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(D,C,w){var T=C.aPosition,m=D.createBuffer();D.bindBuffer(D.ARRAY_BUFFER,m),D.enableVertexAttribArray(T),D.vertexAttribPointer(T,2,D.FLOAT,!1,0,0),D.bufferData(D.ARRAY_BUFFER,w,D.STATIC_DRAW)},_setupFrameBuffer:function(D){var C,w,T=D.context;D.passes>1?(w=D.destinationHeight,D.sourceWidth===(C=D.destinationWidth)&&D.sourceHeight===w||(T.deleteTexture(D.targetTexture),D.targetTexture=D.filterBackend.createTexture(T,C,w)),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,D.targetTexture,0)):(T.bindFramebuffer(T.FRAMEBUFFER,null),T.finish())},_swapTextures:function(D){D.passes--,D.pass++;var C=D.targetTexture;D.targetTexture=D.sourceTexture,D.sourceTexture=C},isNeutralState:function(){var D=this.mainParameter,C=F.Image.filters[this.type].prototype;if(D){if(Array.isArray(C[D])){for(var w=C[D].length;w--;)if(this[D][w]!==C[D][w])return!1;return!0}return C[D]===this[D]}return!1},applyTo:function(D){D.webgl?(this._setupFrameBuffer(D),this.applyToWebGL(D),this._swapTextures(D)):this.applyTo2d(D)},retrieveShader:function(D){return D.programCache.hasOwnProperty(this.type)||(D.programCache[this.type]=this.createProgram(D.context)),D.programCache[this.type]},applyToWebGL:function(D){var C=D.context,w=this.retrieveShader(D);C.bindTexture(C.TEXTURE_2D,0===D.pass&&D.originalTexture?D.originalTexture:D.sourceTexture),C.useProgram(w.program),this.sendAttributeData(C,w.attributeLocations,D.aPosition),C.uniform1f(w.uniformLocations.uStepW,1/D.sourceWidth),C.uniform1f(w.uniformLocations.uStepH,1/D.sourceHeight),this.sendUniformData(C,w.uniformLocations),C.viewport(0,0,D.destinationWidth,D.destinationHeight),C.drawArrays(C.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(D,C,w){D.activeTexture(w),D.bindTexture(D.TEXTURE_2D,C),D.activeTexture(D.TEXTURE0)},unbindAdditionalTexture:function(D,C){D.activeTexture(C),D.bindTexture(D.TEXTURE_2D,null),D.activeTexture(D.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(D){this[this.mainParameter]=D},sendUniformData:function(){},createHelpLayer:function(D){if(!D.helpLayer){var C=document.createElement("canvas");C.width=D.sourceWidth,C.height=D.sourceHeight,D.helpLayer=C}},toObject:function(){var D={type:this.type},C=this.mainParameter;return C&&(D[C]=this[C]),D},toJSON:function(){return this.toObject()}}),F.Image.filters.BaseFilter.fromObject=function(D,C){var w=new F.Image.filters[D.type](D);return C&&C(w),w},function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.ColorMatrix=(0,C.util.createClass)(w.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(m){this.callSuper("initialize",m),this.matrix=this.matrix.slice(0)},applyTo2d:function(m){var v,S,A,I,x,L=m.imageData.data,N=L.length,B=this.matrix,G=this.colorsOnly;for(x=0;x<N;x+=4)v=L[x],S=L[x+1],A=L[x+2],G?(L[x]=v*B[0]+S*B[1]+A*B[2]+255*B[4],L[x+1]=v*B[5]+S*B[6]+A*B[7]+255*B[9],L[x+2]=v*B[10]+S*B[11]+A*B[12]+255*B[14]):(L[x]=v*B[0]+S*B[1]+A*B[2]+(I=L[x+3])*B[3]+255*B[4],L[x+1]=v*B[5]+S*B[6]+A*B[7]+I*B[8]+255*B[9],L[x+2]=v*B[10]+S*B[11]+A*B[12]+I*B[13]+255*B[14],L[x+3]=v*B[15]+S*B[16]+A*B[17]+I*B[18]+255*B[19])},getUniformLocations:function(m,v){return{uColorMatrix:m.getUniformLocation(v,"uColorMatrix"),uConstants:m.getUniformLocation(v,"uConstants")}},sendUniformData:function(m,v){var S=this.matrix,I=[S[4],S[9],S[14],S[19]];m.uniformMatrix4fv(v.uColorMatrix,!1,[S[0],S[1],S[2],S[3],S[5],S[6],S[7],S[8],S[10],S[11],S[12],S[13],S[15],S[16],S[17],S[18]]),m.uniform4fv(v.uConstants,I)}}),C.Image.filters.ColorMatrix.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Brightness=(0,C.util.createClass)(w.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(m){if(0!==this.brightness){var v,S=m.imageData.data,A=S.length,I=Math.round(255*this.brightness);for(v=0;v<A;v+=4)S[v]=S[v]+I,S[v+1]=S[v+1]+I,S[v+2]=S[v+2]+I}},getUniformLocations:function(m,v){return{uBrightness:m.getUniformLocation(v,"uBrightness")}},sendUniformData:function(m,v){m.uniform1f(v.uBrightness,this.brightness)}}),C.Image.filters.Brightness.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.extend,T=C.Image.filters;T.Convolute=(0,C.util.createClass)(T.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(v){var S=Math.sqrt(this.matrix.length),A=this.type+"_"+S+"_"+(this.opaque?1:0),I=this.fragmentSource[A];return v.programCache.hasOwnProperty(A)||(v.programCache[A]=this.createProgram(v.context,I)),v.programCache[A]},applyTo2d:function(v){var S,A,I,x,L,N,B,G,U,W,q,ne,ie,he=v.imageData,le=he.data,oe=this.matrix,J=Math.round(Math.sqrt(oe.length)),Q=Math.floor(J/2),re=he.width,ue=he.height,de=v.ctx.createImageData(re,ue),te=de.data,ee=this.opaque?1:0;for(q=0;q<ue;q++)for(W=0;W<re;W++){for(L=4*(q*re+W),S=0,A=0,I=0,x=0,ie=0;ie<J;ie++)for(ne=0;ne<J;ne++)N=W+ne-Q,(B=q+ie-Q)<0||B>=ue||N<0||N>=re||(S+=le[G=4*(B*re+N)]*(U=oe[ie*J+ne]),A+=le[G+1]*U,I+=le[G+2]*U,ee||(x+=le[G+3]*U));te[L]=S,te[L+1]=A,te[L+2]=I,te[L+3]=ee?le[L+3]:x}v.imageData=de},getUniformLocations:function(v,S){return{uMatrix:v.getUniformLocation(S,"uMatrix"),uOpaque:v.getUniformLocation(S,"uOpaque"),uHalfSize:v.getUniformLocation(S,"uHalfSize"),uSize:v.getUniformLocation(S,"uSize")}},sendUniformData:function(v,S){v.uniform1fv(S.uMatrix,this.matrix)},toObject:function(){return w(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),C.Image.filters.Convolute.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Grayscale=(0,C.util.createClass)(w.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(m){var v,S,A=m.imageData.data,I=A.length,x=this.mode;for(v=0;v<I;v+=4)"average"===x?S=(A[v]+A[v+1]+A[v+2])/3:"lightness"===x?S=(Math.min(A[v],A[v+1],A[v+2])+Math.max(A[v],A[v+1],A[v+2]))/2:"luminosity"===x&&(S=.21*A[v]+.72*A[v+1]+.07*A[v+2]),A[v]=S,A[v+1]=S,A[v+2]=S},retrieveShader:function(m){var v=this.type+"_"+this.mode;return m.programCache.hasOwnProperty(v)||(m.programCache[v]=this.createProgram(m.context,this.fragmentSource[this.mode])),m.programCache[v]},getUniformLocations:function(m,v){return{uMode:m.getUniformLocation(v,"uMode")}},sendUniformData:function(m,v){m.uniform1i(v.uMode,1)},isNeutralState:function(){return!1}}),C.Image.filters.Grayscale.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Invert=(0,C.util.createClass)(w.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(m){var v,S=m.imageData.data,A=S.length;for(v=0;v<A;v+=4)S[v]=255-S[v],S[v+1]=255-S[v+1],S[v+2]=255-S[v+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(m,v){return{uInvert:m.getUniformLocation(v,"uInvert")}},sendUniformData:function(m,v){m.uniform1i(v.uInvert,this.invert)}}),C.Image.filters.Invert.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.extend,T=C.Image.filters;T.Noise=(0,C.util.createClass)(T.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(v){if(0!==this.noise){var S,A,x,I=v.imageData.data,L=this.noise;for(S=0,x=I.length;S<x;S+=4)A=(.5-Math.random())*L,I[S]+=A,I[S+1]+=A,I[S+2]+=A}},getUniformLocations:function(v,S){return{uNoise:v.getUniformLocation(S,"uNoise"),uSeed:v.getUniformLocation(S,"uSeed")}},sendUniformData:function(v,S){v.uniform1f(S.uNoise,this.noise/255),v.uniform1f(S.uSeed,Math.random())},toObject:function(){return w(this.callSuper("toObject"),{noise:this.noise})}}),C.Image.filters.Noise.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Pixelate=(0,C.util.createClass)(w.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(m){var v,S,A,I,x,L,N,B,G,U,W,q=m.imageData,ne=q.data,ie=q.height,he=q.width;for(S=0;S<ie;S+=this.blocksize)for(A=0;A<he;A+=this.blocksize)for(I=ne[v=4*S*he+4*A],x=ne[v+1],L=ne[v+2],N=ne[v+3],U=Math.min(S+this.blocksize,ie),W=Math.min(A+this.blocksize,he),B=S;B<U;B++)for(G=A;G<W;G++)ne[v=4*B*he+4*G]=I,ne[v+1]=x,ne[v+2]=L,ne[v+3]=N},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(m,v){return{uBlocksize:m.getUniformLocation(v,"uBlocksize"),uStepW:m.getUniformLocation(v,"uStepW"),uStepH:m.getUniformLocation(v,"uStepH")}},sendUniformData:function(m,v){m.uniform1f(v.uBlocksize,this.blocksize)}}),C.Image.filters.Pixelate.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.extend,T=C.Image.filters;T.RemoveColor=(0,C.util.createClass)(T.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(v){var S,A,I,x,L=v.imageData.data,N=255*this.distance,B=new C.Color(this.color).getSource(),G=[B[0]-N,B[1]-N,B[2]-N],U=[B[0]+N,B[1]+N,B[2]+N];for(S=0;S<L.length;S+=4)I=L[S+1],x=L[S+2],(A=L[S])>G[0]&&I>G[1]&&x>G[2]&&A<U[0]&&I<U[1]&&x<U[2]&&(L[S+3]=0)},getUniformLocations:function(v,S){return{uLow:v.getUniformLocation(S,"uLow"),uHigh:v.getUniformLocation(S,"uHigh")}},sendUniformData:function(v,S){var A=new C.Color(this.color).getSource(),I=parseFloat(this.distance),L=[A[0]/255+I,A[1]/255+I,A[2]/255+I,1];v.uniform4fv(S.uLow,[0+A[0]/255-I,0+A[1]/255-I,0+A[2]/255-I,1]),v.uniform4fv(S.uHigh,L)},toObject:function(){return w(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),C.Image.filters.RemoveColor.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters,T=C.util.createClass,m={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var v in m)w[v]=T(w.ColorMatrix,{type:v,matrix:m[v],mainParameter:!1,colorsOnly:!0}),C.Image.filters[v].fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric,w=C.Image.filters;w.BlendColor=(0,C.util.createClass)(w.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(m){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[m]+"}\n}"},retrieveShader:function(m){var v,S=this.type+"_"+this.mode;return m.programCache.hasOwnProperty(S)||(v=this.buildSource(this.mode),m.programCache[S]=this.createProgram(m.context,v)),m.programCache[S]},applyTo2d:function(m){var v,S,A,I,x,L,N,B=m.imageData.data,G=B.length,U=1-this.alpha;v=(N=new C.Color(this.color).getSource())[0]*this.alpha,S=N[1]*this.alpha,A=N[2]*this.alpha;for(var W=0;W<G;W+=4)switch(I=B[W],x=B[W+1],L=B[W+2],this.mode){case"multiply":B[W]=I*v/255,B[W+1]=x*S/255,B[W+2]=L*A/255;break;case"screen":B[W]=255-(255-I)*(255-v)/255,B[W+1]=255-(255-x)*(255-S)/255,B[W+2]=255-(255-L)*(255-A)/255;break;case"add":B[W]=I+v,B[W+1]=x+S,B[W+2]=L+A;break;case"diff":case"difference":B[W]=Math.abs(I-v),B[W+1]=Math.abs(x-S),B[W+2]=Math.abs(L-A);break;case"subtract":B[W]=I-v,B[W+1]=x-S,B[W+2]=L-A;break;case"darken":B[W]=Math.min(I,v),B[W+1]=Math.min(x,S),B[W+2]=Math.min(L,A);break;case"lighten":B[W]=Math.max(I,v),B[W+1]=Math.max(x,S),B[W+2]=Math.max(L,A);break;case"overlay":B[W]=v<128?2*I*v/255:255-2*(255-I)*(255-v)/255,B[W+1]=S<128?2*x*S/255:255-2*(255-x)*(255-S)/255,B[W+2]=A<128?2*L*A/255:255-2*(255-L)*(255-A)/255;break;case"exclusion":B[W]=v+I-2*v*I/255,B[W+1]=S+x-2*S*x/255,B[W+2]=A+L-2*A*L/255;break;case"tint":B[W]=v+I*U,B[W+1]=S+x*U,B[W+2]=A+L*U}},getUniformLocations:function(m,v){return{uColor:m.getUniformLocation(v,"uColor")}},sendUniformData:function(m,v){var S=new C.Color(this.color).getSource();S[0]=this.alpha*S[0]/255,S[1]=this.alpha*S[1]/255,S[2]=this.alpha*S[2]/255,S[3]=this.alpha,m.uniform4fv(v.uColor,S)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),C.Image.filters.BlendColor.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric,w=C.Image.filters;w.BlendImage=(0,C.util.createClass)(w.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(m){var v=this.type+"_"+this.mode,S=this.fragmentSource[this.mode];return m.programCache.hasOwnProperty(v)||(m.programCache[v]=this.createProgram(m.context,S)),m.programCache[v]},applyToWebGL:function(m){var v=m.context,S=this.createTexture(m.filterBackend,this.image);this.bindAdditionalTexture(v,S,v.TEXTURE1),this.callSuper("applyToWebGL",m),this.unbindAdditionalTexture(v,v.TEXTURE1)},createTexture:function(m,v){return m.getCachedTexture(v.cacheKey,v._element)},calculateMatrix:function(){var m=this.image;return[1/m.scaleX,0,0,0,1/m.scaleY,0,-m.left/m._element.width,-m.top/m._element.height,1]},applyTo2d:function(m){var v,S,A,I,x,L,N,B,G,U,W,q=m.imageData,ne=m.filterBackend.resources,ie=q.data,he=ie.length,le=q.width,oe=q.height,J=this.image;ne.blendImage||(ne.blendImage=C.util.createCanvasElement()),U=(G=ne.blendImage).getContext("2d"),G.width!==le||G.height!==oe?(G.width=le,G.height=oe):U.clearRect(0,0,le,oe),U.setTransform(J.scaleX,0,0,J.scaleY,J.left,J.top),U.drawImage(J._element,0,0,le,oe),W=U.getImageData(0,0,le,oe).data;for(var Q=0;Q<he;Q+=4)switch(x=ie[Q],L=ie[Q+1],N=ie[Q+2],B=ie[Q+3],v=W[Q],S=W[Q+1],A=W[Q+2],I=W[Q+3],this.mode){case"multiply":ie[Q]=x*v/255,ie[Q+1]=L*S/255,ie[Q+2]=N*A/255,ie[Q+3]=B*I/255;break;case"mask":ie[Q+3]=I}},getUniformLocations:function(m,v){return{uTransformMatrix:m.getUniformLocation(v,"uTransformMatrix"),uImage:m.getUniformLocation(v,"uImage")}},sendUniformData:function(m,v){var S=this.calculateMatrix();m.uniform1i(v.uImage,1),m.uniformMatrix3fv(v.uTransformMatrix,!1,S)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),C.Image.filters.BlendImage.fromObject=function(m,v){C.Image.fromObject(m.image,function(S){var A=C.util.object.clone(m);A.image=S,v(new C.Image.filters.BlendImage(A))})}}(a),function(D){var C=D.fabric||(D.fabric={}),w=Math.pow,T=Math.floor,m=Math.sqrt,v=Math.abs,S=Math.round,A=Math.sin,I=Math.ceil,x=C.Image.filters;x.Resize=(0,C.util.createClass)(x.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(N,B){return{uDelta:N.getUniformLocation(B,"uDelta"),uTaps:N.getUniformLocation(B,"uTaps")}},sendUniformData:function(N,B){N.uniform2fv(B.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),N.uniform1fv(B.uTaps,this.taps)},retrieveShader:function(N){var B=this.getFilterWindow(),G=this.type+"_"+B;if(!N.programCache.hasOwnProperty(G)){var U=this.generateShader(B);N.programCache[G]=this.createProgram(N.context,U)}return N.programCache[G]},getFilterWindow:function(){return Math.ceil(this.lanczosLobes/this.tempScale)},getTaps:function(){for(var N=this.lanczosCreate(this.lanczosLobes),B=this.tempScale,G=this.getFilterWindow(),U=new Array(G),W=1;W<=G;W++)U[W-1]=N(W*B);return U},generateShader:function(N){for(var B=new Array(N),G=this.fragmentSourceTOP,U=1;U<=N;U++)B[U-1]=U+".0 * uDelta";return G+="uniform float uTaps["+N+"];\n",G+="void main() {\n",G+="  vec4 color = texture2D(uTexture, vTexCoord);\n",G+="  float sum = 1.0;\n",B.forEach(function(W,q){G+="  color += texture2D(uTexture, vTexCoord + "+W+") * uTaps["+q+"];\n",G+="  color += texture2D(uTexture, vTexCoord - "+W+") * uTaps["+q+"];\n",G+="  sum += 2.0 * uTaps["+q+"];\n"}),G+="  gl_FragColor = color / sum;\n",G+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(N){N.webgl?(N.passes++,this.width=N.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=N.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),N.destinationWidth=this.dW,this._setupFrameBuffer(N),this.applyToWebGL(N),this._swapTextures(N),N.sourceWidth=N.destinationWidth,this.height=N.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),N.destinationHeight=this.dH,this._setupFrameBuffer(N),this.applyToWebGL(N),this._swapTextures(N),N.sourceHeight=N.destinationHeight):this.applyTo2d(N)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(N){return function(B){if(B>=N||B<=-N)return 0;if(B<1.1920929e-7&&B>-1.1920929e-7)return 1;var G=(B*=Math.PI)/N;return A(B)/B*A(G)/G}},applyTo2d:function(N){var B=N.imageData,G=this.scaleX,U=this.scaleY;this.rcpScaleX=1/G,this.rcpScaleY=1/U;var W,q=B.width,ne=B.height,ie=S(q*G),he=S(ne*U);"sliceHack"===this.resizeType?W=this.sliceByTwo(N,q,ne,ie,he):"hermite"===this.resizeType?W=this.hermiteFastResize(N,q,ne,ie,he):"bilinear"===this.resizeType?W=this.bilinearFiltering(N,q,ne,ie,he):"lanczos"===this.resizeType&&(W=this.lanczosResize(N,q,ne,ie,he)),N.imageData=W},sliceByTwo:function(N,B,G,U,W){var q,ne,ie=N.imageData,le=!1,oe=!1,J=.5*B,Q=.5*G,re=C.filterBackend.resources,ue=0,de=0,te=B,ee=0;for(re.sliceByTwo||(re.sliceByTwo=document.createElement("canvas")),((q=re.sliceByTwo).width<1.5*B||q.height<G)&&(q.width=1.5*B,q.height=G),(ne=q.getContext("2d")).clearRect(0,0,1.5*B,G),ne.putImageData(ie,0,0),U=T(U),W=T(W);!le||!oe;)B=J,G=Q,U<T(.5*J)?J=T(.5*J):(J=U,le=!0),W<T(.5*Q)?Q=T(.5*Q):(Q=W,oe=!0),ne.drawImage(q,ue,de,B,G,te,ee,J,Q),ue=te,de=ee,ee+=Q;return ne.getImageData(ue,de,U,W)},lanczosResize:function(N,B,G,U,W){var q=N.imageData.data,ne=N.ctx.createImageData(U,W),ie=ne.data,he=this.lanczosCreate(this.lanczosLobes),le=this.rcpScaleX,oe=this.rcpScaleY,J=2/this.rcpScaleX,Q=2/this.rcpScaleY,re=I(le*this.lanczosLobes/2),ue=I(oe*this.lanczosLobes/2),de={},te={},ee={};return function se(fe){var ce,pe,Se,we,ye,De,be,Ie,Be,Oe,st;for(te.x=(fe+.5)*le,ee.x=T(te.x),ce=0;ce<W;ce++){for(te.y=(ce+.5)*oe,ee.y=T(te.y),ye=0,De=0,be=0,Ie=0,Be=0,pe=ee.x-re;pe<=ee.x+re;pe++)if(!(pe<0||pe>=B)){Oe=T(1e3*v(pe-te.x)),de[Oe]||(de[Oe]={});for(var bt=ee.y-ue;bt<=ee.y+ue;bt++)bt<0||bt>=G||(st=T(1e3*v(bt-te.y)),de[Oe][st]||(de[Oe][st]=he(m(w(Oe*J,2)+w(st*Q,2))/1e3)),(Se=de[Oe][st])>0&&(ye+=Se,De+=Se*q[we=4*(bt*B+pe)],be+=Se*q[we+1],Ie+=Se*q[we+2],Be+=Se*q[we+3]))}ie[we=4*(ce*U+fe)]=De/ye,ie[we+1]=be/ye,ie[we+2]=Ie/ye,ie[we+3]=Be/ye}return++fe<U?se(fe):ne}(0)},bilinearFiltering:function(N,B,G,U,W){var q,ne,ie,he,le,oe,J,re,ue=0,de=this.rcpScaleX,te=this.rcpScaleY,ee=4*(B-1),se=N.imageData.data,fe=N.ctx.createImageData(U,W),ce=fe.data;for(ie=0;ie<W;ie++)for(he=0;he<U;he++)for(le=de*he-(q=T(de*he)),oe=te*ie-(ne=T(te*ie)),re=4*(ne*B+q),J=0;J<4;J++)ce[ue++]=se[re+J]*(1-le)*(1-oe)+se[re+4+J]*le*(1-oe)+se[re+ee+J]*oe*(1-le)+se[re+ee+4+J]*le*oe;return fe},hermiteFastResize:function(N,B,G,U,W){for(var q=this.rcpScaleX,ne=this.rcpScaleY,ie=I(q/2),he=I(ne/2),le=N.imageData.data,oe=N.ctx.createImageData(U,W),J=oe.data,Q=0;Q<W;Q++)for(var re=0;re<U;re++){for(var ue=4*(re+Q*U),de=0,te=0,ee=0,se=0,fe=0,ce=0,pe=0,Se=(Q+.5)*ne,we=T(Q*ne);we<(Q+1)*ne;we++)for(var ye=v(Se-(we+.5))/he,De=(re+.5)*q,be=ye*ye,Ie=T(re*q);Ie<(re+1)*q;Ie++){var Be=v(De-(Ie+.5))/ie,Oe=m(be+Be*Be);Oe>1&&Oe<-1||(de=2*Oe*Oe*Oe-3*Oe*Oe+1)>0&&(pe+=de*le[3+(Be=4*(Ie+we*B))],ee+=de,le[Be+3]<255&&(de=de*le[Be+3]/250),se+=de*le[Be],fe+=de*le[Be+1],ce+=de*le[Be+2],te+=de)}J[ue]=se/te,J[ue+1]=fe/te,J[ue+2]=ce/te,J[ue+3]=pe/ee}return oe},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),C.Image.filters.Resize.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Contrast=(0,C.util.createClass)(w.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(m){if(0!==this.contrast){var v,S=m.imageData.data,A=S.length,I=Math.floor(255*this.contrast),x=259*(I+255)/(255*(259-I));for(v=0;v<A;v+=4)S[v]=x*(S[v]-128)+128,S[v+1]=x*(S[v+1]-128)+128,S[v+2]=x*(S[v+2]-128)+128}},getUniformLocations:function(m,v){return{uContrast:m.getUniformLocation(v,"uContrast")}},sendUniformData:function(m,v){m.uniform1f(v.uContrast,this.contrast)}}),C.Image.filters.Contrast.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Saturation=(0,C.util.createClass)(w.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(m){if(0!==this.saturation){var v,S,A=m.imageData.data,I=A.length,x=-this.saturation;for(v=0;v<I;v+=4)S=Math.max(A[v],A[v+1],A[v+2]),A[v]+=S!==A[v]?(S-A[v])*x:0,A[v+1]+=S!==A[v+1]?(S-A[v+1])*x:0,A[v+2]+=S!==A[v+2]?(S-A[v+2])*x:0}},getUniformLocations:function(m,v){return{uSaturation:m.getUniformLocation(v,"uSaturation")}},sendUniformData:function(m,v){m.uniform1f(v.uSaturation,-this.saturation)}}),C.Image.filters.Saturation.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Vibrance=(0,C.util.createClass)(w.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(m){if(0!==this.vibrance){var v,S,I,x=m.imageData.data,L=x.length,N=-this.vibrance;for(v=0;v<L;v+=4)S=Math.max(x[v],x[v+1],x[v+2]),I=2*Math.abs(S-(x[v]+x[v+1]+x[v+2])/3)/255*N,x[v]+=S!==x[v]?(S-x[v])*I:0,x[v+1]+=S!==x[v+1]?(S-x[v+1])*I:0,x[v+2]+=S!==x[v+2]?(S-x[v+2])*I:0}},getUniformLocations:function(m,v){return{uVibrance:m.getUniformLocation(v,"uVibrance")}},sendUniformData:function(m,v){m.uniform1f(v.uVibrance,-this.vibrance)}}),C.Image.filters.Vibrance.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Blur=(0,C.util.createClass)(w.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(m){m.webgl?(this.aspectRatio=m.sourceWidth/m.sourceHeight,m.passes++,this._setupFrameBuffer(m),this.horizontal=!0,this.applyToWebGL(m),this._swapTextures(m),this._setupFrameBuffer(m),this.horizontal=!1,this.applyToWebGL(m),this._swapTextures(m)):this.applyTo2d(m)},applyTo2d:function(m){m.imageData=this.simpleBlur(m)},simpleBlur:function(m){var v,S,A=m.filterBackend.resources,I=m.imageData.width,x=m.imageData.height;A.blurLayer1||(A.blurLayer1=C.util.createCanvasElement(),A.blurLayer2=C.util.createCanvasElement()),S=A.blurLayer2,(v=A.blurLayer1).width===I&&v.height===x||(S.width=v.width=I,S.height=v.height=x);var L,N,B,G,U=v.getContext("2d"),W=S.getContext("2d"),q=.06*this.blur*.5;for(U.putImageData(m.imageData,0,0),W.clearRect(0,0,I,x),G=-15;G<=15;G++)B=q*(N=G/15)*I+(L=(Math.random()-.5)/4),W.globalAlpha=1-Math.abs(N),W.drawImage(v,B,L),U.drawImage(S,0,0),W.globalAlpha=1,W.clearRect(0,0,S.width,S.height);for(G=-15;G<=15;G++)B=q*(N=G/15)*x+(L=(Math.random()-.5)/4),W.globalAlpha=1-Math.abs(N),W.drawImage(v,L,B),U.drawImage(S,0,0),W.globalAlpha=1,W.clearRect(0,0,S.width,S.height);m.ctx.drawImage(v,0,0);var ne=m.ctx.getImageData(0,0,v.width,v.height);return U.globalAlpha=1,U.clearRect(0,0,v.width,v.height),ne},getUniformLocations:function(m,v){return{delta:m.getUniformLocation(v,"uDelta")}},sendUniformData:function(m,v){var S=this.chooseRightDelta();m.uniform2fv(v.delta,S)},chooseRightDelta:function(){var m,v=1,S=[0,0];return this.horizontal?this.aspectRatio>1&&(v=1/this.aspectRatio):this.aspectRatio<1&&(v=this.aspectRatio),m=v*this.blur*.12,this.horizontal?S[0]=m:S[1]=m,S}}),w.Blur.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Gamma=(0,C.util.createClass)(w.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(m){this.gamma=[1,1,1],w.BaseFilter.prototype.initialize.call(this,m)},applyTo2d:function(m){var v,S=m.imageData.data,A=this.gamma,I=S.length,x=1/A[0],L=1/A[1],N=1/A[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),v=0,I=256;v<I;v++)this.rVals[v]=255*Math.pow(v/255,x),this.gVals[v]=255*Math.pow(v/255,L),this.bVals[v]=255*Math.pow(v/255,N);for(v=0,I=S.length;v<I;v+=4)S[v]=this.rVals[S[v]],S[v+1]=this.gVals[S[v+1]],S[v+2]=this.bVals[S[v+2]]},getUniformLocations:function(m,v){return{uGamma:m.getUniformLocation(v,"uGamma")}},sendUniformData:function(m,v){m.uniform3fv(v.uGamma,this.gamma)}}),C.Image.filters.Gamma.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.Composed=(0,C.util.createClass)(w.BaseFilter,{type:"Composed",subFilters:[],initialize:function(m){this.callSuper("initialize",m),this.subFilters=this.subFilters.slice(0)},applyTo:function(m){m.passes+=this.subFilters.length-1,this.subFilters.forEach(function(v){v.applyTo(m)})},toObject:function(){return C.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(m){return m.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(m){return!m.isNeutralState()})}}),C.Image.filters.Composed.fromObject=function(m,v){var S=(m.subFilters||[]).map(function(I){return new C.Image.filters[I.type](I)}),A=new C.Image.filters.Composed({subFilters:S});return v&&v(A),A}}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.Image.filters;w.HueRotation=(0,C.util.createClass)(w.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var m=this.rotation*Math.PI,v=C.util.cos(m),S=C.util.sin(m),A=1/3,I=Math.sqrt(A)*S,x=1-v;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=v+x/3,this.matrix[1]=A*x-I,this.matrix[2]=A*x+I,this.matrix[5]=A*x+I,this.matrix[6]=v+A*x,this.matrix[7]=A*x-I,this.matrix[10]=A*x-I,this.matrix[11]=A*x+I,this.matrix[12]=v+A*x},isNeutralState:function(m){return this.calculateMatrix(),w.BaseFilter.prototype.isNeutralState.call(this,m)},applyTo:function(m){this.calculateMatrix(),w.BaseFilter.prototype.applyTo.call(this,m)}}),C.Image.filters.HueRotation.fromObject=C.Image.filters.BaseFilter.fromObject}(a),function(D){var C=D.fabric||(D.fabric={}),w=C.util.object.clone;if(C.Text)C.warn("fabric.Text is already defined");else{var T="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");C.Text=C.util.createClass(C.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:C.Object.prototype.stateProperties.concat(T),cacheProperties:C.Object.prototype.cacheProperties.concat(T),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(m,v){this.styles=v&&v.styles||{},this.text=m,this.__skipDimension=!0,this.callSuper("initialize",v),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var m=this.path;m&&(m.segmentsInfo=C.util.getPathSegmentsInfo(m.path))},getMeasuringContext:function(){return C._measuringContext||(C._measuringContext=this.canvas&&this.canvas.contextCache||C.util.createCanvasElement().getContext("2d")),C._measuringContext},_splitText:function(){var m=this._splitTextIntoLines(this.text);return this.textLines=m.lines,this._textLines=m.graphemeLines,this._unwrappedTextLines=m._unwrappedLines,this._text=m.graphemeText,m},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var m,v,A,I,x,L,N=0,B=this._textLines.length;N<B;N++)if(("justify"===this.textAlign||N!==B-1&&!this.isEndOfWrapping(N))&&(A=0,I=this._textLines[N],(v=this.getLineWidth(N))<this.width&&(L=this.textLines[N].match(this._reSpacesAndTabs)))){m=(this.width-v)/L.length;for(var G=0,U=I.length;G<=U;G++)x=this.__charBounds[N][G],this._reSpaceAndTab.test(I[G])?(x.width+=m,x.kernedWidth+=m,x.left+=A,A+=m):x.left+=A}},isEndOfWrapping:function(m){return m===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var m=this.callSuper("_getCacheCanvasDimensions"),v=this.fontSize;return m.width+=v*m.zoomX,m.height+=v*m.zoomY,m},_render:function(m){var v=this.path;v&&!v.isNotVisible()&&v._render(m),this._setTextStyles(m),this._renderTextLinesBackground(m),this._renderTextDecoration(m,"underline"),this._renderText(m),this._renderTextDecoration(m,"overline"),this._renderTextDecoration(m,"linethrough")},_renderText:function(m){"stroke"===this.paintFirst?(this._renderTextStroke(m),this._renderTextFill(m)):(this._renderTextFill(m),this._renderTextStroke(m))},_setTextStyles:function(m,v,S){if(m.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":m.textBaseline="middle";break;case"ascender":m.textBaseline="top";break;case"descender":m.textBaseline="bottom"}m.font=this._getFontDeclaration(v,S)},calcTextWidth:function(){for(var m=this.getLineWidth(0),v=1,S=this._textLines.length;v<S;v++){var A=this.getLineWidth(v);A>m&&(m=A)}return m},_renderTextLine:function(m,v,S,A,I,x){this._renderChars(m,v,S,A,I,x)},_renderTextLinesBackground:function(m){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var v,S,A,I,x,L,N,B=m.fillStyle,G=this._getLeftOffset(),U=this._getTopOffset(),W=0,q=0,ne=this.path,ie=0,he=this._textLines.length;ie<he;ie++)if(v=this.getHeightOfLine(ie),this.textBackgroundColor||this.styleHas("textBackgroundColor",ie)){A=this._textLines[ie],S=this._getLineLeftOffset(ie),q=0,W=0,I=this.getValueOfPropertyAt(ie,0,"textBackgroundColor");for(var le=0,oe=A.length;le<oe;le++)x=this.__charBounds[ie][le],L=this.getValueOfPropertyAt(ie,le,"textBackgroundColor"),ne?(m.save(),m.translate(x.renderLeft,x.renderTop),m.rotate(x.angle),m.fillStyle=L,L&&m.fillRect(-x.width/2,-v/this.lineHeight*(1-this._fontSizeFraction),x.width,v/this.lineHeight),m.restore()):L!==I?(N=G+S+W,"rtl"===this.direction&&(N=this.width-N-q),m.fillStyle=I,I&&m.fillRect(N,U,q,v/this.lineHeight),W=x.left,q=x.width,I=L):q+=x.kernedWidth;L&&!ne&&(N=G+S+W,"rtl"===this.direction&&(N=this.width-N-q),m.fillStyle=L,m.fillRect(N,U,q,v/this.lineHeight)),U+=v}else U+=v;m.fillStyle=B,this._removeShadow(m)}},getFontCache:function(m){var v=m.fontFamily.toLowerCase();C.charWidthsCache[v]||(C.charWidthsCache[v]={});var S=C.charWidthsCache[v],A=m.fontStyle.toLowerCase()+"_"+(m.fontWeight+"").toLowerCase();return S[A]||(S[A]={}),S[A]},_measureChar:function(m,v,S,A){var I,x,L,N,B=this.getFontCache(v),G=S+m,U=this._getFontDeclaration(v)===this._getFontDeclaration(A),W=v.fontSize/this.CACHE_FONT_SIZE;if(S&&void 0!==B[S]&&(L=B[S]),void 0!==B[m]&&(N=I=B[m]),U&&void 0!==B[G]&&(N=(x=B[G])-L),void 0===I||void 0===L||void 0===x){var q=this.getMeasuringContext();this._setTextStyles(q,v,!0)}return void 0===I&&(N=I=q.measureText(m).width,B[m]=I),void 0===L&&U&&S&&(L=q.measureText(S).width,B[S]=L),U&&void 0===x&&(x=q.measureText(G).width,B[G]=x,N=x-L),{width:I*W,kernedWidth:N*W}},getHeightOfChar:function(m,v){return this.getValueOfPropertyAt(m,v,"fontSize")},measureLine:function(m){var v=this._measureLine(m);return 0!==this.charSpacing&&(v.width-=this._getWidthOfCharSpacing()),v.width<0&&(v.width=0),v},_measureLine:function(m){var v,S,A,I,x,L,N=0,B=this._textLines[m],G=new Array(B.length),U=0,W=this.path,q="right"===this.pathSide;for(this.__charBounds[m]=G,v=0;v<B.length;v++)I=this._getGraphemeBox(S=B[v],m,v,A),G[v]=I,N+=I.kernedWidth,A=S;if(G[v]={left:I?I.left+I.width:0,width:0,kernedWidth:0,height:this.fontSize},W){switch(L=W.segmentsInfo[W.segmentsInfo.length-1].length,(x=C.util.getPointOnPath(W.path,0,W.segmentsInfo)).x+=W.pathOffset.x,x.y+=W.pathOffset.y,this.textAlign){case"left":U=q?L-N:0;break;case"center":U=(L-N)/2;break;case"right":U=q?0:L-N}for(U+=this.pathStartOffset*(q?-1:1),v=q?B.length-1:0;q?v>=0:v<B.length;q?v--:v++)U>L?U%=L:U<0&&(U+=L),this._setGraphemeOnPath(U,I=G[v],x),U+=I.kernedWidth}return{width:N,numOfSpaces:0}},_setGraphemeOnPath:function(m,v,S){var I=this.path,x=C.util.getPointOnPath(I.path,m+v.kernedWidth/2,I.segmentsInfo);v.renderLeft=x.x-S.x,v.renderTop=x.y-S.y,v.angle=x.angle+("right"===this.pathSide?Math.PI:0)},_getGraphemeBox:function(m,v,S,A,I){var x,L=this.getCompleteStyleDeclaration(v,S),N=A?this.getCompleteStyleDeclaration(v,S-1):{},B=this._measureChar(m,L,A,N),G=B.kernedWidth,U=B.width;0!==this.charSpacing&&(U+=x=this._getWidthOfCharSpacing(),G+=x);var W={width:U,left:0,height:L.fontSize,kernedWidth:G,deltaY:L.deltaY};if(S>0&&!I){var q=this.__charBounds[v][S-1];W.left=q.left+q.width+B.kernedWidth-B.width}return W},getHeightOfLine:function(m){if(this.__lineHeights[m])return this.__lineHeights[m];for(var v=this._textLines[m],S=this.getHeightOfChar(m,0),A=1,I=v.length;A<I;A++)S=Math.max(this.getHeightOfChar(m,A),S);return this.__lineHeights[m]=S*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var m,v=0,S=0,A=this._textLines.length;S<A;S++)m=this.getHeightOfLine(S),v+=S===A-1?m/this.lineHeight:m;return v},_getLeftOffset:function(){return"ltr"===this.direction?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(m,v){m.save();for(var S=0,A=this._getLeftOffset(),I=this._getTopOffset(),x=0,L=this._textLines.length;x<L;x++){var N=this.getHeightOfLine(x),B=N/this.lineHeight,G=this._getLineLeftOffset(x);this._renderTextLine(v,m,this._textLines[x],A+G,I+S+B,x),S+=N}m.restore()},_renderTextFill:function(m){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(m,"fillText")},_renderTextStroke:function(m){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(m),m.save(),this._setLineDash(m,this.strokeDashArray),m.beginPath(),this._renderTextCommon(m,"strokeText"),m.closePath(),m.restore())},_renderChars:function(m,v,S,A,I,x){var L,N,B,G,W=this.getHeightOfLine(x),q=-1!==this.textAlign.indexOf("justify"),ne="",ie=0,he=this.path,le=!q&&0===this.charSpacing&&this.isEmptyStyles(x)&&!he,oe="ltr"===this.direction,J="ltr"===this.direction?1:-1,Q=v.canvas.getAttribute("dir");if(v.save(),Q!==this.direction&&(v.canvas.setAttribute("dir",oe?"ltr":"rtl"),v.direction=oe?"ltr":"rtl",v.textAlign=oe?"left":"right"),I-=W*this._fontSizeFraction/this.lineHeight,le)return this._renderChar(m,v,x,0,S.join(""),A,I,W),void v.restore();for(var re=0,ue=S.length-1;re<=ue;re++)G=re===ue||this.charSpacing||he,ne+=S[re],B=this.__charBounds[x][re],0===ie?(A+=J*(B.kernedWidth-B.width),ie+=B.width):ie+=B.kernedWidth,q&&!G&&this._reSpaceAndTab.test(S[re])&&(G=!0),G||(L=L||this.getCompleteStyleDeclaration(x,re),N=this.getCompleteStyleDeclaration(x,re+1),G=this._hasStyleChanged(L,N)),G&&(he?(v.save(),v.translate(B.renderLeft,B.renderTop),v.rotate(B.angle),this._renderChar(m,v,x,re,ne,-ie/2,0,W),v.restore()):this._renderChar(m,v,x,re,ne,A,I,W),ne="",L=N,A+=J*ie,ie=0);v.restore()},_applyPatternGradientTransformText:function(m){var v,S=C.util.createCanvasElement(),A=this.width+this.strokeWidth,I=this.height+this.strokeWidth;return S.width=A,S.height=I,(v=S.getContext("2d")).beginPath(),v.moveTo(0,0),v.lineTo(A,0),v.lineTo(A,I),v.lineTo(0,I),v.closePath(),v.translate(A/2,I/2),v.fillStyle=m.toLive(v),this._applyPatternGradientTransform(v,m),v.fill(),v.createPattern(S,"no-repeat")},handleFiller:function(m,v,S){var A,I;return S.toLive?"percentage"===S.gradientUnits||S.gradientTransform||S.patternTransform?(m.translate(A=-this.width/2,I=-this.height/2),m[v]=this._applyPatternGradientTransformText(S),{offsetX:A,offsetY:I}):(m[v]=S.toLive(m,this),this._applyPatternGradientTransform(m,S)):(m[v]=S,{offsetX:0,offsetY:0})},_setStrokeStyles:function(m,v){return m.lineWidth=v.strokeWidth,m.lineCap=this.strokeLineCap,m.lineDashOffset=this.strokeDashOffset,m.lineJoin=this.strokeLineJoin,m.miterLimit=this.strokeMiterLimit,this.handleFiller(m,"strokeStyle",v.stroke)},_setFillStyles:function(m,v){return this.handleFiller(m,"fillStyle",v.fill)},_renderChar:function(m,v,S,A,I,x,L){var N,B,G=this._getStyleDeclaration(S,A),U=this.getCompleteStyleDeclaration(S,A),W="fillText"===m&&U.fill,q="strokeText"===m&&U.stroke&&U.strokeWidth;(q||W)&&(v.save(),W&&(N=this._setFillStyles(v,U)),q&&(B=this._setStrokeStyles(v,U)),v.font=this._getFontDeclaration(U),G&&G.textBackgroundColor&&this._removeShadow(v),G&&G.deltaY&&(L+=G.deltaY),W&&v.fillText(I,x-N.offsetX,L-N.offsetY),q&&v.strokeText(I,x-B.offsetX,L-B.offsetY),v.restore())},setSuperscript:function(m,v){return this._setScript(m,v,this.superscript)},setSubscript:function(m,v){return this._setScript(m,v,this.subscript)},_setScript:function(m,v,S){var A=this.get2DCursorLocation(m,!0),I=this.getValueOfPropertyAt(A.lineIndex,A.charIndex,"fontSize"),x=this.getValueOfPropertyAt(A.lineIndex,A.charIndex,"deltaY");return this.setSelectionStyles({fontSize:I*S.size,deltaY:x+I*S.baseline},m,v),this},_hasStyleChanged:function(m,v){return m.fill!==v.fill||m.stroke!==v.stroke||m.strokeWidth!==v.strokeWidth||m.fontSize!==v.fontSize||m.fontFamily!==v.fontFamily||m.fontWeight!==v.fontWeight||m.fontStyle!==v.fontStyle||m.deltaY!==v.deltaY},_hasStyleChangedForSvg:function(m,v){return this._hasStyleChanged(m,v)||m.overline!==v.overline||m.underline!==v.underline||m.linethrough!==v.linethrough},_getLineLeftOffset:function(m){var v=this.getLineWidth(m),S=this.width-v,A=this.textAlign,I=this.direction,x=0,L=this.isEndOfWrapping(m);return"justify"===A||"justify-center"===A&&!L||"justify-right"===A&&!L||"justify-left"===A&&!L?0:("center"===A&&(x=S/2),"right"===A&&(x=S),"justify-center"===A&&(x=S/2),"justify-right"===A&&(x=S),"rtl"===I&&(x-=S),x)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var m=this._forceClearCache;return m||(m=this.hasStateChanged("_dimensionAffectingProps")),m&&(this.dirty=!0,this._forceClearCache=!1),m},getLineWidth:function(m){if(void 0!==this.__lineWidths[m])return this.__lineWidths[m];var v=this.measureLine(m).width;return this.__lineWidths[m]=v,v},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(m,v,S){var A=this._getStyleDeclaration(m,v);return A&&void 0!==A[S]?A[S]:this[S]},_renderTextDecoration:function(m,v){if(this[v]||this.styleHas(v)){for(var S,A,I,x,L,N,B,G,U,W,q,ne,ie,he,le,oe,J=this._getLeftOffset(),Q=this._getTopOffset(),re=this.path,ue=this._getWidthOfCharSpacing(),de=this.offsets[v],te=0,ee=this._textLines.length;te<ee;te++)if(S=this.getHeightOfLine(te),this[v]||this.styleHas(v,te)){B=this._textLines[te],he=S/this.lineHeight,x=this._getLineLeftOffset(te),W=0,q=0,G=this.getValueOfPropertyAt(te,0,v),oe=this.getValueOfPropertyAt(te,0,"fill"),U=Q+he*(1-this._fontSizeFraction),A=this.getHeightOfChar(te,0),L=this.getValueOfPropertyAt(te,0,"deltaY");for(var se=0,fe=B.length;se<fe;se++)if(ne=this.__charBounds[te][se],ie=this.getValueOfPropertyAt(te,se,v),le=this.getValueOfPropertyAt(te,se,"fill"),I=this.getHeightOfChar(te,se),N=this.getValueOfPropertyAt(te,se,"deltaY"),re&&ie&&le)m.save(),m.fillStyle=oe,m.translate(ne.renderLeft,ne.renderTop),m.rotate(ne.angle),m.fillRect(-ne.kernedWidth/2,de*I+N,ne.kernedWidth,this.fontSize/15),m.restore();else if((ie!==G||le!==oe||I!==A||N!==L)&&q>0){var ce=J+x+W;"rtl"===this.direction&&(ce=this.width-ce-q),G&&oe&&(m.fillStyle=oe,m.fillRect(ce,U+de*A+L,q,this.fontSize/15)),W=ne.left,q=ne.width,G=ie,oe=le,A=I,L=N}else q+=ne.kernedWidth;ce=J+x+W,"rtl"===this.direction&&(ce=this.width-ce-q),m.fillStyle=le,ie&&le&&m.fillRect(ce,U+de*A+L,q-ue,this.fontSize/15),Q+=S}else Q+=S;this._removeShadow(m)}},_getFontDeclaration:function(m,v){var S=m||this,A=this.fontFamily,I=C.Text.genericFonts.indexOf(A.toLowerCase())>-1,x=void 0===A||A.indexOf("'")>-1||A.indexOf(",")>-1||A.indexOf('"')>-1||I?S.fontFamily:'"'+S.fontFamily+'"';return[C.isLikelyNode?S.fontWeight:S.fontStyle,C.isLikelyNode?S.fontStyle:S.fontWeight,v?this.CACHE_FONT_SIZE+"px":S.fontSize+"px",x].join(" ")},render:function(m){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",m)))},_splitTextIntoLines:function(m){for(var v=m.split(this._reNewline),S=new Array(v.length),A=["\n"],I=[],x=0;x<v.length;x++)S[x]=C.util.string.graphemeSplit(v[x]),I=I.concat(S[x],A);return I.pop(),{_unwrappedLines:S,lines:v,graphemeText:I,graphemeLines:S}},toObject:function(m){var v=T.concat(m),S=this.callSuper("toObject",v);return S.styles=w(this.styles,!0),S.path&&(S.path=this.path.toObject()),S},set:function(m,v){this.callSuper("set",m,v);var S=!1,A=!1;if("object"==typeof m)for(var I in m)"path"===I&&this.setPathInfo(),S=S||-1!==this._dimensionAffectingProps.indexOf(I),A=A||"path"===I;else S=-1!==this._dimensionAffectingProps.indexOf(m),A="path"===m;return A&&this.setPathInfo(),S&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),C.Text.ATTRIBUTE_NAMES=C.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),C.Text.DEFAULT_SVG_FONT_SIZE=16,C.Text.fromElement=function(m,v,S){if(!m)return v(null);var A=C.parseAttributes(m,C.Text.ATTRIBUTE_NAMES),I=A.textAnchor||"left";if((S=C.util.object.extend(S?w(S):{},A)).top=S.top||0,S.left=S.left||0,A.textDecoration){var x=A.textDecoration;-1!==x.indexOf("underline")&&(S.underline=!0),-1!==x.indexOf("overline")&&(S.overline=!0),-1!==x.indexOf("line-through")&&(S.linethrough=!0),delete S.textDecoration}"dx"in A&&(S.left+=A.dx),"dy"in A&&(S.top+=A.dy),"fontSize"in S||(S.fontSize=C.Text.DEFAULT_SVG_FONT_SIZE);var L="";"textContent"in m?L=m.textContent:"firstChild"in m&&null!==m.firstChild&&"data"in m.firstChild&&null!==m.firstChild.data&&(L=m.firstChild.data),L=L.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var N=S.strokeWidth;S.strokeWidth=0;var B=new C.Text(L,S),G=B.getScaledHeight()/B.height,U=((B.height+B.strokeWidth)*B.lineHeight-B.height)*G,W=B.getScaledHeight()+U,q=0;"center"===I&&(q=B.getScaledWidth()/2),"right"===I&&(q=B.getScaledWidth()),B.set({left:B.left-q,top:B.top-(W-B.fontSize*(.07+B._fontSizeFraction))/B.lineHeight,strokeWidth:void 0!==N?N:1}),v(B)},C.Text.fromObject=function(m,v){var S=w(m),A=m.path;return delete S.path,C.Object._fromObject("Text",S,function(I){A?C.Object._fromObject("Path",A,function(x){I.set("path",x),v(I)},"path"):v(I)},"text")},C.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],C.util.createAccessors&&C.util.createAccessors(C.Text)}}(a),F.util.object.extend(F.Text.prototype,{isEmptyStyles:function(D){if(!this.styles||void 0!==D&&!this.styles[D])return!0;var C=void 0===D?this.styles:{line:this.styles[D]};for(var w in C)for(var T in C[w])for(var m in C[w][T])return!1;return!0},styleHas:function(D,C){if(!this.styles||!D||""===D||void 0!==C&&!this.styles[C])return!1;var w=void 0===C?this.styles:{0:this.styles[C]};for(var T in w)for(var m in w[T])if(void 0!==w[T][m][D])return!0;return!1},cleanStyle:function(D){if(!this.styles||!D||""===D)return!1;var C,w,T=this.styles,m=0,v=!0,S=0;for(var A in T){for(var I in C=0,T[A]){var x;m++,(x=T[A][I]).hasOwnProperty(D)?(w?x[D]!==w&&(v=!1):w=x[D],x[D]===this[D]&&delete x[D]):v=!1,0!==Object.keys(x).length?C++:delete T[A][I]}0===C&&delete T[A]}for(var L=0;L<this._textLines.length;L++)S+=this._textLines[L].length;v&&m===S&&(this[D]=w,this.removeStyle(D))},removeStyle:function(D){if(this.styles&&D&&""!==D){var C,w,T,m=this.styles;for(w in m){for(T in C=m[w])delete C[T][D],0===Object.keys(C[T]).length&&delete C[T];0===Object.keys(C).length&&delete m[w]}}},_extendStyles:function(D,C){var w=this.get2DCursorLocation(D);this._getLineStyle(w.lineIndex)||this._setLineStyle(w.lineIndex),this._getStyleDeclaration(w.lineIndex,w.charIndex)||this._setStyleDeclaration(w.lineIndex,w.charIndex,{}),F.util.object.extend(this._getStyleDeclaration(w.lineIndex,w.charIndex),C)},get2DCursorLocation:function(D,C){void 0===D&&(D=this.selectionStart);for(var w=C?this._unwrappedTextLines:this._textLines,T=w.length,m=0;m<T;m++){if(D<=w[m].length)return{lineIndex:m,charIndex:D};D-=w[m].length+this.missingNewlineOffset(m)}return{lineIndex:m-1,charIndex:w[m-1].length<D?w[m-1].length:D}},getSelectionStyles:function(D,C,w){void 0===D&&(D=this.selectionStart||0),void 0===C&&(C=this.selectionEnd||D);for(var T=[],m=D;m<C;m++)T.push(this.getStyleAtPosition(m,w));return T},getStyleAtPosition:function(D,C){var w=this.get2DCursorLocation(D);return(C?this.getCompleteStyleDeclaration(w.lineIndex,w.charIndex):this._getStyleDeclaration(w.lineIndex,w.charIndex))||{}},setSelectionStyles:function(D,C,w){void 0===C&&(C=this.selectionStart||0),void 0===w&&(w=this.selectionEnd||C);for(var T=C;T<w;T++)this._extendStyles(T,D);return this._forceClearCache=!0,this},_getStyleDeclaration:function(D,C){var w=this.styles&&this.styles[D];return w?w[C]:null},getCompleteStyleDeclaration:function(D,C){for(var w,T=this._getStyleDeclaration(D,C)||{},m={},v=0;v<this._styleProperties.length;v++)m[w=this._styleProperties[v]]=void 0===T[w]?this[w]:T[w];return m},_setStyleDeclaration:function(D,C,w){this.styles[D][C]=w},_deleteStyleDeclaration:function(D,C){delete this.styles[D][C]},_getLineStyle:function(D){return!!this.styles[D]},_setLineStyle:function(D){this.styles[D]={}},_deleteLineStyle:function(D){delete this.styles[D]}}),function(){function D(C){C.textDecoration&&(C.textDecoration.indexOf("underline")>-1&&(C.underline=!0),C.textDecoration.indexOf("line-through")>-1&&(C.linethrough=!0),C.textDecoration.indexOf("overline")>-1&&(C.overline=!0),delete C.textDecoration)}F.IText=F.util.createClass(F.Text,F.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(C,w){this.callSuper("initialize",C,w),this.initBehavior()},setSelectionStart:function(C){C=Math.max(C,0),this._updateAndFire("selectionStart",C)},setSelectionEnd:function(C){C=Math.min(C,this.text.length),this._updateAndFire("selectionEnd",C)},_updateAndFire:function(C,w){this[C]!==w&&(this._fireSelectionChanged(),this[C]=w),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(C){this.clearContextTop(),this.callSuper("render",C),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(C){this.callSuper("_render",C)},clearContextTop:function(C){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var w=this.canvas.contextTop,T=this.canvas.viewportTransform;w.save(),w.transform(T[0],T[1],T[2],T[3],T[4],T[5]),this.transform(w),this._clearTextArea(w),C||w.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var C=this._getCursorBoundaries(),w=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(C,w):this.renderSelection(C,w),w.restore()}},_clearTextArea:function(C){var w=this.width+4,T=this.height+4;C.clearRect(-w/2,-T/2,w,T)},_getCursorBoundaries:function(C){void 0===C&&(C=this.selectionStart);var w=this._getLeftOffset(),T=this._getTopOffset(),m=this._getCursorBoundariesOffsets(C);return{left:w,top:T,leftOffset:m.left,topOffset:m.top}},_getCursorBoundariesOffsets:function(C){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var w,T,m,v,S=0,A=0,I=this.get2DCursorLocation(C);m=I.charIndex,T=I.lineIndex;for(var x=0;x<T;x++)S+=this.getHeightOfLine(x);w=this._getLineLeftOffset(T);var L=this.__charBounds[T][m];return L&&(A=L.left),0!==this.charSpacing&&m===this._textLines[T].length&&(A-=this._getWidthOfCharSpacing()),v={top:S,left:w+(A>0?A:0)},"rtl"===this.direction&&(v.left*=-1),this.cursorOffsetCache=v,this.cursorOffsetCache},renderCursor:function(C,w){var T=this.get2DCursorLocation(),m=T.lineIndex,v=T.charIndex>0?T.charIndex-1:0,S=this.getValueOfPropertyAt(m,v,"fontSize"),A=this.scaleX*this.canvas.getZoom(),I=this.cursorWidth/A,x=C.topOffset,L=this.getValueOfPropertyAt(m,v,"deltaY");x+=(1-this._fontSizeFraction)*this.getHeightOfLine(m)/this.lineHeight-S*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(C,w),w.fillStyle=this.cursorColor||this.getValueOfPropertyAt(m,v,"fill"),w.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,w.fillRect(C.left+C.leftOffset-I/2,x+C.top+L,I,S)},renderSelection:function(C,w){for(var T=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,m=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,v=-1!==this.textAlign.indexOf("justify"),S=this.get2DCursorLocation(T),A=this.get2DCursorLocation(m),I=S.lineIndex,x=A.lineIndex,L=S.charIndex<0?0:S.charIndex,N=A.charIndex<0?0:A.charIndex,B=I;B<=x;B++){var G,U=this._getLineLeftOffset(B)||0,W=this.getHeightOfLine(B),q=0,ne=0;if(B===I&&(q=this.__charBounds[I][L].left),B>=I&&B<x)ne=v&&!this.isEndOfWrapping(B)?this.width:this.getLineWidth(B)||5;else if(B===x)if(0===N)ne=this.__charBounds[x][N].left;else{var ie=this._getWidthOfCharSpacing();ne=this.__charBounds[x][N-1].left+this.__charBounds[x][N-1].width-ie}G=W,(this.lineHeight<1||B===x&&this.lineHeight>1)&&(W/=this.lineHeight);var he=C.left+U+q,le=ne-q,oe=W,J=0;this.inCompositionMode?(w.fillStyle=this.compositionColor||"black",oe=1,J=W):w.fillStyle=this.selectionColor,"rtl"===this.direction&&(he=this.width-he-le),w.fillRect(he,C.top+C.topOffset+J,le,oe),C.topOffset+=G}},getCurrentCharFontSize:function(){var C=this._getCurrentCharIndex();return this.getValueOfPropertyAt(C.l,C.c,"fontSize")},getCurrentCharColor:function(){var C=this._getCurrentCharIndex();return this.getValueOfPropertyAt(C.l,C.c,"fill")},_getCurrentCharIndex:function(){var C=this.get2DCursorLocation(this.selectionStart,!0);return{l:C.lineIndex,c:C.charIndex>0?C.charIndex-1:0}}}),F.IText.fromObject=function(C,w){if(D(C),C.styles)for(var T in C.styles)for(var m in C.styles[T])D(C.styles[T][m]);F.Object._fromObject("IText",C,w,"text")}}(),xe=F.util.object.clone,F.util.object.extend(F.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var D=this;this.on("added",function(){var C=D.canvas;C&&(C._hasITextHandlers||(C._hasITextHandlers=!0,D._initCanvasHandlers(C)),C._iTextInstances=C._iTextInstances||[],C._iTextInstances.push(D))})},initRemovedHandler:function(){var D=this;this.on("removed",function(){var C=D.canvas;C&&(C._iTextInstances=C._iTextInstances||[],F.util.removeFromArray(C._iTextInstances,D),0===C._iTextInstances.length&&(C._hasITextHandlers=!1,D._removeCanvasHandlers(C)))})},_initCanvasHandlers:function(D){D._mouseUpITextHandler=function(){D._iTextInstances&&D._iTextInstances.forEach(function(C){C.__isMousedown=!1})},D.on("mouse:up",D._mouseUpITextHandler)},_removeCanvasHandlers:function(D){D.off("mouse:up",D._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(D,C,w,T){var m;return m={isAborted:!1,abort:function(){this.isAborted=!0}},D.animate("_currentCursorOpacity",C,{duration:w,onComplete:function(){m.isAborted||D[T]()},onChange:function(){D.canvas&&D.selectionStart===D.selectionEnd&&D.renderCursorOrSelection()},abort:function(){return m.isAborted}}),m},_onTickComplete:function(){var D=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){D._currentTickCompleteState=D._animateCursor(D,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(D){var C=this,w=D?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){C._tick()},w)},abortCursorAnimation:function(){var D=this._currentTickState||this._currentTickCompleteState,C=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,D&&C&&C.clearContext(C.contextTop||C.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(D){var C=0,w=D-1;if(this._reSpace.test(this._text[w]))for(;this._reSpace.test(this._text[w]);)C++,w--;for(;/\S/.test(this._text[w])&&w>-1;)C++,w--;return D-C},findWordBoundaryRight:function(D){var C=0,w=D;if(this._reSpace.test(this._text[w]))for(;this._reSpace.test(this._text[w]);)C++,w++;for(;/\S/.test(this._text[w])&&w<this._text.length;)C++,w++;return D+C},findLineBoundaryLeft:function(D){for(var C=0,w=D-1;!/\n/.test(this._text[w])&&w>-1;)C++,w--;return D-C},findLineBoundaryRight:function(D){for(var C=0,w=D;!/\n/.test(this._text[w])&&w<this._text.length;)C++,w++;return D+C},searchWordBoundary:function(D,C){for(var w=this._text,T=this._reSpace.test(w[D])?D-1:D,m=w[T],v=F.reNonWord;!v.test(m)&&T>0&&T<w.length;)m=w[T+=C];return v.test(m)&&(T+=1===C?0:1),T},selectWord:function(D){var C=this.searchWordBoundary(D=D||this.selectionStart,-1),w=this.searchWordBoundary(D,1);this.selectionStart=C,this.selectionEnd=w,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(D){var C=this.findLineBoundaryLeft(D=D||this.selectionStart),w=this.findLineBoundaryRight(D);return this.selectionStart=C,this.selectionEnd=w,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(D){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(D),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(D){D._iTextInstances&&D._iTextInstances.forEach(function(C){C.selected=!1,C.isEditing&&C.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(D){if(this.__isMousedown&&this.isEditing){var C=this.getSelectionStartFromPointer(D.e),w=this.selectionStart,T=this.selectionEnd;(C===this.__selectionStartOnMouseDown&&w!==T||w!==C&&T!==C)&&(C>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=C):(this.selectionStart=C,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===w&&this.selectionEnd===T||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(D,C,w){var T=w.slice(0,D),m=F.util.string.graphemeSplit(T).length;if(D===C)return{selectionStart:m,selectionEnd:m};var v=w.slice(D,C);return{selectionStart:m,selectionEnd:m+F.util.string.graphemeSplit(v).length}},fromGraphemeToStringSelection:function(D,C,w){var T=w.slice(0,D).join("").length;return D===C?{selectionStart:T,selectionEnd:T}:{selectionStart:T,selectionEnd:T+w.slice(D,C).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var D=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=D.selectionStart,this.hiddenTextarea.selectionEnd=D.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var D=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=D.selectionEnd,this.inCompositionMode||(this.selectionStart=D.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var D=this._calcTextareaPosition();this.hiddenTextarea.style.left=D.left,this.hiddenTextarea.style.top=D.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var D=this.inCompositionMode?this.compositionStart:this.selectionStart,C=this._getCursorBoundaries(D),w=this.get2DCursorLocation(D),v=this.getValueOfPropertyAt(w.lineIndex,w.charIndex,"fontSize")*this.lineHeight,S=C.leftOffset,A=this.calcTransformMatrix(),I={x:C.left+S,y:C.top+C.topOffset+v},x=this.canvas.getRetinaScaling(),L=this.canvas.upperCanvasEl,N=L.width/x,B=L.height/x,G=N-v,U=B-v,W=L.clientWidth/N,q=L.clientHeight/B;return I=F.util.transformPoint(I,A),(I=F.util.transformPoint(I,this.canvas.viewportTransform)).x*=W,I.y*=q,I.x<0&&(I.x=0),I.x>G&&(I.x=G),I.y<0&&(I.y=0),I.y>U&&(I.y=U),I.x+=this.canvas._offset.left,I.y+=this.canvas._offset.top,{left:I.x+"px",top:I.y+"px",fontSize:v+"px",charHeight:v}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var D=this._textBeforeEdit!==this.text,C=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,C&&(C.blur&&C.blur(),C.parentNode&&C.parentNode.removeChild(C)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),D&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),D&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var D in this.styles)this._textLines[D]||delete this.styles[D]},removeStyleFromTo:function(D,C){var w,T,m=this.get2DCursorLocation(D,!0),v=this.get2DCursorLocation(C,!0),S=m.lineIndex,A=m.charIndex,I=v.lineIndex,x=v.charIndex;if(S!==I){if(this.styles[S])for(w=A;w<this._unwrappedTextLines[S].length;w++)delete this.styles[S][w];if(this.styles[I])for(w=x;w<this._unwrappedTextLines[I].length;w++)(T=this.styles[I][w])&&(this.styles[S]||(this.styles[S]={}),this.styles[S][A+w-x]=T);for(w=S+1;w<=I;w++)delete this.styles[w];this.shiftLineStyles(I,S-I)}else if(this.styles[S]){T=this.styles[S];var L,N,B=x-A;for(w=A;w<x;w++)delete T[w];for(N in this.styles[S])(L=parseInt(N,10))>=x&&(T[L-B]=T[N],delete T[N])}},shiftLineStyles:function(D,C){var w=xe(this.styles);for(var T in this.styles){var m=parseInt(T,10);m>D&&(this.styles[m+C]=w[m],w[m-C]||delete this.styles[m])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(D,C,w,T){var m,v={},S=!1,A=this._unwrappedTextLines[D].length===C;for(var I in w||(w=1),this.shiftLineStyles(D,w),this.styles[D]&&(m=this.styles[D][0===C?C:C-1]),this.styles[D]){var x=parseInt(I,10);x>=C&&(S=!0,v[x-C]=this.styles[D][I],A&&0===C||delete this.styles[D][I])}var L=!1;for(S&&!A&&(this.styles[D+w]=v,L=!0),L&&w--;w>0;)T&&T[w-1]?this.styles[D+w]={0:xe(T[w-1])}:m?this.styles[D+w]={0:xe(m)}:delete this.styles[D+w],w--;this._forceClearCache=!0},insertCharStyleObject:function(D,C,w,T){this.styles||(this.styles={});var m=this.styles[D],v=m?xe(m):{};for(var S in w||(w=1),v){var A=parseInt(S,10);A>=C&&(m[A+w]=v[A],v[A-w]||delete m[A])}if(this._forceClearCache=!0,T)for(;w--;)Object.keys(T[w]).length&&(this.styles[D]||(this.styles[D]={}),this.styles[D][C+w]=xe(T[w]));else if(m)for(var I=m[C?C-1:1];I&&w--;)this.styles[D][C+w]=xe(I)},insertNewStyleBlock:function(D,C,w){for(var T=this.get2DCursorLocation(C,!0),m=[0],v=0,S=0;S<D.length;S++)"\n"===D[S]?m[++v]=0:m[v]++;for(m[0]>0&&(this.insertCharStyleObject(T.lineIndex,T.charIndex,m[0],w),w=w&&w.slice(m[0]+1)),v&&this.insertNewlineStyleObject(T.lineIndex,T.charIndex+m[0],v),S=1;S<v;S++)m[S]>0?this.insertCharStyleObject(T.lineIndex+S,0,m[S],w):w&&this.styles[T.lineIndex+S]&&w[0]&&(this.styles[T.lineIndex+S][0]=w[0]),w=w&&w.slice(m[S]+1);m[S]>0&&this.insertCharStyleObject(T.lineIndex+S,0,m[S],w)},setSelectionStartEndWithShift:function(D,C,w){w<=D?(C===D?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=D),this.selectionStart=w):w>D&&w<C?"right"===this._selectionDirection?this.selectionEnd=w:this.selectionStart=w:(C===D?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=C),this.selectionEnd=w)},setSelectionInBoundaries:function(){var D=this.text.length;this.selectionStart>D?this.selectionStart=D:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>D?this.selectionEnd=D:this.selectionEnd<0&&(this.selectionEnd=0)}}),F.util.object.extend(F.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(D){if(this.canvas){this.__newClickTime=+new Date;var C=D.pointer;this.isTripleClick(C)&&(this.fire("tripleclick",D),this._stopEvent(D.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=C,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(D){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===D.x&&this.__lastPointer.y===D.y},_stopEvent:function(D){D.preventDefault&&D.preventDefault(),D.stopPropagation&&D.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(D){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(D.e))},tripleClickHandler:function(D){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(D.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(D){!this.canvas||!this.editable||D.e.button&&1!==D.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(D.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(D){!this.canvas||!this.editable||D.e.button&&1!==D.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(D){if(this.__isMousedown=!1,!(!this.editable||this.group||D.transform&&D.transform.actionPerformed||D.e.button&&1!==D.e.button)){if(this.canvas){var C=this.canvas._activeObject;if(C&&C!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(D.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(D){var C=this.getSelectionStartFromPointer(D);D.shiftKey?this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,C):(this.selectionStart=C,this.selectionEnd=C),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(D){for(var C,w=this.getLocalPointer(D),T=0,m=0,v=0,S=0,A=0,I=0,x=this._textLines.length;I<x&&v<=w.y;I++)v+=this.getHeightOfLine(I)*this.scaleY,A=I,I>0&&(S+=this._textLines[I-1].length+this.missingNewlineOffset(I-1));m=this._getLineLeftOffset(A)*this.scaleX,C=this._textLines[A],"rtl"===this.direction&&(w.x=this.width*this.scaleX-w.x+m);for(var L=0,N=C.length;L<N&&(T=m,(m+=this.__charBounds[A][L].kernedWidth*this.scaleX)<=w.x);L++)S++;return this._getNewSelectionStartFromOffset(w,T,m,S,N)},_getNewSelectionStartFromOffset:function(D,C,w,T,m){var S=w-D.x,A=T+(S>D.x-C||S<0?0:1);return this.flipX&&(A=m-A),A>this._text.length&&(A=this._text.length),A}}),F.util.object.extend(F.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=F.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var D=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+D.top+"; left: "+D.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uff70top: "+D.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):F.document.body.appendChild(this.hiddenTextarea),F.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),F.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),F.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),F.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),F.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),F.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),F.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),F.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),F.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(F.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(D){if(this.isEditing){var C="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(D.keyCode in C)this[C[D.keyCode]](D);else{if(!(D.keyCode in this.ctrlKeysMapDown)||!D.ctrlKey&&!D.metaKey)return;this[this.ctrlKeysMapDown[D.keyCode]](D)}D.stopImmediatePropagation(),D.preventDefault(),D.keyCode>=33&&D.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(D){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:D.keyCode in this.ctrlKeysMapUp&&(D.ctrlKey||D.metaKey)&&(this[this.ctrlKeysMapUp[D.keyCode]](D),D.stopImmediatePropagation(),D.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(D){var C=this.fromPaste;if(this.fromPaste=!1,D&&D.stopPropagation(),this.isEditing){var w,T,m,v,S,A=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,I=this._text.length,x=A.length,L=x-I,N=this.selectionStart,B=this.selectionEnd,G=N!==B;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var U=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),W=N>U.selectionStart;G?(w=this._text.slice(N,B),L+=B-N):x<I&&(w=W?this._text.slice(B+L,B):this._text.slice(N,N-L)),T=A.slice(U.selectionEnd-L,U.selectionEnd),w&&w.length&&(T.length&&(m=this.getSelectionStyles(N,N+1,!1),m=T.map(function(){return m[0]})),G?(v=N,S=B):W?(v=B-w.length,S=B):(v=B,S=B+w.length),this.removeStyleFromTo(v,S)),T.length&&(C&&T.join("")===F.copiedText&&!F.disableStyleCopyPaste&&(m=F.copiedTextStyle),this.insertNewStyleBlock(T,N,m)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(D){this.compositionStart=D.target.selectionStart,this.compositionEnd=D.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(F.copiedText=this.getSelectedText(),F.copiedTextStyle=F.disableStyleCopyPaste?null:this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(D){return D&&D.clipboardData||F.window.clipboardData},_getWidthBeforeCursor:function(D,C){var w,T=this._getLineLeftOffset(D);return C>0&&(T+=(w=this.__charBounds[D][C-1]).left+w.width),T},getDownCursorOffset:function(D,C){var w=this._getSelectionForOffset(D,C),T=this.get2DCursorLocation(w),m=T.lineIndex;if(m===this._textLines.length-1||D.metaKey||34===D.keyCode)return this._text.length-w;var v=T.charIndex,S=this._getWidthBeforeCursor(m,v),A=this._getIndexOnLine(m+1,S);return this._textLines[m].slice(v).length+A+1+this.missingNewlineOffset(m)},_getSelectionForOffset:function(D,C){return D.shiftKey&&this.selectionStart!==this.selectionEnd&&C?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(D,C){var w=this._getSelectionForOffset(D,C),T=this.get2DCursorLocation(w),m=T.lineIndex;if(0===m||D.metaKey||33===D.keyCode)return-w;var v=T.charIndex,S=this._getWidthBeforeCursor(m,v),A=this._getIndexOnLine(m-1,S),I=this._textLines[m].slice(0,v),x=this.missingNewlineOffset(m-1);return-this._textLines[m-1].length+A-I.length+(1-x)},_getIndexOnLine:function(D,C){for(var w,T,m=this._textLines[D],v=this._getLineLeftOffset(D),S=0,A=0,I=m.length;A<I;A++)if((v+=w=this.__charBounds[D][A].width)>C){T=!0;var L=v,N=Math.abs(v-w-C);S=Math.abs(L-C)<N?A:A-1;break}return T||(S=m.length-1),S},moveCursorDown:function(D){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",D)},moveCursorUp:function(D){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",D)},_moveCursorUpOrDown:function(D,C){var w=this["get"+D+"CursorOffset"](C,"right"===this._selectionDirection);C.shiftKey?this.moveCursorWithShift(w):this.moveCursorWithoutShift(w),0!==w&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(D){return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,"left"===this._selectionDirection?this.selectionStart+D:this.selectionEnd+D),0!==D},moveCursorWithoutShift:function(D){return D<0?(this.selectionStart+=D,this.selectionEnd=this.selectionStart):(this.selectionEnd+=D,this.selectionStart=this.selectionEnd),0!==D},moveCursorLeft:function(D){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",D)},_move:function(D,C,w){var T;if(D.altKey)T=this["findWordBoundary"+w](this[C]);else{if(!D.metaKey&&35!==D.keyCode&&36!==D.keyCode)return this[C]+="Left"===w?-1:1,!0;T=this["findLineBoundary"+w](this[C])}if(void 0!==typeof T&&this[C]!==T)return this[C]=T,!0},_moveLeft:function(D,C){return this._move(D,C,"Left")},_moveRight:function(D,C){return this._move(D,C,"Right")},moveCursorLeftWithoutShift:function(D){var C=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(C=this._moveLeft(D,"selectionStart")),this.selectionEnd=this.selectionStart,C},moveCursorLeftWithShift:function(D){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(D,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(D,"selectionStart")):void 0},moveCursorRight:function(D){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",D)},_moveCursorLeftOrRight:function(D,C){var w="moveCursor"+D+"With";this._currentCursorOpacity=1,this[w+=C.shiftKey?"Shift":"outShift"](C)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(D){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(D,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(D,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(D){var C=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(C=this._moveRight(D,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,C},removeChars:function(D,C){void 0===C&&(C=D+1),this.removeStyleFromTo(D,C),this._text.splice(D,C-D),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(D,C,w,T){void 0===T&&(T=w),T>w&&this.removeStyleFromTo(w,T);var m=F.util.string.graphemeSplit(D);this.insertNewStyleBlock(m,w,C),this._text=[].concat(this._text.slice(0,w),m,this._text.slice(T)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var D=F.util.toFixed,C=/  +/g;F.util.object.extend(F.Text.prototype,{_toSVG:function(){var w=this._getSVGLeftTopOffsets(),T=this._getSVGTextAndBg(w.textTop,w.textLeft);return this._wrapSVGTextAndBg(T)},toSVG:function(w){return this._createBaseSVGMarkup(this._toSVG(),{reviver:w,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(w){var T=this.getSvgTextDecoration(this);return[w.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",T?'text-decoration="'+T+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",w.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(w,T){var m,v=[],S=[],A=w;this._setSVGBg(S);for(var I=0,x=this._textLines.length;I<x;I++)m=this._getLineLeftOffset(I),(this.textBackgroundColor||this.styleHas("textBackgroundColor",I))&&this._setSVGTextLineBg(S,I,T+m,A),this._setSVGTextLineText(v,I,T+m,A),A+=this.getHeightOfLine(I);return{textSpans:v,textBgRects:S}},_createTextCharSpan:function(w,T,m,v){var S=w!==w.trim()||w.match(C),A=this.getSvgSpanStyles(T,S),I=A?'style="'+A+'"':"",x=T.deltaY,L="",N=F.Object.NUM_FRACTION_DIGITS;return x&&(L=' dy="'+D(x,N)+'" '),['<tspan x="',D(m,N),'" y="',D(v,N),'" ',L,I,">",F.util.string.escapeXml(w),"</tspan>"].join("")},_setSVGTextLineText:function(w,T,m,v){var S,A,I,x,L,N=this.getHeightOfLine(T),B=-1!==this.textAlign.indexOf("justify"),G="",U=0,W=this._textLines[T];v+=N*(1-this._fontSizeFraction)/this.lineHeight;for(var q=0,ne=W.length-1;q<=ne;q++)L=q===ne||this.charSpacing,G+=W[q],I=this.__charBounds[T][q],0===U?(m+=I.kernedWidth-I.width,U+=I.width):U+=I.kernedWidth,B&&!L&&this._reSpaceAndTab.test(W[q])&&(L=!0),L||(S=S||this.getCompleteStyleDeclaration(T,q),A=this.getCompleteStyleDeclaration(T,q+1),L=this._hasStyleChangedForSvg(S,A)),L&&(x=this._getStyleDeclaration(T,q)||{},w.push(this._createTextCharSpan(G,x,m,v)),G="",S=A,m+=U,U=0)},_pushTextBgRect:function(w,T,m,v,S,A){var I=F.Object.NUM_FRACTION_DIGITS;w.push("\t\t<rect ",this._getFillAttributes(T),' x="',D(m,I),'" y="',D(v,I),'" width="',D(S,I),'" height="',D(A,I),'"></rect>\n')},_setSVGTextLineBg:function(w,T,m,v){for(var S,A,I=this._textLines[T],x=this.getHeightOfLine(T)/this.lineHeight,L=0,N=0,B=this.getValueOfPropertyAt(T,0,"textBackgroundColor"),G=0,U=I.length;G<U;G++)S=this.__charBounds[T][G],(A=this.getValueOfPropertyAt(T,G,"textBackgroundColor"))!==B?(B&&this._pushTextBgRect(w,B,m+N,v,L,x),N=S.left,L=S.width,B=A):L+=S.kernedWidth;A&&this._pushTextBgRect(w,A,m+N,v,L,x)},_getFillAttributes:function(w){var T=w&&"string"==typeof w?new F.Color(w):"";return T&&T.getSource()&&1!==T.getAlpha()?'opacity="'+T.getAlpha()+'" fill="'+T.setAlpha(1).toRgb()+'"':'fill="'+w+'"'},_getSVGLineTopOffset:function(w){for(var T,m=0,v=0;v<w;v++)m+=this.getHeightOfLine(v);return T=this.getHeightOfLine(v),{lineTop:m,offset:(this._fontSizeMult-this._fontSizeFraction)*T/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(w){return F.Object.prototype.getSvgStyles.call(this,w)+" white-space: pre;"}})}(),function(D){var C=D.fabric||(D.fabric={});C.Textbox=C.util.createClass(C.IText,C.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:C.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(w){for(var T=0,m=0,v=0,S={},A=0;A<w.graphemeLines.length;A++)"\n"===w.graphemeText[v]&&A>0?(m=0,v++,T++):!this.splitByGrapheme&&this._reSpaceAndTab.test(w.graphemeText[v])&&A>0&&(m++,v++),S[A]={line:T,offset:m},v+=w.graphemeLines[A].length,m+=w.graphemeLines[A].length;return S},styleHas:function(w,T){if(this._styleMap&&!this.isWrapping){var m=this._styleMap[T];m&&(T=m.line)}return C.Text.prototype.styleHas.call(this,w,T)},isEmptyStyles:function(w){if(!this.styles)return!0;var T,m,v=0,S=!1,A=this._styleMap[w],I=this._styleMap[w+1];for(var x in A&&(w=A.line,v=A.offset),I&&(S=I.line===w,T=I.offset),m=void 0===w?this.styles:{line:this.styles[w]})for(var L in m[x])if(L>=v&&(!S||L<T))for(var N in m[x][L])return!1;return!0},_getStyleDeclaration:function(w,T){if(this._styleMap&&!this.isWrapping){var m=this._styleMap[w];if(!m)return null;w=m.line,T=m.offset+T}return this.callSuper("_getStyleDeclaration",w,T)},_setStyleDeclaration:function(w,T,m){var v=this._styleMap[w];this.styles[w=v.line][T=v.offset+T]=m},_deleteStyleDeclaration:function(w,T){var m=this._styleMap[w];delete this.styles[w=m.line][T=m.offset+T]},_getLineStyle:function(w){return!!this.styles[this._styleMap[w].line]},_setLineStyle:function(w){this.styles[this._styleMap[w].line]={}},_wrapText:function(w,T){var m,v=[];for(this.isWrapping=!0,m=0;m<w.length;m++)v=v.concat(this._wrapLine(w[m],m,T));return this.isWrapping=!1,v},_measureWord:function(w,T,m){var v,S=0;m=m||0;for(var A=0,I=w.length;A<I;A++)S+=this._getGraphemeBox(w[A],T,A+m,v,!0).kernedWidth,v=w[A];return S},_wrapLine:function(w,T,m,v){var S=0,A=this.splitByGrapheme,I=[],x=[],L=A?C.util.string.graphemeSplit(w):w.split(this._wordJoiners),N="",B=0,G=A?"":" ",U=0,W=0,q=0,ne=!0,ie=this._getWidthOfCharSpacing();v=v||0,0===L.length&&L.push([]),m-=v;for(var he=0;he<L.length;he++)N=A?L[he]:C.util.string.graphemeSplit(L[he]),U=this._measureWord(N,T,B),B+=N.length,(S+=W+U-ie)>m&&!ne?(I.push(x),x=[],S=U,ne=!0):S+=ie,ne||A||x.push(G),x=x.concat(N),W=A?0:this._measureWord([G],T,B),B++,ne=!1,U>q&&(q=U);return he&&I.push(x),q+v>this.dynamicMinWidth&&(this.dynamicMinWidth=q-ie+v),I},isEndOfWrapping:function(w){return!this._styleMap[w+1]||this._styleMap[w+1].line!==this._styleMap[w].line},missingNewlineOffset:function(w){return this.splitByGrapheme?this.isEndOfWrapping(w)?1:0:1},_splitTextIntoLines:function(w){for(var T=C.Text.prototype._splitTextIntoLines.call(this,w),m=this._wrapText(T.lines,this.width),v=new Array(m.length),S=0;S<m.length;S++)v[S]=m[S].join("");return T.lines=v,T.graphemeLines=m,T},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var w={};for(var T in this._styleMap)this._textLines[T]&&(w[this._styleMap[T].line]=1);for(var T in this.styles)w[T]||delete this.styles[T]},toObject:function(w){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(w))}}),C.Textbox.fromObject=function(w,T){return C.Object._fromObject("Textbox",w,T,"text")}}(a),function(){var D=F.controlsUtils,C=D.scaleSkewCursorStyleHandler,w=D.scaleCursorStyleHandler,T=D.scalingEqually,m=D.scalingYOrSkewingX,v=D.scalingXOrSkewingY,S=D.scaleOrSkewActionName,A=F.Object.prototype.controls;if(A.ml=new F.Control({x:-.5,y:0,cursorStyleHandler:C,actionHandler:v,getActionName:S}),A.mr=new F.Control({x:.5,y:0,cursorStyleHandler:C,actionHandler:v,getActionName:S}),A.mb=new F.Control({x:0,y:.5,cursorStyleHandler:C,actionHandler:m,getActionName:S}),A.mt=new F.Control({x:0,y:-.5,cursorStyleHandler:C,actionHandler:m,getActionName:S}),A.tl=new F.Control({x:-.5,y:-.5,cursorStyleHandler:w,actionHandler:T}),A.tr=new F.Control({x:.5,y:-.5,cursorStyleHandler:w,actionHandler:T}),A.bl=new F.Control({x:-.5,y:.5,cursorStyleHandler:w,actionHandler:T}),A.br=new F.Control({x:.5,y:.5,cursorStyleHandler:w,actionHandler:T}),A.mtr=new F.Control({x:0,y:-.5,actionHandler:D.rotationWithSnapping,cursorStyleHandler:D.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),F.Textbox){var I=F.Textbox.prototype.controls={};I.mtr=A.mtr,I.tr=A.tr,I.br=A.br,I.tl=A.tl,I.bl=A.bl,I.mt=A.mt,I.mb=A.mb,I.mr=new F.Control({x:.5,y:0,actionHandler:D.changeWidth,cursorStyleHandler:C,actionName:"resizing"}),I.ml=new F.Control({x:-.5,y:0,actionHandler:D.changeWidth,cursorStyleHandler:C,actionName:"resizing"})}}()},192:()=>{},898:()=>{},245:()=>{}},ST={};function uo(u){var a=ST[u];if(void 0!==a)return a.exports;var l=ST[u]={exports:{}};return gj[u](l,l.exports,uo),l.exports}uo.d=(u,a)=>{for(var l in a)uo.o(a,l)&&!uo.o(u,l)&&Object.defineProperty(u,l,{enumerable:!0,get:a[l]})},uo.o=(u,a)=>Object.prototype.hasOwnProperty.call(u,a);var TT={};(()=>{let u;uo.d(TT,{R:()=>u}),u="undefined"!=typeof document&&"undefined"!=typeof window?uo(653).fabric:{version:"5.2.1"}})();var Rn,ci,Ts,IT,ot=TT.R;(function(u){u[u.DIMT_RECTANGLE=1]="DIMT_RECTANGLE",u[u.DIMT_QUADRILATERAL=2]="DIMT_QUADRILATERAL",u[u.DIMT_TEXT=4]="DIMT_TEXT",u[u.DIMT_ARC=8]="DIMT_ARC",u[u.DIMT_IMAGE=16]="DIMT_IMAGE",u[u.DIMT_POLYGON=32]="DIMT_POLYGON",u[u.DIMT_LINE=64]="DIMT_LINE",u[u.DIMT_GROUP=128]="DIMT_GROUP"})(Rn||(Rn={})),function(u){u[u.DIS_DEFAULT=1]="DIS_DEFAULT",u[u.DIS_SELECTED=2]="DIS_SELECTED"}(ci||(ci={})),function(u){u[u.EF_ENHANCED_FOCUS=4]="EF_ENHANCED_FOCUS",u[u.EF_AUTO_ZOOM=16]="EF_AUTO_ZOOM",u[u.EF_TAP_TO_FOCUS=64]="EF_TAP_TO_FOCUS"}(Ts||(Ts={})),function(u){u.GREY="grey",u.GREY32="grey32",u.RGBA="rgba",u.RBGA="rbga",u.GRBA="grba",u.GBRA="gbra",u.BRGA="brga",u.BGRA="bgra"}(IT||(IT={}));const Ea=u=>"number"==typeof u&&!Number.isNaN(u),Qm=u=>"string"==typeof u;var Jh,pc,wa,Jm,wr,ed;(function(u){u[u.ARC=0]="ARC",u[u.IMAGE=1]="IMAGE",u[u.LINE=2]="LINE",u[u.POLYGON=3]="POLYGON",u[u.QUAD=4]="QUAD",u[u.RECT=5]="RECT",u[u.TEXT=6]="TEXT",u[u.GROUP=7]="GROUP"})(wr||(wr={})),function(u){u[u.DEFAULT=0]="DEFAULT",u[u.SELECTED=1]="SELECTED"}(ed||(ed={}));class Kn{get mediaType(){return new Map([["rect",Rn.DIMT_RECTANGLE],["quad",Rn.DIMT_QUADRILATERAL],["text",Rn.DIMT_TEXT],["arc",Rn.DIMT_ARC],["image",Rn.DIMT_IMAGE],["polygon",Rn.DIMT_POLYGON],["line",Rn.DIMT_LINE],["group",Rn.DIMT_GROUP]]).get(this._mediaType)}get styleSelector(){switch(j(this,pc,"f")){case ci.DIS_DEFAULT:return"default";case ci.DIS_SELECTED:return"selected"}}set drawingStyleId(a){this.styleId=a}get drawingStyleId(){return this.styleId}set coordinateBase(a){if(!["view","image"].includes(a))throw new Error("Invalid 'coordinateBase'.");this._drawingLayer&&("image"===j(this,wa,"f")&&"view"===a?this.updateCoordinateBaseFromImageToView():"view"===j(this,wa,"f")&&"image"===a&&this.updateCoordinateBaseFromViewToImage()),Me(this,wa,a,"f")}get coordinateBase(){return j(this,wa,"f")}get drawingLayerId(){return this._drawingLayerId}constructor(a,l){if(Jh.add(this),pc.set(this,void 0),wa.set(this,"image"),this._zIndex=null,this._drawingLayer=null,this._drawingLayerId=null,this._mapState_StyleId=new Map,this.mapEvent_Callbacks=new Map([["selected",new Map],["deselected",new Map],["mousedown",new Map],["mouseup",new Map],["dblclick",new Map],["mouseover",new Map],["mouseout",new Map]]),this.mapNoteName_Content=new Map([]),this.isDrawingItem=!0,null!=l&&!Ea(l))throw new TypeError("Invalid 'drawingStyleId'.");a&&this._setFabricObject(a),this.setState(ci.DIS_DEFAULT),this.styleId=l}_setFabricObject(a){this._fabricObject=a,this._fabricObject.on("selected",()=>{this.setState(ci.DIS_SELECTED)}),this._fabricObject.on("deselected",()=>{this._fabricObject.canvas&&this._fabricObject.canvas.getActiveObjects().includes(this._fabricObject)?this.setState(ci.DIS_SELECTED):this.setState(ci.DIS_DEFAULT),"textbox"===this._fabricObject.type&&(this._fabricObject.isEditing&&this._fabricObject.exitEditing(),this._fabricObject.selected=!1)}),a.getDrawingItem=()=>this}_getFabricObject(){return this._fabricObject}setState(a){Me(this,pc,a,"f")}getState(){return j(this,pc,"f")}_on(a,l){if(!l)return;const f=a.toLowerCase(),g=this.mapEvent_Callbacks.get(f);if(!g)throw new Error(`Event '${a}' does not exist.`);let p=g.get(l);p||(p=_=>{const y=_.e;if(!y)return void(l&&l.apply(this,[{targetItem:this,itemClientX:null,itemClientY:null,itemPageX:null,itemPageY:null}]));const b={targetItem:this,itemClientX:null,itemClientY:null,itemPageX:null,itemPageY:null};if(this._drawingLayer){let O,M,P,k;const V=y.target.getBoundingClientRect();O=V.left,M=V.top,P=O+window.scrollX,k=M+window.scrollY;const{width:H,height:z}=this._drawingLayer.fabricCanvas.lowerCanvasEl.getBoundingClientRect(),Y=this._drawingLayer.width,X=this._drawingLayer.height,$=H/z,K=Y/X,ge=this._drawingLayer._getObjectFit();let _e,Te,xe,F,Ee=1;if("contain"===ge)$<K?(Ee=H/Y,_e=O+this.get("x")*Ee,Te=M+this.get("y")*Ee+(z-X*Ee)/2,xe=P+this.get("x")*Ee,F=k+this.get("y")*Ee+(z-X*Ee)/2):(Ee=z/X,_e=O+this.get("x")*Ee+(H-Y*Ee)/2,Te=M+this.get("y")*Ee,xe=P+this.get("x")*Ee+(H-Y*Ee)/2,F=k+this.get("y")*Ee);else if("cover"===ge)if($<K){Ee=z/X;let ke=this.get("x")*Ee-(Y*Ee-H)/2;ke=Math.max(ke,0),ke=Math.min(ke,H),_e=O+ke,Te=M+this.get("y")*Ee,xe=P+ke,F=k+this.get("y")*Ee}else{Ee=H/Y;let ke=this.get("y")*Ee-(X*Ee-z)/2;ke=Math.max(ke,0),ke=Math.min(ke,z),_e=O+this.get("x")*Ee,Te=M+ke,xe=P+this.get("x")*Ee,F=k+ke}b.itemClientX=Math.round(_e),b.itemClientY=Math.round(Te),b.itemPageX=Math.round(xe),b.itemPageY=Math.round(F)}for(let O of Object.getOwnPropertyNames(b))Object.defineProperty(y,O,{value:b[O],writable:!0});l&&l.apply(this,[y])},g.set(l,p),this._fabricObject.on("dblclick"===f?"mousedblclick":f,p))}on(a,l){this._on(a,l)}_off(a,l){const f=a.toLowerCase(),g=this.mapEvent_Callbacks.get(f);if(!g)throw new Error(`Event '${a}' does not exist.`);let p=g.get(l);p&&(g.delete(l),this._fabricObject.off("dblclick"===f?"mousedblclick":f,p))}off(a,l){this._off(a,l)}_setEditable(a){const l=this._fabricObject;a?(l.selectable=!0,l.hasControls=!0,l.hoverCursor=null):(l.selectable=!1,l.hasControls=!1,l.hoverCursor="default")}hasNote(a){return this.mapNoteName_Content.has(a)}addNote(a,l){if(this.hasNote(a.name)&&!l)throw new Error("A note with the same name already exists, please use a different name.");const f=a.content?JSON.parse(JSON.stringify(a.content)):a.content;this.mapNoteName_Content.set(a.name,[f])}getNote(a){const l=this.mapNoteName_Content.get(a);return l?1===l.length?{name:a,content:l[0]?JSON.parse(JSON.stringify(l[0])):l[0]}:{name:a,content:JSON.parse(JSON.stringify(l))}:null}getNotes(){const a=[];for(let l of this.mapNoteName_Content){let f=1===l[1].length?l[1][0]:l[1];f=f&&JSON.parse(JSON.stringify(f)),a.push({name:l[0],content:f})}return a}updateNote(a,l,f){const g=this.mapNoteName_Content.get(a);if(!g)throw new Error("The note name does not exist.");f||(g.length=0),l=l&&JSON.parse(JSON.stringify(l)),g.push(l)}deleteNote(a){this.mapNoteName_Content.delete(a)}clearNotes(){this.mapNoteName_Content.clear()}set(a,l){if(!this.extendSet(a,l))if("x"===a){const f=this._fabricObject.group;f?(this._fabricObject.set("left",l-f.left-f.width/2),f.addWithUpdate()):this._fabricObject.set("left",l)}else if("y"===a){const f=this._fabricObject.group;f?(this._fabricObject.set("top",l-f.top-f.height/2),f.addWithUpdate()):this._fabricObject.set("top",l)}else"styleId"===a?this.styleId=l:this._fabricObject.set(a,l);["vertices","startPoint","endPoint","x","y","left","top","width","height","scaleX","scaleY","skewX","skewY","padding","angle","strokeWidth"].includes(a)&&this._fabricObject.setCoords()}get(a){let l=this.extendGet(a);if(void 0===l)if("x"===a){const f=this._fabricObject.group;l=f?this._fabricObject.get("left")+f.left+f.width/2:this._fabricObject.get("left")}else if("y"===a){const f=this._fabricObject.group;l=f?this._fabricObject.get("top")+f.top+f.height/2:this._fabricObject.get("top")}else l="scaledWidth"===a?this._fabricObject.getScaledWidth():"scaledHeight"===a?this._fabricObject.getScaledHeight():["type","mediaType"].includes(a)?this.mediaType:"state"===a?this.getState():"styleId"===a?this.styleId:"drawingLayerId"===a?this.drawingLayerId:this._fabricObject.get(a);return l}remove(){this._drawingLayer&&this._drawingLayer.removeDrawingItems([this])}convertPropFromImageToView(a){if("number"!=typeof a)throw new TypeError("Invalid value.");return a*j(this,Jh,"m",Jm).call(this)}convertPropFromViewToImage(a){if("number"!=typeof a)throw new TypeError("Invalid value.");return a/j(this,Jh,"m",Jm).call(this)}_setLineWidth(a){if(this._drawingLayer)if("view"===this.coordinateBase)this.set("strokeWidth",this.convertPropFromViewToImage(a));else{if("image"!==this.coordinateBase)throw new Error("Invalid 'coordinateBase'.");this.set("strokeWidth",a)}}_getLineWidth(){if(this._drawingLayer){if("view"===this.coordinateBase)return this.convertPropFromImageToView(this.get("strokeWidth"));if("image"===this.coordinateBase)return this.get("strokeWidth");throw new Error("Invalid 'coordinateBase'.")}}_setFontSize(a){if(this._drawingLayer)if("view"===this.coordinateBase)this.set("fontSize",this.convertPropFromViewToImage(a));else{if("image"!==this.coordinateBase)throw new Error("Invalid 'coordinateBase'.");this.set("fontSize",a)}}_getFontSize(){if(this._drawingLayer){if("view"===this.coordinateBase)return this.convertPropFromImageToView(this.get("fontSize"));if("image"===this.coordinateBase)return this.get("fontSize");throw new Error("Invalid 'coordinateBase'.")}}}pc=new WeakMap,wa=new WeakMap,Jh=new WeakSet,Jm=function(){const u=this._drawingLayer;if(!u)return 1;const a=u.width,l=u.height,{width:f,height:g}=u.fabricCanvas.wrapperEl.getBoundingClientRect();if(f<=0||g<=0)throw new Error("Unable to get drawing layer dimensions. Layer may not be rendered on the page.");const p=f/a,_=g/l,y=u._getObjectFit();let b=1;return"contain"===y?b=p<_?f/a:g/l:"cover"===y&&(b=p<_?g/l:f/a),b},Kn.arrMediaTypes=["rect","arc","polygon","image","text","line","quad"],Kn.mapItemType=new Map([[wr.ARC,"arc"],[wr.IMAGE,"image"],[wr.LINE,"line"],[wr.POLYGON,"polygon"],[wr.QUAD,"quad"],[wr.RECT,"rect"],[wr.TEXT,"text"],[wr.GROUP,"group"]]),Kn.arrStyleSelectors=["default","selected"],Kn.mapItemState=new Map([[ed.DEFAULT,"default"],[ed.SELECTED,"selected"]]);const xT=u=>null!==u&&"object"==typeof u&&!Array.isArray(u),e_=u=>!!Qm(u)&&""!==u,n_=u=>!(!qi(u)||!Kt(u.left)||u.left<0||!Kt(u.top)||u.top<0||!Kt(u.right)||u.right<0||!Kt(u.bottom)||u.bottom<0||u.left>=u.right||u.top>=u.bottom||!Vm(u.isMeasuredInPercentage)),RT=u=>!!qi(u)&&!!Bm(u.points)&&0!=u.points.length&&!u.points.some(a=>!va(a)),pj=va,OT=u=>!!qi(u)&&!!Bm(u.points)&&0!=u.points.length&&4==u.points.length&&!u.points.some(a=>!va(a)),Hr=u=>!(!qi(u)||!Kt(u.x)||!Kt(u.y)||!Kt(u.width)||u.width<0||!Kt(u.height)||u.height<0||"isMeasuredInPercentage"in u&&!Vm(u.isMeasuredInPercentage)),MT=u=>!(!xT(u)||"id"in u&&!Ea(u.id)||"lineWidth"in u&&!Ea(u.lineWidth)||"fillStyle"in u&&!e_(u.fillStyle)||"strokeStyle"in u&&!e_(u.strokeStyle)||"paintMode"in u&&!["fill","stroke","strokeAndFill"].includes(u.paintMode)||"fontFamily"in u&&!e_(u.fontFamily)||"fontSize"in u&&!Ea(u.fontSize));class td{static convert(a,l,f){const g={x:0,y:0,width:l,height:f};if(!a)return g;if(Hr(a))a.isMeasuredInPercentage?(g.x=a.x/100*l,g.y=a.y/100*f,g.width=a.width/100*l,g.height=a.height/100*f):(g.x=a.x,g.y=a.y,g.width=a.width,g.height=a.height);else{if(!n_(a))throw TypeError("Invalid region.");a.isMeasuredInPercentage?(g.x=a.left/100*l,g.y=a.top/100*f,g.width=(a.right-a.left)/100*l,g.height=(a.bottom-a.top)/100*f):(g.x=a.left,g.y=a.top,g.width=a.right-a.left,g.height=a.bottom-a.top)}return g.x=Math.round(g.x),g.y=Math.round(g.y),g.width=Math.round(g.width),g.height=Math.round(g.height),g}}var ho,nd;class LT{constructor(){ho.set(this,new Map),nd.set(this,!1)}get disposed(){return j(this,nd,"f")}on(a,l){a=a.toLowerCase();const f=j(this,ho,"f").get(a);if(f){if(f.includes(l))return;f.push(l)}else j(this,ho,"f").set(a,[l])}off(a,l){a=a.toLowerCase();const f=j(this,ho,"f").get(a);if(!f)return;const g=f.indexOf(l);-1!==g&&f.splice(g,1)}offAll(a){a=a.toLowerCase();const l=j(this,ho,"f").get(a);l&&(l.length=0)}fire(a,l=[],f={async:!1,copy:!0}){l||(l=[]),a=a.toLowerCase();const g=j(this,ho,"f").get(a);if(g&&g.length){f=Object.assign({async:!1,copy:!0},f);for(let p of g){if(!p)continue;let _=[];if(f.copy)for(let b of l){try{b=JSON.parse(JSON.stringify(b))}catch(O){}_.push(b)}else _=l;let y=!1;if(f.async)setTimeout(()=>{this.disposed||g.includes(p)&&p.apply(f.target,_)},0);else try{y=p.apply(f.target,_)}catch(b){}if(!0===y)break}}}dispose(){Me(this,nd,!0,"f")}}function mj(u,a,l){return(l.x-u.x)*(a.y-u.y)==(a.x-u.x)*(l.y-u.y)&&Math.min(u.x,a.x)<=l.x&&l.x<=Math.max(u.x,a.x)&&Math.min(u.y,a.y)<=l.y&&l.y<=Math.max(u.y,a.y)}function i_(u){return Math.abs(u)<1e-6?0:u<0?-1:1}function id(u,a,l,f){let g=u[0]*(l[1]-a[1])+a[0]*(u[1]-l[1])+l[0]*(a[1]-u[1]),p=u[0]*(f[1]-a[1])+a[0]*(u[1]-f[1])+f[0]*(a[1]-u[1]);return!((g^p)>=0&&0!==g&&0!==p||(g=l[0]*(u[1]-f[1])+f[0]*(l[1]-u[1])+u[0]*(f[1]-l[1]),p=l[0]*(a[1]-f[1])+f[0]*(l[1]-a[1])+a[0]*(f[1]-l[1]),(g^p)>=0&&0!==g&&0!==p))}ho=new WeakMap,nd=new WeakMap;const r_=function(){var u=ae(function*(a){if("string"!=typeof a)throw new TypeError("Invalid url.");const l=yield fetch(a);if(!l.ok)throw Error("Network Error: "+l.statusText);const f=yield l.text();if(!f.trim().startsWith("<"))throw Error("Unable to get valid HTMLElement.");const g=document.createElement("div");g.insertAdjacentHTML("beforeend",f);for(let p=0;p<g.childElementCount;++p){let _=g.children[p];_ instanceof HTMLStyleElement&&document.head.append(_)}return 1==g.childElementCount?g.children[0]:g});return function(l){return u.apply(this,arguments)}}();var Is,xs,Rs;class ba extends Kn{constructor(a,l){if(super(null,l),Is.set(this,void 0),!Hr(a))throw new TypeError("Invalid 'rect'.");this._setFabricObject(new ot.Rect({left:a.x,top:a.y,width:a.width,height:a.height})),Me(this,Is,JSON.parse(JSON.stringify(a)),"f"),this._mediaType="rect"}extendSet(a,l){return!1}extendGet(a){}updateCoordinateBaseFromImageToView(){this.set("left",this.convertPropFromViewToImage(this.get("left"))),this.set("top",this.convertPropFromViewToImage(this.get("top"))),this.set("width",this.convertPropFromViewToImage(this.get("scaledWidth"))),this.set("height",this.convertPropFromViewToImage(this.get("scaledHeight")))}updateCoordinateBaseFromViewToImage(){this.set("left",this.convertPropFromImageToView(this.get("left"))),this.set("top",this.convertPropFromImageToView(this.get("top"))),this.set("width",this.convertPropFromImageToView(this.get("scaledWidth"))),this.set("height",this.convertPropFromImageToView(this.get("scaledHeight")))}setPosition(a){this.setRect(a)}getPosition(){return this.getRect()}updatePosition(){j(this,Is,"f")&&this.setRect(j(this,Is,"f"))}setRect(a){if(!Hr(a))throw new TypeError("Invalid 'rect'.");if(this._drawingLayer){if("view"===this.coordinateBase)this.set("left",this.convertPropFromViewToImage(a.x)),this.set("top",this.convertPropFromViewToImage(a.y)),this.set("width",this.convertPropFromViewToImage(a.width)),this.set("height",this.convertPropFromViewToImage(a.height));else{if("image"!==this.coordinateBase)throw new Error("Invalid 'coordinateBase'.");this.set("left",a.x),this.set("top",a.y),this.set("width",a.width),this.set("height",a.height)}this._drawingLayer.renderAll()}else Me(this,Is,JSON.parse(JSON.stringify(a)),"f")}getRect(){if(this._drawingLayer){if("view"===this.coordinateBase)return{x:this.convertPropFromImageToView(this.get("left")),y:this.convertPropFromImageToView(this.get("top")),width:this.convertPropFromImageToView(this.get("scaledWidth")),height:this.convertPropFromImageToView(this.get("scaledHeight"))};if("image"===this.coordinateBase)return{x:this.get("left"),y:this.get("top"),width:this.get("scaledWidth"),height:this.get("scaledHeight")};throw new Error("Invalid 'coordinateBase'.")}return j(this,Is,"f")?JSON.parse(JSON.stringify(j(this,Is,"f"))):null}}function s_(u,a,l){return ot.util.transformPoint({x:l.points[this.pointIndex].x-l.pathOffset.x,y:l.points[this.pointIndex].y-l.pathOffset.y},l.calcTransformMatrix())}function FT(u){let a=new ot.Point(u.strokeUniform?1/u.scaleX:1,u.strokeUniform?1/u.scaleY:1).multiply(u.strokeWidth);return new ot.Point(u.width+a.x,u.height+a.y)}function o_(u,a,l,f){let g=a.target,p=g.controls[g.__corner],_=g.toLocalPoint(new ot.Point(l,f),"center","center"),y=FT(g),b=g._getTransformedDimensions(0,0);return g.points[p.pointIndex]={x:_.x*y.x/b.x+g.pathOffset.x,y:_.y*y.y/b.y+g.pathOffset.y},ot.controlsUtils.fireEvent("scaling",{e:u,transform:a,pointer:{x:l,y:f}}),!0}function a_(u,a){return function(l,f,g,p){let _=f.target,y=ot.util.transformPoint({x:_.points[u].x-_.pathOffset.x,y:_.points[u].y-_.pathOffset.y},_.calcTransformMatrix()),b=a(l,f,g,p);_._setPositionDimensions({});let O=FT(_);return _.setPositionByOrigin(y,(_.points[u].x-_.pathOffset.x)/O.x+.5,(_.points[u].y-_.pathOffset.y)/O.y+.5),b}}Is=new WeakMap;class l_ extends Kn{constructor(a,l){if(super(null,l),xs.set(this,void 0),!RT(a))throw new TypeError("Invalid 'polygon'.");this._setFabricObject(new ot.Polygon(a.points,{objectCaching:!1}));const f=this._fabricObject;let g=f.points.length-1;f.controls=f.points.reduce(function(p,_,y){return p["p"+y]=new ot.Control({positionHandler:s_,actionHandler:a_(y>0?y-1:g,o_),actionName:"modifyPolygon",pointIndex:y}),p},{}),Me(this,xs,JSON.parse(JSON.stringify(a)),"f"),this._mediaType="polygon"}extendSet(a,l){if("vertices"===a){const f=this._fabricObject;if(f.group){const p=f.group;f.points=l.map(_=>({x:_.x-p.left-p.width/2,y:_.y-p.top-p.height/2})),p.addWithUpdate()}else f.points=l;const g=f.points.length-1;return f.controls=f.points.reduce(function(p,_,y){return p["p"+y]=new ot.Control({positionHandler:s_,actionHandler:a_(y>0?y-1:g,o_),actionName:"modifyPolygon",pointIndex:y}),p},{}),f._setPositionDimensions({}),!0}}extendGet(a){if("vertices"===a){const l=[],f=this._fabricObject;if(f.selectable&&!f.group)for(let g in f.oCoords)l.push({x:f.oCoords[g].x,y:f.oCoords[g].y});else for(let g of f.points){const y=ot.util.transformPoint({x:g.x-f.pathOffset.x,y:g.y-f.pathOffset.y},f.calcTransformMatrix());l.push({x:y.x,y:y.y})}return l}}updateCoordinateBaseFromImageToView(){const a=this.get("vertices").map(l=>({x:this.convertPropFromViewToImage(l.x),y:this.convertPropFromViewToImage(l.y)}));this.set("vertices",a)}updateCoordinateBaseFromViewToImage(){const a=this.get("vertices").map(l=>({x:this.convertPropFromImageToView(l.x),y:this.convertPropFromImageToView(l.y)}));this.set("vertices",a)}setPosition(a){this.setPolygon(a)}getPosition(){return this.getPolygon()}updatePosition(){j(this,xs,"f")&&this.setPolygon(j(this,xs,"f"))}setPolygon(a){if(!RT(a))throw new TypeError("Invalid 'polygon'.");if(this._drawingLayer){if("view"===this.coordinateBase){const l=a.points.map(f=>({x:this.convertPropFromViewToImage(f.x),y:this.convertPropFromViewToImage(f.y)}));this.set("vertices",l)}else{if("image"!==this.coordinateBase)throw new Error("Invalid 'coordinateBase'.");this.set("vertices",a.points)}this._drawingLayer.renderAll()}else Me(this,xs,JSON.parse(JSON.stringify(a)),"f")}getPolygon(){if(this._drawingLayer){if("view"===this.coordinateBase)return{points:this.get("vertices").map(a=>({x:this.convertPropFromImageToView(a.x),y:this.convertPropFromImageToView(a.y)}))};if("image"===this.coordinateBase)return{points:this.get("vertices")};throw new Error("Invalid 'coordinateBase'.")}return j(this,xs,"f")?JSON.parse(JSON.stringify(j(this,xs,"f"))):null}}xs=new WeakMap;const PT=u=>{let a=u.split("\n").map(f=>f.split("\t"));return(l=>{for(let f=0;;f++){let g=-1;for(let p=0;p<l.length;p++){let _=l[p][f];void 0!==_&&_.length>g&&(g=_.length)}if(-1===g)break;for(let p=0;p<l.length;p++){if(f>=l[p].length-1)continue;let _=" ".repeat(g+2-l[p][f].length);l[p][f]=l[p][f].concat(_)}}})(a),(l=>{let f="";for(let g=0;g<l.length;g++)f=f.concat(...l[g],g===l.length-1?"":"\n");return f})(a)};class _j extends Kn{constructor(a,l,f){if(super(null,f),Rs.set(this,void 0),!Qm(a))throw new TypeError("Invalid 'text'.");if(!Hr(l))throw new TypeError("Invalid 'rect'.");this._setFabricObject(new ot.Textbox(PT(a),{left:l.x,top:l.y,width:l.width})),this._text=a,Me(this,Rs,JSON.parse(JSON.stringify(l)),"f"),this._mediaType="text"}extendSet(a,l){if("text"===a)return this._text=l,this._fabricObject.set("text",PT(l)),!0}extendGet(a){if("text"===a)return this._text}updateCoordinateBaseFromImageToView(){this.set("left",this.convertPropFromViewToImage(this.get("left"))),this.set("top",this.convertPropFromViewToImage(this.get("top"))),this.set("width",this.convertPropFromViewToImage(this.get("scaledWidth")))}updateCoordinateBaseFromViewToImage(){this.set("left",this.convertPropFromImageToView(this.get("left"))),this.set("top",this.convertPropFromImageToView(this.get("top"))),this.set("width",this.convertPropFromImageToView(this.get("scaledWidth")))}setPosition(a){this.setTextRect(a)}getPosition(){return this.getTextRect()}updatePosition(){j(this,Rs,"f")&&this.setTextRect(j(this,Rs,"f"))}setText(a){if(!Qm(a))throw new TypeError("Invalid 'text'.");this.set("text",a)}getText(){return this.get("text")}setTextRect(a){if(!Hr(a))throw new TypeError("Invalid 'rect'.");if(this._drawingLayer){if("view"===this.coordinateBase)this.set("left",this.convertPropFromViewToImage(a.x)),this.set("top",this.convertPropFromViewToImage(a.y)),this.set("width",this.convertPropFromViewToImage(a.width));else{if("image"!==this.coordinateBase)throw new Error("Invalid 'coordinateBase'.");this.set("left",a.x),this.set("top",a.y),this.set("width",a.width)}this._drawingLayer.renderAll()}else Me(this,Rs,JSON.parse(JSON.stringify(a)),"f")}getTextRect(){if(this._drawingLayer){if("view"===this.coordinateBase)return{x:this.convertPropFromImageToView(this.get("left")),y:this.convertPropFromImageToView(this.get("top")),width:this.convertPropFromImageToView(this.get("scaledWidth")),height:this.convertPropFromImageToView(this.get("scaledHeight"))};if("image"===this.coordinateBase)return{x:this.get("left"),y:this.get("top"),width:this.get("scaledWidth"),height:this.get("scaledHeight")};throw new Error("Invalid 'coordinateBase'.")}return j(this,Rs,"f")?JSON.parse(JSON.stringify(j(this,Rs,"f"))):null}}var Ms,Ls,Da,c_,Sa,mc,Ta,ui,_c,vc,yc,NT,kT,BT,VT,rd,It,Cc,Ec,wc,dn,sd,od,ad,Fs,bc,Dc,u_,hi,ld,jT,h_,d_,Sc,cd;Rs=new WeakMap;class vj extends l_{constructor(a,l){if(super({points:null==a?void 0:a.points},l),Ms.set(this,void 0),!OT(a))throw new TypeError("Invalid 'quad'.");Me(this,Ms,JSON.parse(JSON.stringify(a)),"f"),this._mediaType="quad"}setPosition(a){this.setQuad(a)}getPosition(){return this.getQuad()}updatePosition(){j(this,Ms,"f")&&this.setQuad(j(this,Ms,"f"))}setPolygon(){}getPolygon(){return null}setQuad(a){if(!OT(a))throw new TypeError("Invalid 'quad'.");if(this._drawingLayer){if("view"===this.coordinateBase){const l=a.points.map(f=>({x:this.convertPropFromViewToImage(f.x),y:this.convertPropFromViewToImage(f.y)}));this.set("vertices",l)}else{if("image"!==this.coordinateBase)throw new Error("Invalid 'coordinateBase'.");this.set("vertices",a.points)}this._drawingLayer.renderAll()}else Me(this,Ms,JSON.parse(JSON.stringify(a)),"f")}getQuad(){if(this._drawingLayer){if("view"===this.coordinateBase)return{points:this.get("vertices").map(a=>({x:this.convertPropFromImageToView(a.x),y:this.convertPropFromImageToView(a.y)}))};if("image"===this.coordinateBase)return{points:this.get("vertices")};throw new Error("Invalid 'coordinateBase'.")}return j(this,Ms,"f")?JSON.parse(JSON.stringify(j(this,Ms,"f"))):null}}Ms=new WeakMap;class yj extends Kn{constructor(a){super(new ot.Group(a.map(l=>l._getFabricObject()))),this._fabricObject.on("selected",()=>{this.setState(ci.DIS_SELECTED);const l=this._fabricObject._objects;for(let f of l)setTimeout(()=>{f&&f.fire("selected")},0);setTimeout(()=>{this._fabricObject&&this._fabricObject.canvas&&(this._fabricObject.dirty=!0,this._fabricObject.canvas.renderAll())},0)}),this._fabricObject.on("deselected",()=>{this.setState(ci.DIS_DEFAULT);const l=this._fabricObject._objects;for(let f of l)setTimeout(()=>{f&&f.fire("deselected")},0);setTimeout(()=>{this._fabricObject&&this._fabricObject.canvas&&(this._fabricObject.dirty=!0,this._fabricObject.canvas.renderAll())},0)}),this._mediaType="group"}extendSet(a,l){return!1}extendGet(a){}updateCoordinateBaseFromImageToView(){}updateCoordinateBaseFromViewToImage(){}setPosition(){}getPosition(){}updatePosition(){}getChildDrawingItems(){return this._fabricObject._objects.map(a=>a.getDrawingItem())}setChildDrawingItems(a){if(!a||!a.isDrawingItem)throw TypeError("Illegal drawing item.");this._drawingLayer?this._drawingLayer._updateGroupItem(this,a,"add"):this._fabricObject.addWithUpdate(a._getFabricObject())}removeChildItem(a){a&&a.isDrawingItem&&(this._drawingLayer?this._drawingLayer._updateGroupItem(this,a,"remove"):this._fabricObject.removeWithUpdate(a._getFabricObject()))}}class Ce{static createDrawingStyle(a){if(!MT(a))throw new Error("Invalid style definition.");let l,f=Ce.USER_START_STYLE_ID;for(;j(Ce,Ls,"f",Da).has(f);)f++;l=f;const g=JSON.parse(JSON.stringify(a));g.id=l;for(let p in j(Ce,Ls,"f",c_))g.hasOwnProperty(p)||(g[p]=j(Ce,Ls,"f",c_)[p]);return j(Ce,Ls,"f",Da).set(l,g),g.id}static _getDrawingStyle(a,l){if("number"!=typeof a)throw new Error("Invalid style id.");const f=j(Ce,Ls,"f",Da).get(a);return f?l?JSON.parse(JSON.stringify(f)):f:null}static getDrawingStyle(a){return this._getDrawingStyle(a,!0)}static getAllDrawingStyles(){return JSON.parse(JSON.stringify(Array.from(j(Ce,Ls,"f",Da).values())))}static _updateDrawingStyle(a,l){if(!MT(l))throw new Error("Invalid style definition.");const f=j(Ce,Ls,"f",Da).get(a);if(f)for(let g in l)f.hasOwnProperty(g)&&(f[g]=l[g])}static updateDrawingStyle(a,l){this._updateDrawingStyle(a,l)}}Ls=Ce,Ce.STYLE_BLUE_STROKE=1,Ce.STYLE_GREEN_STROKE=2,Ce.STYLE_ORANGE_STROKE=3,Ce.STYLE_YELLOW_STROKE=4,Ce.STYLE_BLUE_STROKE_FILL=5,Ce.STYLE_GREEN_STROKE_FILL=6,Ce.STYLE_ORANGE_STROKE_FILL=7,Ce.STYLE_YELLOW_STROKE_FILL=8,Ce.STYLE_BLUE_STROKE_TRANSPARENT=9,Ce.STYLE_GREEN_STROKE_TRANSPARENT=10,Ce.STYLE_ORANGE_STROKE_TRANSPARENT=11,Ce.USER_START_STYLE_ID=1024,Da={value:new Map([[Ce.STYLE_BLUE_STROKE,{id:Ce.STYLE_BLUE_STROKE,lineWidth:4,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_GREEN_STROKE,{id:Ce.STYLE_GREEN_STROKE,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_ORANGE_STROKE,{id:Ce.STYLE_ORANGE_STROKE,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_YELLOW_STROKE,{id:Ce.STYLE_YELLOW_STROKE,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_BLUE_STROKE_FILL,{id:Ce.STYLE_BLUE_STROKE_FILL,lineWidth:4,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_GREEN_STROKE_FILL,{id:Ce.STYLE_GREEN_STROKE_FILL,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_ORANGE_STROKE_FILL,{id:Ce.STYLE_ORANGE_STROKE_FILL,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_YELLOW_STROKE_FILL,{id:Ce.STYLE_YELLOW_STROKE_FILL,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_BLUE_STROKE_TRANSPARENT,{id:Ce.STYLE_BLUE_STROKE_TRANSPARENT,lineWidth:4,fillStyle:"rgba(73, 245, 73, 0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_GREEN_STROKE_TRANSPARENT,{id:Ce.STYLE_GREEN_STROKE_TRANSPARENT,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[Ce.STYLE_ORANGE_STROKE_TRANSPARENT,{id:Ce.STYLE_ORANGE_STROKE_TRANSPARENT,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}]])},c_={value:{lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}},"undefined"!=typeof document&&"undefined"!=typeof window&&(ot.StaticCanvas.prototype.dispose=function(){return this.isRendering&&(ot.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(u){u.dispose&&u.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),ot.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},ot.Object.prototype.transparentCorners=!1,ot.Object.prototype.cornerSize=20,ot.Object.prototype.touchCornerSize=100,ot.Object.prototype.cornerColor="rgb(254,142,20)",ot.Object.prototype.cornerStyle="circle",ot.Object.prototype.strokeUniform=!0,ot.Object.prototype.hasBorders=!1,ot.Canvas.prototype.containerClass="",ot.Canvas.prototype.getPointer=function(u,a){if(this._absolutePointer&&!a)return this._absolutePointer;if(this._pointer&&a)return this._pointer;var l,f=this.upperCanvasEl,g=ot.util.getPointer(u,f),p=f.getBoundingClientRect(),_=p.width||0,y=p.height||0;_&&y||("top"in p&&"bottom"in p&&(y=Math.abs(p.top-p.bottom)),"right"in p&&"left"in p&&(_=Math.abs(p.right-p.left))),this.calcOffset(),g.x=g.x-this._offset.left,g.y=g.y-this._offset.top,a||(g=this.restorePointerVpt(g));var b=this.getRetinaScaling();if(1!==b&&(g.x/=b,g.y/=b),0!==_&&0!==y){var O=window.getComputedStyle(f).objectFit,M=f.width,P=f.height;l={width:M/_,height:P/y};var Y=M/P,X=_/y;return"contain"===O?Y>X?{x:g.x*l.width,y:(g.y-(y-_/Y)/2)*l.width}:{x:(g.x-(_-y*Y)/2)*l.height,y:g.y*l.height}:"cover"===O?Y>X?{x:(M-l.height*_)/2+g.x*l.height,y:g.y*l.height}:{x:g.x*l.width,y:(P-l.width*y)/2+g.y*l.width}:{x:g.x*l.width,y:g.y*l.height}}return{x:g.x*(l={width:1,height:1}).width,y:g.y*l.height}},ot.Canvas.prototype._onTouchStart=function(u){var a=this.findTarget(u);!this.allowTouchScrolling&&u.cancelable&&u.preventDefault&&u.preventDefault(),a&&u.cancelable&&u.preventDefault&&u.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(u)),this.__onMouseDown(u),this._resetTransformEventData();var l=this.upperCanvasEl,f=this._getEventPrefix();ot.util.addListener(ot.document,"touchend",this._onTouchEnd,{passive:!1}),ot.util.addListener(ot.document,"touchmove",this._onMouseMove,{passive:!1}),ot.util.removeListener(l,f+"down",this._onMouseDown)},ot.Textbox.prototype._wrapLine=function(u,a,l,f){const g=u.match(/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/g);var _=0,y=this.splitByGrapheme||!(!g||!g.length),b=[],O=[],M=y?ot.util.string.graphemeSplit(u):u.split(this._wordJoiners),P="",k=0,V=y?"":" ",H=0,z=0,Y=0,X=!0,$=this._getWidthOfCharSpacing();f=f||0,0===M.length&&M.push([]),l-=f;for(var K=0;K<M.length;K++)P=y?M[K]:ot.util.string.graphemeSplit(M[K]),H=this._measureWord(P,a,k),k+=P.length,(_+=z+H-$)>l&&!X?(b.push(O),O=[],_=H,X=!0):_+=$,X||y||O.push(V),O=O.concat(P),z=y?0:this._measureWord([V],a,k),k++,X=!1,H>Y&&(Y=H);return K&&b.push(O),Y+f>this.dynamicMinWidth&&(this.dynamicMinWidth=Y-$+f),b});class jt{get width(){return this.fabricCanvas.width}get height(){return this.fabricCanvas.height}set _allowMultiSelect(a){this.fabricCanvas.selection=a,this.fabricCanvas.renderAll()}get _allowMultiSelect(){return this.fabricCanvas.selection}constructor(a,l,f){if(this.mapType_StateAndStyleId=new Map,this.mode="viewer",this.onSelectionChanged=null,this._arrDrwaingItem=[],this._arrFabricObject=[],this._visible=!0,a.hasOwnProperty("getFabricCanvas"))this.fabricCanvas=a.getFabricCanvas();else{let _=this.fabricCanvas=new ot.Canvas(a,Object.assign(f,{allowTouchScrolling:!0,selection:!1}));_.setDimensions({width:"100%",height:"100%"},{cssOnly:!0}),_.lowerCanvasEl.className="",_.upperCanvasEl.className="",_.on("selection:created",function(y){const b=y.selected,O=[];for(let M of b){const P=M.getDrawingItem()._drawingLayer;P&&!O.includes(P)&&O.push(P)}for(let M of O){const P=[];for(let k of b){const V=k.getDrawingItem();V._drawingLayer===M&&P.push(V)}setTimeout(()=>{M.onSelectionChanged&&M.onSelectionChanged(P,[])},0)}}),_.on("before:selection:cleared",function(y){const b=this.getActiveObjects(),O=[];for(let M of b){const P=M.getDrawingItem()._drawingLayer;P&&!O.includes(P)&&O.push(P)}for(let M of O){const P=[];for(let k of b){const V=k.getDrawingItem();V._drawingLayer===M&&P.push(V)}setTimeout(()=>{const k=[];for(let V of P)M.hasDrawingItem(V)&&k.push(V);k.length>0&&M.onSelectionChanged&&M.onSelectionChanged([],k)},0)}}),_.on("selection:updated",function(y){const b=y.selected,O=y.deselected,M=[];for(let P of b){const k=P.getDrawingItem()._drawingLayer;k&&!M.includes(k)&&M.push(k)}for(let P of O){const k=P.getDrawingItem()._drawingLayer;k&&!M.includes(k)&&M.push(k)}for(let P of M){const k=[],V=[];for(let H of b){const z=H.getDrawingItem();z._drawingLayer===P&&k.push(z)}for(let H of O){const z=H.getDrawingItem();z._drawingLayer===P&&V.push(z)}setTimeout(()=>{P.onSelectionChanged&&P.onSelectionChanged(k,V)},0)}}),_.wrapperEl.style.position="absolute",a.getFabricCanvas=()=>this.fabricCanvas}let g,p;switch(this.id=l,l){case jt.DDN_LAYER_ID:g=Ce.getDrawingStyle(Ce.STYLE_BLUE_STROKE),p=Ce.getDrawingStyle(Ce.STYLE_BLUE_STROKE_FILL);break;case jt.DBR_LAYER_ID:g=Ce.getDrawingStyle(Ce.STYLE_ORANGE_STROKE),p=Ce.getDrawingStyle(Ce.STYLE_ORANGE_STROKE_FILL);break;case jt.DLR_LAYER_ID:g=Ce.getDrawingStyle(Ce.STYLE_GREEN_STROKE),p=Ce.getDrawingStyle(Ce.STYLE_GREEN_STROKE_FILL);break;default:g=Ce.getDrawingStyle(Ce.STYLE_YELLOW_STROKE),p=Ce.getDrawingStyle(Ce.STYLE_YELLOW_STROKE_FILL)}for(let _ of Kn.arrMediaTypes)this.mapType_StateAndStyleId.set(_,{default:g.id,selected:p.id})}getId(){return this.id}setVisible(a){if(a){for(let l of this._arrFabricObject)l.visible=!0,l.hasControls=!0;this._visible=!0}else{for(let l of this._arrFabricObject)l.visible=!1,l.hasControls=!1;this._visible=!1}this.fabricCanvas.renderAll()}isVisible(){return this._visible}_getItemCurrentStyle(a){return a.styleId?Ce.getDrawingStyle(a.styleId):Ce.getDrawingStyle(a._mapState_StyleId.get(a.styleSelector))||null}_changeMediaTypeCurStyleInStyleSelector(a,l,f,g){const p=this.getDrawingItems(_=>_._mediaType===a);for(let _ of p)_.styleSelector===l&&this._changeItemStyle(_,f,!0);g||this.fabricCanvas.renderAll()}_changeItemStyle(a,l,f){if(!a||!l)return;const g=a._getFabricObject();"number"==typeof a.styleId&&(l=Ce.getDrawingStyle(a.styleId)),g.strokeWidth=l.lineWidth,"fill"===l.paintMode?(g.fill=l.fillStyle,g.stroke=l.fillStyle):"stroke"===l.paintMode?(g.fill="transparent",g.stroke=l.strokeStyle):"strokeAndFill"===l.paintMode&&(g.fill=l.fillStyle,g.stroke=l.strokeStyle),g.fontFamily&&(g.fontFamily=l.fontFamily),g.fontSize&&(g.fontSize=l.fontSize),g.group||(g.dirty=!0),f||this.fabricCanvas.renderAll()}_updateGroupItem(a,l,f){if(!a||!l)return;const g=a.getChildDrawingItems();if("add"===f){if(g.includes(l))return;const p=l._getFabricObject();if(this.fabricCanvas.getObjects().includes(p)){if(!this._arrFabricObject.includes(p))throw new Error("Existed in other drawing layers.");l._zIndex=null}else{let _;if(l.styleId)_=Ce.getDrawingStyle(l.styleId);else{const y=this.mapType_StateAndStyleId.get(l._mediaType);_=Ce.getDrawingStyle(y[a.styleSelector]);const b=()=>{this._changeItemStyle(l,Ce.getDrawingStyle(this.mapType_StateAndStyleId.get(l._mediaType).selected),!0)},O=()=>{this._changeItemStyle(l,Ce.getDrawingStyle(this.mapType_StateAndStyleId.get(l._mediaType).default),!0)};l._on("selected",b),l._on("deselected",O),l._funcChangeStyleToSelected=b,l._funcChangeStyleToDefault=O}l._drawingLayer=this,l._drawingLayerId=this.id,this._changeItemStyle(l,_,!0)}a._fabricObject.addWithUpdate(l._getFabricObject())}else{if("remove"!==f||!g.includes(l))return;l._zIndex=null,l._drawingLayer=null,l._drawingLayerId=null,l._off("selected",l._funcChangeStyleToSelected),l._off("deselected",l._funcChangeStyleToDefault),l._funcChangeStyleToSelected=null,l._funcChangeStyleToDefault=null,a._fabricObject.removeWithUpdate(l._getFabricObject())}this.fabricCanvas.renderAll()}_addDrawingItem(a,l){if(!(a instanceof Kn))throw new TypeError("Invalid 'drawingItem'.");if(a._drawingLayer){if(a._drawingLayer==this)return;throw new Error("This drawing item has existed in other layer.")}let f=a._getFabricObject();const g=this.fabricCanvas.getObjects();let p,_;if(g.includes(f)){if(this._arrFabricObject.includes(f))return;throw new Error("Existed in other drawing layers.")}if("group"===a._mediaType){p=a.getChildDrawingItems();for(let O of p)if(O._drawingLayer&&O._drawingLayer!==this)throw new Error("The childItems of DT_Group have existed in other drawing layers.")}if(l&&"object"==typeof l&&!Array.isArray(l))for(let O in l)f.set(O,l[O]);if(p){for(let O of p){const M=this.mapType_StateAndStyleId.get(O._mediaType);for(let P of Kn.arrStyleSelectors)O._mapState_StyleId.set(P,M[P]);if(O.styleId)_=Ce.getDrawingStyle(O.styleId);else{_=Ce.getDrawingStyle(M.default);const P=()=>{this._changeItemStyle(O,Ce.getDrawingStyle(this.mapType_StateAndStyleId.get(O._mediaType).selected),!0)},k=()=>{this._changeItemStyle(O,Ce.getDrawingStyle(this.mapType_StateAndStyleId.get(O._mediaType).default),!0)};O._on("selected",P),O._on("deselected",k),O._funcChangeStyleToSelected=P,O._funcChangeStyleToDefault=k}O._drawingLayer=this,O._drawingLayerId=this.id,this._changeItemStyle(O,_,!0)}f.dirty=!0,this.fabricCanvas.renderAll()}else{const O=this.mapType_StateAndStyleId.get(a._mediaType);for(let M of Kn.arrStyleSelectors)a._mapState_StyleId.set(M,O[M]);if(a.styleId)_=Ce.getDrawingStyle(a.styleId);else{_=Ce.getDrawingStyle(O.default);const M=()=>{this._changeItemStyle(a,Ce.getDrawingStyle(this.mapType_StateAndStyleId.get(a._mediaType).selected))},P=()=>{this._changeItemStyle(a,Ce.getDrawingStyle(this.mapType_StateAndStyleId.get(a._mediaType).default))};a._on("selected",M),a._on("deselected",P),a._funcChangeStyleToSelected=M,a._funcChangeStyleToDefault=P}this._changeItemStyle(a,_)}a._zIndex=this.id,a._drawingLayer=this,a._drawingLayerId=this.id;const y=this._arrFabricObject.length;let b=g.length;if(y)b=g.indexOf(this._arrFabricObject[y-1])+1;else for(let O=0;O<g.length;O++)if(a._zIndex<g[O].getDrawingItem()._zIndex){b=O;break}this._arrDrwaingItem.push(a),this._arrFabricObject.push(f),f.visible=!!this._visible,this.fabricCanvas.insertAt(f,b,!1)}addDrawingItem(a){if(!a||!a.isDrawingItem)throw TypeError("Illegal drawing item.");if("viewer"===this.mode)a._setEditable(!1);else{if("editor"!==this.mode)throw new Error("Illegal 'mode'.");a._setEditable(!0)}this._addDrawingItem(a),a.updatePosition()}addDrawingItems(a){for(let l of a)this.addDrawingItem(l)}removeDrawingItem(a){if(!a||!a.isDrawingItem)throw TypeError("Illegal drawing item.");if(!this.hasDrawingItem(a))return;if(a._zIndex=null,a._drawingLayer=null,a._drawingLayerId=null,"group"===a._mediaType){const f=a.getChildDrawingItems();for(let g of f)g._zIndex=null,g._drawingLayer=null,g._drawingLayerId=null,g._off("selected",g._funcChangeStyleToSelected),g._off("deselected",g._funcChangeStyleToDefault),g._funcChangeStyleToSelected=null,g._funcChangeStyleToDefault=null,g._mapState_StyleId.clear()}else a._off("selected",a._funcChangeStyleToSelected),a._off("deselected",a._funcChangeStyleToDefault),a._funcChangeStyleToSelected=null,a._funcChangeStyleToDefault=null,a._mapState_StyleId.clear();const l=a._getFabricObject();"selected"===a.styleSelector&&(l.group?l.group.removeWithUpdate(l):this.fabricCanvas._activeObject=null,a.setState(ci.DIS_DEFAULT)),this.fabricCanvas.remove(l),this._arrDrwaingItem.splice(this._arrDrwaingItem.indexOf(a),1),this._arrFabricObject.splice(this._arrFabricObject.indexOf(l),1)}removeDrawingItems(a){for(let l of a)this.removeDrawingItem(l)}setDrawingItems(a){this.clearDrawingItems(),this.addDrawingItems(a)}getDrawingItems(a){return a&&"function"==typeof a?this._arrDrwaingItem.filter(a):Array.from(this._arrDrwaingItem)}getSelectedDrawingItems(){const a=this.fabricCanvas.getActiveObjects(),l=[];for(let f of a)this._arrFabricObject.includes(f)&&l.push(f.getDrawingItem());return l}hasDrawingItem(a){if(!a||!a.isDrawingItem)throw TypeError("Illegal drawing item.");return this._arrDrwaingItem.includes(a)}clearDrawingItems(){this.removeDrawingItems(Array.from(this._arrDrwaingItem))}_setDefaultStyle(a,l,f){l?l.forEach(_=>_.toLowerCase()):l=Kn.arrMediaTypes,f?f.forEach(_=>_.toLowerCase()):f=Kn.arrStyleSelectors;const g=Ce.getDrawingStyle(a);if(!g)throw new Error(`The 'drawingStyle' with id '${a}' doesn't exist.`);let p;for(let _ of l)if(p=this.mapType_StateAndStyleId.get(_),p)for(let y of f){this._changeMediaTypeCurStyleInStyleSelector(_,y,g,!0),p[y]=a;for(let b of this._arrDrwaingItem)b._mediaType===_&&b._mapState_StyleId.set(y,a)}this.fabricCanvas.renderAll()}setDefaultStyle(a,l,f){const g=[];f&Rn.DIMT_RECTANGLE&&g.push("rect"),f&Rn.DIMT_QUADRILATERAL&&g.push("quad"),f&Rn.DIMT_TEXT&&g.push("text"),f&Rn.DIMT_ARC&&g.push("arc"),f&Rn.DIMT_IMAGE&&g.push("image"),f&Rn.DIMT_POLYGON&&g.push("polygon"),f&Rn.DIMT_LINE&&g.push("line");const p=[];l&ci.DIS_DEFAULT&&p.push("default"),l&ci.DIS_SELECTED&&p.push("selected"),this._setDefaultStyle(a,g.length?g:null,p.length?p:null)}setMode(a){if("viewer"===(a=a.toLowerCase())){for(let l of this._arrDrwaingItem)l._setEditable(!1);this.fabricCanvas.discardActiveObject(),this.fabricCanvas.renderAll(),this.mode="viewer"}else{if("editor"!==a)throw new RangeError("Invalid value.");for(let l of this._arrDrwaingItem)l._setEditable(!0);this.mode="editor"}this._manager._switchPointerEvent()}getMode(){return this.mode}_setDimensions(a,l){this.fabricCanvas.setDimensions(a,l)}_setObjectFit(a){if(a=a.toLowerCase(),!["contain","cover"].includes(a))throw new Error(`Unsupported value '${a}'.`);this.fabricCanvas.lowerCanvasEl.style.objectFit=a,this.fabricCanvas.upperCanvasEl.style.objectFit=a}_getObjectFit(){return this.fabricCanvas.lowerCanvasEl.style.objectFit}renderAll(){for(let a of this._arrDrwaingItem){const l=this._getItemCurrentStyle(a);this._changeItemStyle(a,l,!0)}this.fabricCanvas.renderAll()}dispose(){this.clearDrawingItems(),1===this._manager._arrDrawingLayer.length&&(this.fabricCanvas.wrapperEl.style.pointerEvents="none",this.fabricCanvas.dispose(),this._arrDrwaingItem.length=0,this._arrFabricObject.length=0)}}jt.DDN_LAYER_ID=1,jt.DBR_LAYER_ID=2,jt.DLR_LAYER_ID=3,jt.USER_DEFINED_LAYER_BASE_ID=100,jt.TIP_LAYER_ID=999;class Cj{constructor(){this._arrDrawingLayer=[]}createDrawingLayer(a,l){if(this.getDrawingLayer(l))throw new Error("Existed drawing layer id.");const f=new jt(a,l,{enableRetinaScaling:!1});return f._manager=this,this._arrDrawingLayer.push(f),this._switchPointerEvent(),f}deleteDrawingLayer(a){const l=this.getDrawingLayer(a);if(!l)return;const f=this._arrDrawingLayer;l.dispose(),f.splice(f.indexOf(l),1),this._switchPointerEvent()}clearDrawingLayers(){for(let a of this._arrDrawingLayer)a.dispose();this._arrDrawingLayer.length=0}getDrawingLayer(a){for(let l of this._arrDrawingLayer)if(l.getId()===a)return l;return null}getAllDrawingLayers(){return Array.from(this._arrDrawingLayer)}getSelectedDrawingItems(){if(!this._arrDrawingLayer.length)return;const a=this._getFabricCanvas().getActiveObjects(),l=[];for(let f of a)l.push(f.getDrawingItem());return l}setDimensions(a,l){this._arrDrawingLayer.length&&this._arrDrawingLayer[0]._setDimensions(a,l)}setObjectFit(a){for(let l of this._arrDrawingLayer)l&&l._setObjectFit(a)}getObjectFit(){return this._arrDrawingLayer.length?this._arrDrawingLayer[0]._getObjectFit():null}setVisible(a){this._arrDrawingLayer.length&&(this._getFabricCanvas().wrapperEl.style.display=a?"block":"none")}_getFabricCanvas(){return this._arrDrawingLayer.length?this._arrDrawingLayer[0].fabricCanvas:null}_switchPointerEvent(){if(this._arrDrawingLayer.length)for(let a of this._arrDrawingLayer)a.getMode()}}class Ej extends _j{constructor(a,l,f,g,p){super(a,{x:l,y:f,width:g,height:0},p),Sa.set(this,void 0),mc.set(this,void 0),this._fabricObject.paddingTop=15,this._fabricObject.calcTextHeight=function(){for(var _=0,y=0,b=this._textLines.length;y<b;y++)_+=this.getHeightOfLine(y);return _+2*this.paddingTop},this._fabricObject._getTopOffset=function(){return-this.height/2+this.getHeightOfLine(0)*(1-1/this.lineHeight)/2+this.paddingTop},this.set("backgroundColor","rgba(50, 50, 52, .8)"),this.set("lineHeight",1.3),this.set("textAlign","center")}setDuration(a){Me(this,Sa,a,"f"),j(this,mc,"f")&&clearTimeout(j(this,mc,"f")),j(this,Sa,"f")>=0&&Me(this,mc,setTimeout(()=>{this.set("visible",!1),this._drawingLayer&&this._drawingLayer.renderAll()},j(this,Sa,"f")),"f")}getDuration(){return j(this,Sa,"f")}}Sa=new WeakMap,mc=new WeakMap,ui=new WeakMap,_c=new WeakMap,vc=new WeakMap,yc=new WeakMap,Ta=new WeakSet,NT=function(u,a,l,f,g,p){const _=new Ej(u,a,l,f,p);return _.coordinateBase=g,_},kT=function(u,a){a.hasDrawingItem(u)||a.addDrawingItems([u])},BT=function(){this._tip&&this._drawingLayerOfTip.removeDrawingItems([this._tip])},VT=function(){if(!this._tip)return;const u=j(this,ui,"f");this._tip.coordinateBase=u.coordinateBase,this._tip.setTextRect({x:u.topLeftPoint.x,y:u.topLeftPoint.y,width:u.width,height:0}),this._tip.set("width",this._tip.get("width")),this._tip._drawingLayer&&this._tip._drawingLayer.renderAll()};class f_ extends HTMLElement{constructor(){super(),rd.set(this,void 0);const a=document.createElement("template").content,l=document.createElement("div");l.setAttribute("class","wrapper"),a.appendChild(l),Me(this,rd,l,"f");const f=document.createElement("slot");f.setAttribute("name","single-frame-input-container"),l.append(f);const g=document.createElement("slot");g.setAttribute("name","content"),l.append(g);const p=document.createElement("slot");p.setAttribute("name","drawing-layer"),l.append(p);const _=document.createElement("style");_.textContent='\n.wrapper {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n::slotted(canvas[slot="content"]) {\n  object-fit: contain;\n  pointer-events: none;\n}\n::slotted(div[slot="single-frame-input-container"]) {\n  width: 1px;\n  height: 1px;\n  overflow: hidden;\n  pointer-events: none;\n}\n::slotted(*) {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n}\n    ',a.appendChild(_),this.attachShadow({mode:"open"}).appendChild(a.cloneNode(!0))}getWrapper(){return j(this,rd,"f")}setElement(a,l){if(!(l instanceof HTMLElement))throw new TypeError("Invalid 'el'.");if(!["content","single-frame-input-container","drawing-layer"].includes(a))throw new TypeError("Invalid 'slot'.");this.removeElement(a),l.setAttribute("slot",a),this.appendChild(l)}getElement(a){if(!["content","single-frame-input-container","drawing-layer"].includes(a))throw new TypeError("Invalid 'slot'.");return this.querySelector(`[slot="${a}"]`)}removeElement(a){var l;if(!["content","single-frame-input-container","drawing-layer"].includes(a))throw new TypeError("Invalid 'slot'.");null===(l=this.querySelectorAll(`[slot="${a}"]`))||void 0===l||l.forEach(f=>f.remove())}}rd=new WeakMap,customElements.get("dce-component")||customElements.define("dce-component",f_);class Ia extends HTMLElement{constructor(){super();const a=window._dce_default_template.content;this.attachShadow({mode:"open"}).appendChild(a.cloneNode(!0))}showScanLaser(){const a=this.shadowRoot.querySelector(".dce-scanlight");a&&(a.style.display="")}hideScanLaser(){const a=this.shadowRoot.querySelector(".dce-scanlight");a&&(a.style.display="none")}getElement(a){return this.shadowRoot.querySelector(a)}getVideoContainer(){return this.shadowRoot.querySelector(".dce-video-container")}getScanAreaEl(){return this.shadowRoot.querySelector(".dce-scanarea")}getScanLightEl(){return this.shadowRoot.querySelector(".dce-scanlight")}getLoadingBackgroundEl(){return this.shadowRoot.querySelector(".dce-bg-loading")}getCameraBackgroundEl(){return this.shadowRoot.querySelector(".dce-bg-camera")}getCameraSelectEl(){return this.shadowRoot.querySelector(".dce-sel-camera")}getResolutionSelectEl(){return this.shadowRoot.querySelector(".dce-sel-resolution")}getResolutionOptionEl(){return this.shadowRoot.querySelector(".dce-opt-gotResolution")}getCloseBtnEl(){return this.shadowRoot.querySelector(".dce-btn-close")}getDLRSelectEl(){return this.shadowRoot.querySelector(".dlr-sel-minletter")}getDLROptionEl(){return this.shadowRoot.querySelector(".dlr-opt-gotMinLtr")}}class rn extends class wj{constructor(){Ta.add(this),ui.set(this,void 0),_c.set(this,void 0),vc.set(this,void 0),yc.set(this,!0),this._drawingLayerManager=new Cj}createDrawingLayerBaseCvs(a,l,f="contain"){if("number"!=typeof a||a<=1)throw new Error("Invalid 'width'.");if("number"!=typeof l||l<=1)throw new Error("Invalid 'height'.");if(!["contain","cover"].includes(f))throw new Error("Unsupported 'objectFit'.");const g=document.createElement("canvas");return g.width==a&&g.height==l||(g.width=a,g.height=l),g.style.objectFit=f,g}_createDrawingLayer(a,l,f,g){if(!this._layerBaseCvs){let y;try{y=this.getContentDimensions()}catch(b){if("Invalid content dimensions."!==(b.message||b))throw b}l||(l=(null==y?void 0:y.width)||1280),f||(f=(null==y?void 0:y.height)||720),g||(g=(null==y?void 0:y.objectFit)||"contain"),this._layerBaseCvs=this.createDrawingLayerBaseCvs(l,f,g)}const p=this._layerBaseCvs,_=this._drawingLayerManager.createDrawingLayer(p,a);return this._innerComponent.getElement("drawing-layer")||this._innerComponent.setElement("drawing-layer",p.parentElement),_}createDrawingLayer(){let a;for(let l=jt.USER_DEFINED_LAYER_BASE_ID;;l++)if(!this._drawingLayerManager.getDrawingLayer(l)&&l!==jt.TIP_LAYER_ID){a=l;break}return this._createDrawingLayer(a)}deleteDrawingLayer(a){var l;this._drawingLayerManager.deleteDrawingLayer(a),this._drawingLayerManager.getAllDrawingLayers().length||(null===(l=this._innerComponent)||void 0===l||l.removeElement("drawing-layer"),this._layerBaseCvs=null)}deleteUserDefinedDrawingLayer(a){if("number"!=typeof a)throw new TypeError("Invalid id.");if(a<jt.USER_DEFINED_LAYER_BASE_ID)throw new Error(`The drawing layer with id ${a} is not defined by users.`);this.deleteDrawingLayer(a)}_clearDrawingLayers(){const a=this.getAllDrawingLayers();for(let l of a)this.deleteDrawingLayer(l.getId())}clearUserDefinedDrawingLayers(){const a=this.getAllDrawingLayers();for(let l of a){const f=l.getId();f<jt.USER_DEFINED_LAYER_BASE_ID||this.deleteUserDefinedDrawingLayer(f)}}getDrawingLayer(a){return a==jt.TIP_LAYER_ID?null:this._drawingLayerManager.getDrawingLayer(a)||([jt.DDN_LAYER_ID,jt.DBR_LAYER_ID,jt.DLR_LAYER_ID].includes(a)?this._createDrawingLayer(a):null)}getAllDrawingLayers(){return this._drawingLayerManager.getAllDrawingLayers().filter(a=>a.getId()>=0&&a.getId()!==jt.TIP_LAYER_ID)}updateDrawingLayers(a){((l,f,g)=>{if(!(l<=1||f<=1)){if(!["contain","cover"].includes(g))throw new Error("Unsupported 'objectFit'.");this._drawingLayerManager.setDimensions({width:l,height:f},{backstoreOnly:!0}),this._drawingLayerManager.setObjectFit(g)}})(a.width,a.height,a.objectFit)}getSelectedDrawingItems(){return this._drawingLayerManager.getSelectedDrawingItems()}setTipConfig(a){if(!(xT(l=a)&&pj(l.topLeftPoint)&&Ea(l.width))||l.width<=0||!Ea(l.duration)||"coordinateBase"in l&&!["view","image"].includes(l.coordinateBase))throw new Error("Invalid tip config.");var l;Me(this,ui,JSON.parse(JSON.stringify(a)),"f"),j(this,ui,"f").coordinateBase||(j(this,ui,"f").coordinateBase="view"),Me(this,vc,a.duration,"f"),j(this,Ta,"m",VT).call(this)}getTipConfig(){return j(this,ui,"f")?j(this,ui,"f"):null}setTipVisible(a){if("boolean"!=typeof a)throw new TypeError("Invalid value.");this._tip&&(this._tip.set("visible",a),this._drawingLayerOfTip&&this._drawingLayerOfTip.renderAll()),Me(this,yc,a,"f")}isTipVisible(){return j(this,yc,"f")}updateTipMessage(a){if(!j(this,ui,"f"))throw new Error("Tip config is not set.");this._tipStyleId||(this._tipStyleId=Ce.createDrawingStyle({fillStyle:"#FFFFFF",paintMode:"fill",fontFamily:"Open Sans",fontSize:40})),this._drawingLayerOfTip||(this._drawingLayerOfTip=this._drawingLayerManager.getDrawingLayer(jt.TIP_LAYER_ID)||this._createDrawingLayer(jt.TIP_LAYER_ID)),this._tip?this._tip.set("text",a):this._tip=j(this,Ta,"m",NT).call(this,a,j(this,ui,"f").topLeftPoint.x,j(this,ui,"f").topLeftPoint.y,j(this,ui,"f").width,j(this,ui,"f").coordinateBase,this._tipStyleId),j(this,Ta,"m",kT).call(this,this._tip,this._drawingLayerOfTip),this._tip.set("visible",j(this,yc,"f")),this._drawingLayerOfTip&&this._drawingLayerOfTip.renderAll(),j(this,_c,"f")&&clearTimeout(j(this,_c,"f")),j(this,vc,"f")>=0&&Me(this,_c,setTimeout(()=>{j(this,Ta,"m",BT).call(this)},j(this,vc,"f")),"f")}}{static get engineResourcePath(){return Qt.engineResourcePaths.dce}static set defaultUIElementURL(a){rn._defaultUIElementURL=a}static get defaultUIElementURL(){var a;return null===(a=rn._defaultUIElementURL)||void 0===a?void 0:a.replace("@engineResourcePath/",rn.engineResourcePath)}static createInstance(a){return ae(function*(){customElements.get(rn.uiComponentName)||customElements.define(rn.uiComponentName,Ia);const l=new rn;return yield l.setUIElement(a||rn.defaultUIElementURL),l})()}static _transformCoordinates(a,l,f,g,p,_,y){const O=y/p;a.x=Math.round(a.x/(_/g)+l),a.y=Math.round(a.y/O+f)}set _singleFrameMode(a){if(!["disabled","image","camera"].includes(a))throw new Error("Invalid value.");if(a!==j(this,bc,"f")){if(Me(this,bc,a,"f"),j(this,It,"m",hi).call(this))Me(this,dn,null,"f"),this._videoContainer=null,this._innerComponent.removeElement("content"),this._innerComponent&&(this._innerComponent.addEventListener("click",this._clickIptSingleFrameMode),this._innerComponent.setAttribute("title","Take a photo")),this._bgCamera&&(this._bgCamera.style.display="block");else if(this._innerComponent&&(this._innerComponent.removeEventListener("click",this._clickIptSingleFrameMode),this._innerComponent.removeAttribute("title")),this._bgCamera&&(this._bgCamera.style.display="none"),!j(this,dn,"f")){const l=document.createElement("video");l.style.position="absolute",l.style.left="0",l.style.top="0",l.style.width="100%",l.style.height="100%",l.style.objectFit=this.getVideoFit(),l.setAttribute("autoplay","true"),l.setAttribute("playsinline","true"),l.setAttribute("muted","true"),["iPhone","iPad","Mac"].includes(An.OS)&&l.setAttribute("poster","data:image/gif;base64,R0lGODlhAQABAIEAAAAAAAAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAgEAAEEBAA7"),Me(this,dn,l,"f");const f=document.createElement("div");f.append(l),f.style.overflow="hidden",this._videoContainer=f,this._innerComponent.setElement("content",f)}j(this,It,"m",hi).call(this)||this._hideDefaultSelection?(this._selCam&&(this._selCam.style.display="none"),this._selRsl&&(this._selRsl.style.display="none"),this._selMinLtr&&(this._selMinLtr.style.display="none")):(this._selCam&&(this._selCam.style.display="block"),this._selRsl&&(this._selRsl.style.display="block"),this._selMinLtr&&(this._selMinLtr.style.display="block"),this._stopLoading())}}get _singleFrameMode(){return j(this,bc,"f")}get disposed(){return j(this,u_,"f")}constructor(){var a;super(),a=this,It.add(this),Cc.set(this,void 0),Ec.set(this,void 0),wc.set(this,void 0),this.containerClassName="dce-video-container",dn.set(this,void 0),this.videoFit="contain",this._hideDefaultSelection=!1,this._divScanArea=null,this._divScanLight=null,this._bgLoading=null,this._selCam=null,this._bgCamera=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,sd.set(this,null),this.regionMaskFillStyle="rgba(0,0,0,0.5)",this.regionMaskStrokeStyle="rgb(254,142,20)",this.regionMaskLineWidth=6,od.set(this,!1),ad.set(this,!1),Fs.set(this,{width:0,height:0}),this._updateLayersTimeout=500,this._videoResizeListener=()=>{j(this,It,"m",Sc).call(this),this._updateLayersTimeoutId&&clearTimeout(this._updateLayersTimeoutId),this._updateLayersTimeoutId=setTimeout(()=>{this.disposed||(this.eventHandler.fire("videoEl:resized",null,{async:!1}),this.eventHandler.fire("content:updated",null,{async:!1}),this.isScanLaserVisible()&&j(this,It,"m",d_).call(this))},this._updateLayersTimeout)},this._windowResizeListener=()=>{rn._onLog&&rn._onLog("window resize event triggered."),j(this,Fs,"f").width===document.documentElement.clientWidth&&j(this,Fs,"f").height===document.documentElement.clientHeight||(j(this,Fs,"f").width=document.documentElement.clientWidth,j(this,Fs,"f").height=document.documentElement.clientHeight,this._videoResizeListener())},bc.set(this,"disabled"),this._clickIptSingleFrameMode=()=>{if(!j(this,It,"m",hi).call(this))return;let l;if(this._singleFrameInputContainer)l=this._singleFrameInputContainer.firstElementChild;else{l=document.createElement("input"),l.setAttribute("type","file"),"camera"===this._singleFrameMode?(l.setAttribute("capture",""),l.setAttribute("accept","image/*")):"image"===this._singleFrameMode&&(l.removeAttribute("capture"),l.setAttribute("accept",".jpg,.jpeg,.icon,.gif,.svg,.webp,.png,.bmp")),l.addEventListener("change",ae(function*(){const g=l.files[0];l.value="";{const p=function(){var V=ae(function*(H){let z=null,Y=null;if("undefined"!=typeof createImageBitmap)try{if(z=yield createImageBitmap(H),z)return z}catch($){}var X;return z||(Y=yield(X=H,new Promise(($,K)=>{let ge=URL.createObjectURL(X),_e=new Image;_e.src=ge,_e.onload=()=>{URL.revokeObjectURL(_e.src),$(_e)},_e.onerror=Te=>{K(new Error("Can't convert blob to image : "+(Te instanceof Event?Te.type:Te)))}}))),Y});return function(z){return V.apply(this,arguments)}}(),_=(V,H,z,Y)=>{V.width==z&&V.height==Y||(V.width=z,V.height=Y);const X=V.getContext("2d");X.clearRect(0,0,V.width,V.height),X.drawImage(H,0,0)},y=yield p(g),b=y instanceof HTMLImageElement?y.naturalWidth:y.width,O=y instanceof HTMLImageElement?y.naturalHeight:y.height;let M=a._cvsSingleFrameMode;const P=null==M?void 0:M.width,k=null==M?void 0:M.height;M||(M=document.createElement("canvas"),a._cvsSingleFrameMode=M),_(M,y,b,O),a._innerComponent.setElement("content",M),P===M.width&&k===M.height||a.eventHandler.fire("content:updated",null,{async:!1})}a._onSingleFrameAcquired&&setTimeout(()=>{a._onSingleFrameAcquired(a._cvsSingleFrameMode)},0)})),l.style.position="absolute",l.style.top="-9999px",l.style.backgroundColor="transparent",l.style.color="transparent";const f=document.createElement("div");f.append(l),this._innerComponent.setElement("single-frame-input-container",f),this._singleFrameInputContainer=f}null==l||l.click()},Dc.set(this,[]),this._capturedResultReceiver={onCapturedResultReceived:(l,f)=>{var g,p,_,y;if(this.disposed||(this.clearAllInnerDrawingItems(),!l))return;const b=l.originalImageTag;if(!b)return;const O=l.items;if(!(null==O?void 0:O.length))return;const M=(null===(g=b.cropRegion)||void 0===g?void 0:g.left)||0,P=(null===(p=b.cropRegion)||void 0===p?void 0:p.top)||0,k=(null===(_=b.cropRegion)||void 0===_?void 0:_.right)?b.cropRegion.right-M:b.originalWidth,V=(null===(y=b.cropRegion)||void 0===y?void 0:y.bottom)?b.cropRegion.bottom-P:b.originalHeight,H=b.currentWidth,z=b.currentHeight,Y=(K,ge,_e,Te,xe,F,Ee,ke,Qe=[],D)=>{ge.forEach(w=>rn._transformCoordinates(w,_e,Te,xe,F,Ee,ke));const C=new vj({points:[{x:ge[0].x,y:ge[0].y},{x:ge[1].x,y:ge[1].y},{x:ge[2].x,y:ge[2].y},{x:ge[3].x,y:ge[3].y}]},D);for(let w of Qe)C.addNote(w);K.addDrawingItems([C]),j(this,Dc,"f").push(C)};let X,$;for(let K of O)switch(K.type){case Jt.CRIT_ORIGINAL_IMAGE:break;case Jt.CRIT_BARCODE:X=this.getDrawingLayer(jt.DBR_LAYER_ID),$=[{name:"format",content:K.formatString},{name:"text",content:K.text}],(null==f?void 0:f.isBarcodeVerifyOpen)?K.verified?Y(X,K.location.points,M,P,k,V,H,z,$):Y(X,K.location.points,M,P,k,V,H,z,$,Ce.STYLE_ORANGE_STROKE_TRANSPARENT):Y(X,K.location.points,M,P,k,V,H,z,$);break;case Jt.CRIT_TEXT_LINE:X=this.getDrawingLayer(jt.DLR_LAYER_ID),$=[{name:"text",content:K.text}],f.isLabelVerifyOpen?K.verified?Y(X,K.location.points,M,P,k,V,H,z,$):Y(X,K.location.points,M,P,k,V,H,z,$,Ce.STYLE_GREEN_STROKE_TRANSPARENT):Y(X,K.location.points,M,P,k,V,H,z,$);break;case Jt.CRIT_DETECTED_QUAD:X=this.getDrawingLayer(jt.DDN_LAYER_ID),(null==f?void 0:f.isDetectVerifyOpen)?K.verified?Y(X,K.location.points,M,P,k,V,H,z,[]):Y(X,K.location.points,M,P,k,V,H,z,[],Ce.STYLE_BLUE_STROKE_TRANSPARENT):Y(X,K.location.points,M,P,k,V,H,z,[]);break;case Jt.CRIT_NORMALIZED_IMAGE:X=this.getDrawingLayer(jt.DDN_LAYER_ID),(null==f?void 0:f.isNormalizeVerifyOpen)?K.verified?Y(X,K.location.points,M,P,k,V,H,z,[]):Y(X,K.location.points,M,P,k,V,H,z,[],Ce.STYLE_BLUE_STROKE_TRANSPARENT):Y(X,K.location.points,M,P,k,V,H,z,[]);break;case Jt.CRIT_PARSED_RESULT:break;default:throw new Error("Illegal item type.")}}},u_.set(this,!1),this.eventHandler=new LT,this.eventHandler.on("content:updated",()=>{j(this,Cc,"f")&&clearTimeout(j(this,Cc,"f")),Me(this,Cc,setTimeout(()=>{if(this.disposed)return;let l;this._updateVideoContainer();try{l=this.getContentDimensions()}catch(f){if("Invalid content dimensions."===(f.message||f))return;throw f}this.updateDrawingLayers(l),this.updateConvertedRegion(l)},0),"f")}),this.eventHandler.on("videoEl:resized",()=>{j(this,Ec,"f")&&clearTimeout(j(this,Ec,"f")),Me(this,Ec,setTimeout(()=>{this.disposed||this._updateVideoContainer()},0),"f")})}_setUIElement(a){a instanceof HTMLTemplateElement?(window._dce_default_template=a,this.UIElement=new Ia):this.UIElement=a,this._unbindUI(),this._bindUI()}setUIElement(a){var l=this;return ae(function*(){let f;if(f="string"==typeof a?yield r_(a):a,f instanceof HTMLDivElement&&0==f.childElementCount){const g=yield r_(rn.defaultUIElementURL);g instanceof HTMLTemplateElement?(window._dce_default_template=g,f.append(new Ia)):f.append(g),l._setUIElement(f)}else l._setUIElement(f)})()}getUIElement(){return this.UIElement}_bindUI(){var a;if(!this.UIElement)throw new Error("Need to set 'UIElement'.");if(this._innerComponent)return;let l,f=this.UIElement;if(f instanceof Ia?l=f.getElement(`.${this.containerClassName}`):f instanceof HTMLDivElement&&1===f.childElementCount&&f.firstElementChild instanceof Ia?(l=f.firstElementChild.getElement(`.${this.containerClassName}`),f=f.firstElementChild):l=f.classList.contains(this.containerClassName)?f:f.querySelector(`.${this.containerClassName}`),!l)throw Error(`Can not find the element with class '${this.containerClassName}'.`);if(this._innerComponent=new f_,l.appendChild(this._innerComponent),!j(this,It,"m",hi).call(this)){const g=document.createElement("video");g.style.position="absolute",g.style.left="0",g.style.top="0",g.style.width="100%",g.style.height="100%",g.style.objectFit=this.getVideoFit(),g.setAttribute("autoplay","true"),g.setAttribute("playsinline","true"),g.setAttribute("muted","true"),["iPhone","iPad","Mac"].includes(An.OS)&&g.setAttribute("poster","data:image/gif;base64,R0lGODlhAQABAIEAAAAAAAAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAgEAAEEBAA7"),Me(this,dn,g,"f");const p=document.createElement("div");p.append(g),p.style.overflow="hidden",this._videoContainer=p,this._innerComponent.setElement("content",p)}if(f instanceof Ia?(this._selRsl=f.getElement(".dce-sel-resolution"),this._selMinLtr=f.getElement(".dlr-sel-minletter"),this._divScanArea=f.getElement(".dce-scanarea"),this._divScanLight=f.getElement(".dce-scanlight"),this._bgLoading=f.getElement(".dce-bg-loading"),this._bgCamera=f.getElement(".dce-bg-camera"),this._selCam=f.getElement(".dce-sel-camera"),this._optGotRsl=f.getElement(".dce-opt-gotResolution"),this._btnClose=f.getElement(".dce-btn-close"),this._optGotMinLtr=f.getElement(".dlr-opt-gotMinLtr")):(this._selRsl=f.querySelector(".dce-sel-resolution"),this._selMinLtr=f.querySelector(".dlr-sel-minletter"),this._divScanArea=f.querySelector(".dce-scanarea"),this._divScanLight=f.querySelector(".dce-scanlight"),this._bgLoading=f.querySelector(".dce-bg-loading"),this._bgCamera=f.querySelector(".dce-bg-camera"),this._selCam=f.querySelector(".dce-sel-camera"),this._optGotRsl=f.querySelector(".dce-opt-gotResolution"),this._btnClose=f.querySelector(".dce-btn-close"),this._optGotMinLtr=f.querySelector(".dlr-opt-gotMinLtr")),this._selRsl&&(this._hideDefaultSelection||j(this,It,"m",hi).call(this)||this._selRsl.options.length||(this._selRsl.innerHTML=['<option class="dce-opt-gotResolution" value="got"></option>','<option data-width="1920" data-height="1080">ask 1920x1080</option>','<option data-width="1280" data-height="720">ask 1280x720</option>','<option data-width="640" data-height="480">ask 640x480</option>'].join(""),this._optGotRsl=this._selRsl.options[0])),this._selMinLtr&&(this._hideDefaultSelection||j(this,It,"m",hi).call(this)||this._selMinLtr.options.length||(this._selMinLtr.innerHTML=['<option class="dlr-opt-gotMinLtr" value="got"></option>','<option value="0" selected>any letter</option>','<option value="3">3+ letters</option>','<option value="5">5+ letters</option>','<option value="8">8+ letters</option>','<option value="12">12+ letters</option>','<option value="17">17+ letters</option>','<option value="30">30+ letters</option>','<option value="50">50+ letters</option>','<option value="80">80+ letters</option>','<option value="120">120+ letters</option>'].join(""),this._optGotMinLtr=this._selMinLtr.options[0])),this.isScanLaserVisible()||j(this,It,"m",Sc).call(this),j(this,It,"m",hi).call(this)&&(this._innerComponent&&(this._innerComponent.addEventListener("click",this._clickIptSingleFrameMode),this._innerComponent.setAttribute("title","Take a photo")),this._bgCamera&&(this._bgCamera.style.display="block")),j(this,It,"m",hi).call(this)||this._hideDefaultSelection?(this._selCam&&(this._selCam.style.display="none"),this._selRsl&&(this._selRsl.style.display="none"),this._selMinLtr&&(this._selMinLtr.style.display="none")):(this._selCam&&(this._selCam.style.display="block"),this._selRsl&&(this._selRsl.style.display="block"),this._selMinLtr&&(this._selMinLtr.style.display="block"),this._stopLoading()),window.ResizeObserver){this._resizeObserver||(this._resizeObserver=new ResizeObserver(p=>{var _;rn._onLog&&rn._onLog("resize observer triggered.");for(let y of p)y.target===(null===(_=this._innerComponent)||void 0===_?void 0:_.getWrapper())&&this._videoResizeListener()}));const g=null===(a=this._innerComponent)||void 0===a?void 0:a.getWrapper();g&&this._resizeObserver.observe(g)}j(this,Fs,"f").width=document.documentElement.clientWidth,j(this,Fs,"f").height=document.documentElement.clientHeight,window.addEventListener("resize",this._windowResizeListener)}_unbindUI(){var a,l,f,g;j(this,It,"m",hi).call(this)?(this._innerComponent&&(this._innerComponent.removeEventListener("click",this._clickIptSingleFrameMode),this._innerComponent.removeAttribute("title")),this._bgCamera&&(this._bgCamera.style.display="none")):this._stopLoading(),j(this,It,"m",Sc).call(this),null===(a=this._drawingLayerManager)||void 0===a||a.clearDrawingLayers(),null===(l=this._innerComponent)||void 0===l||l.removeElement("drawing-layer"),this._layerBaseCvs=null,this._drawingLayerOfMask=null,this._drawingLayerOfTip=null,null===(f=this._innerComponent)||void 0===f||f.remove(),this._innerComponent=null,Me(this,dn,null,"f"),null===(g=this._videoContainer)||void 0===g||g.remove(),this._videoContainer=null,this._selCam=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this._divScanArea=null,this._divScanLight=null,this._singleFrameInputContainer&&(this._singleFrameInputContainer.remove(),this._singleFrameInputContainer=null),window.ResizeObserver&&this._resizeObserver&&this._resizeObserver.disconnect(),window.removeEventListener("resize",this._windowResizeListener)}_startLoading(){this._bgLoading&&(this._bgLoading.style.display="",this._bgLoading.style.animationPlayState="")}_stopLoading(){this._bgLoading&&(this._bgLoading.style.display="none",this._bgLoading.style.animationPlayState="paused")}_renderCamerasInfo(a,l){if(!this._selCam)return;let f;this._selCam.textContent="";for(let g of l){const p=document.createElement("option");p.value=g.deviceId,p.innerText=g.label,this._selCam.append(p),g.deviceId&&a&&a.deviceId==g.deviceId&&(f=p)}this._selCam.value=f?f.value:""}_renderResolutionInfo(a){this._optGotRsl&&(this._optGotRsl.setAttribute("data-width",a.width),this._optGotRsl.setAttribute("data-height",a.height),this._optGotRsl.innerText="got "+a.width+"x"+a.height,this._selRsl&&this._optGotRsl.parentNode==this._selRsl&&(this._selRsl.value="got"))}getVideoElement(){return j(this,dn,"f")}isVideoLoaded(){return!!j(this,dn,"f")&&4==j(this,dn,"f").readyState}setVideoFit(a){if(a=a.toLowerCase(),!["contain","cover"].includes(a))throw new Error(`Unsupported value '${a}'.`);if(this.videoFit=a,!j(this,dn,"f")||(j(this,dn,"f").style.objectFit=a,j(this,It,"m",hi).call(this)))return;let l;this._updateVideoContainer();try{l=this.getContentDimensions()}catch(f){if("Invalid content dimensions."===(f.message||f))return;throw f}j(this,It,"m",cd).call(this,l,this.getConvertedRegion()),this.updateDrawingLayers(l)}getVideoFit(){return this.videoFit}getContentDimensions(){var a,l,f,g;let p,_,y;if(j(this,It,"m",hi).call(this)?(p=null===(f=this._cvsSingleFrameMode)||void 0===f?void 0:f.width,_=null===(g=this._cvsSingleFrameMode)||void 0===g?void 0:g.height,y="contain"):(p=null===(a=j(this,dn,"f"))||void 0===a?void 0:a.videoWidth,_=null===(l=j(this,dn,"f"))||void 0===l?void 0:l.videoHeight,y=this.getVideoFit()),!p||!_)throw new Error("Invalid content dimensions.");return{width:p,height:_,objectFit:y}}updateConvertedRegion(a){const l=td.convert(this.scanRegion,a.width,a.height);Me(this,sd,l,"f"),j(this,wc,"f")&&clearTimeout(j(this,wc,"f")),Me(this,wc,setTimeout(()=>{let f;try{f=this.getContentDimensions()}catch(g){if("Invalid content dimensions."===(g.message||g))return;throw g}j(this,It,"m",ld).call(this,f,l),j(this,It,"m",cd).call(this,f,l)},0),"f")}getConvertedRegion(){return j(this,sd,"f")}setScanRegion(a){if(null!=a&&!n_(a)&&!Hr(a))throw TypeError("Invalid 'region'.");let l;this.scanRegion=a?JSON.parse(JSON.stringify(a)):null;try{l=this.getContentDimensions()}catch(f){if("Invalid content dimensions."===(f.message||f))return;throw f}this.updateConvertedRegion(l)}getScanRegion(){return JSON.parse(JSON.stringify(this.scanRegion))}getVisibleRegionOfVideo(a){if(!this.isVideoLoaded())throw new Error("The video is not loaded.");const l=j(this,dn,"f").videoWidth,f=j(this,dn,"f").videoHeight,g=this.getVideoFit(),{width:p,height:_}=this._innerComponent.getBoundingClientRect();if(p<=0||_<=0)throw new Error("Unable to get video dimensions. Video may not be rendered on the page.");let y;const b={x:0,y:0,width:l,height:f,isMeasuredInPercentage:!1};if("cover"===g&&(p/_<l/f?(y=_/f,b.x=Math.floor((l-p/y)/2),b.y=0,b.width=Math.ceil(p/y),b.height=f):(y=p/l,b.x=0,b.y=Math.floor((f-_/y)/2),b.width=l,b.height=Math.ceil(_/y))),null==a?void 0:a.inPixels)return b;const O=b;return O.x=Math.ceil(O.x/f*100),O.y=Math.ceil(O.y/l*100),O.width=Math.floor(O.width/l*100),O.height=Math.floor(O.height/f*100),O.isMeasuredInPercentage=!0,b}setScanRegionMask(a,l,f,g){this._drawingLayerOfMask||(this._drawingLayerOfMask=this._createDrawingLayer(-2),this.isScanRegionMaskVisible()||j(this,It,"m",h_).call(this)),this.clearScanRegionMask(),this._maskBackRectStyleId||(this._maskBackRectStyleId=Ce.createDrawingStyle({paintMode:"fill",fillStyle:this.regionMaskFillStyle,lineWidth:0})),this._maskCenterRectStyleId||(this._maskCenterRectStyleId=Ce.createDrawingStyle({paintMode:"stroke",strokeStyle:this.regionMaskStrokeStyle,lineWidth:this.regionMaskLineWidth}));const p=this._drawingLayerOfMask.width,_=this._drawingLayerOfMask.height,y=new ba({x:0,y:0,width:p,height:_},this._maskBackRectStyleId),b=new ba({x:-p/2,y:-_/2+l,width:a,height:g}),O=new ba({x:-p/2+a+f,y:-_/2+l,width:p-a-f<0?0:p-a-f,height:g}),M=new ba({x:-p/2,y:-_/2,width:p,height:l}),P=new ba({x:-p/2,y:-_/2+l+g,width:p,height:_-l-g<0?0:_-l-g});b.set("strokeWidth",0),O.set("strokeWidth",0),M.set("strokeWidth",0),P.set("strokeWidth",0);const k=new yj([b,O,M,P])._getFabricObject();y.set("clipPath",k);const V=new ba({x:a,y:l,width:f,height:g},this._maskCenterRectStyleId);this._drawingLayerOfMask.addDrawingItems([y,V])}clearScanRegionMask(){this._drawingLayerOfMask&&this._drawingLayerOfMask.clearDrawingItems()}deleteScanRegionMask(){this._drawingLayerOfMask&&this.deleteDrawingLayer(this._drawingLayerOfMask.getId())}_setScanRegionMaskVisible(a){Me(this,od,a,"f"),a?j(this,It,"m",jT).call(this):j(this,It,"m",h_).call(this)}setScanRegionMaskVisible(a){this._setScanRegionMaskVisible(a),this._userSetMaskVisible=a}isScanRegionMaskVisible(){return j(this,od,"f")}setScanRegionMaskStyle(a){if(!a)return;let l;a.fillStyle&&(this.regionMaskFillStyle=a.fillStyle),a.strokeStyle&&(this.regionMaskStrokeStyle=a.strokeStyle),a.lineWidth&&(this.regionMaskLineWidth=a.lineWidth),this._maskBackRectStyleId&&Ce.updateDrawingStyle(this._maskBackRectStyleId,{fillStyle:this.regionMaskFillStyle}),this._maskCenterRectStyleId&&Ce.updateDrawingStyle(this._maskCenterRectStyleId,{strokeStyle:this.regionMaskStrokeStyle,lineWidth:this.regionMaskLineWidth});try{l=this.getContentDimensions()}catch(f){if("Invalid content dimensions."===(f.message||f))return;throw f}j(this,It,"m",ld).call(this,l,this.getConvertedRegion())}getScanRegionMaskStyle(){return{fillStyle:this.regionMaskFillStyle,strokeStyle:this.regionMaskStrokeStyle,lineWidth:this.regionMaskLineWidth}}_setScanLaserVisible(a){Me(this,ad,a,"f"),a?j(this,It,"m",d_).call(this):j(this,It,"m",Sc).call(this)}setScanLaserVisible(a){this._setScanLaserVisible(a),this._userSetLaserVisible=a}isScanLaserVisible(){return j(this,ad,"f")}_updateVideoContainer(){if(!j(this,dn,"f")||j(this,It,"m",hi).call(this))return;let a=1;const l=j(this,dn,"f").style.transform.match(/scale\((.+)\)/);l&&(a=parseFloat(l[1]));const f=this._videoContainer;if("contain"===this.videoFit&&a>1){const g=j(this,dn,"f").videoWidth,p=j(this,dn,"f").videoHeight,{width:_,height:y}=this._innerComponent.getBoundingClientRect(),b=g/p;if(_/y<b){let O=_/b;f.style.left="0",f.style.top=(y-O)/2/y*100+"%",f.style.width="100%",f.style.height=O/y*100+"%"}else{let O=y*b;f.style.left=(_-O)/2/_*100+"%",f.style.top="0",f.style.width=O/_*100+"%",f.style.height="100%"}}else f.style.left="0",f.style.top="0",f.style.width="100%",f.style.height="100%"}updateLayers(){let a;this._updateVideoContainer();try{a=this.getContentDimensions()}catch(f){if("Invalid content dimensions."===(f.message||f))return;throw f}const l=this.getConvertedRegion();j(this,It,"m",cd).call(this,a,l),this.updateDrawingLayers(a),j(this,It,"m",ld).call(this,a,l)}clearAllInnerDrawingItems(){j(this,Dc,"f").forEach(a=>a.remove()),j(this,Dc,"f").length=0}dispose(){this._unbindUI(),delete window._dce_default_template,this.__proto__=null;for(let a in this)delete this[a];Object.defineProperty(this,"disposed",{value:!0})}}function Z(u,a,l,f){if("a"===l&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof a?u!==a||!f:!a.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===l?f:"a"===l?f.call(u):f?f.value:a.get(u)}function ft(u,a,l,f,g){if("m"===f)throw new TypeError("Private method is not writable");if("a"===f&&!g)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof a?u!==a||!g:!a.has(u))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===f?g.call(u,l):g?g.value=l:a.set(u,l),l}Cc=new WeakMap,Ec=new WeakMap,wc=new WeakMap,dn=new WeakMap,sd=new WeakMap,od=new WeakMap,ad=new WeakMap,Fs=new WeakMap,bc=new WeakMap,Dc=new WeakMap,u_=new WeakMap,It=new WeakSet,hi=function(){return"disabled"!==this._singleFrameMode},ld=function(u,a){!a||0===a.x&&0===a.y&&a.width===u.width&&a.height===u.height?this.clearScanRegionMask():this.setScanRegionMask(a.x,a.y,a.width,a.height)},jT=function(){this._drawingLayerOfMask&&this._drawingLayerOfMask.setVisible(!0)},h_=function(){this._drawingLayerOfMask&&this._drawingLayerOfMask.setVisible(!1)},d_=function(){this._divScanLight&&"none"==this._divScanLight.style.display&&(this._divScanLight.style.display="block")},Sc=function(){this._divScanLight&&(this._divScanLight.style.display="none")},cd=function(u,a){if(!this._divScanArea||!this._innerComponent.getElement("content"))return;const{width:l,height:f,objectFit:g}=u;a||(a={x:0,y:0,width:l,height:f});const{width:p,height:_}=this._innerComponent.getBoundingClientRect();if(p<=0||_<=0)return;const y=p/_,b=l/f;let O,M,P,k,V=1;if("contain"===g)y<b?(V=p/l,O=0,M=(_-f*V)/2):(V=_/f,O=(p-l*V)/2,M=0),O+=a.x*V,M+=a.y*V,P=a.width*V,k=a.height*V;else if("cover"===g)if(y<b){V=_/f,O=a.x*V-(l*V-p)/2,O=Math.max(O,0),O=Math.min(O,p),M=a.y*V;let H=(a.x+a.width)*V-(l*V-p)/2;H=Math.max(H,0),H=Math.min(H,p),P=H-O,k=a.height*V}else{V=p/l,O=a.x*V,M=a.y*V-(f*V-_)/2,M=Math.max(M,0),M=Math.min(M,_);let H=(a.y+a.height)*V-(f*V-_)/2;H=Math.max(H,0),H=Math.min(H,_),P=a.width*V,k=H-M}else O=0,M=0,P=0,k=0;this._divScanArea.style.left=O+"px",this._divScanArea.style.top=M+"px",this._divScanArea.style.width=P+"px",this._divScanArea.style.height=k+"px"},rn.uiComponentName="default-camera-view",rn._defaultUIElementURL="@engineResourcePath/dce.ui.html","function"==typeof SuppressedError&&SuppressedError;const UT="undefined"==typeof self;let Tc,Ic,ud,g_,kn;function Wn(u,a,l,f){if("a"===l&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof a?u!==a||!f:!a.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===l?f:"a"===l?f.call(u):f?f.value:a.get(u)}function Ki(u,a,l,f,g){if("m"===f)throw new TypeError("Private method is not writable");if("a"===f&&!g)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof a?u!==a||!g:!a.has(u))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===f?g.call(u,l):g?g.value=l:a.set(u,l),l}"undefined"!=typeof navigator&&(Tc=navigator,Ic=Tc.userAgent,ud=Tc.platform,g_=Tc.mediaDevices),function(){if(!UT){const u={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:Tc.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},a={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:ud,search:"Win"},Mac:{str:ud},Linux:{str:ud}};let l="unknownBrowser",f=0,g="unknownOS";for(let p in u){const _=u[p]||{};let O=_.verStr||Ic,M=_.verSearch||p;if(M instanceof Array||(M=[M]),-1!=(_.str||Ic).indexOf(_.search||p)){l=p;for(let P of M){let k=O.indexOf(P);if(-1!=k){f=parseFloat(O.substring(k+P.length+1));break}}break}}for(let p in a){const _=a[p]||{};if(-1!=(_.str||Ic).indexOf(_.search||p)){g=p;break}}"Linux"==g&&-1!=Ic.indexOf("Windows NT")&&(g="HarmonyOS"),kn={browser:l,version:f,OS:g}}UT&&(kn={browser:"ssr",version:0,OS:"ssr"})}(),"function"==typeof SuppressedError&&SuppressedError;let zr=class{static multiply(a,l){const f=[];for(let g=0;g<3;g++){const p=l.slice(3*g,3*g+3);for(let _=0;_<3;_++){const y=[a[_],a[_+3],a[_+6]].reduce((b,O,M)=>b+O*p[M],0);f.push(y)}}return f}static identity(){return[1,0,0,0,1,0,0,0,1]}static translate(a,l,f){return Ke.multiply(a,[1,0,0,0,1,0,l,f,1])}static rotate(a,l){var f=Math.cos(l),g=Math.sin(l);return Ke.multiply(a,[f,-g,0,g,f,0,0,0,1])}static scale(a,l,f){return Ke.multiply(a,[l,0,0,0,f,0,0,0,1])}};var gt,Yr,$r,hd,xa,xc,Ac,Aa,dd,fo,fd,p_,Fe,Je,vt,gd,pd,At,Oi,Xr,Ra,md,br,qr,di,Oa,Ma,Rc,_d,La,go,Zr,Kr,m_,fn,__,po,GT,vd,yd,HT,Qi,v_,y_,Fa,Oc,Cd,fi,Pa,C_,E_,WT;!function(u){u.GREY="grey",u.GREY32="grey32",u.RGBA="rgba",u.RBGA="rbga",u.GRBA="grba",u.GBRA="gbra",u.BRGA="brga",u.BGRA="bgra"}(gt||(gt={}));class Ye{static get version(){return"1.1.0"}static checkWebGLSupport(){return null===document.createElement("canvas").getContext("webgl")?(Ki(Ye,Yr,!1,"f",$r),!1):(Ki(Ye,Yr,!0,"f",$r),!0)}get disposed(){return Wn(this,dd,"f")}constructor(){hd.set(this,gt.RGBA),xa.set(this,null),xc.set(this,null),Ac.set(this,null),this.useWebGLByDefault=!0,this._reusedCvs=null,this._reusedWebGLCvs=null,Aa.set(this,null),dd.set(this,!1)}drawImage(a,l,f,g,p,_){if(this.disposed)throw Error("The 'ImageDataGetter' instance has been disposed.");if(!f||!g)throw new Error("Invalid 'sourceWidth' or 'sourceHeight'.");if(null==Wn(Ye,Yr,"f",$r)&&Ye.checkWebGLSupport(),(null==_?void 0:_.bUseWebGL)&&!Wn(Ye,Yr,"f",$r))throw new Error("Your browser or machine may not support WebGL.");if(l instanceof HTMLVideoElement&&4!==l.readyState||l instanceof HTMLImageElement&&!l.complete)throw new Error("The source is not loaded.");let y;Ye._onLog&&(y=Date.now(),Ye._onLog("drawImage(), START: "+y));let b=0,O=0,M=f,P=g,k=0,V=0,H=f,z=g;p&&(p.sx&&(b=Math.round(p.sx)),p.sy&&(O=Math.round(p.sy)),p.sWidth&&(M=Math.round(p.sWidth)),p.sHeight&&(P=Math.round(p.sHeight)),p.dx&&(k=Math.round(p.dx)),p.dy&&(V=Math.round(p.dy)),p.dWidth&&(H=Math.round(p.dWidth)),p.dHeight&&(z=Math.round(p.dHeight)));let Y,X=gt.RGBA;if((null==_?void 0:_.pixelFormat)&&(X=_.pixelFormat),(null==_?void 0:_.bufferContainer)&&(Y=_.bufferContainer,Y.length<4*H*z))throw new Error("Unexpected size of the 'bufferContainer'.");const $=a;if(!Wn(Ye,Yr,"f",$r)||!(this.useWebGLByDefault&&null==(null==_?void 0:_.bUseWebGL)||(null==_?void 0:_.bUseWebGL))){Ye._onLog&&Ye._onLog("drawImage() in context2d."),$.ctx2d||($.ctx2d=$.getContext("2d",{willReadFrequently:!0}));const K=$.ctx2d;if(!K)throw new Error("Unable to get 'CanvasRenderingContext2D' from canvas.");return($.width<k+H||$.height<V+z)&&($.width=k+H,$.height=V+z),K.drawImage(l,b,O,M,P,k,V,H,z),Ye._onLog&&Ye._onLog("drawImage() in context2d end. Costs: "+(Date.now()-y)),{context:K,pixelFormat:gt.RGBA,bUseWebGL:!1}}Ye._onLog&&Ye._onLog("drawImage() in WebGL.");try{($.width<k+H||$.height<V+z)&&($.width=k+H,$.height=V+z,$.ctxWebGL&&$.ctxWebGL.viewport(0,0,k+H,V+z));const K=$.ctxWebGL||$.getContext("webgl",{antialias:!1})||$.getContext("experimental-webgl",{antialias:!1});if(!K){Ye._onLog&&Ye._onLog("Browser or machine may not support WebGL, or the canvas has already been set to a different context mode.");const F=new Error("Unable to get 'WebGLRenderingContext'. Your browser or machine may not support WebGL, or the canvas has already been set to a different context mode.");throw F.name="WebGLError",F}if(!$.ctxWebGL||X!==Wn(this,hd,"f")){$.ctxWebGL=K;const F=m=>{const v=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,v),m.bufferData(m.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),m.STATIC_DRAW);const S=m.createBuffer();return m.bindBuffer(m.ARRAY_BUFFER,S),m.bufferData(m.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),m.STATIC_DRAW),{positions:v,texCoords:S}},Ee=m=>{const v=m.createTexture();return m.bindTexture(m.TEXTURE_2D,v),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),v},ke=(m,v)=>{const S=m.createProgram();if(v.forEach(A=>m.attachShader(S,A)),m.linkProgram(S),!m.getProgramParameter(S,m.LINK_STATUS)){const A=new Error(`An error occured linking the program: ${m.getProgramInfoLog(S)}.`);throw A.name="WebGLError",A}return m.useProgram(S),S},Qe=(m,v,S)=>{const A=m.createShader(v);if(m.shaderSource(A,S),m.compileShader(A),!m.getShaderParameter(A,m.COMPILE_STATUS)){const I=new Error(`An error occured compiling the shader: ${m.getShaderInfoLog(A)}.`);throw I.name="WebGLError",I}return A},D="\n                  attribute vec2 a_position;\n                  attribute vec2 a_texCoord;\n  \n                  uniform mat3 u_matrix;\n                  uniform mat3 u_textureMatrix;\n  \n                  varying vec2 v_texCoord;\n                  void main(void) {\n                  gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1.0);\n                  v_texCoord = vec4((u_textureMatrix * vec3(a_texCoord, 1)).xy, 0, 1.0).xy;\n                  }\n              ";let C="rgb";["rgba","rbga","grba","gbra","brga","bgra"].includes(X)&&(C=X.slice(0,3));const w=`\n                  precision mediump float;\n                  varying vec2 v_texCoord;\n                  uniform sampler2D u_image;\n                  uniform float uColorFactor;\n  \n                  void main() {\n                      vec4 sample = texture2D(u_image, v_texCoord);\n                      float grey = 0.21 * sample.r + 0.71 * sample.g + 0.07 * sample.b;\n                      gl_FragColor = vec4(sample.${C} * (1.0 - uColorFactor) + (grey * uColorFactor), sample.a);\n                  }\n              `,T=ke(K,[Qe(K,K.VERTEX_SHADER,D),Qe(K,K.FRAGMENT_SHADER,w)]);Ki(this,xc,{program:T,attribLocations:{vertexPosition:K.getAttribLocation(T,"a_position"),texPosition:K.getAttribLocation(T,"a_texCoord")},uniformLocations:{uSampler:K.getUniformLocation(T,"u_image"),uColorFactor:K.getUniformLocation(T,"uColorFactor"),uMatrix:K.getUniformLocation(T,"u_matrix"),uTextureMatrix:K.getUniformLocation(T,"u_textureMatrix")}},"f"),Ki(this,Ac,F(K),"f"),Ki(this,xa,Ee(K),"f"),Ki(this,hd,X,"f")}const ge=(F,Ee,ke)=>{F.bindBuffer(F.ARRAY_BUFFER,Ee),F.enableVertexAttribArray(ke),F.vertexAttribPointer(ke,2,F.FLOAT,!1,0,0)},Te=(F,Ee,ke,Qe)=>{F.clearColor(0,0,0,1),F.clearDepth(1),F.enable(F.DEPTH_TEST),F.depthFunc(F.LEQUAL),F.clear(F.COLOR_BUFFER_BIT|F.DEPTH_BUFFER_BIT),ge(F,ke.positions,Ee.attribLocations.vertexPosition),ge(F,ke.texCoords,Ee.attribLocations.texPosition),F.activeTexture(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,Qe),F.uniform1i(Ee.uniformLocations.uSampler,0),F.uniform1f(Ee.uniformLocations.uColorFactor,[gt.GREY,gt.GREY32].includes(X)?1:0);let D,C,w=zr.translate(zr.identity(),-1,-1);w=zr.scale(w,2,2),w=zr.scale(w,1/F.canvas.width,1/F.canvas.height),D=zr.translate(w,k,V),D=zr.scale(D,H,z),F.uniformMatrix3fv(Ee.uniformLocations.uMatrix,!1,D),C=zr.translate(zr.identity(),b/f,O/g),C=zr.scale(C,M/f,P/g),F.uniformMatrix3fv(Ee.uniformLocations.uTextureMatrix,!1,C),F.drawArrays(F.TRIANGLES,0,6)};((F,Ee,ke)=>{const Qe=F.RGBA,D=F.RGBA,C=F.UNSIGNED_BYTE;F.bindTexture(F.TEXTURE_2D,Ee),F.texImage2D(F.TEXTURE_2D,0,Qe,D,C,ke)})(K,Wn(this,xa,"f"),l),Te(K,Wn(this,xc,"f"),Wn(this,Ac,"f"),Wn(this,xa,"f"));const xe=Y||new Uint8Array(4*H*z);if(K.readPixels(k,V,H,z,K.RGBA,K.UNSIGNED_BYTE,xe),255!==xe[3]){Ye._onLog&&Ye._onLog("Incorrect WebGL drawing .");const F=new Error("WebGL error: incorrect drawing.");throw F.name="WebGLError",F}return Ye._onLog&&Ye._onLog("drawImage() in WebGL end. Costs: "+(Date.now()-y)),{context:K,pixelFormat:X===gt.GREY?gt.GREY32:X,bUseWebGL:!0}}catch(K){if(this.forceLoseContext(),null==(null==_?void 0:_.bUseWebGL))return Ye._onLog&&Ye._onLog("'drawImage()' in WebGL failed, try again in context2d."),this.useWebGLByDefault=!1,this.drawImage(a,l,f,g,p,Object.assign({},_,{bUseWebGL:!1}));throw K.name="WebGLError",K}}readCvsData(a,l,f){if(!(a instanceof CanvasRenderingContext2D||a instanceof WebGLRenderingContext))throw new Error("Invalid 'context'.");let g,p=0,_=0,y=a.canvas.width,b=a.canvas.height;if(l&&(l.x&&(p=l.x),l.y&&(_=l.y),l.width&&(y=l.width),l.height&&(b=l.height)),(null==f?void 0:f.length)<4*y*b)throw new Error("Unexpected size of the 'bufferContainer'.");if(a instanceof WebGLRenderingContext){const O=a;f?(O.readPixels(p,_,y,b,O.RGBA,O.UNSIGNED_BYTE,f),g=new Uint8Array(f.buffer,0,4*y*b)):(g=new Uint8Array(4*y*b),O.readPixels(p,_,y,b,O.RGBA,O.UNSIGNED_BYTE,g))}else if(a instanceof CanvasRenderingContext2D){let O;O=a.getImageData(p,_,y,b),g=new Uint8Array(O.data.buffer),null==f||f.set(g)}return g}transformPixelFormat(a,l,f,g){let p,_;if(Ye._onLog&&(p=Date.now(),Ye._onLog("transformPixelFormat(), START: "+p)),l===f)return Ye._onLog&&Ye._onLog("transformPixelFormat() end. Costs: "+(Date.now()-p)),g?new Uint8Array(a):a;const y=[gt.RGBA,gt.RBGA,gt.GRBA,gt.GBRA,gt.BRGA,gt.BGRA];if(y.includes(l))if(f===gt.GREY){_=new Uint8Array(a.length/4);for(let b=0;b<a.length;b+=4)_[b/4]=.21*a[b]+.71*a[b+1]+.07*a[b+2]}else if(f===gt.GREY32){_=g?new Uint8Array(a):a;for(let b=0;b<a.length;b+=4){const O=.21*a[b]+.71*a[b+1]+.07*a[b+2];_[b]=O,_[b+1]=O,_[b+2]=O}}else{if(!y.includes(f))throw new Error("Unable to transform.");if(g){_=new Uint8Array(a);const b=l.indexOf("r"),O=l.indexOf("g"),M=l.indexOf("b"),P=f.indexOf("r"),k=f.indexOf("g"),V=f.indexOf("b");for(let H=0;H<a.length;H+=4)_[H+P]=a[H+b],_[H+k]=a[H+O],_[H+V]=a[H+M]}else{_=a;const b=l.indexOf("r"),O=l.indexOf("g"),M=l.indexOf("b"),P=f.indexOf("r"),k=f.indexOf("g"),V=f.indexOf("b");for(let H=0;H<a.length;H+=4){let z=[a[H],a[H+1],a[H+2]];_[H+P]=z[b],_[H+k]=z[O],_[H+V]=z[M]}}}else if(l===gt.GREY){if(f!==gt.GREY32)throw new Error("Unable to transform.");_=new Uint8Array(4*a.length);for(let b=0;b<a.length;b++)_[4*b]=a[b],_[4*b+1]=a[b],_[4*b+2]=a[b],_[4*b+3]=255}else{if(l!==gt.GREY32)throw new Error("Unable to transform.");if(f!==gt.GREY)throw new Error("Unable to transform.");_=new Uint8Array(a.length/4);for(let b=0;b<a.length;b+=4)_[b/4]=a[b]}return Ye._onLog&&Ye._onLog("transformPixelFormat() end. Costs: "+(Date.now()-p)),_}getImageData(a,l,f,g,p){if(this.disposed)throw Error("The 'ImageDataGetter' instance has been disposed.");if(!l||!f)throw new Error("Invalid 'sourceWidth' or 'sourceHeight'.");if(null==Wn(Ye,Yr,"f",$r)&&Ye.checkWebGLSupport(),(null==p?void 0:p.bUseWebGL)&&!Wn(Ye,Yr,"f",$r))throw new Error("Your browser or machine may not support WebGL.");if(g.sx>l||g.sy>f||g.sx+g.sWidth>l||g.sy+g.sHeight>f)throw new Error("Invalid position.");if(a instanceof HTMLVideoElement&&4!==a.readyState||a instanceof HTMLImageElement&&!a.complete)throw new Error("The source is not loaded.");let _;Ye._onLog&&(_=Date.now(),Ye._onLog("getImageData(), START: "+_));const y=Math.round(g.sx),b=Math.round(g.sy),O=Math.round(g.sWidth),M=Math.round(g.sHeight),P=Math.round(g.dWidth),k=Math.round(g.dHeight);let V=gt.RGBA;(null==p?void 0:p.pixelFormat)&&(V=p.pixelFormat);let H,z,Y,X=null;if((null==p?void 0:p.bufferContainer)&&(X=p.bufferContainer),Wn(Ye,Yr,"f",$r)&&(this.useWebGLByDefault&&null==(null==p?void 0:p.bUseWebGL)||(null==p?void 0:p.bUseWebGL))){Ye._onLog&&Ye._onLog("getImageData() in WebGL."),this._reusedWebGLCvs||(this._reusedWebGLCvs=document.createElement("canvas")),H=this._reusedWebGLCvs;try{if(X)if(V===gt.GREY){if(Y=new Uint8Array(4*P*k),z=this.drawImage(H,a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},{pixelFormat:V,bUseWebGL:!0,bufferContainer:Y}),Y=this.transformPixelFormat(Y,z.pixelFormat,V),X){if(X.length<Y.length)throw new Error("Unexpected size of the 'bufferContainer'.");X.set(Y)}}else z=this.drawImage(H,a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},{pixelFormat:V,bUseWebGL:!0,bufferContainer:X}),Y=new Uint8Array(X.buffer,0,4*P*k),Y=this.transformPixelFormat(Y,z.pixelFormat,V);else V===gt.GREY?((!Wn(this,Aa,"f")||Wn(this,Aa,"f").length<4*P*k)&&Ki(this,Aa,new Uint8Array(4*P*k),"f"),Y=new Uint8Array(Wn(this,Aa,"f").buffer,0,4*P*k)):Y=new Uint8Array(4*P*k),z=this.drawImage(H,a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},{pixelFormat:V,bUseWebGL:!0,bufferContainer:Y}),Y=this.transformPixelFormat(Y,z.pixelFormat,V)}catch($){if("WebGLError"===$.name&&(this.forceLoseContext(),null==(null==p?void 0:p.bUseWebGL)))return Ye._onLog&&Ye._onLog("getImageData() in WebGL failed, try again in context2d."),this.useWebGLByDefault=!1,this.getImageData(a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},Object.assign({},p,{bUseWebGL:!1}));throw $}}else if(Ye._onLog&&Ye._onLog("getImageData() in context2d."),this._reusedCvs||(this._reusedCvs=document.createElement("canvas")),H=this._reusedCvs,z=this.drawImage(H,a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},{pixelFormat:gt.RGBA,bUseWebGL:!1}),Y=this.readCvsData(z.context,{width:P,height:k},null),Y=this.transformPixelFormat(Y,z.pixelFormat,V),X){if(X.length<Y.length)throw new Error("Unexpected size of the 'bufferContainer'.");X.set(Y)}return Ye._onLog&&Ye._onLog("getImageData() end. Costs: "+(Date.now()-_)),{data:Y,pixelFormat:V,width:P,height:k,bUseWebGL:z.bUseWebGL}}convertDataToCvs(a,l,f,g){if(!(a instanceof Uint8Array||a instanceof Uint8ClampedArray))throw new TypeError("Invalid 'data'.");if("number"!=typeof l||l<=0)throw new Error("Invalid 'width'.");if("number"!=typeof f||f<=0)throw new Error("Invalid 'height'.");const p=document.createElement("canvas");let _;if(p.width=l,p.height=f,g===gt.GREY){_=new Uint8ClampedArray(4*l*f);for(let b=0;b<_.length;b+=4)_[b]=a[b/4],_[b+1]=a[b/4],_[b+2]=a[b/4],_[b+3]=255}else _=new Uint8ClampedArray(a.buffer);const y=new ImageData(_,l,f);return p.getContext("2d").putImageData(y,0,0),p}forceLoseContext(){if(!this._reusedWebGLCvs)return;const a=this._reusedWebGLCvs.ctxWebGL;a&&!a.isContextLost()&&a.getExtension("WEBGL_lose_context")&&a.getExtension("WEBGL_lose_context").loseContext(),Ki(this,xa,null,"f"),Ki(this,xc,null,"f"),Ki(this,Ac,null,"f"),this._reusedWebGLCvs=null}dispose(){this.forceLoseContext(),Ki(this,dd,!0,"f")}}Yr=Ye,hd=new WeakMap,xa=new WeakMap,xc=new WeakMap,Ac=new WeakMap,Aa=new WeakMap,dd=new WeakMap,$r={value:void 0};class bj{constructor(){fo.set(this,new Map),fd.set(this,!1)}get disposed(){return Z(this,fd,"f")}on(a,l){a=a.toLowerCase();const f=Z(this,fo,"f").get(a);if(f){if(f.includes(l))return;f.push(l)}else Z(this,fo,"f").set(a,[l])}off(a,l){a=a.toLowerCase();const f=Z(this,fo,"f").get(a);if(!f)return;const g=f.indexOf(l);-1!==g&&f.splice(g,1)}offAll(a){a=a.toLowerCase();const l=Z(this,fo,"f").get(a);l&&(l.length=0)}fire(a,l=[],f={async:!1,copy:!0}){var g=this;return ae(function*(){l||(l=[]),a=a.toLowerCase();const p=Z(g,fo,"f").get(a);if(p&&p.length){f=Object.assign({async:!1,copy:!0},f);for(let _ of p){if(!_)continue;let y=[];if(f.copy)for(let O of l){try{O=JSON.parse(JSON.stringify(O))}catch(M){}y.push(O)}else y=l;let b=!1;if(f.async)setTimeout(()=>{g.disposed||_.apply(f.target,y)},0);else try{b=_.apply(f.target,y)}catch(O){}if(!0===b)break}}})()}dispose(){ft(this,fd,!0,"f")}}fo=new WeakMap,fd=new WeakMap;const Qn=(u,a,l,f)=>{if(!l)return u;let g=a+Math.round((u-a)/l)*l;return f&&(g=Math.min(g,f)),g};class Ge{static get version(){return"2.0.7"}static isStorageAvailable(a){let l;try{l=window[a];const f="__storage_test__";return l.setItem(f,f),l.removeItem(f),!0}catch(f){return f instanceof DOMException&&(22===f.code||1014===f.code||"QuotaExceededError"===f.name||"NS_ERROR_DOM_QUOTA_REACHED"===f.name)&&l&&0!==l.length}}static findBestRearCameraInIOS(a,l){if(!a||!a.length)return null;let f=!1;if((null==l?void 0:l.getMainCamera)&&(f=!0),f){const g=["\ud6c4\uba74 \uce74\uba54\ub77c","\u80cc\u9762\u30ab\u30e1\u30e9","\u5f8c\u7f6e\u93e1\u982d","\u540e\u7f6e\u76f8\u673a","\u0e01\u0e25\u0e49\u0e2d\u0e07\u0e14\u0e49\u0e32\u0e19\u0e2b\u0e25\u0e31\u0e07","\u092c\u0948\u0915 \u0915\u0948\u092e\u0930\u093e","\u0627\u0644\u0643\u0627\u0645\u064a\u0631\u0627 \u0627\u0644\u062e\u0644\u0641\u064a\u0629","\u05de\u05e6\u05dc\u05de\u05d4 \u05d0\u05d7\u05d5\u05e8\u05d9\u05ea","\u043a\u0430\u043c\u0435\u0440\u0430 \u043d\u0430 \u0437\u0430\u0434\u043d\u0435\u0439 \u043f\u0430\u043d\u0435\u043b\u0438","\u0437\u0430\u0434\u043d\u044f \u043a\u0430\u043c\u0435\u0440\u0430","\u0437\u0430\u0434\u043d\u0430 \u043a\u0430\u043c\u0435\u0440\u0430","\u0430\u0440\u0442\u049b\u044b \u043a\u0430\u043c\u0435\u0440\u0430","\u03c0\u03af\u03c3\u03c9 \u03ba\u03ac\u03bc\u03b5\u03c1\u03b1","zadn\xed fotoapar\xe1t","zadn\xe1 kamera","tylny aparat","takakamera","stra\u017enja kamera","r\xfcckkamera","kamera p\xe5 baksidan","kamera belakang","kamera bak","h\xe1ts\xf3 kamera","fotocamera (posteriore)","c\xe2mera traseira","c\xe2mara traseira","c\xe1mara trasera","c\xe0mera posterior","cam\xe9ra arri\xe8re","camer\u0103 spate","camera m\u1eb7t sau","camera aan achterzijde","bagsidekamera","back camera","arka kamera"],p=a.find(_=>g.includes(_.label.toLowerCase()));return null==p?void 0:p.deviceId}{const g=["\ud6c4\uba74","\u80cc\u9762","\u5f8c\u7f6e","\u540e\u7f6e","\u0e32\u0e19\u0e2b\u0e25\u0e31\u0e07","\u092c\u0948\u0915","\u062e\u0644\u0641\u064a\u0629","\u05d0\u05d7\u05d5\u05e8\u05d9\u05ea","\u0437\u0430\u0434\u043d\u044f\u044f","\u0437\u0430\u0434\u043d\u0435\u0439","\u0437\u0430\u0434\u043d\u0430","\u03c0\u03af\u03c3\u03c9","zadn\xed","zadn\xe1","tylny","trasera","traseira","taka","stra\u017enja","spate","sau","r\xfcck","posteriore","posterior","h\xe1ts\xf3","belakang","baksidan","bakre","bak","bagside","back","a\u0440\u0442\u049b\u044b","arri\xe8re","arka","achterzijde"],p=["\ud2b8\ub9ac\ud50c","\u4e09\u955c\u5934","\u4e09\u93e1\u982d","\u30c8\u30ea\u30d7\u30eb","\u0e2a\u0e32\u0e21","\u091f\u094d\u0930\u093f\u092a\u0932","\u062b\u0644\u0627\u062b\u064a\u0629","\u05de\u05e9\u05d5\u05dc\u05e9\u05ea","\u04af\u0448\u0442\u0456\u043a","\u0442\u0440\u043e\u0439\u043d\u0430\u044f","\u0442\u0440\u043e\u0439\u043d\u0430","\u043f\u043e\u0442\u0440\u043e\u0454\u043d\u0430","\u03c4\u03c1\u03b9\u03c0\u03bb\u03ae","\xfc\xe7l\xfc","tr\xf3jobiektywowy","trostruka","trojn\xfd","trojit\xe1","trippelt","trippel","tripl\u0103","triple","tripla","tiga","kolmois","ba camera"],_=["\ub4c0\uc5bc \uc640\uc774\ub4dc","\u96d9\u5ee3\u89d2","\u53cc\u5e7f\u89d2","\u30c7\u30e5\u30a2\u30eb\u5e83\u89d2","\u0e04\u0e39\u0e48\u0e14\u0e49\u0e32\u0e19\u0e2b\u0e25\u0e31\u0e07\u0e21\u0e38\u0e21\u0e01\u0e27\u0e49\u0e32\u0e07","\u0921\u094d\u092f\u0941\u0905\u0932 \u0935\u093e\u0907\u0921","\u0645\u0632\u062f\u0648\u062c\u0629 \u0639\u0631\u064a\u0636\u0629","\u05db\u05e4\u05d5\u05dc\u05d4 \u05e8\u05d7\u05d1\u05d4","\u049b\u043e\u0441 \u043a\u0435\u04a3 \u0431\u04b1\u0440\u044b\u0448\u0442\u044b","\u0437\u0434\u0432\u043e\u0454\u043d\u0430 \u0448\u0438\u0440\u043e\u043a\u043e\u043a\u0443\u0442\u043d\u0430","\u0434\u0432\u043e\u0439\u043d\u0430\u044f \u0448\u0438\u0440\u043e\u043a\u043e\u0443\u0433\u043e\u043b\u044c\u043d\u0430\u044f","\u0434\u0432\u043e\u0439\u043d\u0430 \u0448\u0438\u0440\u043e\u043a\u043e\u044a\u0433\u044a\u043b\u043d\u0430","\u03b4\u03b9\u03c0\u03bb\u03ae \u03b5\u03c5\u03c1\u03b5\u03af\u03b1","\xe7ift geni\u015f","laajakulmainen kaksois","k\xe9p r\u1ed9ng m\u1eb7t sau","kett\u0151s, sz\xe9les l\xe1t\xf3sz\xf6g\u0171","grande angular dupla","ganda","dwuobiektywowy","dwikamera","dvostruka \u0161iroka","du\xe1ln\xed \u0161iroko\xfahl\xfd","du\xe1lna \u0161irokouhl\xe1","dupla grande-angular","dubl\u0103","dubbel vidvinkel","dual-weitwinkel","dual wide","dual con gran angular","dual","double","doppia con grandangolo","doble","dobbelt vidvinkelkamera"],y=a.filter(M=>{const P=M.label.toLowerCase();return g.some(k=>P.includes(k))});if(!y.length)return null;const b=y.find(M=>{const P=M.label.toLowerCase();return p.some(k=>P.includes(k))});if(b)return b.deviceId;const O=y.find(M=>{const P=M.label.toLowerCase();return _.some(k=>P.includes(k))});return O?O.deviceId:y[0].deviceId}}static findBestRearCamera(a,l){if(!a||!a.length)return null;if(["iPhone","iPad","Mac"].includes(kn.OS))return Ge.findBestRearCameraInIOS(a,{getMainCamera:null==l?void 0:l.getMainCameraInIOS});const f=["\ud6c4","\u80cc\u9762","\u80cc\u7f6e","\u5f8c\u9762","\u5f8c\u7f6e","\u540e\u9762","\u540e\u7f6e","\u0e32\u0e19\u0e2b\u0e25\u0e31\u0e07","\u0e2b\u0e25\u0e31\u0e07","\u092c\u0948\u0915","\u062e\u0644\u0641\u064a\u0629","\u05d0\u05d7\u05d5\u05e8\u05d9\u05ea","\u0437\u0430\u0434\u043d\u044f\u044f","\u0437\u0430\u0434\u043d\u044f","\u0437\u0430\u0434\u043d\u0435\u0439","\u0437\u0430\u0434\u043d\u0430","\u03c0\u03af\u03c3\u03c9","zadn\xed","zadn\xe1","tylny","tr\xe1s","trasera","traseira","taka","stra\u017enja","spate","sau","r\xfcck","rear","posteriore","posterior","h\xe1ts\xf3","darrere","belakang","baksidan","bakre","bak","bagside","back","a\u0440\u0442\u049b\u044b","arri\xe8re","arka","achterzijde"];for(let g of a){const p=g.label.toLowerCase();if(p&&f.some(_=>p.includes(_))&&/\b0(\b)?/.test(p))return g.deviceId}return["Android","HarmonyOS"].includes(kn.OS)?a[a.length-1].deviceId:null}static findBestCamera(a,l,f){return a&&a.length?"environment"===l?this.findBestRearCamera(a,f):"user"===l?null:l?void 0:null:null}static playVideo(a,l,f){return ae(function*(){if(!a)throw new Error("Invalid 'videoEl'.");if(!l)throw new Error("Invalid 'source'.");return new Promise(function(){var g=ae(function*(p,_){let y;const b=()=>{a.removeEventListener("loadstart",k),a.removeEventListener("abort",V),a.removeEventListener("play",H),a.removeEventListener("error",z),a.removeEventListener("loadedmetadata",$)};let O=!1;const M=()=>{O=!0,y&&clearTimeout(y),b(),p(a)},P=K=>{y&&clearTimeout(y),b(),_(K)},k=()=>{a.addEventListener("abort",V,{once:!0})},V=()=>{const K=new Error("Video playing was interrupted.");K.name="AbortError",P(K)},H=()=>{M()},z=()=>{P(new Error(`Video error ${a.error.code}: ${a.error.message}.`))};let Y;const X=new Promise(K=>{Y=K}),$=()=>{Y()};if(a.addEventListener("loadstart",k,{once:!0}),a.addEventListener("play",H,{once:!0}),a.addEventListener("error",z,{once:!0}),a.addEventListener("loadedmetadata",$,{once:!0}),"string"==typeof l||l instanceof String?a.src=l:a.srcObject=l,a.autoplay&&(yield new Promise(K=>{setTimeout(K,1e3)})),!O){f&&(y=setTimeout(()=>{b(),_(new Error("Failed to play video. Timeout."))},f));try{a.src&&(yield a.load()),yield a.play(),M()}catch(K){console.warn("1st play error: "+((null==K?void 0:K.message)||K))}if(!O){yield X;try{yield a.play(),M()}catch(K){console.warn("2rd play error: "+((null==K?void 0:K.message)||K)),P(K)}}}});return function(p,_){return g.apply(this,arguments)}}())})()}static testCameraAccess(a){return ae(function*(){var l,f;if(!(null===(f=null===(l=null==window?void 0:window.navigator)||void 0===l?void 0:l.mediaDevices)||void 0===f?void 0:f.getUserMedia))return{ok:!1,errorName:"InsecureContext",errorMessage:"Insecure context."};let g;try{g=a?yield navigator.mediaDevices.getUserMedia(a):yield navigator.mediaDevices.getUserMedia({video:!0})}catch(p){return{ok:!1,errorName:p.name,errorMessage:p.message}}finally{null==g||g.getTracks().forEach(p=>{p.stop()})}return{ok:!0}})()}get state(){if(!Z(this,di,"f"))return"closed";if("pending"===Z(this,di,"f"))return"opening";if("fulfilled"===Z(this,di,"f"))return"opened";throw new Error("Unknown state.")}set ifSaveLastUsedCamera(a){a?Ge.isStorageAvailable("localStorage")?ft(this,Ra,!0,"f"):(ft(this,Ra,!1,"f"),console.warn("Local storage is unavailable")):ft(this,Ra,!1,"f")}get ifSaveLastUsedCamera(){return Z(this,Ra,"f")}get isVideoPlaying(){return!(!Z(this,Je,"f")||Z(this,Je,"f").paused)&&"opened"===this.state}set tapFocusEventBoundEl(a){var l,f,g;if(!(a instanceof HTMLElement)&&null!=a)throw new TypeError("Invalid 'element'.");null===(l=Z(this,go,"f"))||void 0===l||l.removeEventListener("click",Z(this,La,"f")),null===(f=Z(this,go,"f"))||void 0===f||f.removeEventListener("touchend",Z(this,La,"f")),null===(g=Z(this,go,"f"))||void 0===g||g.removeEventListener("touchmove",Z(this,_d,"f")),ft(this,go,a,"f"),a&&(window.TouchEvent&&["Android","HarmonyOS","iPhone","iPad"].includes(kn.OS)?(a.addEventListener("touchend",Z(this,La,"f")),a.addEventListener("touchmove",Z(this,_d,"f"))):a.addEventListener("click",Z(this,La,"f")))}get tapFocusEventBoundEl(){return Z(this,go,"f")}get disposed(){return Z(this,yd,"f")}constructor(a){var f,g,l=this;Fe.add(this),Je.set(this,null),vt.set(this,void 0),gd.set(this,()=>{"opened"===this.state&&Z(this,fn,"f").fire("resumed",null,{target:this,async:!1})}),pd.set(this,()=>{Z(this,fn,"f").fire("paused",null,{target:this,async:!1})}),At.set(this,void 0),Oi.set(this,void 0),this.cameraOpenTimeout=15e3,this._arrCameras=[],Xr.set(this,void 0),Ra.set(this,!1),this.ifSkipCameraInspection=!1,this.selectIOSRearMainCameraAsDefault=!1,md.set(this,void 0),br.set(this,!0),qr.set(this,void 0),di.set(this,void 0),Oa.set(this,!1),this._focusParameters={maxTimeout:400,minTimeout:300,kTimeout:void 0,oldDistance:null,fds:null,isDoingFocus:0,taskBackToContinous:null,curFocusTaskId:0,focusCancelableTime:1500,defaultFocusAreaSizeRatio:6,focusBackToContinousTime:5e3,tapFocusMinDistance:null,tapFocusMaxDistance:null,focusArea:null,tempBufferContainer:null,defaultTempBufferContainerLenRatio:1/4},Ma.set(this,!1),this._focusSupported=!0,this.calculateCoordInVideo=(p,_)=>{let y,b;const O=window.getComputedStyle(Z(this,Je,"f")).objectFit,M=this.getResolution(),P=Z(this,Je,"f").getBoundingClientRect(),k=P.left,V=P.top,{width:H,height:z}=Z(this,Je,"f").getBoundingClientRect();if(H<=0||z<=0)throw new Error("Unable to get video dimensions. Video may not be rendered on the page.");const Y=H/z,X=M.width/M.height;let $=1;if("contain"===O)X>Y?($=H/M.width,y=(p-k)/$,b=(_-V-(z-H/X)/2)/$):($=z/M.height,b=(_-V)/$,y=(p-k-(H-z*X)/2)/$);else{if("cover"!==O)throw new Error("Unsupported object-fit.");X>Y?($=z/M.height,b=(_-V)/$,y=(p-k+(z*X-H)/2)/$):($=H/M.width,y=(p-k)/$,b=(_-V+(H/X-z)/2)/$)}return{x:y,y:b}},Rc.set(this,!1),_d.set(this,()=>{ft(this,Rc,!0,"f")}),La.set(this,function(){var p=ae(function*(_){var y;if(Z(l,Rc,"f"))return void ft(l,Rc,!1,"f");if(!(Z(l,Ma,"f")&&l.isVideoPlaying&&Z(l,vt,"f")&&l._focusSupported))return;if(!l._focusParameters.fds&&(l._focusParameters.fds=null===(y=l.getCameraCapabilities())||void 0===y?void 0:y.focusDistance,!l._focusParameters.fds))return void(l._focusSupported=!1);if(null==l._focusParameters.kTimeout&&(l._focusParameters.kTimeout=(l._focusParameters.maxTimeout-l._focusParameters.minTimeout)/(1/l._focusParameters.fds.min-1/l._focusParameters.fds.max)),1==l._focusParameters.isDoingFocus)return;let b,O;if(l._focusParameters.taskBackToContinous&&(clearTimeout(l._focusParameters.taskBackToContinous),l._focusParameters.taskBackToContinous=null),_ instanceof MouseEvent)b=_.clientX,O=_.clientY;else{if(!(_ instanceof TouchEvent))throw new Error("Unknown event type.");if(!_.changedTouches.length)return;b=_.changedTouches[0].clientX,O=_.changedTouches[0].clientY}const M=l.getResolution(),P=2*Math.round(Math.min(M.width,M.height)/l._focusParameters.defaultFocusAreaSizeRatio/2);let k;try{k=l.calculateCoordInVideo(b,O)}catch(X){}if(k.x<0||k.x>M.width||k.y<0||k.y>M.height)return;const V={x:k.x+"px",y:k.y+"px"},H=P+"px",z=H;let Y;Ge._onLog&&(Y=Date.now());try{yield Z(l,Fe,"m",C_).call(l,V,H,z,l._focusParameters.tapFocusMinDistance,l._focusParameters.tapFocusMaxDistance)}catch(X){if(Ge._onLog)throw Ge._onLog(X),X}Ge._onLog&&Ge._onLog(`Tap focus costs: ${Date.now()-Y} ms`),l._focusParameters.taskBackToContinous=setTimeout(()=>{var X;Ge._onLog&&Ge._onLog("Back to continuous focus."),null===(X=Z(l,vt,"f"))||void 0===X||X.applyConstraints({advanced:[{focusMode:"continuous"}]}).catch(()=>{})},l._focusParameters.focusBackToContinousTime),Z(l,fn,"f").fire("tapfocus",null,{target:l,async:!1})});return function(_){return p.apply(this,arguments)}}()),go.set(this,null),Zr.set(this,1),Kr.set(this,{x:0,y:0}),this.updateVideoElWhenSoftwareScaled=()=>{if(!Z(this,Je,"f"))return;const p=Z(this,Zr,"f");if(p<1)throw new RangeError("Invalid scale value.");if(1===p)Z(this,Je,"f").style.transform="";else{const _=window.getComputedStyle(Z(this,Je,"f")).objectFit,y=Z(this,Je,"f").videoWidth,b=Z(this,Je,"f").videoHeight,{width:O,height:M}=Z(this,Je,"f").getBoundingClientRect();if(O<=0||M<=0)throw new Error("Unable to get video dimensions. Video may not be rendered on the page.");const P=O/M,k=y/b;let V=1;"contain"===_?V=P<k?O/(y/p):M/(b/p):"cover"===_&&(V=k>P?M/(y/p):O/(b/p));const H=V*(1-1/p)*(y/2-Z(this,Kr,"f").x),z=V*(1-1/p)*(b/2-Z(this,Kr,"f").y);Z(this,Je,"f").style.transform=`translate(${H}px, ${z}px) scale(${p})`}},m_.set(this,function(){if(!(this.data instanceof Uint8Array||this.data instanceof Uint8ClampedArray))throw new TypeError("Invalid data.");if("number"!=typeof this.width||this.width<=0)throw new Error("Invalid width.");if("number"!=typeof this.height||this.height<=0)throw new Error("Invalid height.");const p=document.createElement("canvas");let _;if(p.width=this.width,p.height=this.height,this.pixelFormat===gt.GREY){_=new Uint8ClampedArray(this.width*this.height*4);for(let b=0;b<_.length;b+=4)_[b]=this.data[b/4],_[b+1]=this.data[b/4],_[b+2]=this.data[b/4],_[b+3]=255}else _=new Uint8ClampedArray(this.data.buffer);const y=new ImageData(_,this.width,this.height);return p.getContext("2d").putImageData(y,0,0),p}),fn.set(this,void 0),__.set(this,["before:open","opened","before:close","closed","before:camera:change","camera:changed","before:resolution:change","resolution:changed","played","paused","resumed","tapfocus"]),this.detectedResolutions=[{width:160,height:120},{width:320,height:240},{width:480,height:360},{width:640,height:480},{width:800,height:600},{width:960,height:720},{width:1280,height:720},{width:1920,height:1080},{width:2560,height:1440},{width:3840,height:2160}],po.set(this,new Map),GT.set(this,!1),vd.set(this,ae(function*(){var p,_;if("visible"===document.visibilityState){if(Ge._onLog&&Ge._onLog("document visible. video paused: "+(null===(p=Z(l,Je,"f"))||void 0===p?void 0:p.paused)),"opening"==l.state||"opened"==l.state){let y=!1;if(!l.isVideoPlaying){Ge._onLog&&Ge._onLog("document visible. Not auto resume. 1st resume start.");try{yield l.resume(),y=!0}catch(b){Ge._onLog&&Ge._onLog("document visible. 1st resume video failed, try open instead.")}y||(yield Z(l,Fe,"m",Fa).call(l))}if(yield new Promise(b=>setTimeout(b,300)),!l.isVideoPlaying){Ge._onLog&&Ge._onLog("document visible. 1st open failed. 2rd resume start."),y=!1;try{yield l.resume(),y=!0}catch(b){Ge._onLog&&Ge._onLog("document visible. 2rd resume video failed, try open instead.")}y||(yield Z(l,Fe,"m",Fa).call(l))}}}else"hidden"===document.visibilityState&&(Ge._onLog&&Ge._onLog("document hidden. video paused: "+(null===(_=Z(l,Je,"f"))||void 0===_?void 0:_.paused)),"opening"==l.state||"opened"==l.state&&l.isVideoPlaying&&l.pause())})),yd.set(this,!1),(null===(g=null===(f=null==window?void 0:window.navigator)||void 0===f?void 0:f.mediaDevices)||void 0===g?void 0:g.getUserMedia)||setTimeout(()=>{Ge.onWarning&&Ge.onWarning("The browser is too old or the page is loaded from an insecure origin.")},0),this.defaultConstraints={video:{facingMode:{ideal:"environment"}}},this.resetMediaStreamConstraints(),a instanceof HTMLVideoElement&&this.setVideoEl(a),ft(this,fn,new bj,"f"),this.imageDataGetter=new Ye,document.addEventListener("visibilitychange",Z(this,vd,"f"))}setVideoEl(a){if(!(a&&a instanceof HTMLVideoElement))throw new Error("Invalid 'videoEl'.");a.addEventListener("play",Z(this,gd,"f")),a.addEventListener("pause",Z(this,pd,"f")),ft(this,Je,a,"f")}getVideoEl(){return Z(this,Je,"f")}releaseVideoEl(){var a,l;null===(a=Z(this,Je,"f"))||void 0===a||a.removeEventListener("play",Z(this,gd,"f")),null===(l=Z(this,Je,"f"))||void 0===l||l.removeEventListener("pause",Z(this,pd,"f")),ft(this,Je,null,"f")}isVideoLoaded(){return!!Z(this,Je,"f")&&4==Z(this,Je,"f").readyState}open(){var a=this;return ae(function*(){if(Z(a,qr,"f")&&!Z(a,br,"f")){if("pending"===Z(a,di,"f"))return Z(a,qr,"f");if("fulfilled"===Z(a,di,"f"))return}Z(a,fn,"f").fire("before:open",null,{target:a}),yield Z(a,Fe,"m",Fa).call(a),Z(a,fn,"f").fire("played",null,{target:a,async:!1}),Z(a,fn,"f").fire("opened",null,{target:a,async:!1})})()}close(){var a=this;return ae(function*(){if("closed"===a.state)return;Z(a,fn,"f").fire("before:close",null,{target:a});const l=Z(a,qr,"f");if(Z(a,Fe,"m",Cd).call(a),l&&"pending"===Z(a,di,"f")){try{yield l}catch(f){}if(!1===Z(a,br,"f")){const f=new Error("'close()' was interrupted.");throw f.name="AbortError",f}}ft(a,qr,null,"f"),ft(a,di,null,"f"),Z(a,fn,"f").fire("closed",null,{target:a,async:!1})})()}pause(){if(!this.isVideoLoaded())throw new Error("Video is not loaded.");if("opened"!==this.state)throw new Error("Camera or video is not open.");Z(this,Je,"f").pause()}resume(){var a=this;return ae(function*(){if(!a.isVideoLoaded())throw new Error("Video is not loaded.");if("opened"!==a.state)throw new Error("Camera or video is not open.");yield Z(a,Je,"f").play()})()}setCamera(a){var l=this;return ae(function*(){if("string"!=typeof a)throw new TypeError("Invalid 'deviceId'.");if("object"!=typeof Z(l,At,"f").video&&(Z(l,At,"f").video={}),delete Z(l,At,"f").video.facingMode,Z(l,At,"f").video.deviceId={exact:a},!("closed"===l.state||l.videoSrc||"opening"===l.state&&Z(l,br,"f"))){Z(l,fn,"f").fire("before:camera:change",[],{target:l,async:!1}),yield Z(l,Fe,"m",Oc).call(l);try{l.resetSoftwareScale()}catch(f){}return Z(l,Oi,"f")}})()}switchToFrontCamera(a){var l=this;return ae(function*(){if("object"!=typeof Z(l,At,"f").video&&(Z(l,At,"f").video={}),(null==a?void 0:a.resolution)&&(Z(l,At,"f").video.width={ideal:a.resolution.width},Z(l,At,"f").video.height={ideal:a.resolution.height}),delete Z(l,At,"f").video.deviceId,Z(l,At,"f").video.facingMode={exact:"user"},ft(l,Xr,null,"f"),!("closed"===l.state||l.videoSrc||"opening"===l.state&&Z(l,br,"f"))){Z(l,fn,"f").fire("before:camera:change",[],{target:l,async:!1}),Z(l,Fe,"m",Oc).call(l);try{l.resetSoftwareScale()}catch(f){}return Z(l,Oi,"f")}})()}getCamera(){var a;if(Z(this,Oi,"f"))return Z(this,Oi,"f");{let l=(null===(a=Z(this,At,"f").video)||void 0===a?void 0:a.deviceId)||"";if(l){l=l.exact||l.ideal||l;for(let f of this._arrCameras)if(f.deviceId===l)return JSON.parse(JSON.stringify(f))}return{deviceId:"",label:"",_checked:!1}}}_getCameras(a){var l=this;return ae(function*(){var f,g;if(!(null===(g=null===(f=null==window?void 0:window.navigator)||void 0===f?void 0:f.mediaDevices)||void 0===g?void 0:g.getUserMedia))throw new Error("Failed to access the camera because the browser is too old or the page is loaded from an insecure origin.");let p;if(a){let b=yield navigator.mediaDevices.getUserMedia({video:!0});p=(yield navigator.mediaDevices.enumerateDevices()).filter(O=>"videoinput"===O.kind),b.getTracks().forEach(O=>{O.stop()})}else p=(yield navigator.mediaDevices.enumerateDevices()).filter(b=>"videoinput"===b.kind);const _=[],y=[];if(l._arrCameras)for(let b of l._arrCameras)b._checked&&y.push(b);for(let b=0;b<p.length;b++){let O,M=p[b];for(let P of y)if(M.deviceId==P.deviceId){O=P;break}O||(O={deviceId:M.deviceId,label:M.label?M.label:"camera "+b,_checked:!1}),O.deviceId&&_.push(O)}return l._arrCameras=_,Ge._onLog&&Ge._onLog(JSON.stringify(l._arrCameras)),_})()}getCameras(){var a=this;return ae(function*(){var l,f;if(!(null===(f=null===(l=null==window?void 0:window.navigator)||void 0===l?void 0:l.mediaDevices)||void 0===f?void 0:f.enumerateDevices))throw new Error("Failed to access the camera because the browser is too old or the page is loaded from an insecure origin.");const g=(yield navigator.mediaDevices.enumerateDevices()).filter(p=>"videoinput"===p.kind);return a._getCameras(!(!g||!g.length||g[0].deviceId))})()}getAllCameras(){var a=this;return ae(function*(){return a.getCameras()})()}setResolution(a,l,f){var g=this;return ae(function*(){if("number"!=typeof a||a<=0)throw new TypeError("Invalid 'width'.");if("number"!=typeof l||l<=0)throw new TypeError("Invalid 'height'.");if("object"!=typeof Z(g,At,"f").video&&(Z(g,At,"f").video={}),f?(Z(g,At,"f").video.width={exact:a},Z(g,At,"f").video.height={exact:l}):(Z(g,At,"f").video.width={ideal:a},Z(g,At,"f").video.height={ideal:l}),"closed"===g.state||g.videoSrc||"opening"===g.state&&Z(g,br,"f"))return null;Z(g,fn,"f").fire("before:resolution:change",[],{target:g,async:!1}),yield Z(g,Fe,"m",Oc).call(g);try{g.resetSoftwareScale()}catch(_){}const p=g.getResolution();return{width:p.width,height:p.height}})()}getResolution(){if("opened"===this.state&&this.videoSrc&&Z(this,Je,"f"))return{width:Z(this,Je,"f").videoWidth,height:Z(this,Je,"f").videoHeight};if(Z(this,vt,"f")){const a=Z(this,vt,"f").getSettings();return{width:a.width,height:a.height}}if(this.isVideoLoaded())return{width:Z(this,Je,"f").videoWidth,height:Z(this,Je,"f").videoHeight};{const a={width:0,height:0};let l=Z(this,At,"f").video.width||0,f=Z(this,At,"f").video.height||0;return l&&(a.width=l.exact||l.ideal||l),f&&(a.height=f.exact||f.ideal||f),a}}getResolutions(a){var l=this;return ae(function*(){var f,g,p,_,y,b,O,M,P,k,V;if(!(null===(g=null===(f=null==window?void 0:window.navigator)||void 0===f?void 0:f.mediaDevices)||void 0===g?void 0:g.getUserMedia))throw new Error("Failed to access the camera because the browser is too old or the page is loaded from an insecure origin.");let H="";const z=(Y,X)=>{const $=Z(l,po,"f").get(Y);if(!$||!$.length)return!1;for(let K of $)if(K.width===X.width&&K.height===X.height)return!0;return!1};if(l._mediaStream){H=null===(V=Z(l,Oi,"f"))||void 0===V?void 0:V.deviceId;let Y=Z(l,po,"f").get(H);if(Y&&!a)return JSON.parse(JSON.stringify(Y));Y=[],Z(l,po,"f").set(H,Y),ft(l,Oa,!0,"f");try{for(let X of l.detectedResolutions){yield Z(l,vt,"f").applyConstraints({width:{ideal:X.width},height:{ideal:X.height}}),Z(l,Fe,"m",Qi).call(l);const $=Z(l,vt,"f").getSettings(),K={width:$.width,height:$.height};z(H,K)||Y.push({width:K.width,height:K.height})}}catch(X){throw Z(l,Fe,"m",Cd).call(l),ft(l,Oa,!1,"f"),X}try{yield Z(l,Fe,"m",Fa).call(l)}catch(X){if("AbortError"===X.name)return Y;throw X}finally{ft(l,Oa,!1,"f")}return Y}{const Y=function(){var K=ae(function*(ge,_e,Te){const xe={video:{deviceId:{exact:ge},width:{ideal:_e},height:{ideal:Te}}};let F=null;try{F=yield navigator.mediaDevices.getUserMedia(xe)}catch(Qe){return null}if(!F)return null;const Ee=F.getVideoTracks();let ke=null;try{const Qe=Ee[0].getSettings();ke={width:Qe.width,height:Qe.height}}catch(Qe){const D=document.createElement("video");D.srcObject=F,ke={width:D.videoWidth,height:D.videoHeight},D.srcObject=null}return Ee.forEach(Qe=>{Qe.stop()}),ke});return function(_e,Te,xe){return K.apply(this,arguments)}}();let X=(null===(y=null===(_=null===(p=Z(l,At,"f"))||void 0===p?void 0:p.video)||void 0===_?void 0:_.deviceId)||void 0===y?void 0:y.exact)||(null===(M=null===(O=null===(b=Z(l,At,"f"))||void 0===b?void 0:b.video)||void 0===O?void 0:O.deviceId)||void 0===M?void 0:M.ideal)||(null===(k=null===(P=Z(l,At,"f"))||void 0===P?void 0:P.video)||void 0===k?void 0:k.deviceId);if(!X)return[];let $=Z(l,po,"f").get(X);if($&&!a)return JSON.parse(JSON.stringify($));$=[],Z(l,po,"f").set(X,$);for(let K of l.detectedResolutions){const ge=yield Y(X,K.width,K.height);ge&&!z(X,ge)&&$.push({width:ge.width,height:ge.height})}return $}})()}setMediaStreamConstraints(a,l){var f=this;return ae(function*(){if(null===(g=a)||"[object Object]"!==Object.prototype.toString.call(g))throw new TypeError("Invalid 'mediaStreamConstraints'.");var g;ft(f,At,JSON.parse(JSON.stringify(a)),"f"),ft(f,Xr,null,"f"),l&&Z(f,Fe,"m",Oc).call(f)})()}getMediaStreamConstraints(){return JSON.parse(JSON.stringify(Z(this,At,"f")))}resetMediaStreamConstraints(){ft(this,At,this.defaultConstraints?JSON.parse(JSON.stringify(this.defaultConstraints)):null,"f")}getCameraCapabilities(){if(!Z(this,vt,"f")||"opened"!==this.state)throw new Error("Camera is not open.");return Z(this,vt,"f").getCapabilities?Z(this,vt,"f").getCapabilities():{}}getCameraSettings(){if(!Z(this,vt,"f")||"opened"!==this.state)throw new Error("Camera is not open.");return Z(this,vt,"f").getSettings()}turnOnTorch(){var a=this;return ae(function*(){if(!Z(a,vt,"f")||"opened"!==a.state)throw new Error("Camera is not open.");const l=a.getCameraCapabilities();if(!(null==l?void 0:l.torch))throw Error("Not supported.");yield Z(a,vt,"f").applyConstraints({advanced:[{torch:!0}]})})()}turnOffTorch(){var a=this;return ae(function*(){if(!Z(a,vt,"f")||"opened"!==a.state)throw new Error("Camera is not open.");const l=a.getCameraCapabilities();if(!(null==l?void 0:l.torch))throw Error("Not supported.");yield Z(a,vt,"f").applyConstraints({advanced:[{torch:!1}]})})()}setColorTemperature(a,l){var f=this;return ae(function*(){var g;if("number"!=typeof a)throw new TypeError("Invalid 'value'.");if(!Z(f,vt,"f")||"opened"!==f.state)throw new Error("Camera is not open.");const p=null===(g=f.getCameraCapabilities())||void 0===g?void 0:g.colorTemperature;if(!p)throw Error("Not supported.");return l&&(a<p.min?a=p.min:a>p.max&&(a=p.max),a=Qn(a,p.min,p.step,p.max)),yield Z(f,vt,"f").applyConstraints({advanced:[{colorTemperature:a,whiteBalanceMode:"manual"}]}),a})()}getColorTemperature(){return this.getCameraSettings().colorTemperature||0}setExposureCompensation(a,l){var f=this;return ae(function*(){var g;if("number"!=typeof a)throw new TypeError("Invalid 'value'.");if(!Z(f,vt,"f")||"opened"!==f.state)throw new Error("Camera is not open.");const p=null===(g=f.getCameraCapabilities())||void 0===g?void 0:g.exposureCompensation;if(!p)throw Error("Not supported.");return l&&(a<p.min?a=p.min:a>p.max&&(a=p.max),a=Qn(a,p.min,p.step,p.max)),yield Z(f,vt,"f").applyConstraints({advanced:[{exposureCompensation:a}]}),a})()}getExposureCompensation(){return this.getCameraSettings().exposureCompensation||0}setFrameRate(a,l){var f=this;return ae(function*(){var g;if("number"!=typeof a)throw new TypeError("Invalid 'value'.");if(!Z(f,vt,"f")||"opened"!==f.state)throw new Error("Camera is not open.");let p=null===(g=f.getCameraCapabilities())||void 0===g?void 0:g.frameRate;if(!p)throw Error("Not supported.");l&&(a<p.min?a=p.min:a>p.max&&(a=p.max));const _=f.getResolution();return yield Z(f,vt,"f").applyConstraints({width:{ideal:Math.max(_.width,_.height)},frameRate:a}),a})()}getFrameRate(){return this.getCameraSettings().frameRate}setFocus(a,l){var f=this;return ae(function*(){if("object"!=typeof a||Array.isArray(a)||null==a)throw new TypeError("Invalid 'settings'.");if(!Z(f,vt,"f")||"opened"!==f.state)throw new Error("Camera is not open.");const g=f.getCameraCapabilities(),p=null==g?void 0:g.focusMode,_=null==g?void 0:g.focusDistance;if(!p)throw Error("Not supported.");if("string"!=typeof a.mode)throw TypeError("Invalid 'mode'.");const y=a.mode.toLowerCase();if(!p.includes(y))throw Error("Unsupported focus mode.");if("manual"===y){if(!_)throw Error("Manual focus unsupported.");if(a.hasOwnProperty("distance")){let b=a.distance;l&&(b<_.min?b=_.min:b>_.max&&(b=_.max),b=Qn(b,_.min,_.step,_.max)),f._focusParameters.focusArea=null,yield Z(f,vt,"f").applyConstraints({advanced:[{focusMode:y,focusDistance:b}]})}else{if(!a.area)throw new Error("'distance' or 'area' should be specified in 'manual' mode.");{const b=a.area.centerPoint;let O=a.area.width,M=a.area.height;if(!O||!M){const P=f.getResolution();O||(O=2*Math.round(Math.min(P.width,P.height)/f._focusParameters.defaultFocusAreaSizeRatio/2)+"px"),M||(M=2*Math.round(Math.min(P.width,P.height)/f._focusParameters.defaultFocusAreaSizeRatio/2)+"px")}f._focusParameters.focusArea={centerPoint:{x:b.x,y:b.y},width:O,height:M},yield Z(f,Fe,"m",C_).call(f,b,O,M)}}}else f._focusParameters.focusArea=null,yield Z(f,vt,"f").applyConstraints({advanced:[{focusMode:y}]})})()}getFocus(){const a=this.getCameraSettings(),l=a.focusMode;return l?"manual"===l?this._focusParameters.focusArea?{mode:"manual",area:JSON.parse(JSON.stringify(this._focusParameters.focusArea))}:{mode:"manual",distance:a.focusDistance}:{mode:l}:null}enableTapToFocus(){var a=this;return ae(function*(){ft(a,Ma,!0,"f")})()}disableTapToFocus(){ft(this,Ma,!1,"f")}isTapToFocusEnabled(){return Z(this,Ma,"f")}setZoom(a){var l=this;return ae(function*(){if("object"!=typeof a||Array.isArray(a)||null==a)throw new TypeError("Invalid 'settings'.");if("number"!=typeof a.factor)throw new TypeError("Illegal type of 'factor'.");if(a.factor<1)throw new RangeError("Invalid 'factor'.");if("opened"!==l.state)throw new Error("Video is not playing.");a.centerPoint?Z(l,Fe,"m",E_).call(l,a.centerPoint):l.resetScaleCenter();try{if(Z(l,Fe,"m",WT).call(l,Z(l,Kr,"f"))){const f=yield l.setHardwareScale(a.factor,!0);let g=l.getHardwareScale();1==g&&1!=f&&(g=f),l.setSoftwareScale(a.factor>g?a.factor/g:1)}else yield l.setHardwareScale(1),l.setSoftwareScale(a.factor)}catch(f){const g=f.message||f;if("Not supported."!==g&&"Camera is not open."!==g)throw f;l.setSoftwareScale(a.factor)}})()}getZoom(){if("opened"!==this.state)throw new Error("Video is not playing.");let a=1;try{a=this.getHardwareScale()}catch(l){if("Camera is not open."!==(l.message||l))throw l}return{factor:a*Z(this,Zr,"f")}}resetZoom(){var a=this;return ae(function*(){yield a.setZoom({factor:1})})()}setHardwareScale(a,l){var f=this;return ae(function*(){var g;if("number"!=typeof a)throw new TypeError("Invalid 'value'.");if(a<1)throw new RangeError("Invalid 'value'.");if(!Z(f,vt,"f")||"opened"!==f.state)throw new Error("Camera is not open.");const p=null===(g=f.getCameraCapabilities())||void 0===g?void 0:g.zoom;if(!p)throw Error("Not supported.");return l&&(a<p.min?a=p.min:a>p.max&&(a=p.max),a=Qn(a,p.min,p.step,p.max)),yield Z(f,vt,"f").applyConstraints({advanced:[{zoom:a}]}),a})()}getHardwareScale(){return this.getCameraSettings().zoom||1}setSoftwareScale(a,l){if("number"!=typeof a)throw new TypeError("Invalid 'value'.");if(a<1)throw new RangeError("Invalid 'value'.");if("opened"!==this.state)throw new Error("Video is not playing.");l&&Z(this,Fe,"m",E_).call(this,l),ft(this,Zr,a,"f"),this.updateVideoElWhenSoftwareScaled()}getSoftwareScale(){return Z(this,Zr,"f")}resetScaleCenter(){if("opened"!==this.state)throw new Error("Video is not playing.");const a=this.getResolution();ft(this,Kr,{x:a.width/2,y:a.height/2},"f")}resetSoftwareScale(){this.setSoftwareScale(1),this.resetScaleCenter()}getFrameData(a){if(this.disposed)throw Error("The 'Camera' instance has been disposed.");if(!this.isVideoLoaded()||Z(this,Oa,"f"))return null;const l=Date.now();Ge._onLog&&Ge._onLog("getFrameData() START: "+l);const f=Z(this,Je,"f").videoWidth,g=Z(this,Je,"f").videoHeight;let p={sx:0,sy:0,sWidth:f,sHeight:g,dWidth:f,dHeight:g};(null==a?void 0:a.position)&&(p=JSON.parse(JSON.stringify(a.position)));let _=gt.RGBA;(null==a?void 0:a.pixelFormat)&&(_=a.pixelFormat);let y=Z(this,Zr,"f");(null==a?void 0:a.scale)&&(y=a.scale);let b=Z(this,Kr,"f");if(null==a?void 0:a.scaleCenter){if("string"!=typeof a.scaleCenter.x||"string"!=typeof a.scaleCenter.y)throw new Error("Invalid scale center.");let k=0,V=0;if(a.scaleCenter.x.endsWith("px"))k=parseFloat(a.scaleCenter.x);else{if(!a.scaleCenter.x.endsWith("%"))throw new Error("Invalid scale center.");k=parseFloat(a.scaleCenter.x)/100*f}if(a.scaleCenter.y.endsWith("px"))V=parseFloat(a.scaleCenter.y);else{if(!a.scaleCenter.y.endsWith("%"))throw new Error("Invalid scale center.");V=parseFloat(a.scaleCenter.y)/100*g}if(isNaN(k)||isNaN(V))throw new Error("Invalid scale center.");b.x=Math.round(k),b.y=Math.round(V)}let O=null;if((null==a?void 0:a.bufferContainer)&&(O=a.bufferContainer),0==f||0==g)return null;1!==y&&(p.sWidth=Math.round(p.sWidth/y),p.sHeight=Math.round(p.sHeight/y),p.sx=Math.round((1-1/y)*b.x+p.sx/y),p.sy=Math.round((1-1/y)*b.y+p.sy/y));const M=this.imageDataGetter.getImageData(Z(this,Je,"f"),f,g,p,{pixelFormat:_,bufferContainer:O});if(!M)return null;const P=Date.now();return Ge._onLog&&Ge._onLog("getFrameData() END: "+P),{data:M.data,width:M.width,height:M.height,pixelFormat:M.pixelFormat,timeSpent:P-l,timeStamp:P,toCanvas:Z(this,m_,"f")}}on(a,l){if(!Z(this,__,"f").includes(a.toLowerCase()))throw new Error(`Event '${a}' does not exist.`);Z(this,fn,"f").on(a,l)}off(a,l){Z(this,fn,"f").off(a,l)}dispose(){var a=this;return ae(function*(){a.tapFocusEventBoundEl=null,yield a.close(),a.releaseVideoEl(),Z(a,fn,"f").dispose(),a.imageDataGetter.dispose(),document.removeEventListener("visibilitychange",Z(a,vd,"f")),ft(a,yd,!0,"f")})()}}var Mc,Ed,Na,mo,wd,ka,zT,YT,pt,w_,b_,Le,Ne,Lc,Qr,_o,bd,Dd,Sd,Fc,vo,Td,Jr,gi,Wt,Pe,Dr,D_,Rt,$T,XT,S_,T_;Je=new WeakMap,vt=new WeakMap,gd=new WeakMap,pd=new WeakMap,At=new WeakMap,Oi=new WeakMap,Xr=new WeakMap,Ra=new WeakMap,md=new WeakMap,br=new WeakMap,qr=new WeakMap,di=new WeakMap,Oa=new WeakMap,Ma=new WeakMap,Rc=new WeakMap,_d=new WeakMap,La=new WeakMap,go=new WeakMap,Zr=new WeakMap,Kr=new WeakMap,m_=new WeakMap,fn=new WeakMap,__=new WeakMap,po=new WeakMap,GT=new WeakMap,vd=new WeakMap,yd=new WeakMap,Fe=new WeakSet,HT=function(){var u=ae(function*(){var a=this;const l=this.getMediaStreamConstraints();if("boolean"==typeof l.video&&(l.video={}),!l.video.deviceId)if(Z(this,Xr,"f"))delete l.video.facingMode,l.video.deviceId={exact:Z(this,Xr,"f")};else if(this.ifSaveLastUsedCamera&&Ge.isStorageAvailable&&window.localStorage.getItem("dce_last_camera_id")){delete l.video.facingMode,l.video.deviceId={ideal:window.localStorage.getItem("dce_last_camera_id")};const f=JSON.parse(window.localStorage.getItem("dce_last_apply_width")),g=JSON.parse(window.localStorage.getItem("dce_last_apply_height"));f&&g&&(l.video.width=f,l.video.height=g)}else if(!this.ifSkipCameraInspection){const f=function(){var _=ae(function*(y){let b=null;return"environment"===y&&["Android","HarmonyOS","iPhone","iPad"].includes(kn.OS)?(yield a._getCameras(!1),Z(a,Fe,"m",Qi).call(a),b=Ge.findBestCamera(a._arrCameras,"environment",{getMainCameraInIOS:a.selectIOSRearMainCameraAsDefault})):y||["Android","HarmonyOS","iPhone","iPad"].includes(kn.OS)||(yield a._getCameras(!1),Z(a,Fe,"m",Qi).call(a),b=Ge.findBestCamera(a._arrCameras,null,{getMainCameraInIOS:a.selectIOSRearMainCameraAsDefault})),b});return function(b){return _.apply(this,arguments)}}();let g=l.video.facingMode;g instanceof Array&&g.length&&(g=g[0]),"object"==typeof g&&(g=g.exact||g.ideal);const p=yield f(g);p&&(delete l.video.facingMode,l.video.deviceId={exact:p})}return l});return function(){return u.apply(this,arguments)}}(),Qi=function(){if(Z(this,br,"f")){const u=new Error("The operation was interrupted.");throw u.name="AbortError",u}},v_=function(){var u=ae(function*(a){var f,g,l=this;if(!(null===(g=null===(f=null==window?void 0:window.navigator)||void 0===f?void 0:f.mediaDevices)||void 0===g?void 0:g.getUserMedia))throw new Error("Failed to access the camera because the browser is too old or the page is loaded from an insecure origin.");let p;try{Ge._onLog&&Ge._onLog("======try getUserMedia========");let _=[0,500,1e3,2e3],y=null;const b=function(){var O=ae(function*(M){for(let P of _){P&&(yield new Promise(k=>setTimeout(k,P)),Z(l,Fe,"m",Qi).call(l));try{Ge._onLog&&Ge._onLog("ask "+JSON.stringify(M)),p=yield navigator.mediaDevices.getUserMedia(M),Z(l,Fe,"m",Qi).call(l);break}catch(k){if("NotFoundError"===k.name||"NotAllowedError"===k.name||"AbortError"===k.name||"OverconstrainedError"===k.name)throw k;y=k,Ge._onLog&&Ge._onLog(k.message||k)}}});return function(P){return O.apply(this,arguments)}}();if(yield b(a),p||"object"!=typeof a.video||(a.video.deviceId&&(delete a.video.deviceId,yield b(a)),!p&&a.video.facingMode&&(delete a.video.facingMode,yield b(a)),p||!a.video.width&&!a.video.height||(delete a.video.width,delete a.video.height,yield b(a))),!p)throw y;return p}catch(_){throw null==p||p.getTracks().forEach(y=>{y.stop()}),"NotFoundError"===_.name&&(DOMException?_=new DOMException("No camera available, please use a device with an accessible camera.",_.name):(_=new Error("No camera available, please use a device with an accessible camera.")).name="NotFoundError"),_}});return function(l){return u.apply(this,arguments)}}(),y_=function(){this._mediaStream&&(this._mediaStream.getTracks().forEach(u=>{u.stop()}),this._mediaStream=null),ft(this,vt,null,"f")},Fa=function(){var u=ae(function*(){var a=this;ft(this,br,!1,"f");const l=ft(this,md,Symbol(),"f");if(Z(this,qr,"f")&&"pending"===Z(this,di,"f")){try{yield Z(this,qr,"f")}catch(g){}Z(this,Fe,"m",Qi).call(this)}return l!==Z(this,md,"f")?void 0:ft(this,qr,ae(function*(){ft(a,di,"pending","f");try{if(a.videoSrc){if(!Z(a,Je,"f"))throw new Error("'videoEl' should be set.");yield Ge.playVideo(Z(a,Je,"f"),a.videoSrc,a.cameraOpenTimeout),Z(a,Fe,"m",Qi).call(a)}else{let g=yield Z(a,Fe,"m",HT).call(a);Z(a,Fe,"m",y_).call(a);let p=yield Z(a,Fe,"m",v_).call(a,g);yield a._getCameras(!1),Z(a,Fe,"m",Qi).call(a);const _=()=>{const M=p.getVideoTracks();let P,k;if(M.length&&(P=M[0]),P){const V=P.getSettings();if(V)for(let H of a._arrCameras)if(V.deviceId===H.deviceId){H._checked=!0,H.label=P.label,k=H;break}}return k},y=Z(a,At,"f");if("object"==typeof y.video){let M=y.video.facingMode;if(M instanceof Array&&M.length&&(M=M[0]),"object"==typeof M&&(M=M.exact||M.ideal),!(Z(a,Xr,"f")||a.ifSaveLastUsedCamera&&Ge.isStorageAvailable&&window.localStorage.getItem("dce_last_camera_id")||a.ifSkipCameraInspection||y.video.deviceId)){const P=_(),k=Ge.findBestCamera(a._arrCameras,M,{getMainCameraInIOS:a.selectIOSRearMainCameraAsDefault});k&&k!=(null==P?void 0:P.deviceId)&&(p.getTracks().forEach(V=>{V.stop()}),g.video.deviceId={exact:k},p=yield Z(a,Fe,"m",v_).call(a,g),Z(a,Fe,"m",Qi).call(a))}}const b=_();(null==b?void 0:b.deviceId)&&(ft(a,Xr,b&&b.deviceId,"f"),a.ifSaveLastUsedCamera&&Ge.isStorageAvailable&&(window.localStorage.setItem("dce_last_camera_id",Z(a,Xr,"f")),"object"==typeof g.video&&g.video.width&&g.video.height&&(window.localStorage.setItem("dce_last_apply_width",JSON.stringify(g.video.width)),window.localStorage.setItem("dce_last_apply_height",JSON.stringify(g.video.height))))),Z(a,Je,"f")&&(yield Ge.playVideo(Z(a,Je,"f"),p,a.cameraOpenTimeout),Z(a,Fe,"m",Qi).call(a)),a._mediaStream=p;const O=p.getVideoTracks();(null==O?void 0:O.length)&&ft(a,vt,O[0],"f"),ft(a,Oi,b,"f")}}catch(g){throw Z(a,Fe,"m",Cd).call(a),ft(a,di,null,"f"),g}ft(a,di,"fulfilled","f")})(),"f")});return function(){return u.apply(this,arguments)}}(),Oc=function(){var u=ae(function*(){var a;if("closed"===this.state||this.videoSrc)return;const l=null===(a=Z(this,Oi,"f"))||void 0===a?void 0:a.deviceId,f=this.getResolution();yield Z(this,Fe,"m",Fa).call(this);const g=this.getResolution();l&&l!==Z(this,Oi,"f").deviceId&&Z(this,fn,"f").fire("camera:changed",[Z(this,Oi,"f").deviceId,l],{target:this,async:!1}),f.width==g.width&&f.height==g.height||Z(this,fn,"f").fire("resolution:changed",[{width:g.width,height:g.height},{width:f.width,height:f.height}],{target:this,async:!1}),Z(this,fn,"f").fire("played",null,{target:this,async:!1})});return function(){return u.apply(this,arguments)}}(),Cd=function(){Z(this,Fe,"m",y_).call(this),ft(this,Oi,null,"f"),Z(this,Je,"f")&&(Z(this,Je,"f").srcObject=null,this.videoSrc&&(Z(this,Je,"f").pause(),Z(this,Je,"f").currentTime=0)),ft(this,br,!0,"f");try{this.resetSoftwareScale()}catch(u){}},fi=function(){var u=ae(function*(l,f){const g=Y=>{if(!Z(this,vt,"f")||!this.isVideoPlaying||Y.focusTaskId!=this._focusParameters.curFocusTaskId){Z(this,vt,"f")&&this.isVideoPlaying||(this._focusParameters.isDoingFocus=0);const X=new Error(`Focus task ${Y.focusTaskId} canceled.`);throw X.name="DeprecatedTaskError",X}1===this._focusParameters.isDoingFocus&&Date.now()-Y.timeStart>this._focusParameters.focusCancelableTime&&(this._focusParameters.isDoingFocus=-1)};let p;f=Qn(f,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),yield Z(this,vt,"f").applyConstraints({advanced:[{focusMode:"manual",focusDistance:f}]}),g(l),p=null==this._focusParameters.oldDistance?this._focusParameters.kTimeout*Math.max(Math.abs(1/this._focusParameters.fds.min-1/f),Math.abs(1/this._focusParameters.fds.max-1/f))+this._focusParameters.minTimeout:this._focusParameters.kTimeout*Math.abs(1/this._focusParameters.oldDistance-1/f)+this._focusParameters.minTimeout,this._focusParameters.oldDistance=f,yield new Promise(Y=>{setTimeout(Y,p)}),g(l);let _=l.focusL-l.focusW/2,y=l.focusT-l.focusH/2,b=l.focusW,O=l.focusH;const M=this.getResolution();if(_>=M.width||y>=M.height)throw new Error("Invalid area.");_+b>M.width&&(b=M.width-_),y+O>M.height&&(O=M.height-y),_=Math.round(_),y=Math.round(y),b=Math.round(b),O=Math.round(O);const P=4*M.width*M.height*this._focusParameters.defaultTempBufferContainerLenRatio,k=4*b*O;let V=this._focusParameters.tempBufferContainer;if(V){const Y=V.length;P>Y&&P>=k?V=new Uint8Array(P):k>Y&&k>=P&&(V=new Uint8Array(k))}else V=this._focusParameters.tempBufferContainer=new Uint8Array(Math.max(P,k));if(!this.imageDataGetter.getImageData(Z(this,Je,"f"),M.width,M.height,{sx:_,sy:y,sWidth:b,sHeight:O,dWidth:b,dHeight:O},{pixelFormat:gt.RGBA,bufferContainer:V}))return Z(this,Fe,"m",a).call(this,l,f);const H=V;let z=0;for(let Y=0,X=k-8;Y<X;++Y){let $=H[Y]-H[Y+8];++Y;let K=H[Y]-H[Y+8];++Y;let ge=H[Y]-H[Y+8];++Y,z+=$*$+K*K+ge*ge}return-z});function a(l,f){return u.apply(this,arguments)}return a}(),Pa=function(){var u=ae(function*(l,f,g,p,_,y,b){let O;if(f=Qn(f,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),p=Qn(p,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),y?y=Qn(y,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max):(y=Qn(Math.sqrt((f||this._focusParameters.fds.step)*(p||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),b=yield Z(this,Fe,"m",fi).call(this,l,y)),b<=g&&b<=_?O=3:g<_&&g<b?O=1:_<g&&_<b&&(O=2),(p-f)/2<=this._focusParameters.fds.step)return 3===O||(1===O?yield Z(this,vt,"f").applyConstraints({advanced:[{focusMode:"manual",focusDistance:f}]}):2===O&&(yield Z(this,vt,"f").applyConstraints({advanced:[{focusMode:"manual",focusDistance:p}]}))),!0;if(1===O)return yield Z(this,Fe,"m",a).call(this,l,f,g,y,b);if(2===O)return yield Z(this,Fe,"m",a).call(this,l,y,b,p,_);if(3!==O)return g=yield Z(this,Fe,"m",fi).call(this,l,f),_=yield Z(this,Fe,"m",fi).call(this,l,p),yield Z(this,Fe,"m",a).call(this,l,f,g,p,_);let M=Qn(Math.sqrt((f||this._focusParameters.fds.step)*(y||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),P=Qn(Math.sqrt((p||this._focusParameters.fds.step)*(y||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max);if(Math.abs(1/this._focusParameters.oldDistance-1/M)<=Math.abs(1/this._focusParameters.oldDistance-1/P)){let k=yield Z(this,Fe,"m",fi).call(this,l,M);if(k<b)return yield Z(this,Fe,"m",a).call(this,l,f,g,y,b,M,k);if(k==b)return yield Z(this,Fe,"m",a).call(this,l,M,k,y,b);let V=yield Z(this,Fe,"m",fi).call(this,l,P);if(k>b&&b<V)return yield Z(this,Fe,"m",a).call(this,l,M,k,P,V,y,b);if(b==V)return yield Z(this,Fe,"m",a).call(this,l,y,b,P,V);if(b>V)return yield Z(this,Fe,"m",a).call(this,l,y,b,p,_,P,V)}else{let k=yield Z(this,Fe,"m",fi).call(this,l,P);if(b>k)return yield Z(this,Fe,"m",a).call(this,l,y,b,p,_,P,k);if(b==k)return yield Z(this,Fe,"m",a).call(this,l,y,b,P,k);let V=yield Z(this,Fe,"m",fi).call(this,l,M);if(V>b&&b<k)return yield Z(this,Fe,"m",a).call(this,l,M,V,P,k,y,b);if(V==b)return yield Z(this,Fe,"m",a).call(this,l,M,V,y,b);if(V<b)return yield Z(this,Fe,"m",a).call(this,l,f,g,y,b,M,V)}return!1});function a(l,f,g,p,_,y,b){return u.apply(this,arguments)}return a}(),C_=function(){var u=ae(function*(a,l,f,g,p){var y,_=this;if(1==this._focusParameters.isDoingFocus)return!1;if(!a||"string"!=typeof a.x||"string"!=typeof a.y)throw new Error("Invalid 'centerPoint'.");if(!l||"string"!=typeof l)throw new Error("Invalid 'width'.");if(!f||"string"!=typeof f)throw new Error("Invalid 'height'.");const b=this.getResolution();let O=0,M=0;if(a.x.endsWith("px"))O=parseFloat(a.x);else{if(!a.x.endsWith("%"))throw new Error("Invalid 'centerPoint'.");O=parseFloat(a.x)/100*b.width}if(a.y.endsWith("px"))M=parseFloat(a.y);else{if(!a.y.endsWith("%"))throw new Error("Invalid 'centerPoint'.");M=parseFloat(a.y)/100*b.height}if(isNaN(O)||isNaN(M)||O<0||O>b.width||M<0||M>b.height)throw new Error("Invalid 'centerPoint'.");let P=0;if(l.endsWith("px"))P=parseFloat(l);else{if(!l.endsWith("%"))throw new Error("Invalid 'width'.");P=parseFloat(l)/100*b.width}if(isNaN(P)||P<0)throw new Error("Invalid 'width'.");let k=0;if(f.endsWith("px"))k=parseFloat(f);else{if(!f.endsWith("%"))throw new Error("Invalid 'height'.");k=parseFloat(f)/100*b.height}if(isNaN(k)||k<0)throw new Error("Invalid 'height'.");if(1!==Z(this,Zr,"f")){const z=Z(this,Zr,"f"),Y=Z(this,Kr,"f");P/=z,k/=z,O=(1-1/z)*Y.x+O/z,M=(1-1/z)*Y.y+M/z}if(!this._focusSupported)throw new Error("Manual focus unsupported.");if(!this._focusParameters.fds&&(this._focusParameters.fds=null===(y=this.getCameraCapabilities())||void 0===y?void 0:y.focusDistance,!this._focusParameters.fds))throw this._focusSupported=!1,new Error("Manual focus unsupported.");null==this._focusParameters.kTimeout&&(this._focusParameters.kTimeout=(this._focusParameters.maxTimeout-this._focusParameters.minTimeout)/(1/this._focusParameters.fds.min-1/this._focusParameters.fds.max)),this._focusParameters.isDoingFocus=1;const V={focusL:O,focusT:M,focusW:P,focusH:k,focusTaskId:++this._focusParameters.curFocusTaskId,timeStart:Date.now()},H=function(){var z=ae(function*(Y,X,$){try{(null==X||X<_._focusParameters.fds.min)&&(X=_._focusParameters.fds.min),(null==$||$>_._focusParameters.fds.max)&&($=_._focusParameters.fds.max),_._focusParameters.oldDistance=null;let K=Qn(Math.sqrt($*(X||_._focusParameters.fds.step)),_._focusParameters.fds.min,_._focusParameters.fds.step,_._focusParameters.fds.max),ge=Qn(Math.sqrt((X||_._focusParameters.fds.step)*K),_._focusParameters.fds.min,_._focusParameters.fds.step,_._focusParameters.fds.max),_e=Qn(Math.sqrt(K*$),_._focusParameters.fds.min,_._focusParameters.fds.step,_._focusParameters.fds.max),Te=yield Z(_,Fe,"m",fi).call(_,Y,_e),xe=yield Z(_,Fe,"m",fi).call(_,Y,ge),F=yield Z(_,Fe,"m",fi).call(_,Y,K);if(xe>F&&F<Te){const Ee=yield Z(_,Fe,"m",Pa).call(_,Y,ge,xe,_e,Te,K,F);return _._focusParameters.isDoingFocus=0,Ee}if(xe<F&&xe<Te){let Ee=yield Z(_,Fe,"m",fi).call(_,Y,X);const ke=yield Z(_,Fe,"m",Pa).call(_,Y,X,Ee,K,F,ge,xe);return _._focusParameters.isDoingFocus=0,ke}if(F>Te&&xe>Te){let Ee=yield Z(_,Fe,"m",fi).call(_,Y,$);const ke=yield Z(_,Fe,"m",Pa).call(_,Y,K,F,$,Ee,_e,Te);return _._focusParameters.isDoingFocus=0,ke}if(xe==F&&F<Te){const Ee=yield Z(_,Fe,"m",Pa).call(_,Y,ge,xe,K,F);return _._focusParameters.isDoingFocus=0,Ee}if(F==Te&&xe>F){const Ee=yield Z(_,Fe,"m",Pa).call(_,Y,K,F,_e,Te);return _._focusParameters.isDoingFocus=0,Ee}return H(Y,X,$)}catch(K){if("DeprecatedTaskError"!==K.name)throw K}});return function(X,$,K){return z.apply(this,arguments)}}();return H(V,g,p)});return function(l,f,g,p,_){return u.apply(this,arguments)}}(),E_=function(u){if("opened"!==this.state)throw new Error("Video is not playing.");if(!u||"string"!=typeof u.x||"string"!=typeof u.y)throw new Error("Invalid 'center'.");const a=this.getResolution();let l=0,f=0;if(u.x.endsWith("px"))l=parseFloat(u.x);else{if(!u.x.endsWith("%"))throw new Error("Invalid scale center.");l=parseFloat(u.x)/100*a.width}if(u.y.endsWith("px"))f=parseFloat(u.y);else{if(!u.y.endsWith("%"))throw new Error("Invalid scale center.");f=parseFloat(u.y)/100*a.height}if(isNaN(l)||isNaN(f))throw new Error("Invalid scale center.");ft(this,Kr,{x:l,y:f},"f")},WT=function(u){if("opened"!==this.state)throw new Error("Video is not playing.");const a=this.getResolution();return u&&u.x==a.width/2&&u.y==a.height/2},Ge.browserInfo=kn,Ge.onWarning=null===(p_=null==window?void 0:window.console)||void 0===p_?void 0:p_.warn;class es{constructor(a){Mc.add(this),Ed.set(this,void 0),Na.set(this,0),mo.set(this,void 0),wd.set(this,0),ka.set(this,!1),Me(this,Ed,a,"f")}startCharging(){j(this,ka,"f")||(es._onLog&&es._onLog("start charging."),j(this,Mc,"m",YT).call(this),Me(this,ka,!0,"f"))}stopCharging(){j(this,mo,"f")&&clearTimeout(j(this,mo,"f")),j(this,ka,"f")&&(es._onLog&&es._onLog("stop charging."),Me(this,Na,Date.now()-j(this,wd,"f"),"f"),Me(this,ka,!1,"f"))}}Ed=new WeakMap,Na=new WeakMap,mo=new WeakMap,wd=new WeakMap,ka=new WeakMap,Mc=new WeakSet,zT=function(){Qt.cfd(1),es._onLog&&es._onLog("charge 1.")},YT=function u(){0==j(this,Na,"f")&&j(this,Mc,"m",zT).call(this),Me(this,wd,Date.now(),"f"),j(this,mo,"f")&&clearTimeout(j(this,mo,"f")),Me(this,mo,setTimeout(()=>{Me(this,Na,0,"f"),j(this,Mc,"m",u).call(this)},j(this,Ed,"f")-j(this,Na,"f")),"f")};const qT=new Map([[Ve.IPF_GRAYSCALED,gt.GREY],[Ve.IPF_ABGR_8888,gt.RGBA],[Ve.IPF_ARGB_8888,gt.BGRA]]),ZT=new Map([[gt.GREY,Ve.IPF_GRAYSCALED],[gt.RGBA,Ve.IPF_ABGR_8888],[gt.BGRA,Ve.IPF_ARGB_8888]]),I_="function"==typeof BigInt?{BF_NULL:BigInt(0),BF_ALL:BigInt(0x10000000000000000),BF_DEFAULT:BigInt(4265345023),BF_ONED:BigInt(3147775),BF_GS1_DATABAR:BigInt(260096),BF_CODE_39:BigInt(1),BF_CODE_128:BigInt(2),BF_CODE_93:BigInt(4),BF_CODABAR:BigInt(8),BF_ITF:BigInt(16),BF_EAN_13:BigInt(32),BF_EAN_8:BigInt(64),BF_UPC_A:BigInt(128),BF_UPC_E:BigInt(256),BF_INDUSTRIAL_25:BigInt(512),BF_CODE_39_EXTENDED:BigInt(1024),BF_GS1_DATABAR_OMNIDIRECTIONAL:BigInt(2048),BF_GS1_DATABAR_TRUNCATED:BigInt(4096),BF_GS1_DATABAR_STACKED:BigInt(8192),BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL:BigInt(16384),BF_GS1_DATABAR_EXPANDED:BigInt(32768),BF_GS1_DATABAR_EXPANDED_STACKED:BigInt(65536),BF_GS1_DATABAR_LIMITED:BigInt(131072),BF_PATCHCODE:BigInt(262144),BF_CODE_32:BigInt(16777216),BF_PDF417:BigInt(33554432),BF_QR_CODE:BigInt(67108864),BF_DATAMATRIX:BigInt(134217728),BF_AZTEC:BigInt(268435456),BF_MAXICODE:BigInt(536870912),BF_MICRO_QR:BigInt(1073741824),BF_MICRO_PDF417:BigInt(524288),BF_GS1_COMPOSITE:BigInt(2147483648),BF_MSI_CODE:BigInt(1048576),BF_CODE_11:BigInt(2097152),BF_TWO_DIGIT_ADD_ON:BigInt(4194304),BF_FIVE_DIGIT_ADD_ON:BigInt(8388608),BF_MATRIX_25:BigInt(68719476736),BF_POSTALCODE:BigInt(0x3f0000000000000),BF_NONSTANDARD_BARCODE:BigInt(4294967296),BF_USPSINTELLIGENTMAIL:BigInt(4503599627370496),BF_POSTNET:BigInt(9007199254740992),BF_PLANET:BigInt(0x40000000000000),BF_AUSTRALIANPOST:BigInt(0x80000000000000),BF_RM4SCC:BigInt(72057594037927940),BF_KIX:BigInt(0x200000000000000),BF_DOTCODE:BigInt(8589934592),BF_PHARMACODE_ONE_TRACK:BigInt(17179869184),BF_PHARMACODE_TWO_TRACK:BigInt(34359738368),BF_PHARMACODE:BigInt(51539607552)}:{BF_NULL:"0x00",BF_ALL:"0xFFFFFFFFFFFFFFFF",BF_DEFAULT:"0xFE3BFFFF",BF_ONED:"0x003007FF",BF_GS1_DATABAR:"0x0003F800",BF_CODE_39:"0x1",BF_CODE_128:"0x2",BF_CODE_93:"0x4",BF_CODABAR:"0x8",BF_ITF:"0x10",BF_EAN_13:"0x20",BF_EAN_8:"0x40",BF_UPC_A:"0x80",BF_UPC_E:"0x100",BF_INDUSTRIAL_25:"0x200",BF_CODE_39_EXTENDED:"0x400",BF_GS1_DATABAR_OMNIDIRECTIONAL:"0x800",BF_GS1_DATABAR_TRUNCATED:"0x1000",BF_GS1_DATABAR_STACKED:"0x2000",BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL:"0x4000",BF_GS1_DATABAR_EXPANDED:"0x8000",BF_GS1_DATABAR_EXPANDED_STACKED:"0x10000",BF_GS1_DATABAR_LIMITED:"0x20000",BF_PATCHCODE:"0x00040000",BF_CODE_32:"0x01000000",BF_PDF417:"0x02000000",BF_QR_CODE:"0x04000000",BF_DATAMATRIX:"0x08000000",BF_AZTEC:"0x10000000",BF_MAXICODE:"0x20000000",BF_MICRO_QR:"0x40000000",BF_MICRO_PDF417:"0x00080000",BF_GS1_COMPOSITE:"0x80000000",BF_MSI_CODE:"0x100000",BF_CODE_11:"0x200000",BF_TWO_DIGIT_ADD_ON:"0x400000",BF_FIVE_DIGIT_ADD_ON:"0x800000",BF_MATRIX_25:"0x1000000000",BF_POSTALCODE:"0x3F0000000000000",BF_NONSTANDARD_BARCODE:"0x100000000",BF_USPSINTELLIGENTMAIL:"0x10000000000000",BF_POSTNET:"0x20000000000000",BF_PLANET:"0x40000000000000",BF_AUSTRALIANPOST:"0x80000000000000",BF_RM4SCC:"0x100000000000000",BF_KIX:"0x200000000000000",BF_DOTCODE:"0x200000000",BF_PHARMACODE_ONE_TRACK:"0x400000000",BF_PHARMACODE_TWO_TRACK:"0x800000000",BF_PHARMACODE:"0xC00000000"};class rt extends Ai{static set _onLog(a){Me(rt,w_,a,"f",b_),Ge._onLog=a,es._onLog=a}static get _onLog(){return j(rt,w_,"f",b_)}static detectEnvironment(){return ae(function*(){return yield ae(function*(){return{wasm:hj,worker:dj,getUserMedia:DT,camera:yield fj(),browser:An.browser,version:An.version,OS:An.OS}})()})()}static testCameraAccess(){return ae(function*(){const a=yield Ge.testCameraAccess();return a.ok?{ok:!0,message:"Successfully accessed the camera."}:"InsecureContext"===a.errorName?{ok:!1,message:"Insecure context."}:"OverconstrainedError"===a.errorName||"NotFoundError"===a.errorName?{ok:!1,message:"No camera detected."}:"NotAllowedError"===a.errorName?{ok:!1,message:"No permission to access camera."}:"AbortError"===a.errorName?{ok:!1,message:"Some problem occurred which prevented the device from being used."}:"NotReadableError"===a.errorName?{ok:!1,message:"A hardware error occurred."}:"SecurityError"===a.errorName?{ok:!1,message:"User media support is disabled."}:{ok:!1,message:a.errorMessage}})()}static createInstance(a){return ae(function*(){var l,f;if(a&&!(a instanceof rn))throw new TypeError("Invalid view.");if(null===(l=yn.license)||void 0===l?void 0:l.LicenseManager){if(!(null===(f=yn.license)||void 0===f?void 0:f.LicenseManager.bCallInitLicense))throw new Error("License is not set.");yield Qt.loadWasm(["license"]),yield yn.license.dynamsoft()}const g=new rt(a);return rt.onWarning&&(location&&"file:"===location.protocol?setTimeout(()=>{rt.onWarning&&rt.onWarning({id:1,message:"The page is opened over file:// and Dynamsoft Camera Enhancer may not work properly. Please open the page via https://."})},0):!1!==window.isSecureContext&&navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||setTimeout(()=>{rt.onWarning&&rt.onWarning({id:2,message:"Dynamsoft Camera Enhancer may not work properly in a non-secure context. Please open the page via https://."})},0)),g})()}get video(){return j(this,Le,"f").getVideoEl()}set videoSrc(a){if(!j(this,Le,"f"))throw new Error("Camera manager is null.");j(this,Ne,"f")&&(j(this,Ne,"f")._hideDefaultSelection=!0),j(this,Le,"f").videoSrc=a}get videoSrc(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.videoSrc}set ifSaveLastUsedCamera(a){if(!j(this,Le,"f"))throw new Error("Camera manager is null.");j(this,Le,"f").ifSaveLastUsedCamera=a}get ifSaveLastUsedCamera(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.ifSaveLastUsedCamera}set ifSkipCameraInspection(a){if(!j(this,Le,"f"))throw new Error("Camera manager is null.");j(this,Le,"f").ifSkipCameraInspection=a}get ifSkipCameraInspection(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.ifSkipCameraInspection}set cameraOpenTimeout(a){if(!j(this,Le,"f"))throw new Error("Camera manager is null.");j(this,Le,"f").cameraOpenTimeout=a}get cameraOpenTimeout(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.cameraOpenTimeout}set singleFrameMode(a){if(!["disabled","image","camera"].includes(a))throw new Error("Invalid value.");if(this.isOpen())throw new Error("It is not allowed to change `singleFrameMode` when the camera is open.");Me(this,bd,a,"f")}get singleFrameMode(){return j(this,bd,"f")}get _isFetchingStarted(){return j(this,Jr,"f")}get disposed(){return j(this,D_,"f")}constructor(a){var l;if(super(),l=this,pt.add(this),Le.set(this,void 0),Ne.set(this,void 0),Lc.set(this,"closed"),Qr.set(this,void 0),_o.set(this,!1),bd.set(this,void 0),this._onCameraSelChange=ae(function*(){l.isOpen()&&j(l,Ne,"f")&&!j(l,Ne,"f").disposed&&(yield l.selectCamera(j(l,Ne,"f")._selCam.value))}),this._onResolutionSelChange=ae(function*(){if(!l.isOpen()||!j(l,Ne,"f")||j(l,Ne,"f").disposed)return;let f,g;if(j(l,Ne,"f")._selRsl&&-1!=j(l,Ne,"f")._selRsl.selectedIndex){let p=j(l,Ne,"f")._selRsl.options[j(l,Ne,"f")._selRsl.selectedIndex];f=parseInt(p.getAttribute("data-width")),g=parseInt(p.getAttribute("data-height"))}yield l.setResolution({width:f,height:g})}),this._onCloseBtnClick=ae(function*(){l.isOpen()&&j(l,Ne,"f")&&!j(l,Ne,"f").disposed&&l.close()}),Dd.set(this,(f,g,p,_)=>{const y=Date.now(),b={sx:_.x,sy:_.y,sWidth:_.width,sHeight:_.height,dWidth:_.width,dHeight:_.height},O=Math.max(b.dWidth,b.dHeight);if(this.canvasSizeLimit&&O>this.canvasSizeLimit){const k=this.canvasSizeLimit/O;b.dWidth>b.dHeight?(b.dWidth=this.canvasSizeLimit,b.dHeight=Math.round(b.dHeight*k)):(b.dWidth=Math.round(b.dWidth*k),b.dHeight=this.canvasSizeLimit)}const M=j(this,Le,"f").imageDataGetter.getImageData(f,g,p,b,{pixelFormat:qT.get(this.getPixelFormat())});let P=null;if(M){const k=Date.now();let V;V=M.pixelFormat===gt.GREY?M.width:4*M.width;let H=!0;0===b.sx&&0===b.sy&&b.sWidth===g&&b.sHeight===p&&(H=!1),P={bytes:M.data,width:M.width,height:M.height,stride:V,format:ZT.get(M.pixelFormat),tag:{imageId:this._imageId==Number.MAX_VALUE?this._imageId=0:++this._imageId,type:$h.ITT_FILE_IMAGE,isCropped:H,cropRegion:{left:_.x,top:_.y,right:_.x+_.width,bottom:_.y+_.height,isMeasuredInPercentage:!1},originalWidth:g,originalHeight:p,currentWidth:M.width,currentHeight:M.height,timeSpent:k-y,timeStamp:k},toCanvas:j(this,Sd,"f"),isDCEFrame:!0}}return P}),this._onSingleFrameAcquired=f=>{let g;g=j(this,Ne,"f")?j(this,Ne,"f").getConvertedRegion():td.convert(j(this,vo,"f"),f.width,f.height),g||(g={x:0,y:0,width:f.width,height:f.height});const p=j(this,Dd,"f").call(this,f,f.width,f.height,g);j(this,Qr,"f").fire("singleFrameAcquired",[p],{async:!1,copy:!1})},Sd.set(this,function(){if(!(this.bytes instanceof Uint8Array||this.bytes instanceof Uint8ClampedArray))throw new TypeError("Invalid bytes.");if("number"!=typeof this.width||this.width<=0)throw new Error("Invalid width.");if("number"!=typeof this.height||this.height<=0)throw new Error("Invalid height.");const f=document.createElement("canvas");let g;if(f.width=this.width,f.height=this.height,this.format===Ve.IPF_GRAYSCALED){g=new Uint8ClampedArray(this.width*this.height*4);for(let p=0;p<g.length;p+=4)g[p]=this.bytes[p/4],g[p+1]=this.bytes[p/4],g[p+2]=this.bytes[p/4],g[p+3]=255}else g=new Uint8ClampedArray(this.bytes.buffer);return f.getContext("2d").putImageData(new ImageData(g,this.width,this.height),0,0),f}),Fc.set(this,void 0),vo.set(this,void 0),Td.set(this,Ve.IPF_ABGR_8888),Jr.set(this,!1),this._imageId=-1,gi.set(this,void 0),this.fetchInterval=0,Wt.set(this,{enhancedFocus:!1,autoZoom:!1,tapToFocus:!1}),Pe.set(this,{minValue:1,maxValue:999,autoFocusFrameArray:[],autoFocusFrameLimit:[5,3],autoZoomDetectionArea:.5,autoZoomTargetBorder:.9,autoZoomIdealArea:[0,.05],autoZoomInFrameArray:[],autoZoomInFrameLimit:[5,3],autoZoomInMaxTimes:5,autoZoomInMinStep:Math.pow(10,.2),autoZoomInIdealModuleSize:6,autoZoomOutFrameCount:0,autoZoomOutFrameLimit:3,autoZoomOutStepRate:1/3,autoZoomOutStepRate_2:.05,autoZoomOutMinStep:2,frameArrayInIdealZoom:[],frameLimitInIdealZoom:[5,3]}),Dr.set(this,void 0),D_.set(this,!1),this.isCameraEnhancer=!0,a&&!(a instanceof rn))throw new TypeError("Invalid view.");Me(this,Qr,new LT,"f"),Me(this,Le,new Ge,"f"),this._imageDataGetter=j(this,Le,"f").imageDataGetter,j(this,Le,"f").updateVideoElWhenSoftwareScaled=()=>{if(!this.video)return;const f=j(this,Le,"f").getSoftwareScale();if(f<1)throw new RangeError("Invalid scale value.");j(this,Ne,"f")&&!j(this,Ne,"f").disposed?(this.video.style.transform=1===f?"":`scale(${f})`,j(this,Ne,"f")._updateVideoContainer()):this.video.style.transform=1===f?"":`scale(${f})`},["iPhone","iPad","Android","HarmonyOS"].includes(An.OS)?j(this,Le,"f").setResolution(1280,720):j(this,Le,"f").setResolution(1920,1080),this.singleFrameMode=navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?"disabled":"image",a&&this.setCameraView(a),this._on("before:camera:change",()=>{j(this,Dr,"f").stopCharging();const f=j(this,Ne,"f");f&&!f.disposed&&(f._startLoading(),f.clearAllInnerDrawingItems())}),this._on("camera:changed",()=>{this.clearBuffer()}),this._on("before:resolution:change",()=>{const f=j(this,Ne,"f");f&&!f.disposed&&(f._startLoading(),f.clearAllInnerDrawingItems())}),this._on("resolution:changed",()=>{this.clearBuffer(),a.eventHandler.fire("content:updated",null,{async:!1})}),this._on("paused",()=>{j(this,Dr,"f").stopCharging(),j(this,Ne,"f")}),this._on("resumed",()=>{j(this,Ne,"f")}),this._on("tapfocus",()=>{j(this,Wt,"f").tapToFocus&&j(this,Dr,"f").startCharging()}),this._intermediateResultReceiver={},this._intermediateResultReceiver.onTaskResultsReceived=function(){var f=ae(function*(g,p){var _,y,b,O;if(j(l,pt,"m",Rt).call(l)||!l.isOpen()||l.isPaused())return;const M=g.intermediateResultUnits;rt._onLog&&(rt._onLog("intermediateResultUnits:"),rt._onLog(M));let P=!1,k=!1;for(let V of M){if(V.unitType===ya.IRUT_DECODED_BARCODES&&V.decodedBarcodes.length){P=!0;break}V.unitType===ya.IRUT_LOCALIZED_BARCODES&&V.localizedBarcodes.length&&(k=!0)}if(rt._onLog&&(rt._onLog("hasLocalizedBarcodes:"),rt._onLog(k)),j(l,Wt,"f").autoZoom||j(l,Wt,"f").enhancedFocus)if(P)j(l,Pe,"f").autoZoomInFrameArray.length=0,j(l,Pe,"f").autoZoomOutFrameCount=0,j(l,Pe,"f").frameArrayInIdealZoom.length=0,j(l,Pe,"f").autoFocusFrameArray.length=0;else{const V=function(){var z=ae(function*(Y){yield l.setZoom(Y),j(l,Wt,"f").autoZoom&&j(l,Dr,"f").startCharging()});return function(X){return z.apply(this,arguments)}}(),H=function(){var z=ae(function*(Y){yield l.setFocus(Y),j(l,Wt,"f").enhancedFocus&&j(l,Dr,"f").startCharging()});return function(X){return z.apply(this,arguments)}}();if(k){const z=M[0].originalImageTag,Y=(null===(_=z.cropRegion)||void 0===_?void 0:_.left)||0,X=(null===(y=z.cropRegion)||void 0===y?void 0:y.top)||0,$=(null===(b=z.cropRegion)||void 0===b?void 0:b.right)?z.cropRegion.right-Y:z.originalWidth,K=(null===(O=z.cropRegion)||void 0===O?void 0:O.bottom)?z.cropRegion.bottom-X:z.originalHeight,ge=z.currentWidth,_e=z.currentHeight;let Te;{let xe,F,Ee,ke,Qe;{const w=l.video.videoWidth*(1-j(l,Pe,"f").autoZoomDetectionArea)/2,T=l.video.videoWidth*(1+j(l,Pe,"f").autoZoomDetectionArea)/2,m=T,v=w,S=l.video.videoHeight*(1-j(l,Pe,"f").autoZoomDetectionArea)/2,A=S,I=l.video.videoHeight*(1+j(l,Pe,"f").autoZoomDetectionArea)/2;Qe=[{x:w,y:S},{x:T,y:A},{x:m,y:I},{x:v,y:I}]}rt._onLog&&(rt._onLog("detectionArea:"),rt._onLog(Qe));const D=[];{const w=(T,m)=>{const v=(A,I)=>{if(!A&&!I)throw new Error("Invalid arguments.");return function(x,L,N){let B=!1;const G=x.length;if(G<=2)return!1;for(let U=0;U<G;U++){const W=x[U],q=x[(U+1)%G];if(mj(W,q,{x:L,y:N}))return!0;i_(W.y-N)>0!=i_(q.y-N)>0&&i_(L-(N-W.y)*(W.x-q.x)/(W.y-q.y)-W.x)<0&&(B=!B)}return B}(I,A.x,A.y)},S=(A,I)=>!!(id([A[0],A[1]],[A[2],A[3]],[I[0].x,I[0].y],[I[1].x,I[1].y])||id([A[0],A[1]],[A[2],A[3]],[I[1].x,I[1].y],[I[2].x,I[2].y])||id([A[0],A[1]],[A[2],A[3]],[I[2].x,I[2].y],[I[3].x,I[3].y])||id([A[0],A[1]],[A[2],A[3]],[I[3].x,I[3].y],[I[0].x,I[0].y]));return!!(v({x:T[0].x,y:T[0].y},m)||v({x:T[1].x,y:T[1].y},m)||v({x:T[2].x,y:T[2].y},m)||v({x:T[3].x,y:T[3].y},m))||!!(v({x:m[0].x,y:m[0].y},T)||v({x:m[1].x,y:m[1].y},T)||v({x:m[2].x,y:m[2].y},T)||v({x:m[3].x,y:m[3].y},T))||!!(S([m[0].x,m[0].y,m[1].x,m[1].y],T)||S([m[1].x,m[1].y,m[2].x,m[2].y],T)||S([m[2].x,m[2].y,m[3].x,m[3].y],T)||S([m[3].x,m[3].y,m[0].x,m[0].y],T))};for(let T of M)if(T.unitType===ya.IRUT_LOCALIZED_BARCODES)for(let m of T.localizedBarcodes){if(!m)continue;const v=m.location.points;v.forEach(S=>{rn._transformCoordinates(S,Y,X,$,K,ge,_e)}),w(Qe,v)&&D.push(m)}if(rt._debug&&j(l,Ne,"f")){const T=l.__layer||(l.__layer=j(l,Ne,"f")._createDrawingLayer(99));T.clearDrawingItems();const m=l.__styleId2||(l.__styleId2=Ce.createDrawingStyle({strokeStyle:"red"}));for(let v of M)if(v.unitType===ya.IRUT_LOCALIZED_BARCODES)for(let S of v.localizedBarcodes){if(!S)continue;const I=new l_({points:S.location.points},m);T.addDrawingItems([I])}}}if(rt._onLog&&(rt._onLog("intersectedResults:"),rt._onLog(D)),!D.length)return;let C;if(D.length){let w=D.filter(T=>T.possibleFormats==I_.BF_QR_CODE||T.possibleFormats==I_.BF_DATAMATRIX);if(w.length||(w=D.filter(T=>T.possibleFormats==I_.BF_ONED),w.length||(w=D)),w.length){const T=v=>{const S=v.location.points,A=(S[0].x+S[1].x+S[2].x+S[3].x)/4,I=(S[0].y+S[1].y+S[2].y+S[3].y)/4;return(A-ge/2)*(A-ge/2)+(I-_e/2)*(I-_e/2)};C=w[0];let m=T(C);if(1!=w.length)for(let v=1;v<w.length;v++){const S=T(w[v]);(w[v].confidence>1.1*C.confidence||w[v].confidence>.9*C.confidence&&S<m)&&(C=w[v],m=S)}}}if(rt._onLog&&(rt._onLog("highPriorityResult:"),rt._onLog(C)),C){const w=C.location.points;xe=Math.min(w[0].x,w[1].x,w[2].x,w[3].x),F=Math.max(w[0].x,w[1].x,w[2].x,w[3].x),Ee=Math.min(w[0].y,w[1].y,w[2].y,w[3].y),ke=Math.max(w[0].y,w[1].y,w[2].y,w[3].y),Te={points:[{x:xe,y:Ee},{x:F,y:Ee},{x:F,y:ke},{x:xe,y:ke}],result:C}}}if(rt._onLog&&(rt._onLog("boundingRect:"),rt._onLog(Te)),!Te)return;if(rt._debug&&j(l,Ne,"f")&&(null==Te?void 0:Te.points)){const xe=l.__layer||(l.__layer=j(l,Ne,"f")._createDrawingLayer(99)),F=l.__styleId1||(l.__styleId1=Ce.createDrawingStyle({strokeStyle:"blue"})),Ee=new l_({points:Te.points},F);xe.addDrawingItems([Ee])}if(j(l,Pe,"f").autoZoomOutFrameCount=0,j(l,Wt,"f").autoZoom){const xe=j(l,Pe,"f").autoZoomIdealArea[1];let F=(1-j(l,Pe,"f").autoZoomTargetBorder)/2;const Ee=Te.points[0].x/$,ke=($-Te.points[2].x)/$,Qe=Te.points[0].y/K,D=(K-Te.points[2].y)/K;if(Ee>xe&&ke>xe&&Qe>xe&&D>xe&&Te.result.moduleSize<j(l,Pe,"f").autoZoomInIdealModuleSize){if(j(l,Pe,"f").autoZoomInFrameArray.push(!0),j(l,Pe,"f").autoZoomInFrameArray.splice(0,j(l,Pe,"f").autoZoomInFrameArray.length-j(l,Pe,"f").autoZoomInFrameLimit[0]),j(l,Pe,"f").frameArrayInIdealZoom.length=0,j(l,Wt,"f").enhancedFocus&&H({mode:"continuous"}).catch(()=>{}),j(l,Pe,"f").autoZoomInFrameArray.filter(C=>!0===C).length>=j(l,Pe,"f").autoZoomInFrameLimit[1]){j(l,Pe,"f").autoZoomInFrameArray.length=0;const C=[(.5-F)/(.5-Ee),(.5-F)/(.5-ke),(.5-F)/(.5-Qe),(.5-F)/(.5-D)].filter(S=>S>0),w=Math.min(...C,j(l,Pe,"f").autoZoomInIdealModuleSize/Te.result.moduleSize),T=l.getZoomSettings().factor;let m=Math.max(Math.pow(T*w,1/j(l,Pe,"f").autoZoomInMaxTimes),j(l,Pe,"f").autoZoomInMinStep);m=Math.min(m,w);let v=T*m;v=Math.max(j(l,Pe,"f").minValue,v),v=Math.min(j(l,Pe,"f").maxValue,v);try{yield V({factor:v})}catch(S){console.warn(S.message||S)}l.clearBuffer()}}else if(j(l,Pe,"f").autoZoomInFrameArray.length=0,j(l,Pe,"f").frameArrayInIdealZoom.push(!0),j(l,Pe,"f").frameArrayInIdealZoom.splice(0,j(l,Pe,"f").frameArrayInIdealZoom.length-j(l,Pe,"f").frameLimitInIdealZoom[0]),j(l,Pe,"f").frameArrayInIdealZoom.filter(C=>!0===C).length>=j(l,Pe,"f").frameLimitInIdealZoom[1]&&(j(l,Pe,"f").frameArrayInIdealZoom.length=0,j(l,Wt,"f").enhancedFocus)){const C=Te.points;try{yield H({mode:"manual",area:{centerPoint:{x:(C[0].x+C[2].x)/2+"px",y:(C[0].y+C[2].y)/2+"px"},width:C[2].x-C[0].x+"px",height:C[2].y-C[0].y+"px"}})}catch(w){console.warn(w.message||w)}l.clearBuffer()}}if(!j(l,Wt,"f").autoZoom&&j(l,Wt,"f").enhancedFocus&&(j(l,Pe,"f").autoFocusFrameArray.push(!0),j(l,Pe,"f").autoFocusFrameArray.splice(0,j(l,Pe,"f").autoFocusFrameArray.length-j(l,Pe,"f").autoFocusFrameLimit[0]),j(l,Pe,"f").autoFocusFrameArray.filter(xe=>!0===xe).length>=j(l,Pe,"f").autoFocusFrameLimit[1])){j(l,Pe,"f").autoFocusFrameArray.length=0;try{const xe=Te.points;yield H({mode:"manual",area:{centerPoint:{x:(xe[0].x+xe[2].x)/2+"px",y:(xe[0].y+xe[2].y)/2+"px"},width:xe[2].x-xe[0].x+"px",height:xe[2].y-xe[0].y+"px"}})}catch(xe){console.warn(xe.message||xe)}l.clearBuffer()}}else{if(j(l,Wt,"f").autoZoom){if(j(l,Pe,"f").autoZoomInFrameArray.push(!1),j(l,Pe,"f").autoZoomInFrameArray.splice(0,j(l,Pe,"f").autoZoomInFrameArray.length-j(l,Pe,"f").autoZoomInFrameLimit[0]),j(l,Pe,"f").autoZoomOutFrameCount++,j(l,Pe,"f").frameArrayInIdealZoom.push(!1),j(l,Pe,"f").frameArrayInIdealZoom.splice(0,j(l,Pe,"f").frameArrayInIdealZoom.length-j(l,Pe,"f").frameLimitInIdealZoom[0]),j(l,Pe,"f").autoZoomOutFrameCount>=j(l,Pe,"f").autoZoomOutFrameLimit){j(l,Pe,"f").autoZoomOutFrameCount=0;const z=l.getZoomSettings().factor;let Y=z-Math.max((z-1)*j(l,Pe,"f").autoZoomOutStepRate,j(l,Pe,"f").autoZoomOutMinStep);Y=Math.max(j(l,Pe,"f").minValue,Y),Y=Math.min(j(l,Pe,"f").maxValue,Y);try{yield V({factor:Y})}catch(X){console.warn(X.message||X)}l.clearBuffer()}j(l,Wt,"f").enhancedFocus&&H({mode:"continuous"}).catch(()=>{})}!j(l,Wt,"f").autoZoom&&j(l,Wt,"f").enhancedFocus&&(j(l,Pe,"f").autoFocusFrameArray.length=0,H({mode:"continuous"}).catch(()=>{}))}}});return function(g,p){return f.apply(this,arguments)}}(),Me(this,Dr,new es(1e4),"f")}setCameraView(a){if(!(a instanceof rn))throw new TypeError("Invalid view.");if(a.disposed)throw new Error("The camera view has been disposed.");if(this.isOpen())throw new Error("It is not allowed to change camera view when the camera is open.");this.releaseCameraView(),a._singleFrameMode=this.singleFrameMode,a._onSingleFrameAcquired=this._onSingleFrameAcquired,this.videoSrc&&(j(this,Ne,"f")._hideDefaultSelection=!0),j(this,pt,"m",Rt).call(this)||j(this,Le,"f").setVideoEl(a.getVideoElement()),Me(this,Ne,a,"f"),this.addListenerToView()}getCameraView(){return j(this,Ne,"f")}releaseCameraView(){j(this,Ne,"f")&&(this.removeListenerFromView(),j(this,Ne,"f").disposed||(j(this,Ne,"f")._singleFrameMode="disabled",j(this,Ne,"f")._onSingleFrameAcquired=null,j(this,Ne,"f")._hideDefaultSelection=!1),j(this,Le,"f").releaseVideoEl(),Me(this,Ne,null,"f"))}addListenerToView(){if(!j(this,Ne,"f"))return;if(j(this,Ne,"f").disposed)throw new Error("'cameraView' has been disposed.");const a=j(this,Ne,"f");j(this,pt,"m",Rt).call(this)||this.videoSrc||(a._innerComponent&&(j(this,Le,"f").tapFocusEventBoundEl=a._innerComponent),a._selCam&&a._selCam.addEventListener("change",this._onCameraSelChange),a._selRsl&&a._selRsl.addEventListener("change",this._onResolutionSelChange)),a._btnClose&&a._btnClose.addEventListener("click",this._onCloseBtnClick)}removeListenerFromView(){if(!j(this,Ne,"f")||j(this,Ne,"f").disposed)return;const a=j(this,Ne,"f");j(this,Le,"f").tapFocusEventBoundEl=null,a._selCam&&a._selCam.removeEventListener("change",this._onCameraSelChange),a._selRsl&&a._selRsl.removeEventListener("change",this._onResolutionSelChange),a._btnClose&&a._btnClose.removeEventListener("click",this._onCloseBtnClick)}getCameraState(){return j(this,pt,"m",Rt).call(this)?j(this,Lc,"f"):new Map([["closed","closed"],["opening","opening"],["opened","open"]]).get(j(this,Le,"f").state)}isOpen(){return"open"===this.getCameraState()}getVideoEl(){return this.video}open(){var a=this;return ae(function*(){const l=j(a,Ne,"f");if(null==l?void 0:l.disposed)throw new Error("'cameraView' has been disposed.");l&&(l._singleFrameMode=a.singleFrameMode,j(a,pt,"m",Rt).call(a)?l._clickIptSingleFrameMode():(j(a,Le,"f").setVideoEl(l.getVideoElement()),l._startLoading()));let f={width:0,height:0,deviceId:""};if(!j(a,pt,"m",Rt).call(a)){try{yield j(a,Le,"f").open()}catch(p){throw l&&l._stopLoading(),p}j(a,_o,"f")&&a.turnOnTorch().catch(()=>{});const g=a.getResolution();f.width=g.width,f.height=g.height,f.deviceId=a.getSelectedCamera().deviceId}return Me(a,Lc,"open","f"),l&&(l._innerComponent.style.display="",j(a,pt,"m",Rt).call(a)||(l._stopLoading(),l._renderCamerasInfo(a.getSelectedCamera(),j(a,Le,"f")._arrCameras),l._renderResolutionInfo({width:f.width,height:f.height}),l.eventHandler.fire("content:updated",null,{async:!1}),l.eventHandler.fire("videoEl:resized",null,{async:!1}))),j(a,Qr,"f").fire("opened",null,{target:a,async:!1}),f})()}close(){const a=j(this,Ne,"f");if(null==a?void 0:a.disposed)throw new Error("'cameraView' has been disposed.");this.stopFetching(),this.clearBuffer(),j(this,pt,"m",Rt).call(this)||j(this,Le,"f").close(),Me(this,Lc,"closed","f"),j(this,Dr,"f").stopCharging(),a&&(a._innerComponent.style.display="none",j(this,pt,"m",Rt).call(this)&&a._innerComponent.removeElement("content"),a._stopLoading()),j(this,Qr,"f").fire("closed",null,{target:this,async:!1})}pause(){if(j(this,pt,"m",Rt).call(this))throw new Error("'pause()' is invalid in 'singleFrameMode'.");j(this,Le,"f").pause()}isPaused(){var a;return!j(this,pt,"m",Rt).call(this)&&!0===(null===(a=this.video)||void 0===a?void 0:a.paused)}resume(){var a=this;return ae(function*(){if(j(a,pt,"m",Rt).call(a))throw new Error("'resume()' is invalid in 'singleFrameMode'.");yield j(a,Le,"f").resume()})()}selectCamera(a){var l=this;return ae(function*(){if(!a)throw new Error("Invalid value.");let f;f="string"==typeof a?a:a.deviceId,yield j(l,Le,"f").setCamera(f),Me(l,_o,!1,"f");const g=l.getResolution(),p=j(l,Ne,"f");return p&&!p.disposed&&(p._stopLoading(),p._renderCamerasInfo(l.getSelectedCamera(),j(l,Le,"f")._arrCameras),p._renderResolutionInfo({width:g.width,height:g.height})),{width:g.width,height:g.height,deviceId:l.getSelectedCamera().deviceId}})()}getSelectedCamera(){return j(this,Le,"f").getCamera()}getAllCameras(){var a=this;return ae(function*(){return j(a,Le,"f").getCameras()})()}setResolution(a){var l=this;return ae(function*(){yield j(l,Le,"f").setResolution(a.width,a.height),j(l,_o,"f")&&l.turnOnTorch().catch(()=>{});const f=l.getResolution(),g=j(l,Ne,"f");return g&&!g.disposed&&(g._stopLoading(),g._renderResolutionInfo({width:f.width,height:f.height})),{width:f.width,height:f.height,deviceId:l.getSelectedCamera().deviceId}})()}getResolution(){return j(this,Le,"f").getResolution()}getAvailableResolutions(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.getResolutions()}_on(a,l){["opened","closed","singleframeacquired","frameaddedtobuffer"].includes(a.toLowerCase())?j(this,Qr,"f").on(a,l):j(this,Le,"f").on(a,l)}_off(a,l){["opened","closed","singleframeacquired","frameaddedtobuffer"].includes(a.toLowerCase())?j(this,Qr,"f").off(a,l):j(this,Le,"f").off(a,l)}on(a,l){const f=a.toLowerCase(),g=new Map([["cameraopen","opened"],["cameraclose","closed"],["camerachange","camera:changed"],["resolutionchange","resolution:changed"],["played","played"],["singleframeacquired","singleFrameAcquired"],["frameaddedtobuffer","frameAddedToBuffer"]]).get(f);if(!g)throw new Error("Invalid event.");this._on(g,l)}off(a,l){const f=a.toLowerCase(),g=new Map([["cameraopen","opened"],["cameraclose","closed"],["camerachange","camera:changed"],["resolutionchange","resolution:changed"],["played","played"],["singleframeacquired","singleFrameAcquired"],["frameaddedtobuffer","frameAddedToBuffer"]]).get(f);if(!g)throw new Error("Invalid event.");this._off(g,l)}getVideoSettings(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.getMediaStreamConstraints()}updateVideoSettings(a){var l=this;return ae(function*(){var f;yield null===(f=j(l,Le,"f"))||void 0===f?void 0:f.setMediaStreamConstraints(a,!0)})()}getCapabilities(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.getCameraCapabilities()}getCameraSettings(){return j(this,Le,"f").getCameraSettings()}turnOnTorch(){var a=this;return ae(function*(){var l;if(j(a,pt,"m",Rt).call(a))throw new Error("'turnOnTorch()' is invalid in 'singleFrameMode'.");yield null===(l=j(a,Le,"f"))||void 0===l?void 0:l.turnOnTorch(),Me(a,_o,!0,"f")})()}turnOffTorch(){var a=this;return ae(function*(){var l;if(j(a,pt,"m",Rt).call(a))throw new Error("'turnOffTorch()' is invalid in 'singleFrameMode'.");yield null===(l=j(a,Le,"f"))||void 0===l?void 0:l.turnOffTorch(),Me(a,_o,!1,"f")})()}setColorTemperature(a){var l=this;return ae(function*(){if(j(l,pt,"m",Rt).call(l))throw new Error("'setColorTemperature()' is invalid in 'singleFrameMode'.");yield j(l,Le,"f").setColorTemperature(a,!0)})()}getColorTemperature(){return j(this,Le,"f").getColorTemperature()}setExposureCompensation(a){var l=this;return ae(function*(){var f;if(j(l,pt,"m",Rt).call(l))throw new Error("'setExposureCompensation()' is invalid in 'singleFrameMode'.");yield null===(f=j(l,Le,"f"))||void 0===f?void 0:f.setExposureCompensation(a,!0)})()}getExposureCompensation(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.getExposureCompensation()}_setZoom(a){var l=this;return ae(function*(){var f;if(j(l,pt,"m",Rt).call(l))throw new Error("'setZoom()' is invalid in 'singleFrameMode'.");yield null===(f=j(l,Le,"f"))||void 0===f?void 0:f.setZoom(a)})()}setZoom(a){var l=this;return ae(function*(){yield l._setZoom(a)})()}getZoomSettings(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.getZoom()}resetZoom(){var a=this;return ae(function*(){var l;if(j(a,pt,"m",Rt).call(a))throw new Error("'resetZoom()' is invalid in 'singleFrameMode'.");yield null===(l=j(a,Le,"f"))||void 0===l?void 0:l.resetZoom()})()}setFrameRate(a){var l=this;return ae(function*(){var f;if(j(l,pt,"m",Rt).call(l))throw new Error("'setFrameRate()' is invalid in 'singleFrameMode'.");yield null===(f=j(l,Le,"f"))||void 0===f?void 0:f.setFrameRate(a,!0)})()}getFrameRate(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.getFrameRate()}setFocus(a){var l=this;return ae(function*(){var f;if(j(l,pt,"m",Rt).call(l))throw new Error("'setFocus()' is invalid in 'singleFrameMode'.");yield null===(f=j(l,Le,"f"))||void 0===f?void 0:f.setFocus(a,!0)})()}getFocusSettings(){var a;return null===(a=j(this,Le,"f"))||void 0===a?void 0:a.getFocus()}setAutoZoomRange(a){j(this,Pe,"f").minValue=a.min,j(this,Pe,"f").maxValue=a.max}getAutoZoomRange(){return{min:j(this,Pe,"f").minValue,max:j(this,Pe,"f").maxValue}}enableEnhancedFeatures(a){var l=this;return ae(function*(){var f,g;if(!(null===(g=null===(f=yn.license)||void 0===f?void 0:f.LicenseManager)||void 0===g?void 0:g.bPassValidation))throw new Error("License is not verified, or license is invalid.");if(0!==Qt.bSupportDce4Module)throw new Error("Please set a license containing the DCE module.");a&Ts.EF_ENHANCED_FOCUS&&(j(l,Wt,"f").enhancedFocus=!0),a&Ts.EF_AUTO_ZOOM&&(j(l,Wt,"f").autoZoom=!0),a&Ts.EF_TAP_TO_FOCUS&&(j(l,Wt,"f").tapToFocus=!0,j(l,Le,"f").enableTapToFocus())})()}disableEnhancedFeatures(a){a&Ts.EF_ENHANCED_FOCUS&&(j(this,Wt,"f").enhancedFocus=!1,this.setFocus({mode:"continuous"}).catch(()=>{})),a&Ts.EF_AUTO_ZOOM&&(j(this,Wt,"f").autoZoom=!1,this.resetZoom().catch(()=>{})),a&Ts.EF_TAP_TO_FOCUS&&(j(this,Wt,"f").tapToFocus=!1,j(this,Le,"f").disableTapToFocus()),j(this,pt,"m",XT).call(this)&&j(this,pt,"m",$T).call(this)||j(this,Dr,"f").stopCharging()}_setScanRegion(a){if(null!=a&&!n_(a)&&!Hr(a))throw TypeError("Invalid 'region'.");Me(this,vo,a?JSON.parse(JSON.stringify(a)):null,"f"),j(this,Ne,"f")&&!j(this,Ne,"f").disposed&&j(this,Ne,"f").setScanRegion(a)}setScanRegion(a){this._setScanRegion(a),j(this,Ne,"f")&&!j(this,Ne,"f").disposed&&(null===a?j(this,Ne,"f").setScanRegionMaskVisible(!1):j(this,Ne,"f").setScanRegionMaskVisible(!0))}getScanRegion(){return JSON.parse(JSON.stringify(j(this,vo,"f")))}setErrorListener(a){if(!a)throw new TypeError("Invalid 'listener'");Me(this,Fc,a,"f")}hasNextImageToFetch(){return!("open"!==this.getCameraState()||!j(this,Le,"f").isVideoLoaded()||j(this,pt,"m",Rt).call(this))}startFetching(){if(j(this,pt,"m",Rt).call(this))throw Error("'startFetching()' is unavailable in 'singleFrameMode'.");j(this,Jr,"f")||(Me(this,Jr,!0,"f"),j(this,pt,"m",S_).call(this))}stopFetching(){j(this,Jr,"f")&&(rt._onLog&&rt._onLog("DCE: stop fetching loop: "+Date.now()),j(this,gi,"f")&&clearTimeout(j(this,gi,"f")),Me(this,Jr,!1,"f"))}fetchImage(){if(j(this,pt,"m",Rt).call(this))throw new Error("'fetchImage()' is unavailable in 'singleFrameMode'.");if(!this.video)throw new Error("The video element does not exist.");if(4!==this.video.readyState)throw new Error("The video is not loaded.");const a=this.getResolution();if(!(null==a?void 0:a.width)||!(null==a?void 0:a.height))throw new Error("The video is not loaded.");let l;if(l=td.convert(j(this,vo,"f"),a.width,a.height),l||(l={x:0,y:0,width:a.width,height:a.height}),l.x>a.width||l.y>a.height)throw new Error("Invalid scan region.");l.x+l.width>a.width&&(l.width=a.width-l.x),l.y+l.height>a.height&&(l.height=a.height-l.y);const f={sx:l.x,sy:l.y,sWidth:l.width,sHeight:l.height,dWidth:l.width,dHeight:l.height},g=Math.max(f.dWidth,f.dHeight);if(this.canvasSizeLimit&&g>this.canvasSizeLimit){const b=this.canvasSizeLimit/g;f.dWidth>f.dHeight?(f.dWidth=this.canvasSizeLimit,f.dHeight=Math.round(f.dHeight*b)):(f.dWidth=Math.round(f.dWidth*b),f.dHeight=this.canvasSizeLimit)}const p=j(this,Le,"f").getFrameData({position:f,pixelFormat:qT.get(this.getPixelFormat())});if(!p)return null;let _;_=p.pixelFormat===gt.GREY?p.width:4*p.width;let y=!0;return 0===f.sx&&0===f.sy&&f.sWidth===a.width&&f.sHeight===a.height&&(y=!1),{bytes:p.data,width:p.width,height:p.height,stride:_,format:ZT.get(p.pixelFormat),tag:{imageId:this._imageId==Number.MAX_VALUE?this._imageId=0:++this._imageId,type:$h.ITT_VIDEO_FRAME,isCropped:y,cropRegion:{left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height,isMeasuredInPercentage:!1},originalWidth:a.width,originalHeight:a.height,currentWidth:p.width,currentHeight:p.height,timeSpent:p.timeSpent,timeStamp:p.timeStamp},toCanvas:j(this,Sd,"f"),isDCEFrame:!0}}setImageFetchInterval(a){this.fetchInterval=a,j(this,Jr,"f")&&(j(this,gi,"f")&&clearTimeout(j(this,gi,"f")),Me(this,gi,setTimeout(()=>{this.disposed||j(this,pt,"m",S_).call(this)},a),"f"))}getImageFetchInterval(){return this.fetchInterval}setPixelFormat(a){Me(this,Td,a,"f")}getPixelFormat(){return j(this,Td,"f")}takePhoto(a){var l=this;if(!this.isOpen())throw new Error("Not open.");if(j(this,pt,"m",Rt).call(this))throw new Error("'takePhoto()' is unavailable in 'singleFrameMode'.");const f=document.createElement("input");f.setAttribute("type","file"),f.setAttribute("accept",".jpg,.jpeg,.icon,.gif,.svg,.webp,.png,.bmp"),f.setAttribute("capture",""),f.style.position="absolute",f.style.top="-9999px",f.style.backgroundColor="transparent",f.style.color="transparent",f.addEventListener("click",()=>{const g=this.isOpen();this.close(),window.addEventListener("focus",()=>{g&&this.open(),f.remove()},{once:!0})}),f.addEventListener("change",ae(function*(){const g=f.files[0],p=yield(M=ae(function*(P){let k=null,V=null;if("undefined"!=typeof createImageBitmap)try{if(k=yield createImageBitmap(P),k)return k}catch(z){}var H;return k||(V=yield(H=P,new Promise((z,Y)=>{let X=URL.createObjectURL(H),$=new Image;$.src=X,$.onload=()=>{URL.revokeObjectURL($.src),z($)},$.onerror=K=>{Y(new Error("Can't convert blob to image : "+(K instanceof Event?K.type:K)))}}))),V}),function(P){return M.apply(this,arguments)})(g),_=p instanceof HTMLImageElement?p.naturalWidth:p.width,y=p instanceof HTMLImageElement?p.naturalHeight:p.height;var M;let b=td.convert(j(l,vo,"f"),_,y);b||(b={x:0,y:0,width:_,height:y});const O=j(l,Dd,"f").call(l,p,_,y,b);a&&a(O)})),document.body.appendChild(f),f.click()}convertToPageCoordinates(a){const l=j(this,pt,"m",T_).call(this,a);return{x:l.pageX,y:l.pageY}}convertToClientCoordinates(a){const l=j(this,pt,"m",T_).call(this,a);return{x:l.clientX,y:l.clientY}}dispose(){this.close(),j(this,Le,"f").dispose(),this.releaseCameraView(),this.__proto__=null;for(let a in this)delete this[a];Object.defineProperty(this,"isCameraEnhancer",{value:!0}),Object.defineProperty(this,"disposed",{value:!0})}}function zn(u,a,l,f){if("a"===l&&!f)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof a?u!==a||!f:!a.has(u))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===l?f:"a"===l?f.call(u):f?f.value:a.get(u)}function Ji(u,a,l,f,g){if("m"===f)throw new TypeError("Private method is not writable");if("a"===f&&!g)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof a?u!==a||!g:!a.has(u))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===f?g.call(u,l):g?g.value=l:a.set(u,l),l}w_=rt,Le=new WeakMap,Ne=new WeakMap,Lc=new WeakMap,Qr=new WeakMap,_o=new WeakMap,bd=new WeakMap,Dd=new WeakMap,Sd=new WeakMap,Fc=new WeakMap,vo=new WeakMap,Td=new WeakMap,Jr=new WeakMap,gi=new WeakMap,Wt=new WeakMap,Pe=new WeakMap,Dr=new WeakMap,D_=new WeakMap,pt=new WeakSet,Rt=function(){return"disabled"!==this.singleFrameMode},$T=function(){return!this.videoSrc&&"opened"===j(this,Le,"f").state},XT=function(){for(let u in j(this,Wt,"f"))if(1==j(this,Wt,"f")[u])return!0;return!1},S_=function u(){if(this.disposed)return;if("open"!==this.getCameraState()||!j(this,Jr,"f"))return j(this,gi,"f")&&clearTimeout(j(this,gi,"f")),void Me(this,gi,setTimeout(()=>{this.disposed||j(this,pt,"m",u).call(this)},this.fetchInterval),"f");const a=()=>{var l;let f;rt._onLog&&rt._onLog("DCE: start fetching a frame into buffer: "+Date.now());try{f=this.fetchImage()}catch(g){const p=g.message||g;if("The video is not loaded."===p)return;if(null===(l=j(this,Fc,"f"))||void 0===l?void 0:l.onErrorReceived)return void setTimeout(()=>{var _;null===(_=j(this,Fc,"f"))||void 0===_||_.onErrorReceived(Hm.EC_IMAGE_READ_FAILED,p)},0);console.warn(g)}f?(this.addImageToBuffer(f),rt._onLog&&rt._onLog("DCE: finish fetching a frame into buffer: "+Date.now()),j(this,Qr,"f").fire("frameAddedToBuffer",null,{async:!1})):rt._onLog&&rt._onLog("DCE: get a invalid frame, abandon it: "+Date.now())};if(this.getImageCount()>=this.getMaxImageCount())switch(this.getBufferOverflowProtectionMode()){case so.BOPM_BLOCK:break;case so.BOPM_UPDATE:a()}else a();j(this,gi,"f")&&clearTimeout(j(this,gi,"f")),Me(this,gi,setTimeout(()=>{this.disposed||j(this,pt,"m",u).call(this)},this.fetchInterval),"f")},T_=function(u){if(!j(this,Ne,"f"))throw new Error("Camera view is not set.");if(j(this,Ne,"f").disposed)throw new Error("'cameraView' has been disposed.");if(!this.isOpen())throw new Error("Not open.");if(!j(this,pt,"m",Rt).call(this)&&!j(this,Le,"f").isVideoLoaded())throw new Error("Video is not loaded.");if(j(this,pt,"m",Rt).call(this)&&!j(this,Ne,"f")._cvsSingleFrameMode)throw new Error("No image is selected.");const a=j(this,Ne,"f")._innerComponent.getBoundingClientRect(),l=a.left,f=a.top,g=l+window.scrollX,p=f+window.scrollY,{width:_,height:y}=j(this,Ne,"f")._innerComponent.getBoundingClientRect();if(_<=0||y<=0)throw new Error("Unable to get content dimensions. Camera view may not be rendered on the page.");let b,O,M;if(j(this,pt,"m",Rt).call(this)){const $=j(this,Ne,"f")._innerComponent.getElement("content");b=$.width,O=$.height,M="contain"}else{const $=this.getVideoEl();b=$.videoWidth,O=$.videoHeight,M=j(this,Ne,"f").getVideoFit()}const P=_/y,k=b/O;let V,H,z,Y,X=1;if("contain"===M)P<k?(X=_/b,V=l+u.x*X,H=f+u.y*X+(y-O*X)/2,z=g+u.x*X,Y=p+u.y*X+(y-O*X)/2):(X=y/O,V=l+u.x*X+(_-b*X)/2,H=f+u.y*X,z=g+u.x*X+(_-b*X)/2,Y=p+u.y*X);else if("cover"===M)if(P<k){X=y/O;let $=u.x*X-(b*X-_)/2;$=Math.max($,0),$=Math.min($,_),V=l+$,H=f+u.y*X,z=g+$,Y=p+u.y*X}else{X=_/b;let $=u.y*X-(O*X-y)/2;$=Math.max($,0),$=Math.min($,y),V=l+u.x*X,H=f+$,z=g+u.x*X,Y=p+$}return{clientX:V,clientY:H,pageX:z,pageY:Y}},rt._debug=!1,b_={value:void 0},rt.browserInfo=An,"function"==typeof SuppressedError&&SuppressedError;class pi{static multiply(a,l){const f=[];for(let g=0;g<3;g++){const p=l.slice(3*g,3*g+3);for(let _=0;_<3;_++){const y=[a[_],a[_+3],a[_+6]].reduce((b,O,M)=>b+O*p[M],0);f.push(y)}}return f}static identity(){return[1,0,0,0,1,0,0,0,1]}static translate(a,l,f){return pi.multiply(a,[1,0,0,0,1,0,l,f,1])}static rotate(a,l){var f=Math.cos(l),g=Math.sin(l);return pi.multiply(a,[f,-g,0,g,f,0,0,0,1])}static scale(a,l,f){return pi.multiply(a,[l,0,0,0,f,0,0,0,1])}}var Ut,ts,ns,Id,Ba,Pc,Nc,Va,xd,Mi,KT,R_,Vc,jc;!function(u){u.GREY="grey",u.GREY32="grey32",u.RGBA="rgba",u.RBGA="rbga",u.GRBA="grba",u.GBRA="gbra",u.BRGA="brga",u.BGRA="bgra"}(Ut||(Ut={}));class $e{static get version(){return"1.1.0"}static checkWebGLSupport(){return null===document.createElement("canvas").getContext("webgl")?(Ji($e,ts,!1,"f",ns),!1):(Ji($e,ts,!0,"f",ns),!0)}get disposed(){return zn(this,xd,"f")}constructor(){Id.set(this,Ut.RGBA),Ba.set(this,null),Pc.set(this,null),Nc.set(this,null),this.useWebGLByDefault=!0,this._reusedCvs=null,this._reusedWebGLCvs=null,Va.set(this,null),xd.set(this,!1)}drawImage(a,l,f,g,p,_){if(this.disposed)throw Error("The 'ImageDataGetter' instance has been disposed.");if(!f||!g)throw new Error("Invalid 'sourceWidth' or 'sourceHeight'.");if(null==zn($e,ts,"f",ns)&&$e.checkWebGLSupport(),(null==_?void 0:_.bUseWebGL)&&!zn($e,ts,"f",ns))throw new Error("Your browser or machine may not support WebGL.");if(l instanceof HTMLVideoElement&&4!==l.readyState||l instanceof HTMLImageElement&&!l.complete)throw new Error("The source is not loaded.");let y;$e._onLog&&(y=Date.now(),$e._onLog("drawImage(), START: "+y));let b=0,O=0,M=f,P=g,k=0,V=0,H=f,z=g;p&&(p.sx&&(b=Math.round(p.sx)),p.sy&&(O=Math.round(p.sy)),p.sWidth&&(M=Math.round(p.sWidth)),p.sHeight&&(P=Math.round(p.sHeight)),p.dx&&(k=Math.round(p.dx)),p.dy&&(V=Math.round(p.dy)),p.dWidth&&(H=Math.round(p.dWidth)),p.dHeight&&(z=Math.round(p.dHeight)));let Y,X=Ut.RGBA;if((null==_?void 0:_.pixelFormat)&&(X=_.pixelFormat),(null==_?void 0:_.bufferContainer)&&(Y=_.bufferContainer,Y.length<4*H*z))throw new Error("Unexpected size of the 'bufferContainer'.");const $=a;if(!zn($e,ts,"f",ns)||!(this.useWebGLByDefault&&null==(null==_?void 0:_.bUseWebGL)||(null==_?void 0:_.bUseWebGL))){$e._onLog&&$e._onLog("drawImage() in context2d."),$.ctx2d||($.ctx2d=$.getContext("2d",{willReadFrequently:!0}));const K=$.ctx2d;if(!K)throw new Error("Unable to get 'CanvasRenderingContext2D' from canvas.");return($.width<k+H||$.height<V+z)&&($.width=k+H,$.height=V+z),K.drawImage(l,b,O,M,P,k,V,H,z),$e._onLog&&$e._onLog("drawImage() in context2d end. Costs: "+(Date.now()-y)),{context:K,pixelFormat:Ut.RGBA,bUseWebGL:!1}}$e._onLog&&$e._onLog("drawImage() in WebGL.");try{($.width<k+H||$.height<V+z)&&($.width=k+H,$.height=V+z,$.ctxWebGL&&$.ctxWebGL.viewport(0,0,k+H,V+z));const K=$.ctxWebGL||$.getContext("webgl",{antialias:!1})||$.getContext("experimental-webgl",{antialias:!1});if(!K){$e._onLog&&$e._onLog("Browser or machine may not support WebGL, or the canvas has already been set to a different context mode.");const F=new Error("Unable to get 'WebGLRenderingContext'. Your browser or machine may not support WebGL, or the canvas has already been set to a different context mode.");throw F.name="WebGLError",F}if(!$.ctxWebGL||X!==zn(this,Id,"f")){$.ctxWebGL=K;const F=m=>{const v=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,v),m.bufferData(m.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),m.STATIC_DRAW);const S=m.createBuffer();return m.bindBuffer(m.ARRAY_BUFFER,S),m.bufferData(m.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),m.STATIC_DRAW),{positions:v,texCoords:S}},Ee=m=>{const v=m.createTexture();return m.bindTexture(m.TEXTURE_2D,v),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),v},ke=(m,v)=>{const S=m.createProgram();if(v.forEach(A=>m.attachShader(S,A)),m.linkProgram(S),!m.getProgramParameter(S,m.LINK_STATUS)){const A=new Error(`An error occured linking the program: ${m.getProgramInfoLog(S)}.`);throw A.name="WebGLError",A}return m.useProgram(S),S},Qe=(m,v,S)=>{const A=m.createShader(v);if(m.shaderSource(A,S),m.compileShader(A),!m.getShaderParameter(A,m.COMPILE_STATUS)){const I=new Error(`An error occured compiling the shader: ${m.getShaderInfoLog(A)}.`);throw I.name="WebGLError",I}return A},D="\n                  attribute vec2 a_position;\n                  attribute vec2 a_texCoord;\n  \n                  uniform mat3 u_matrix;\n                  uniform mat3 u_textureMatrix;\n  \n                  varying vec2 v_texCoord;\n                  void main(void) {\n                  gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1.0);\n                  v_texCoord = vec4((u_textureMatrix * vec3(a_texCoord, 1)).xy, 0, 1.0).xy;\n                  }\n              ";let C="rgb";["rgba","rbga","grba","gbra","brga","bgra"].includes(X)&&(C=X.slice(0,3));const w=`\n                  precision mediump float;\n                  varying vec2 v_texCoord;\n                  uniform sampler2D u_image;\n                  uniform float uColorFactor;\n  \n                  void main() {\n                      vec4 sample = texture2D(u_image, v_texCoord);\n                      float grey = 0.21 * sample.r + 0.71 * sample.g + 0.07 * sample.b;\n                      gl_FragColor = vec4(sample.${C} * (1.0 - uColorFactor) + (grey * uColorFactor), sample.a);\n                  }\n              `,T=ke(K,[Qe(K,K.VERTEX_SHADER,D),Qe(K,K.FRAGMENT_SHADER,w)]);Ji(this,Pc,{program:T,attribLocations:{vertexPosition:K.getAttribLocation(T,"a_position"),texPosition:K.getAttribLocation(T,"a_texCoord")},uniformLocations:{uSampler:K.getUniformLocation(T,"u_image"),uColorFactor:K.getUniformLocation(T,"uColorFactor"),uMatrix:K.getUniformLocation(T,"u_matrix"),uTextureMatrix:K.getUniformLocation(T,"u_textureMatrix")}},"f"),Ji(this,Nc,F(K),"f"),Ji(this,Ba,Ee(K),"f"),Ji(this,Id,X,"f")}const ge=(F,Ee,ke)=>{F.bindBuffer(F.ARRAY_BUFFER,Ee),F.enableVertexAttribArray(ke),F.vertexAttribPointer(ke,2,F.FLOAT,!1,0,0)},Te=(F,Ee,ke,Qe)=>{F.clearColor(0,0,0,1),F.clearDepth(1),F.enable(F.DEPTH_TEST),F.depthFunc(F.LEQUAL),F.clear(F.COLOR_BUFFER_BIT|F.DEPTH_BUFFER_BIT),ge(F,ke.positions,Ee.attribLocations.vertexPosition),ge(F,ke.texCoords,Ee.attribLocations.texPosition),F.activeTexture(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,Qe),F.uniform1i(Ee.uniformLocations.uSampler,0),F.uniform1f(Ee.uniformLocations.uColorFactor,[Ut.GREY,Ut.GREY32].includes(X)?1:0);let D,C,w=pi.translate(pi.identity(),-1,-1);w=pi.scale(w,2,2),w=pi.scale(w,1/F.canvas.width,1/F.canvas.height),D=pi.translate(w,k,V),D=pi.scale(D,H,z),F.uniformMatrix3fv(Ee.uniformLocations.uMatrix,!1,D),C=pi.translate(pi.identity(),b/f,O/g),C=pi.scale(C,M/f,P/g),F.uniformMatrix3fv(Ee.uniformLocations.uTextureMatrix,!1,C),F.drawArrays(F.TRIANGLES,0,6)};((F,Ee,ke)=>{const Qe=F.RGBA,D=F.RGBA,C=F.UNSIGNED_BYTE;F.bindTexture(F.TEXTURE_2D,Ee),F.texImage2D(F.TEXTURE_2D,0,Qe,D,C,ke)})(K,zn(this,Ba,"f"),l),Te(K,zn(this,Pc,"f"),zn(this,Nc,"f"),zn(this,Ba,"f"));const xe=Y||new Uint8Array(4*H*z);if(K.readPixels(k,V,H,z,K.RGBA,K.UNSIGNED_BYTE,xe),255!==xe[3]){$e._onLog&&$e._onLog("Incorrect WebGL drawing .");const F=new Error("WebGL error: incorrect drawing.");throw F.name="WebGLError",F}return $e._onLog&&$e._onLog("drawImage() in WebGL end. Costs: "+(Date.now()-y)),{context:K,pixelFormat:X===Ut.GREY?Ut.GREY32:X,bUseWebGL:!0}}catch(K){if(this.forceLoseContext(),null==(null==_?void 0:_.bUseWebGL))return $e._onLog&&$e._onLog("'drawImage()' in WebGL failed, try again in context2d."),this.useWebGLByDefault=!1,this.drawImage(a,l,f,g,p,Object.assign({},_,{bUseWebGL:!1}));throw K.name="WebGLError",K}}readCvsData(a,l,f){if(!(a instanceof CanvasRenderingContext2D||a instanceof WebGLRenderingContext))throw new Error("Invalid 'context'.");let g,p=0,_=0,y=a.canvas.width,b=a.canvas.height;if(l&&(l.x&&(p=l.x),l.y&&(_=l.y),l.width&&(y=l.width),l.height&&(b=l.height)),(null==f?void 0:f.length)<4*y*b)throw new Error("Unexpected size of the 'bufferContainer'.");if(a instanceof WebGLRenderingContext){const O=a;f?(O.readPixels(p,_,y,b,O.RGBA,O.UNSIGNED_BYTE,f),g=new Uint8Array(f.buffer,0,4*y*b)):(g=new Uint8Array(4*y*b),O.readPixels(p,_,y,b,O.RGBA,O.UNSIGNED_BYTE,g))}else if(a instanceof CanvasRenderingContext2D){let O;O=a.getImageData(p,_,y,b),g=new Uint8Array(O.data.buffer),null==f||f.set(g)}return g}transformPixelFormat(a,l,f,g){let p,_;if($e._onLog&&(p=Date.now(),$e._onLog("transformPixelFormat(), START: "+p)),l===f)return $e._onLog&&$e._onLog("transformPixelFormat() end. Costs: "+(Date.now()-p)),g?new Uint8Array(a):a;const y=[Ut.RGBA,Ut.RBGA,Ut.GRBA,Ut.GBRA,Ut.BRGA,Ut.BGRA];if(y.includes(l))if(f===Ut.GREY){_=new Uint8Array(a.length/4);for(let b=0;b<a.length;b+=4)_[b/4]=.21*a[b]+.71*a[b+1]+.07*a[b+2]}else if(f===Ut.GREY32){_=g?new Uint8Array(a):a;for(let b=0;b<a.length;b+=4){const O=.21*a[b]+.71*a[b+1]+.07*a[b+2];_[b]=O,_[b+1]=O,_[b+2]=O}}else{if(!y.includes(f))throw new Error("Unable to transform.");if(g){_=new Uint8Array(a);const b=l.indexOf("r"),O=l.indexOf("g"),M=l.indexOf("b"),P=f.indexOf("r"),k=f.indexOf("g"),V=f.indexOf("b");for(let H=0;H<a.length;H+=4)_[H+P]=a[H+b],_[H+k]=a[H+O],_[H+V]=a[H+M]}else{_=a;const b=l.indexOf("r"),O=l.indexOf("g"),M=l.indexOf("b"),P=f.indexOf("r"),k=f.indexOf("g"),V=f.indexOf("b");for(let H=0;H<a.length;H+=4){let z=[a[H],a[H+1],a[H+2]];_[H+P]=z[b],_[H+k]=z[O],_[H+V]=z[M]}}}else if(l===Ut.GREY){if(f!==Ut.GREY32)throw new Error("Unable to transform.");_=new Uint8Array(4*a.length);for(let b=0;b<a.length;b++)_[4*b]=a[b],_[4*b+1]=a[b],_[4*b+2]=a[b],_[4*b+3]=255}else{if(l!==Ut.GREY32)throw new Error("Unable to transform.");if(f!==Ut.GREY)throw new Error("Unable to transform.");_=new Uint8Array(a.length/4);for(let b=0;b<a.length;b+=4)_[b/4]=a[b]}return $e._onLog&&$e._onLog("transformPixelFormat() end. Costs: "+(Date.now()-p)),_}getImageData(a,l,f,g,p){if(this.disposed)throw Error("The 'ImageDataGetter' instance has been disposed.");if(!l||!f)throw new Error("Invalid 'sourceWidth' or 'sourceHeight'.");if(null==zn($e,ts,"f",ns)&&$e.checkWebGLSupport(),(null==p?void 0:p.bUseWebGL)&&!zn($e,ts,"f",ns))throw new Error("Your browser or machine may not support WebGL.");if(g.sx>l||g.sy>f||g.sx+g.sWidth>l||g.sy+g.sHeight>f)throw new Error("Invalid position.");if(a instanceof HTMLVideoElement&&4!==a.readyState||a instanceof HTMLImageElement&&!a.complete)throw new Error("The source is not loaded.");let _;$e._onLog&&(_=Date.now(),$e._onLog("getImageData(), START: "+_));const y=Math.round(g.sx),b=Math.round(g.sy),O=Math.round(g.sWidth),M=Math.round(g.sHeight),P=Math.round(g.dWidth),k=Math.round(g.dHeight);let V=Ut.RGBA;(null==p?void 0:p.pixelFormat)&&(V=p.pixelFormat);let H,z,Y,X=null;if((null==p?void 0:p.bufferContainer)&&(X=p.bufferContainer),zn($e,ts,"f",ns)&&(this.useWebGLByDefault&&null==(null==p?void 0:p.bUseWebGL)||(null==p?void 0:p.bUseWebGL))){$e._onLog&&$e._onLog("getImageData() in WebGL."),this._reusedWebGLCvs||(this._reusedWebGLCvs=document.createElement("canvas")),H=this._reusedWebGLCvs;try{if(X)if(V===Ut.GREY){if(Y=new Uint8Array(4*P*k),z=this.drawImage(H,a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},{pixelFormat:V,bUseWebGL:!0,bufferContainer:Y}),Y=this.transformPixelFormat(Y,z.pixelFormat,V),X){if(X.length<Y.length)throw new Error("Unexpected size of the 'bufferContainer'.");X.set(Y)}}else z=this.drawImage(H,a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},{pixelFormat:V,bUseWebGL:!0,bufferContainer:X}),Y=new Uint8Array(X.buffer,0,4*P*k),Y=this.transformPixelFormat(Y,z.pixelFormat,V);else V===Ut.GREY?((!zn(this,Va,"f")||zn(this,Va,"f").length<4*P*k)&&Ji(this,Va,new Uint8Array(4*P*k),"f"),Y=new Uint8Array(zn(this,Va,"f").buffer,0,4*P*k)):Y=new Uint8Array(4*P*k),z=this.drawImage(H,a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},{pixelFormat:V,bUseWebGL:!0,bufferContainer:Y}),Y=this.transformPixelFormat(Y,z.pixelFormat,V)}catch($){if("WebGLError"===$.name&&(this.forceLoseContext(),null==(null==p?void 0:p.bUseWebGL)))return $e._onLog&&$e._onLog("getImageData() in WebGL failed, try again in context2d."),this.useWebGLByDefault=!1,this.getImageData(a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},Object.assign({},p,{bUseWebGL:!1}));throw $}}else if($e._onLog&&$e._onLog("getImageData() in context2d."),this._reusedCvs||(this._reusedCvs=document.createElement("canvas")),H=this._reusedCvs,z=this.drawImage(H,a,l,f,{sx:y,sy:b,sWidth:O,sHeight:M,dWidth:P,dHeight:k},{pixelFormat:Ut.RGBA,bUseWebGL:!1}),Y=this.readCvsData(z.context,{width:P,height:k},null),Y=this.transformPixelFormat(Y,z.pixelFormat,V),X){if(X.length<Y.length)throw new Error("Unexpected size of the 'bufferContainer'.");X.set(Y)}return $e._onLog&&$e._onLog("getImageData() end. Costs: "+(Date.now()-_)),{data:Y,pixelFormat:V,width:P,height:k,bUseWebGL:z.bUseWebGL}}convertDataToCvs(a,l,f,g){if(!(a instanceof Uint8Array||a instanceof Uint8ClampedArray))throw new TypeError("Invalid 'data'.");if("number"!=typeof l||l<=0)throw new Error("Invalid 'width'.");if("number"!=typeof f||f<=0)throw new Error("Invalid 'height'.");const p=document.createElement("canvas");let _;if(p.width=l,p.height=f,g===Ut.GREY){_=new Uint8ClampedArray(4*l*f);for(let b=0;b<_.length;b+=4)_[b]=a[b/4],_[b+1]=a[b/4],_[b+2]=a[b/4],_[b+3]=255}else _=new Uint8ClampedArray(a.buffer);const y=new ImageData(_,l,f);return p.getContext("2d").putImageData(y,0,0),p}forceLoseContext(){if(!this._reusedWebGLCvs)return;const a=this._reusedWebGLCvs.ctxWebGL;a&&!a.isContextLost()&&a.getExtension("WEBGL_lose_context")&&a.getExtension("WEBGL_lose_context").loseContext(),Ji(this,Ba,null,"f"),Ji(this,Pc,null,"f"),Ji(this,Nc,null,"f"),this._reusedWebGLCvs=null}dispose(){this.forceLoseContext(),Ji(this,xd,!0,"f")}}ts=$e,Id=new WeakMap,Ba=new WeakMap,Pc=new WeakMap,Nc=new WeakMap,Va=new WeakMap,xd=new WeakMap,ns={value:void 0};class Ua{static beep(){if(!this.beepSoundSource)return;let a;if(j(this,Mi,"f",Vc).size&&(a=j(this,Mi,"f",Vc).values().next().value,this.beepSoundSource==a.src?(j(this,Mi,"f",Vc).delete(a),a.play()):a=null),!a)if(j(this,Mi,"f",jc).size<64){a=new Audio(this.beepSoundSource);let l=null,f=()=>{a.removeEventListener("loadedmetadata",f),a.play(),l=setTimeout(()=>{j(this,Mi,"f",jc).delete(a)},2e3*a.duration)};a.addEventListener("loadedmetadata",f),a.addEventListener("ended",()=>{null!=l&&(clearTimeout(l),l=null),a.pause(),a.currentTime=0,j(this,Mi,"f",jc).delete(a),j(this,Mi,"f",Vc).add(a)})}else j(this,Mi,"f",R_)||(Me(this,Mi,!0,"f",R_),console.warn("The requested audio tracks exceed 64 and will not be played."));a&&j(this,Mi,"f",jc).add(a)}static vibrate(){if(!navigator||!navigator.vibrate)throw new Error("Not supported.");navigator.vibrate(Ua.vibrateDuration)}}Mi=Ua,KT={value:"data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"},R_={value:!1},Vc={value:new Set},jc={value:new Set},Ua.beepSoundSource=j(Ua,Mi,"f",KT),Ua.vibrateDuration=300;const JT="undefined"==typeof self,O_=(()=>{if(!JT&&document.currentScript){let u=document.currentScript.src,a=u.indexOf("?");if(-1!=a)u=u.substring(0,a);else{let l=u.indexOf("#");-1!=l&&(u=u.substring(0,l))}return u.substring(0,u.lastIndexOf("/")+1)}return"./"})(),eI=u=>{if(null==u&&(u="./"),!JT){let a=document.createElement("a");a.href=u,u=a.href}return u.endsWith("/")||(u+="/"),u};null==Ke.dbr&&(Ke.dbr=O_),Ds.dbr={js:!1,wasm:!0,deps:["license","dip"]},yn.dbr={};"string"!=typeof Ke.std&&oo(Ke.std.version,"1.2.0")<0&&(Ke.std={version:"1.2.0",path:eI(O_+"../../dynamsoft-capture-vision-std@1.2.0/dist/")});const L_="2.2.10";var tI,nI,iI,rI;(!Ke.dip||"string"!=typeof Ke.dip&&oo(Ke.dip.version,L_)<0)&&(Ke.dip={version:L_,path:eI(O_+`../../dynamsoft-image-processing@${L_}/dist/`)}),"function"==typeof BigInt&&(BigInt(0),BigInt(0x10000000000000000),BigInt(4265345023),BigInt(3147775),BigInt(260096),BigInt(1),BigInt(2),BigInt(4),BigInt(8),BigInt(16),BigInt(32),BigInt(64),BigInt(128),BigInt(256),BigInt(512),BigInt(1024),BigInt(2048),BigInt(4096),BigInt(8192),BigInt(16384),BigInt(32768),BigInt(65536),BigInt(131072),BigInt(262144),BigInt(16777216),BigInt(33554432),BigInt(67108864),BigInt(134217728),BigInt(268435456),BigInt(536870912),BigInt(1073741824),BigInt(524288),BigInt(2147483648),BigInt(1048576),BigInt(2097152),BigInt(4194304),BigInt(8388608),BigInt(68719476736),BigInt(0x3f0000000000000),BigInt(4294967296),BigInt(4503599627370496),BigInt(9007199254740992),BigInt(0x40000000000000),BigInt(0x80000000000000),BigInt(72057594037927940),BigInt(0x200000000000000),BigInt(8589934592),BigInt(17179869184),BigInt(34359738368),BigInt(51539607552)),function(u){u[u.EBRT_STANDARD_RESULT=0]="EBRT_STANDARD_RESULT",u[u.EBRT_CANDIDATE_RESULT=1]="EBRT_CANDIDATE_RESULT",u[u.EBRT_PARTIAL_RESULT=2]="EBRT_PARTIAL_RESULT"}(tI||(tI={})),function(u){u[u.QRECL_ERROR_CORRECTION_H=0]="QRECL_ERROR_CORRECTION_H",u[u.QRECL_ERROR_CORRECTION_L=1]="QRECL_ERROR_CORRECTION_L",u[u.QRECL_ERROR_CORRECTION_M=2]="QRECL_ERROR_CORRECTION_M",u[u.QRECL_ERROR_CORRECTION_Q=3]="QRECL_ERROR_CORRECTION_Q"}(nI||(nI={})),function(u){u[u.LM_AUTO=1]="LM_AUTO",u[u.LM_CONNECTED_BLOCKS=2]="LM_CONNECTED_BLOCKS",u[u.LM_STATISTICS=4]="LM_STATISTICS",u[u.LM_LINES=8]="LM_LINES",u[u.LM_SCAN_DIRECTLY=16]="LM_SCAN_DIRECTLY",u[u.LM_STATISTICS_MARKS=32]="LM_STATISTICS_MARKS",u[u.LM_STATISTICS_POSTAL_CODE=64]="LM_STATISTICS_POSTAL_CODE",u[u.LM_CENTRE=128]="LM_CENTRE",u[u.LM_ONED_FAST_SCAN=256]="LM_ONED_FAST_SCAN",u[u.LM_REV=-2147483648]="LM_REV",u[u.LM_SKIP=0]="LM_SKIP"}(iI||(iI={})),function(u){u[u.DM_DIRECT_BINARIZATION=1]="DM_DIRECT_BINARIZATION",u[u.DM_THRESHOLD_BINARIZATION=2]="DM_THRESHOLD_BINARIZATION",u[u.DM_GRAY_EQUALIZATION=4]="DM_GRAY_EQUALIZATION",u[u.DM_SMOOTHING=8]="DM_SMOOTHING",u[u.DM_MORPHING=16]="DM_MORPHING",u[u.DM_DEEP_ANALYSIS=32]="DM_DEEP_ANALYSIS",u[u.DM_SHARPENING=64]="DM_SHARPENING",u[u.DM_BASED_ON_LOC_BIN=128]="DM_BASED_ON_LOC_BIN",u[u.DM_SHARPENING_SMOOTHING=256]="DM_SHARPENING_SMOOTHING",u[u.DM_REV=-2147483648]="DM_REV",u[u.DM_SKIP=0]="DM_SKIP"}(rI||(rI={}));const oI="undefined"==typeof self,F_=(()=>{if(!oI&&document.currentScript){let u=document.currentScript.src,a=u.indexOf("?");if(-1!=a)u=u.substring(0,a);else{let l=u.indexOf("#");-1!=l&&(u=u.substring(0,l))}return u.substring(0,u.lastIndexOf("/")+1)}return"./"})(),aI=u=>{if(null==u&&(u="./"),!oI){let a=document.createElement("a");a.href=u,u=a.href}return u.endsWith("/")||(u+="/"),u};null==Ke.utility&&(Ke.utility=F_),Ds.utility={js:!0,wasm:!0};const P_="1.2.10";"string"!=typeof Ke.std&&oo(Ke.std.version,P_)<0&&(Ke.std={version:P_,path:aI(F_+`../../dynamsoft-capture-vision-std@${P_}/dist/`)});const N_="2.2.30";(!Ke.dip||"string"!=typeof Ke.dip&&oo(Ke.dip.version,N_)<0)&&(Ke.dip={version:N_,path:aI(F_+`../../dynamsoft-image-processing@${N_}/dist/`)});let Ps="./";if(document.currentScript){let u=document.currentScript.src,a=u.indexOf("?");if(-1!=a)u=u.substring(0,a);else{let l=u.indexOf("#");-1!=l&&(u=u.substring(0,l))}Ps=u.substring(0,u.lastIndexOf("/")+1)}const yo=u=>{null==u&&(u="./");let a=document.createElement("a");return a.href=u,(u=a.href).endsWith("/")||(u+="/"),u};Qt.engineResourcePaths={std:yo(Ps+"../../dynamsoft-capture-vision-std@1.2.10/dist/"),dip:yo(Ps+"../../dynamsoft-image-processing@2.2.30/dist/"),core:yo(Ps+"../../dynamsoft-core@3.2.30/dist/"),license:yo(Ps+"../../dynamsoft-license@3.2.21/dist/"),cvr:yo(Ps+"../../dynamsoft-capture-vision-router@2.2.30/dist/"),dce:yo(Ps+"../../dynamsoft-camera-enhancer@4.0.3/dist/"),dbr:yo(Ps+"../../dynamsoft-barcode-reader@10.2.10/dist/")};let xj=(()=>{class u{constructor(){this.showDiv=!1}getShowDiv(){return this.showDiv}setShowDiv(l){this.showDiv=l}toggleShowDiv(){this.showDiv=!this.showDiv}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275prov=mt({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const Aj=function(){return["/barcode-reader"]};function Rj(u,a){if(1&u&&(ln(0,"div")(1,"a",7),pr(2),tn()()),2&u){const l=Il().$implicit;lr(1),dr("title",l.name+" details")("routerLink",Yu(3,Aj)),lr(1),ra("> ",l.name," ")}}const Oj=function(){return["/barcode-scanner"]};function Mj(u,a){if(1&u&&(ln(0,"a",7),pr(1),tn()),2&u){const l=Il().$implicit;dr("title",l.name+" details")("routerLink",Yu(3,Oj)),lr(1),ra("> ",l.name," ")}}function Lj(u,a){if(1&u&&(ln(0,"p"),pr(1),tn()),2&u){const l=Il().$implicit;lr(1),ra("Description: ",l.description,"")}}function Fj(u,a){if(1&u&&(ln(0,"div")(1,"h3"),ta(2,Rj,3,4,"div",5),ta(3,Mj,2,4,"ng-template",null,6,aw),tn(),ta(5,Lj,2,1,"p",3),tn()),2&u){const l=a.$implicit,f=function aC(u){return function To(u,a){return u[a]}(function Mx(){return qe.lFrame.contextLView}(),20+u)}(4);lr(2),dr("ngIf","reader"===l.id)("ngIfElse",f),lr(3),dr("ngIf",l.description)}}function Pj(u,a){if(1&u&&(ln(0,"div")(1,"h2"),pr(2,"Examples"),tn(),ta(3,Fj,6,3,"div",4),tn()),2&u){const l=Il();lr(3),dr("ngForOf",l.products)}}let Nj=(()=>{class u{constructor(l){this.sharedService=l,this.products=XV,this.inputText="",this.processedText="",this.placeholderText="DLS2eyJoYW5kc2hha2VDb2RlIjoiMjAwMDAxLTE2NDk4Mjk3OTI2MzUiLCJvcmdhbml6YXRpb25JRCI6IjIwMDAwMSIsInNlc3Npb25QYXNzd29yZCI6IndTcGR6Vm05WDJrcEQ5YUoifQ=="}activate(){var l=this;return ae(function*(){l.processedText=l.inputText.toUpperCase(),Qt.engineResourcePaths={std:"assets/dynamsoft-capture-vision-std/",dip:"assets/dynamsoft-image-processing/",core:"assets/dynamsoft-core/",license:"assets/dynamsoft-license/",cvr:"assets/dynamsoft-capture-vision-router/",dbr:"assets/dynamsoft-barcode-reader/",dce:"assets/dynamsoft-camera-enhancer/"};try{let f=""===l.inputText?l.placeholderText:l.inputText;yield Ft.initLicense(f,!0),Qt.loadWasm(["DBR"]),l.toggleDivVisibility()}catch(f){alert(f)}})()}toggleDivVisibility(){this.sharedService.toggleShowDiv()}get showDiv(){return this.sharedService.getShowDiv()}}return u.\u0275fac=function(l){return new(l||u)(ve(xj))},u.\u0275cmp=os({type:u,selectors:[["app-product-list"]],decls:9,vars:3,consts:[["href","https://www.dynamsoft.com/customer/license/trialLicense","target","_blank"],["type","text",3,"ngModel","placeholder","ngModelChange"],[3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["elseBlock",""],[3,"title","routerLink"]],template:function(l,f){1&l&&(ln(0,"div")(1,"div"),pr(2," Get a License key from "),ln(3,"a",0),pr(4,"here"),tn()(),ln(5,"input",1),Tn("ngModelChange",function(p){return f.inputText=p}),tn(),ln(6,"button",2),Tn("click",function(){return f.activate()}),pr(7,"Activate SDK"),tn()(),ta(8,Pj,4,1,"div",3)),2&l&&(lr(5),dr("ngModel",f.inputText)("placeholder",f.placeholderText),lr(3),dr("ngIf",f.showDiv))},directives:[ph,nD,cm,ub,lb,ac],styles:[""]}),u})();class lI{initOverlay(a){this.overlay=a,this.context=this.overlay.getContext("2d")}updateOverlay(a,l){this.overlay&&(this.overlay.width=a,this.overlay.height=l,this.clearOverlay())}clearOverlay(){this.context&&this.overlay&&(this.context.clearRect(0,0,this.overlay.width,this.overlay.height),this.context.strokeStyle="#ff0000",this.context.lineWidth=5)}drawOverlay(a,l){if(this.context){let f=a.points;this.context.beginPath(),this.context.moveTo(f[0].x,f[0].y),this.context.lineTo(f[1].x,f[1].y),this.context.lineTo(f[2].x,f[2].y),this.context.lineTo(f[3].x,f[3].y),this.context.lineTo(f[0].x,f[0].y),this.context.stroke(),this.context.font="18px Verdana",this.context.fillStyle="#ff0000";let g=[f[0].x,f[1].x,f[2].x,f[3].x],p=[f[0].y,f[1].y,f[2].y,f[3].y];g.sort(function(b,O){return b-O}),p.sort(function(b,O){return O-b}),this.context.fillText(l,g[0],p[0]+50)}}}let kj=(()=>{class u{constructor(){this.isLoaded=!1,this.overlayManager=new lI}ngOnInit(){var l=this;this.overlayManager.initOverlay(document.getElementById("overlay")),ae(function*(){l.cvr=yield wt.createInstance(),l.isLoaded=!0})()}onChange(l){let g=l.currentTarget.files;if(g){let p=g.item(0);if(p){let _=new FileReader;_.onload=y=>{let b=document.getElementById("image");if(b){b.src=y.target.result;const O=new Image;O.onload=M=>{this.overlayManager.updateOverlay(O.width,O.height),this.cvr&&this.cvr.capture(p,"ReadBarcodes_Balance").then(P=>{console.log(P);let k=[],V=document.getElementById("result");try{let z,Y=P.items;if(Y.length>0){for(var H=0;H<Y.length;++H){if(Y[H].type!==Jt.CRIT_BARCODE)continue;let X=Y[H];k.push(X.text),z=X.location,console.log(z),this.overlayManager.drawOverlay(z,X.text)}V&&(V.innerHTML=k.join(", "))}else V&&(V.innerHTML=k.join(", "))}catch(z){alert(z)}})},O.src=y.target.result}},_.readAsDataURL(p)}}}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275cmp=os({type:u,selectors:[["app-barcode-reader"]],decls:6,vars:0,consts:[["type","file","id","file","accept","image/*",3,"change"],["id","result"],["id","imageview"],["id","image"],["id","overlay"]],template:function(l,f){1&l&&(ln(0,"input",0),Tn("change",function(p){return f.onChange(p)}),tn(),ln(1,"div"),ps(2,"a",1),tn(),ln(3,"div",2),ps(4,"img",3)(5,"canvas",4),tn())},styles:["#imageview[_ngcontent-%COMP%]{position:absolute;width:20vw}#image[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}#overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:contain}"]}),u})();const Bj=[{path:"",component:Nj},{path:"barcode-reader",component:kj},{path:"barcode-scanner",component:(()=>{class u{constructor(){this.isLoaded=!1,this.cameraInfo={},this.isDestroyed=!1,this.overlayManager=new lI}ngOnInit(){var l=this;this.videoSelect=document.querySelector("select#videoSource"),this.overlayManager.initOverlay(document.getElementById("overlay")),ae(function*(){yield l.initBarcodeScanner()})()}ngOnDestroy(){var l,f;this.isDestroyed=!0;try{null===(l=this.cvr)||void 0===l||l.dispose(),null===(f=this.cameraEnhancer)||void 0===f||f.dispose()}catch(g){}}updateResolution(){if(this.cameraEnhancer&&this.overlayManager){let l=this.cameraEnhancer.getResolution();this.overlayManager.updateOverlay(l.width,l.height)}}initBarcodeScanner(){var l=this;return ae(function*(){var f,g,p,_;const y=yield rn.createInstance();l.cameraEnhancer=yield rt.createInstance(y),l.isLoaded=!0;let b=document.getElementById("videoContainer");if(b){b.append(y.getUIElement()),null===(g=null===(f=y.getUIElement().shadowRoot)||void 0===f?void 0:f.querySelector(".dce-sel-camera"))||void 0===g||g.setAttribute("style","display: none"),null===(_=null===(p=y.getUIElement().shadowRoot)||void 0===p?void 0:p.querySelector(".dce-sel-resolution"))||void 0===_||_.setAttribute("style","display: none");let O=yield l.cameraEnhancer.getAllCameras();if(l.listCameras(O),l.cvr=yield wt.createInstance(),l.isDestroyed||(l.cvr.setInput(l.cameraEnhancer),l.cvr.addResultReceiver({onCapturedResultReceived:M=>{l.overlayManager.clearOverlay();let P=[],k=document.getElementById("result");try{let H,z=M.items;if(z.length>0){for(var V=0;V<z.length;++V){if(z[V].type!==Jt.CRIT_BARCODE)continue;let Y=z[V];P.push(Y.text),H=Y.location,console.log(H),l.overlayManager.drawOverlay(H,Y.text)}k&&(k.innerHTML=P.join(", "))}else k&&(k.innerHTML=P.join(", "))}catch(H){alert(H)}}}),l.cvr.addResultReceiver({onDecodedBarcodesReceived:M=>{!M.barcodeResultItems.length||console.log(M)}}),l.cameraEnhancer.on("played",()=>{l.updateResolution()}),yield l.openCamera(),l.isDestroyed)||(yield l.cvr.startCapturing("ReadSingleBarcode"),l.isDestroyed))throw Error("VideoCapture Component Destroyed")}})()}openCamera(){var l=this;return ae(function*(){if(l.overlayManager.clearOverlay(),l.videoSelect){let f=l.videoSelect.value;l.cameraEnhancer&&(yield l.cameraEnhancer.selectCamera(f),yield l.cameraEnhancer.open())}})()}listCameras(l){for(var f=0;f<l.length;++f){var g=l[f],p=document.createElement("option");p.value=g.deviceId,p.text=g.label,this.cameraInfo[g.deviceId]=g,this.videoSelect&&this.videoSelect.appendChild(p)}}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275cmp=os({type:u,selectors:[["app-barcode-scanner"]],decls:7,vars:0,consts:[[1,"select"],["for","videoSource"],["id","videoSource",3,"change"],["id","videoview"],["id","videoContainer",1,"dce-video-container"],["id","overlay"]],template:function(l,f){1&l&&(ln(0,"div",0)(1,"label",1),pr(2,"Video source: "),tn(),ln(3,"select",2),Tn("change",function(){return f.openCamera()}),tn()(),ln(4,"div",3),ps(5,"div",4)(6,"canvas",5),tn())},styles:["#videoview[_ngcontent-%COMP%]{position:absolute;width:40vw;height:40vh}#videoContainer[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;z-index:1}#overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:2;object-fit:contain}"]}),u})()}];let Vj=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275mod=nr({type:u}),u.\u0275inj=Pi({imports:[[US.forRoot(Bj)],US]}),u})();const jj=function(){return["/"]};let Uj=(()=>{class u{constructor(){}ngOnInit(){}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275cmp=os({type:u,selectors:[["app-top-bar"]],decls:3,vars:2,consts:[[3,"routerLink"]],template:function(l,f){1&l&&(ln(0,"a",0)(1,"h1"),pr(2,"Dynamsoft Capture Vision SDK"),tn()()),2&l&&dr("routerLink",Yu(1,jj))},directives:[ac],styles:[""]}),u})(),Gj=(()=>{class u{constructor(){this.title="angular-barcode-qr-code-scanner"}}return u.\u0275fac=function(l){return new(l||u)},u.\u0275cmp=os({type:u,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"container"]],template:function(l,f){1&l&&(ps(0,"app-top-bar"),ln(1,"div",0),ps(2,"router-outlet"),tn())},directives:[Uj,Rm],styles:[""]}),u})(),Hj=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275mod=nr({type:u,bootstrap:[Gj]}),u.\u0275inj=Pi({providers:[],imports:[[_k,Vj,F2]]}),u})();(function JF(){Bw=!1})(),pk().bootstrapModule(Hj).catch(u=>console.error(u))}},Pt=>{Pt(Pt.s=942)}]);
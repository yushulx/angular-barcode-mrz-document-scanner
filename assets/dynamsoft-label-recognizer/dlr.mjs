/*!
* Dynamsoft JavaScript Library
* @product Dynamsoft Label Recognizer JS Edition
* @website http://www.dynamsoft.com
* @copyright Copyright 2024, Dynamsoft Corporation
* @author Dynamsoft
* @version 3.4.20
* @fileoverview Dynamsoft JavaScript Library for Barcode Reader
* More info on dlr JS: https://www.dynamsoft.com/label-recognition/docs/web/programming/javascript/
*/
import{autoDiscoveryPaths as t,workerAutoResources as e,compareVersion as r,mapPackageRegister as a,innerVersions as s,loadWasm as c,getNextTaskID as n,mapTaskCallBack as o,handleEngineResourcePaths as i,CoreModule as l,worker as h}from"dynamsoft-core";const u="undefined"==typeof self,d=(()=>{if(!u&&document.currentScript){let t=document.currentScript.src,e=t.indexOf("?");if(-1!=e)t=t.substring(0,e);else{let e=t.indexOf("#");-1!=e&&(t=t.substring(0,e))}return t.substring(0,t.lastIndexOf("/")+1)}return"./"})(),R=t=>{if(null==t&&(t="./"),u);else{let e=document.createElement("a");e.href=t,t=e.href}return t.endsWith("/")||(t+="/"),t};t.dlr={version:"3.4.20",path:d},null==t.dlrData&&(t.dlrData={version:"1.0.11",path:R(d+"../../dynamsoft-label-recognizer-data@1.0.11/dist/")}),e.dlr={js:!0,wasm:!0,deps:["license","dip","dnn"]},e.dnn={wasm:!0,deps:["dip"]};const p="1.4.10";"string"!=typeof t.std&&r(t.std.version,p)<0&&(t.std={version:p,path:R(d+`../../dynamsoft-capture-vision-std@${p}/dist/`)});const f="2.4.20";(!t.dip||"string"!=typeof t.dip&&r(t.dip.version,f)<0)&&(t.dip={version:f,path:R(d+`../../dynamsoft-image-processing@${f}/dist/`)});const g="1.0.20";(!t.dnn||"string"!=typeof t.dnn&&r(t.dnn.version,g)<0)&&(t.dnn={version:g,path:R(d+`../../dynamsoft-capture-vision-dnn@${g}/dist/`)});let x=!1;class C{static getVersion(){const t=s.dlr&&s.dlr.wasm,e=s.dlr&&s.dlr.worker;return`3.4.20(Worker: ${e||"Not Loaded"}, Wasm: ${t||"Not Loaded"})`}static async loadRecognitionData(e,r){return await c("dlr"),await new Promise(((a,s)=>{let c=n();o[c]=async t=>{if(t.success){const e=t.result;if(0!==e.exception){let t=new Error(e.description);return t.errorCode=e.exception,s(t)}return e.bModel||(x=!0),a(e)}{let e=new Error(t.message);return e.stack=t.stack+"\n"+e.stack,s(e)}},r&&!r.endsWith("/")&&(r+="/");const u=i(l.engineResourcePaths,t);r||"ConfusableChars"!==e||(r=u.dlr),h.postMessage({type:"dlr_loadData",id:c,body:{dataName:e,dataPath:r||u.dlrData}})}))}}a.dlr={loadRecognitionData:C.loadRecognitionData,get bLoadConfusableCharsData(){return x}};const S={filterVINResult:function(t){let e="";if(18===t.characterResults.length){let e=t.characterResults[9].location.points[0].x-t.characterResults[8].location.points[1].x;e<2&&(e=2);let r=t.characterResults[1].location.points[0].x-t.characterResults[0].location.points[1].x,a=t.characterResults[17].location.points[0].x-t.characterResults[16].location.points[1].x,s=2===e?3:e;if(r-e>=s&&a-e<s)t.characterResults.shift();else if(a-e>=s&&r-e<s)t.characterResults.pop();else{t.characterResults[0].characterHConfidence>t.characterResults[17].characterHConfidence?t.characterResults.pop():t.characterResults.shift()}}else if(19===t.characterResults.length){let e=t.characterResults[10].location.points[0].x-t.characterResults[9].location.points[1].x;e<2&&(e=2);let r,a,s,c=t.characterResults[1].location.points[0].x-t.characterResults[0].location.points[1].x,n=t.characterResults[18].location.points[0].x-t.characterResults[17].location.points[1].x,o=t.characterResults[2].location.points[0].x-t.characterResults[1].location.points[1].x,i=t.characterResults[17].location.points[0].x-t.characterResults[16].location.points[1].x,l=2===e?3:e;if("1"===t.characterResults[1].characterH||"1"===t.characterResults[2].characterH||"1"===t.characterResults[16].characterH||"1"===t.characterResults[17].characterH){for(let e=9;e<t.characterResults.length;e++)if("1"!==t.characterResults[e].characterH){s=t.characterResults[e].location.points[1].x-t.characterResults[e].location.points[0].x;break}"1"===t.characterResults[1].characterH&&(r=s-(t.characterResults[1].location.points[1].x-t.characterResults[1].location.points[0].x)+3),"1"===t.characterResults[2].characterH&&(r=s-(t.characterResults[2].location.points[1].x-t.characterResults[2].location.points[0].x)+3),"1"===t.characterResults[16].characterH&&(a=s-(t.characterResults[16].location.points[1].x-t.characterResults[16].location.points[0].x)+3),"1"===t.characterResults[17].characterH&&(a=s-(t.characterResults[17].location.points[1].x-t.characterResults[17].location.points[0].x)+3)}if(o-e>=(r||l)&&i-e<(a||l))t.characterResults.splice(0,2);else if(i-e>=(a||l)&&o-e<(r||l))t.characterResults.splice(17,2);else if(c>e&&n>e)t.characterResults.pop(),t.characterResults.shift();else{let e=t.characterResults[0].characterHConfidence+t.characterResults[1].characterHConfidence,r=t.characterResults[17].characterHConfidence+t.characterResults[18].characterHConfidence,a=t.characterResults[0].characterHConfidence+t.characterResults[18].characterHConfidence,s=Math.min(e,r,a);s===e?t.characterResults.splice(0,2):s===r?t.characterResults.splice(17,2):s===a&&(t.characterResults.pop(),t.characterResults.shift())}}for(let r of t.characterResults)e+=r.characterH;return e},checkValidVIN:function(t){if(!t||17!=t.length)return!1;return(t=>{const e=new Map([["A",1],["B",2],["C",3],["D",4],["E",5],["F",6],["G",7],["H",8],["J",1],["K",2],["L",3],["M",4],["N",5],["P",7],["R",9],["S",2],["T",3],["U",4],["V",5],["W",6],["X",7],["Y",8],["Z",9],["1",1],["2",2],["3",3],["4",4],["5",5],["6",6],["7",7],["8",8],["9",9]]),r=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2];let a=0;for(let s=0;s<t.length;s++){let c=e.get(t[s]);c&&(a+=c*r[s])}return a%11})(t).toString()===t[8]},checkValidMRP:function(t){if(!t||44!=t.length)return!1;const e=(t,e,r)=>{const a=new Map([["<",0],["0",0],["1",1],["2",2],["3",3],["4",4],["5",5],["6",6],["7",7],["8",8],["9",9],["A",10],["B",11],["C",12],["D",13],["E",14],["F",15],["G",16],["H",17],["I",18],["J",19],["K",20],["L",21],["M",22],["N",23],["O",24],["P",25],["Q",26],["R",27],["S",28],["T",29],["U",30],["V",31],["W",32],["X",33],["Y",34],["Z",35]]),s=[7,3,1];let c=0;for(let n=e,o=0;n<=r;n++){let e=a.get(t[n]);e&&(c+=e*s[o%3]),o++}return c%10},r=t.slice(0,10)+t.slice(13,20)+t.slice(21,43),a=e(t,0,8).toString(),s=e(t,13,18).toString(),c=e(t,21,26).toString(),n=e(t,28,41).toString(),o=e(r,0,r.length).toString();return a===t[9]&&s===t[19]&&c===t[27]&&n===t[42]&&o===t[43]},checkValidMRV:function(t){if(!t||44!=t.length&&36!=t.length)return!1;const e=(t,e,r)=>{const a=new Map([["<",0],["0",0],["1",1],["2",2],["3",3],["4",4],["5",5],["6",6],["7",7],["8",8],["9",9],["A",10],["B",11],["C",12],["D",13],["E",14],["F",15],["G",16],["H",17],["I",18],["J",19],["K",20],["L",21],["M",22],["N",23],["O",24],["P",25],["Q",26],["R",27],["S",28],["T",29],["U",30],["V",31],["W",32],["X",33],["Y",34],["Z",35]]),s=[7,3,1];let c=0;for(let n=e,o=0;n<=r;n++){let e=a.get(t[n]);e&&(c+=e*s[o%3]),o++}return c%10},r=e(t,0,8).toString(),a=e(t,13,18).toString(),s=e(t,21,26).toString();return r===t[9]&&a===t[19]&&s===t[27]},checkValidIDCard:function(t,e){if(!t||30!=t.length&&36!=t.length)return!1;const r=(t,e,r)=>{const a=new Map([["<",0],["0",0],["1",1],["2",2],["3",3],["4",4],["5",5],["6",6],["7",7],["8",8],["9",9],["A",10],["B",11],["C",12],["D",13],["E",14],["F",15],["G",16],["H",17],["I",18],["J",19],["K",20],["L",21],["M",22],["N",23],["O",24],["P",25],["Q",26],["R",27],["S",28],["T",29],["U",30],["V",31],["W",32],["X",33],["Y",34],["Z",35]]),s=[7,3,1];let c=0;for(let n=e,o=0;n<=r;n++){let e=a.get(t[n]);e&&(c+=e*s[o%3]),o++}return c%10};if(30===t.length){if(e&&t===e){return r(t,5,13).toString()===t[14]}if(e&&t!==e){const a=`${e.substring(5,30)}${t.substring(0,7)}${t.substring(8,15)}${t.substring(18,29)}`;return r(a,0,a.length-1).toString()===t[29]}}else if(36===t.length){const e=r(t,0,8).toString(),a=r(t,13,18).toString(),s=r(t,21,26).toString(),c=`${t.substring(0,10)}${t.substring(13,20)}${t.substring(21,28)}`,n=r(c,0,c.length-1).toString();return e===t[9]&&a===t[19]&&s===t[27]&&n===t[35]}}};var D;!function(t){t[t.RTLS_LOCALIZED=0]="RTLS_LOCALIZED",t[t.RTLS_RECOGNITION_FAILED=1]="RTLS_RECOGNITION_FAILED",t[t.RTLS_RECOGNITION_SUCCEEDED=2]="RTLS_RECOGNITION_SUCCEEDED"}(D||(D={})),o[-1]=async t=>{C.onDataLoadProgressChanged&&C.onDataLoadProgressChanged(t.resourcesPath,t.tag,{loaded:t.loaded,total:t.total})};export{D as EnumRawTextLineStatus,C as LabelRecognizerModule,S as utilsFuncs};
